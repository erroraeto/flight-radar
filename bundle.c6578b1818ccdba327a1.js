/*! For license information please see bundle.c6578b1818ccdba327a1.js.LICENSE.txt */
(()=>{var e={216:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23333%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27m10.5 14 4-8 4 8z%27/%3E%3Cpath fill=%27%23ccc%27 d=%27m10.5 16 4 8 4-8z%27/%3E%3C/svg%3E"},540:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},557:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23fff%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3C/svg%3E"},961:(e,t,r)=>{"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=r(6221)},1113:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},1166:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;var i=n(r(6540));r(1353);var a=r(5582);t.App=function(){return i.default.createElement(i.default.Fragment,null,i.default.createElement(a.MapFrame,null))}},1247:(e,t,r)=>{"use strict";var n=r(9982),i=r(6540),a=r(961);function o(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function u(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function h(e){if(l(e)!==e)throw Error(o(188))}function d(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=d(e)))return t;e=e.sibling}return null}var p=Object.assign,f=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),b=Symbol.for("react.consumer"),x=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),E=Symbol.for("react.lazy");Symbol.for("react.scope");var C=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var M=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var k=Symbol.iterator;function I(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=k&&e[k]||e["@@iterator"])?e:null}var A=Symbol.for("react.client.reference");function z(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===A?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case _:return"Fragment";case v:return"Profiler";case y:return"StrictMode";case T:return"Suspense";case S:return"SuspenseList";case C:return"Activity"}if("object"==typeof e)switch(e.$$typeof){case g:return"Portal";case x:return e.displayName||"Context";case b:return(e._context.displayName||"Context")+".Consumer";case w:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:z(e.type)||"Memo";case E:t=e._payload,e=e._init;try{return z(e(t))}catch(e){}}return null}var D=Array.isArray,L=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F={pending:!1,data:null,method:null,action:null},B=[],O=-1;function N(e){return{current:e}}function V(e){0>O||(e.current=B[O],B[O]=null,O--)}function j(e,t){O++,B[O]=e.current,e.current=t}var U,G,q=N(null),$=N(null),Z=N(null),H=N(null);function W(e,t){switch(j(Z,t),j($,e),j(q,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?_h(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=yh(t=_h(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}V(q),j(q,e)}function X(){V(q),V($),V(Z)}function Y(e){null!==e.memoizedState&&j(H,e);var t=q.current,r=yh(t,e.type);t!==r&&(j($,e),j(q,r))}function K(e){$.current===e&&(V(q),V($)),H.current===e&&(V(H),ud._currentValue=F)}function Q(e){if(void 0===U)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);U=t&&t[1]||"",G=-1<e.stack.indexOf("\n    at")?" (<anonymous>)":-1<e.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+U+e+G}var J=!1;function ee(e,t){if(!e||J)return"";J=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var n={DetermineComponentFrameRoot:function(){try{if(t){var r=function(){throw Error()};if(Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(r,[])}catch(e){var n=e}Reflect.construct(e,[],r)}else{try{r.call()}catch(e){n=e}e.call(r.prototype)}}else{try{throw Error()}catch(e){n=e}(r=e())&&"function"==typeof r.catch&&r.catch(function(){})}}catch(e){if(e&&n&&"string"==typeof e.stack)return[e.stack,n.stack]}return[null,null]}};n.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(n.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(n.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var a=n.DetermineComponentFrameRoot(),o=a[0],s=a[1];if(o&&s){var l=o.split("\n"),c=s.split("\n");for(i=n=0;n<l.length&&!l[n].includes("DetermineComponentFrameRoot");)n++;for(;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;if(n===l.length||i===c.length)for(n=l.length-1,i=c.length-1;1<=n&&0<=i&&l[n]!==c[i];)i--;for(;1<=n&&0<=i;n--,i--)if(l[n]!==c[i]){if(1!==n||1!==i)do{if(n--,0>--i||l[n]!==c[i]){var u="\n"+l[n].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=n&&0<=i);break}}}finally{J=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?Q(r):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return Q(e.type);case 16:return Q("Lazy");case 13:return e.child!==t&&null!==t?Q("Suspense Fallback"):Q("Suspense");case 19:return Q("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return Q("Activity");default:return""}}function re(e){try{var t="",r=null;do{t+=te(e,r),r=e,e=e.return}while(e);return t}catch(e){return"\nError generating stack: "+e.message+"\n"+e.stack}}var ne=Object.prototype.hasOwnProperty,ie=n.unstable_scheduleCallback,ae=n.unstable_cancelCallback,oe=n.unstable_shouldYield,se=n.unstable_requestPaint,le=n.unstable_now,ce=n.unstable_getCurrentPriorityLevel,ue=n.unstable_ImmediatePriority,he=n.unstable_UserBlockingPriority,de=n.unstable_NormalPriority,pe=n.unstable_LowPriority,fe=n.unstable_IdlePriority,me=n.log,ge=n.unstable_setDisableYieldValue,_e=null,ye=null;function ve(e){if("function"==typeof me&&ge(e),ye&&"function"==typeof ye.setStrictMode)try{ye.setStrictMode(_e,e)}catch(e){}}var be=Math.clz32?Math.clz32:function(e){return 0==(e>>>=0)?32:31-(xe(e)/we|0)|0},xe=Math.log,we=Math.LN2,Te=256,Se=262144,Pe=4194304;function Ee(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ce(e,t,r){var n=e.pendingLanes;if(0===n)return 0;var i=0,a=e.suspendedLanes,o=e.pingedLanes;e=e.warmLanes;var s=134217727&n;return 0!==s?0!==(n=s&~a)?i=Ee(n):0!==(o&=s)?i=Ee(o):r||0!==(r=s&~e)&&(i=Ee(r)):0!==(s=n&~a)?i=Ee(s):0!==o?i=Ee(o):r||0!==(r=n&~e)&&(i=Ee(r)),0===i?0:0!==t&&t!==i&&0===(t&a)&&((a=i&-i)>=(r=t&-t)||32===a&&4194048&r)?t:i}function Me(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function ke(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Ie(){var e=Pe;return!(62914560&(Pe<<=1))&&(Pe=4194304),e}function Ae(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ze(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function De(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var n=31-be(t);e.entangledLanes|=t,e.entanglements[n]=1073741824|e.entanglements[n]|261930&r}function Le(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-be(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}function Re(e,t){var r=t&-t;return 0!==((r=42&r?1:Fe(r))&(e.suspendedLanes|t))?0:r}function Fe(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Be(e){return 2<(e&=-e)?8<e?134217727&e?32:268435456:8:2}function Oe(){var e=R.p;return 0!==e?e:void 0===(e=window.event)?32:Ed(e.type)}function Ne(e,t){var r=R.p;try{return R.p=e,t()}finally{R.p=r}}var Ve=Math.random().toString(36).slice(2),je="__reactFiber$"+Ve,Ue="__reactProps$"+Ve,Ge="__reactContainer$"+Ve,qe="__reactEvents$"+Ve,$e="__reactListeners$"+Ve,Ze="__reactHandles$"+Ve,He="__reactResources$"+Ve,We="__reactMarker$"+Ve;function Xe(e){delete e[je],delete e[Ue],delete e[qe],delete e[$e],delete e[Ze]}function Ye(e){var t=e[je];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ge]||r[je]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=Fh(e);null!==e;){if(r=e[je])return r;e=Fh(e)}return t}r=(e=r).parentNode}return null}function Ke(e){if(e=e[je]||e[Ge]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Qe(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(o(33))}function Je(e){var t=e[He];return t||(t=e[He]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[We]=!0}var tt=new Set,rt={};function nt(e,t){it(e,t),it(e+"Capture",t)}function it(e,t){for(rt[e]=t,e=0;e<t.length;e++)tt.add(t[e])}var at=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ot={},st={};function lt(e,t,r){if(i=t,ne.call(st,i)||!ne.call(ot,i)&&(at.test(i)?st[i]=!0:(ot[i]=!0,0)))if(null===r)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var n=t.toLowerCase().slice(0,5);if("data-"!==n&&"aria-"!==n)return void e.removeAttribute(t)}e.setAttribute(t,""+r)}var i}function ct(e,t,r){if(null===r)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+r)}}function ut(e,t,r,n){if(null===n)e.removeAttribute(r);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(r)}e.setAttributeNS(t,r,""+n)}}function ht(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function dt(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function pt(e){if(!e._valueTracker){var t=dt(e)?"checked":"value";e._valueTracker=function(e,t,r){var n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function ft(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=dt(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function mt(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var gt=/[\n"\\]/g;function _t(e){return e.replace(gt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function yt(e,t,r,n,i,a,o,s){e.name="",null!=o&&"function"!=typeof o&&"symbol"!=typeof o&&"boolean"!=typeof o?e.type=o:e.removeAttribute("type"),null!=t?"number"===o?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ht(t)):e.value!==""+ht(t)&&(e.value=""+ht(t)):"submit"!==o&&"reset"!==o||e.removeAttribute("value"),null!=t?bt(e,o,ht(t)):null!=r?bt(e,o,ht(r)):null!=n&&e.removeAttribute("value"),null==i&&null!=a&&(e.defaultChecked=!!a),null!=i&&(e.checked=i&&"function"!=typeof i&&"symbol"!=typeof i),null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&"boolean"!=typeof s?e.name=""+ht(s):e.removeAttribute("name")}function vt(e,t,r,n,i,a,o,s){if(null!=a&&"function"!=typeof a&&"symbol"!=typeof a&&"boolean"!=typeof a&&(e.type=a),null!=t||null!=r){if(("submit"===a||"reset"===a)&&null==t)return void pt(e);r=null!=r?""+ht(r):"",t=null!=t?""+ht(t):r,s||t===e.value||(e.value=t),e.defaultValue=t}n="function"!=typeof(n=null!=n?n:i)&&"symbol"!=typeof n&&!!n,e.checked=s?e.checked:!!n,e.defaultChecked=!!n,null!=o&&"function"!=typeof o&&"symbol"!=typeof o&&"boolean"!=typeof o&&(e.name=o),pt(e)}function bt(e,t,r){"number"===t&&mt(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function xt(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ht(r),t=null,i=0;i<e.length;i++){if(e[i].value===r)return e[i].selected=!0,void(n&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function wt(e,t,r){null==t||((t=""+ht(t))!==e.value&&(e.value=t),null!=r)?e.defaultValue=null!=r?""+ht(r):"":e.defaultValue!==t&&(e.defaultValue=t)}function Tt(e,t,r,n){if(null==t){if(null!=n){if(null!=r)throw Error(o(92));if(D(n)){if(1<n.length)throw Error(o(93));n=n[0]}r=n}null==r&&(r=""),t=r}r=ht(t),e.defaultValue=r,(n=e.textContent)===r&&""!==n&&null!==n&&(e.value=n),pt(e)}function St(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var Pt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Et(e,t,r){var n=0===t.indexOf("--");null==r||"boolean"==typeof r||""===r?n?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":n?e.setProperty(t,r):"number"!=typeof r||0===r||Pt.has(t)?"float"===t?e.cssFloat=r:e[t]=(""+r).trim():e[t]=r+"px"}function Ct(e,t,r){if(null!=t&&"object"!=typeof t)throw Error(o(62));if(e=e.style,null!=r){for(var n in r)!r.hasOwnProperty(n)||null!=t&&t.hasOwnProperty(n)||(0===n.indexOf("--")?e.setProperty(n,""):"float"===n?e.cssFloat="":e[n]="");for(var i in t)n=t[i],t.hasOwnProperty(i)&&r[i]!==n&&Et(e,i,n)}else for(var a in t)t.hasOwnProperty(a)&&Et(e,a,t[a])}function Mt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),It=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function At(e){return It.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function zt(){}var Dt=null;function Lt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Rt=null,Ft=null;function Bt(e){var t=Ke(e);if(t&&(e=t.stateNode)){var r=e[Ue]||null;e:switch(e=t.stateNode,t.type){case"input":if(yt(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+_t(""+t)+'"][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=n[Ue]||null;if(!i)throw Error(o(90));yt(n,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<r.length;t++)(n=r[t]).form===e.form&&ft(n)}break e;case"textarea":wt(e,r.value,r.defaultValue);break e;case"select":null!=(t=r.value)&&xt(e,!!r.multiple,t,!1)}}}var Ot=!1;function Nt(e,t,r){if(Ot)return e(t,r);Ot=!0;try{return e(t)}finally{if(Ot=!1,(null!==Rt||null!==Ft)&&(Jc(),Rt&&(t=Rt,e=Ft,Ft=Rt=null,Bt(t),e)))for(t=0;t<e.length;t++)Bt(e[t])}}function Vt(e,t){var r=e.stateNode;if(null===r)return null;var n=r[Ue]||null;if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!=typeof r)throw Error(o(231,t,typeof r));return r}var jt=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),Ut=!1;if(jt)try{var Gt={};Object.defineProperty(Gt,"passive",{get:function(){Ut=!0}}),window.addEventListener("test",Gt,Gt),window.removeEventListener("test",Gt,Gt)}catch(e){Ut=!1}var qt=null,$t=null,Zt=null;function Ht(){if(Zt)return Zt;var e,t,r=$t,n=r.length,i="value"in qt?qt.value:qt.textContent,a=i.length;for(e=0;e<n&&r[e]===i[e];e++);var o=n-e;for(t=1;t<=o&&r[n-t]===i[a-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function Wt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Xt(){return!0}function Yt(){return!1}function Kt(e){function t(t,r,n,i,a){for(var o in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?Xt:Yt,this.isPropagationStopped=Yt,this}return p(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Xt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Xt)},persist:function(){},isPersistent:Xt}),t}var Qt,Jt,er,tr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rr=Kt(tr),nr=p({},tr,{view:0,detail:0}),ir=Kt(nr),ar=p({},nr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==er&&(er&&"mousemove"===e.type?(Qt=e.screenX-er.screenX,Jt=e.screenY-er.screenY):Jt=Qt=0,er=e),Qt)},movementY:function(e){return"movementY"in e?e.movementY:Jt}}),or=Kt(ar),sr=Kt(p({},ar,{dataTransfer:0})),lr=Kt(p({},nr,{relatedTarget:0})),cr=Kt(p({},tr,{animationName:0,elapsedTime:0,pseudoElement:0})),ur=Kt(p({},tr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),hr=Kt(p({},tr,{data:0})),dr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=fr[e])&&!!t[e]}function gr(){return mr}var _r=Kt(p({},nr,{key:function(e){if(e.key){var t=dr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Wt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?pr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gr,charCode:function(e){return"keypress"===e.type?Wt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Wt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),yr=Kt(p({},ar,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),vr=Kt(p({},nr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gr})),br=Kt(p({},tr,{propertyName:0,elapsedTime:0,pseudoElement:0})),xr=Kt(p({},ar,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),wr=Kt(p({},tr,{newState:0,oldState:0})),Tr=[9,13,27,32],Sr=jt&&"CompositionEvent"in window,Pr=null;jt&&"documentMode"in document&&(Pr=document.documentMode);var Er=jt&&"TextEvent"in window&&!Pr,Cr=jt&&(!Sr||Pr&&8<Pr&&11>=Pr),Mr=String.fromCharCode(32),kr=!1;function Ir(e,t){switch(e){case"keyup":return-1!==Tr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ar(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var zr=!1,Dr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Dr[e.type]:"textarea"===t}function Rr(e,t,r,n){Rt?Ft?Ft.push(n):Ft=[n]:Rt=n,0<(t=nh(t,"onChange")).length&&(r=new rr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Fr=null,Br=null;function Or(e){Xu(e,0)}function Nr(e){if(ft(Qe(e)))return e}function Vr(e,t){if("change"===e)return t}var jr=!1;if(jt){var Ur;if(jt){var Gr="oninput"in document;if(!Gr){var qr=document.createElement("div");qr.setAttribute("oninput","return;"),Gr="function"==typeof qr.oninput}Ur=Gr}else Ur=!1;jr=Ur&&(!document.documentMode||9<document.documentMode)}function $r(){Fr&&(Fr.detachEvent("onpropertychange",Zr),Br=Fr=null)}function Zr(e){if("value"===e.propertyName&&Nr(Br)){var t=[];Rr(t,Br,e,Lt(e)),Nt(Or,t)}}function Hr(e,t,r){"focusin"===e?($r(),Br=r,(Fr=t).attachEvent("onpropertychange",Zr)):"focusout"===e&&$r()}function Wr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Nr(Br)}function Xr(e,t){if("click"===e)return Nr(t)}function Yr(e,t){if("input"===e||"change"===e)return Nr(t)}var Kr="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function Qr(e,t){if(Kr(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!ne.call(t,i)||!Kr(e[i],t[i]))return!1}return!0}function Jr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function en(e,t){var r,n=Jr(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Jr(n)}}function tn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?tn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function rn(e){for(var t=mt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var r="string"==typeof t.contentWindow.location.href}catch(e){r=!1}if(!r)break;t=mt((e=t.contentWindow).document)}return t}function nn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var an=jt&&"documentMode"in document&&11>=document.documentMode,on=null,sn=null,ln=null,cn=!1;function un(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;cn||null==on||on!==mt(n)||(n="selectionStart"in(n=on)&&nn(n)?{start:n.selectionStart,end:n.selectionEnd}:{anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},ln&&Qr(ln,n)||(ln=n,0<(n=nh(sn,"onSelect")).length&&(t=new rr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=on)))}function hn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var dn={animationend:hn("Animation","AnimationEnd"),animationiteration:hn("Animation","AnimationIteration"),animationstart:hn("Animation","AnimationStart"),transitionrun:hn("Transition","TransitionRun"),transitionstart:hn("Transition","TransitionStart"),transitioncancel:hn("Transition","TransitionCancel"),transitionend:hn("Transition","TransitionEnd")},pn={},fn={};function mn(e){if(pn[e])return pn[e];if(!dn[e])return e;var t,r=dn[e];for(t in r)if(r.hasOwnProperty(t)&&t in fn)return pn[e]=r[t];return e}jt&&(fn=document.createElement("div").style,"AnimationEvent"in window||(delete dn.animationend.animation,delete dn.animationiteration.animation,delete dn.animationstart.animation),"TransitionEvent"in window||delete dn.transitionend.transition);var gn=mn("animationend"),_n=mn("animationiteration"),yn=mn("animationstart"),vn=mn("transitionrun"),bn=mn("transitionstart"),xn=mn("transitioncancel"),wn=mn("transitionend"),Tn=new Map,Sn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pn(e,t){Tn.set(e,t),nt(t,[e])}Sn.push("scrollEnd");var En="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Cn=[],Mn=0,kn=0;function In(){for(var e=Mn,t=kn=Mn=0;t<e;){var r=Cn[t];Cn[t++]=null;var n=Cn[t];Cn[t++]=null;var i=Cn[t];Cn[t++]=null;var a=Cn[t];if(Cn[t++]=null,null!==n&&null!==i){var o=n.pending;null===o?i.next=i:(i.next=o.next,o.next=i),n.pending=i}0!==a&&Ln(r,i,a)}}function An(e,t,r,n){Cn[Mn++]=e,Cn[Mn++]=t,Cn[Mn++]=r,Cn[Mn++]=n,kn|=n,e.lanes|=n,null!==(e=e.alternate)&&(e.lanes|=n)}function zn(e,t,r,n){return An(e,t,r,n),Rn(e)}function Dn(e,t){return An(e,null,null,t),Rn(e)}function Ln(e,t,r){e.lanes|=r;var n=e.alternate;null!==n&&(n.lanes|=r);for(var i=!1,a=e.return;null!==a;)a.childLanes|=r,null!==(n=a.alternate)&&(n.childLanes|=r),22===a.tag&&(null===(e=a.stateNode)||1&e._visibility||(i=!0)),e=a,a=a.return;return 3===e.tag?(a=e.stateNode,i&&null!==t&&(i=31-be(r),null===(n=(e=a.hiddenUpdates)[i])?e[i]=[t]:n.push(t),t.lane=536870912|r),a):null}function Rn(e){if(50<qc)throw qc=0,$c=null,Error(o(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Fn={};function Bn(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function On(e,t,r,n){return new Bn(e,t,r,n)}function Nn(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Vn(e,t){var r=e.alternate;return null===r?((r=On(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=65011712&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function jn(e,t){e.flags&=65011714;var r=e.alternate;return null===r?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,t=r.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Un(e,t,r,n,i,a){var s=0;if(n=e,"function"==typeof e)Nn(e)&&(s=1);else if("string"==typeof e)s=function(e,t,r){if(1===r||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!=typeof t.precedence||"string"!=typeof t.href||""===t.href)break;return!0;case"link":if("string"!=typeof t.rel||"string"!=typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"==typeof t.precedence&&null==e);case"script":if(t.async&&"function"!=typeof t.async&&"symbol"!=typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"==typeof t.src)return!0}return!1}(e,r,q.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case C:return(e=On(31,r,t,i)).elementType=C,e.lanes=a,e;case _:return Gn(r.children,i,a,t);case y:s=8,i|=24;break;case v:return(e=On(12,r,t,2|i)).elementType=v,e.lanes=a,e;case T:return(e=On(13,r,t,i)).elementType=T,e.lanes=a,e;case S:return(e=On(19,r,t,i)).elementType=S,e.lanes=a,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case x:s=10;break e;case b:s=9;break e;case w:s=11;break e;case P:s=14;break e;case E:s=16,n=null;break e}s=29,r=Error(o(130,null===e?"null":typeof e,"")),n=null}return(t=On(s,r,t,i)).elementType=e,t.type=n,t.lanes=a,t}function Gn(e,t,r,n){return(e=On(7,e,n,t)).lanes=r,e}function qn(e,t,r){return(e=On(6,e,null,t)).lanes=r,e}function $n(e){var t=On(18,null,null,0);return t.stateNode=e,t}function Zn(e,t,r){return(t=On(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Hn=new WeakMap;function Wn(e,t){if("object"==typeof e&&null!==e){var r=Hn.get(e);return void 0!==r?r:(t={value:e,source:t,stack:re(t)},Hn.set(e,t),t)}return{value:e,source:t,stack:re(t)}}var Xn=[],Yn=0,Kn=null,Qn=0,Jn=[],ei=0,ti=null,ri=1,ni="";function ii(e,t){Xn[Yn++]=Qn,Xn[Yn++]=Kn,Kn=e,Qn=t}function ai(e,t,r){Jn[ei++]=ri,Jn[ei++]=ni,Jn[ei++]=ti,ti=e;var n=ri;e=ni;var i=32-be(n)-1;n&=~(1<<i),r+=1;var a=32-be(t)+i;if(30<a){var o=i-i%5;a=(n&(1<<o)-1).toString(32),n>>=o,i-=o,ri=1<<32-be(t)+i|r<<i|n,ni=a+e}else ri=1<<a|r<<i|n,ni=e}function oi(e){null!==e.return&&(ii(e,1),ai(e,1,0))}function si(e){for(;e===Kn;)Kn=Xn[--Yn],Xn[Yn]=null,Qn=Xn[--Yn],Xn[Yn]=null;for(;e===ti;)ti=Jn[--ei],Jn[ei]=null,ni=Jn[--ei],Jn[ei]=null,ri=Jn[--ei],Jn[ei]=null}function li(e,t){Jn[ei++]=ri,Jn[ei++]=ni,Jn[ei++]=ti,ri=t.id,ni=t.overflow,ti=e}var ci=null,ui=null,hi=!1,di=null,pi=!1,fi=Error(o(519));function mi(e){throw xi(Wn(Error(o(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),fi}function gi(e){var t=e.stateNode,r=e.type,n=e.memoizedProps;switch(t[je]=e,t[Ue]=n,r){case"dialog":Yu("cancel",t),Yu("close",t);break;case"iframe":case"object":case"embed":Yu("load",t);break;case"video":case"audio":for(r=0;r<Hu.length;r++)Yu(Hu[r],t);break;case"source":Yu("error",t);break;case"img":case"image":case"link":Yu("error",t),Yu("load",t);break;case"details":Yu("toggle",t);break;case"input":Yu("invalid",t),vt(t,n.value,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name,!0);break;case"select":Yu("invalid",t);break;case"textarea":Yu("invalid",t),Tt(t,n.value,n.defaultValue,n.children)}"string"!=typeof(r=n.children)&&"number"!=typeof r&&"bigint"!=typeof r||t.textContent===""+r||!0===n.suppressHydrationWarning||ch(t.textContent,r)?(null!=n.popover&&(Yu("beforetoggle",t),Yu("toggle",t)),null!=n.onScroll&&Yu("scroll",t),null!=n.onScrollEnd&&Yu("scrollend",t),null!=n.onClick&&(t.onclick=zt),t=!0):t=!1,t||mi(e,!0)}function _i(e){for(ci=e.return;ci;)switch(ci.tag){case 5:case 31:case 13:return void(pi=!1);case 27:case 3:return void(pi=!0);default:ci=ci.return}}function yi(e){if(e!==ci)return!1;if(!hi)return _i(e),hi=!0,!1;var t,r=e.tag;if((t=3!==r&&27!==r)&&((t=5===r)&&(t=!("form"!==(t=e.type)&&"button"!==t)||vh(e.type,e.memoizedProps)),t=!t),t&&ui&&mi(e),_i(e),13===r){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));ui=Rh(e)}else if(31===r){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));ui=Rh(e)}else 27===r?(r=ui,Eh(e.type)?(e=Lh,Lh=null,ui=e):ui=r):ui=ci?Dh(e.stateNode.nextSibling):null;return!0}function vi(){ui=ci=null,hi=!1}function bi(){var e=di;return null!==e&&(null===Ic?Ic=e:Ic.push.apply(Ic,e),di=null),e}function xi(e){null===di?di=[e]:di.push(e)}var wi=N(null),Ti=null,Si=null;function Pi(e,t,r){j(wi,t._currentValue),t._currentValue=r}function Ei(e){e._currentValue=wi.current,V(wi)}function Ci(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Mi(e,t,r,n){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var a=i.dependencies;if(null!==a){var s=i.child;a=a.firstContext;e:for(;null!==a;){var l=a;a=i;for(var c=0;c<t.length;c++)if(l.context===t[c]){a.lanes|=r,null!==(l=a.alternate)&&(l.lanes|=r),Ci(a.return,r,e),n||(s=null);break e}a=l.next}}else if(18===i.tag){if(null===(s=i.return))throw Error(o(341));s.lanes|=r,null!==(a=s.alternate)&&(a.lanes|=r),Ci(s,r,e),s=null}else s=i.child;if(null!==s)s.return=i;else for(s=i;null!==s;){if(s===e){s=null;break}if(null!==(i=s.sibling)){i.return=s.return,s=i;break}s=s.return}i=s}}function ki(e,t,r,n){e=null;for(var i=t,a=!1;null!==i;){if(!a)if(524288&i.flags)a=!0;else if(262144&i.flags)break;if(10===i.tag){var s=i.alternate;if(null===s)throw Error(o(387));if(null!==(s=s.memoizedProps)){var l=i.type;Kr(i.pendingProps.value,s.value)||(null!==e?e.push(l):e=[l])}}else if(i===H.current){if(null===(s=i.alternate))throw Error(o(387));s.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(ud):e=[ud])}i=i.return}null!==e&&Mi(t,e,r,n),t.flags|=262144}function Ii(e){for(e=e.firstContext;null!==e;){if(!Kr(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ai(e){Ti=e,Si=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function zi(e){return Li(Ti,e)}function Di(e,t){return null===Ti&&Ai(e),Li(e,t)}function Li(e,t){var r=t._currentValue;if(t={context:t,memoizedValue:r,next:null},null===Si){if(null===e)throw Error(o(308));Si=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Si=Si.next=t;return r}var Ri="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,r){e.push(r)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Fi=n.unstable_scheduleCallback,Bi=n.unstable_NormalPriority,Oi={$$typeof:x,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ni(){return{controller:new Ri,data:new Map,refCount:0}}function Vi(e){e.refCount--,0===e.refCount&&Fi(Bi,function(){e.controller.abort()})}var ji=null,Ui=0,Gi=0,qi=null;function $i(){if(0===--Ui&&null!==ji){null!==qi&&(qi.status="fulfilled");var e=ji;ji=null,Gi=0,qi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Zi=L.S;L.S=function(e,t){Dc=le(),"object"==typeof t&&null!==t&&"function"==typeof t.then&&function(e,t){if(null===ji){var r=ji=[];Ui=0,Gi=Uu(),qi={status:"pending",value:void 0,then:function(e){r.push(e)}}}Ui++,t.then($i,$i)}(0,t),null!==Zi&&Zi(e,t)};var Hi=N(null);function Wi(){var e=Hi.current;return null!==e?e:fc.pooledCache}function Xi(e,t){j(Hi,null===t?Hi.current:t.pool)}function Yi(){var e=Wi();return null===e?null:{parent:Oi._currentValue,pool:e}}var Ki=Error(o(460)),Qi=Error(o(474)),Ji=Error(o(542)),ea={then:function(){}};function ta(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ra(e,t,r){switch(void 0===(r=e[r])?e.push(t):r!==t&&(t.then(zt,zt),t=r),t.status){case"fulfilled":return t.value;case"rejected":throw oa(e=t.reason),e;default:if("string"==typeof t.status)t.then(zt,zt);else{if(null!==(e=fc)&&100<e.shellSuspendCounter)throw Error(o(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var r=t;r.status="fulfilled",r.value=e}},function(e){if("pending"===t.status){var r=t;r.status="rejected",r.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw oa(e=t.reason),e}throw ia=t,Ki}}function na(e){try{return(0,e._init)(e._payload)}catch(e){if(null!==e&&"object"==typeof e&&"function"==typeof e.then)throw ia=e,Ki;throw e}}var ia=null;function aa(){if(null===ia)throw Error(o(459));var e=ia;return ia=null,e}function oa(e){if(e===Ki||e===Ji)throw Error(o(483))}var sa=null,la=0;function ca(e){var t=la;return la+=1,null===sa&&(sa=[]),ra(sa,e,t)}function ua(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function ha(e,t){if(t.$$typeof===f)throw Error(o(525));throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function da(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Vn(e,t)).index=0,e.sibling=null,e}function a(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=67108866,r):n:(t.flags|=67108866,r):(t.flags|=1048576,r)}function s(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,r,n){return null===t||6!==t.tag?((t=qn(r,e.mode,n)).return=e,t):((t=i(t,r)).return=e,t)}function c(e,t,r,n){var a=r.type;return a===_?h(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===E&&na(a)===t.type)?(ua(t=i(t,r.props),r),t.return=e,t):(ua(t=Un(r.type,r.key,r.props,null,e.mode,n),r),t.return=e,t)}function u(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Zn(r,e.mode,n)).return=e,t):((t=i(t,r.children||[])).return=e,t)}function h(e,t,r,n,a){return null===t||7!==t.tag?((t=Gn(r,e.mode,n,a)).return=e,t):((t=i(t,r)).return=e,t)}function d(e,t,r){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return(t=qn(""+t,e.mode,r)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case m:return ua(r=Un(t.type,t.key,t.props,null,e.mode,r),t),r.return=e,r;case g:return(t=Zn(t,e.mode,r)).return=e,t;case E:return d(e,t=na(t),r)}if(D(t)||I(t))return(t=Gn(t,e.mode,r,null)).return=e,t;if("function"==typeof t.then)return d(e,ca(t),r);if(t.$$typeof===x)return d(e,Di(e,t),r);ha(e,t)}return null}function p(e,t,r,n){var i=null!==t?t.key:null;if("string"==typeof r&&""!==r||"number"==typeof r||"bigint"==typeof r)return null!==i?null:l(e,t,""+r,n);if("object"==typeof r&&null!==r){switch(r.$$typeof){case m:return r.key===i?c(e,t,r,n):null;case g:return r.key===i?u(e,t,r,n):null;case E:return p(e,t,r=na(r),n)}if(D(r)||I(r))return null!==i?null:h(e,t,r,n,null);if("function"==typeof r.then)return p(e,t,ca(r),n);if(r.$$typeof===x)return p(e,t,Di(e,r),n);ha(e,r)}return null}function f(e,t,r,n,i){if("string"==typeof n&&""!==n||"number"==typeof n||"bigint"==typeof n)return l(t,e=e.get(r)||null,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case m:return c(t,e=e.get(null===n.key?r:n.key)||null,n,i);case g:return u(t,e=e.get(null===n.key?r:n.key)||null,n,i);case E:return f(e,t,r,n=na(n),i)}if(D(n)||I(n))return h(t,e=e.get(r)||null,n,i,null);if("function"==typeof n.then)return f(e,t,r,ca(n),i);if(n.$$typeof===x)return f(e,t,r,Di(t,n),i);ha(t,n)}return null}function y(l,c,u,h){if("object"==typeof u&&null!==u&&u.type===_&&null===u.key&&(u=u.props.children),"object"==typeof u&&null!==u){switch(u.$$typeof){case m:e:{for(var v=u.key;null!==c;){if(c.key===v){if((v=u.type)===_){if(7===c.tag){r(l,c.sibling),(h=i(c,u.props.children)).return=l,l=h;break e}}else if(c.elementType===v||"object"==typeof v&&null!==v&&v.$$typeof===E&&na(v)===c.type){r(l,c.sibling),ua(h=i(c,u.props),u),h.return=l,l=h;break e}r(l,c);break}t(l,c),c=c.sibling}u.type===_?((h=Gn(u.props.children,l.mode,h,u.key)).return=l,l=h):(ua(h=Un(u.type,u.key,u.props,null,l.mode,h),u),h.return=l,l=h)}return s(l);case g:e:{for(v=u.key;null!==c;){if(c.key===v){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){r(l,c.sibling),(h=i(c,u.children||[])).return=l,l=h;break e}r(l,c);break}t(l,c),c=c.sibling}(h=Zn(u,l.mode,h)).return=l,l=h}return s(l);case E:return y(l,c,u=na(u),h)}if(D(u))return function(i,o,s,l){for(var c=null,u=null,h=o,m=o=0,g=null;null!==h&&m<s.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var _=p(i,h,s[m],l);if(null===_){null===h&&(h=g);break}e&&h&&null===_.alternate&&t(i,h),o=a(_,o,m),null===u?c=_:u.sibling=_,u=_,h=g}if(m===s.length)return r(i,h),hi&&ii(i,m),c;if(null===h){for(;m<s.length;m++)null!==(h=d(i,s[m],l))&&(o=a(h,o,m),null===u?c=h:u.sibling=h,u=h);return hi&&ii(i,m),c}for(h=n(h);m<s.length;m++)null!==(g=f(h,i,m,s[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),o=a(g,o,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach(function(e){return t(i,e)}),hi&&ii(i,m),c}(l,c,u,h);if(I(u)){if("function"!=typeof(v=I(u)))throw Error(o(150));return function(i,s,l,c){if(null==l)throw Error(o(151));for(var u=null,h=null,m=s,g=s=0,_=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(_=m,m=null):_=m.sibling;var v=p(i,m,y.value,c);if(null===v){null===m&&(m=_);break}e&&m&&null===v.alternate&&t(i,m),s=a(v,s,g),null===h?u=v:h.sibling=v,h=v,m=_}if(y.done)return r(i,m),hi&&ii(i,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=d(i,y.value,c))&&(s=a(y,s,g),null===h?u=y:h.sibling=y,h=y);return hi&&ii(i,g),u}for(m=n(m);!y.done;g++,y=l.next())null!==(y=f(m,i,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),s=a(y,s,g),null===h?u=y:h.sibling=y,h=y);return e&&m.forEach(function(e){return t(i,e)}),hi&&ii(i,g),u}(l,c,u=v.call(u),h)}if("function"==typeof u.then)return y(l,c,ca(u),h);if(u.$$typeof===x)return y(l,c,Di(l,u),h);ha(l,u)}return"string"==typeof u&&""!==u||"number"==typeof u||"bigint"==typeof u?(u=""+u,null!==c&&6===c.tag?(r(l,c.sibling),(h=i(c,u)).return=l,l=h):(r(l,c),(h=qn(u,l.mode,h)).return=l,l=h),s(l)):r(l,c)}return function(e,t,r,n){try{la=0;var i=y(e,t,r,n);return sa=null,i}catch(t){if(t===Ki||t===Ji)throw t;var a=On(29,t,null,e.mode);return a.lanes=n,a.return=e,a}}}var pa=da(!0),fa=da(!1),ma=!1;function ga(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function _a(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ya(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function va(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,2&pc){var i=n.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),n.pending=t,t=Rn(e),Ln(e,null,r),t}return An(e,n,t,r),Rn(e)}function ba(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,4194048&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,Le(e,r)}}function xa(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var i=null,a=null;if(null!==(r=r.firstBaseUpdate)){do{var o={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};null===a?i=a=o:a=a.next=o,r=r.next}while(null!==r);null===a?i=a=t:a=a.next=t}else i=a=t;return r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,callbacks:n.callbacks},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}var wa=!1;function Ta(){if(wa&&null!==qi)throw qi}function Sa(e,t,r,n){wa=!1;var i=e.updateQueue;ma=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var l=s,c=l.next;l.next=null,null===o?a=c:o.next=c,o=l;var u=e.alternate;null!==u&&(s=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l)}if(null!==a){var h=i.baseState;for(o=0,u=c=l=null,s=a;;){var d=-536870913&s.lane,f=d!==s.lane;if(f?(gc&d)===d:(n&d)===d){0!==d&&d===Gi&&(wa=!0),null!==u&&(u=u.next={lane:0,tag:s.tag,payload:s.payload,callback:null,next:null});e:{var m=e,g=s;d=t;var _=r;switch(g.tag){case 1:if("function"==typeof(m=g.payload)){h=m.call(_,h,d);break e}h=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null==(d="function"==typeof(m=g.payload)?m.call(_,h,d):m))break e;h=p({},h,d);break e;case 2:ma=!0}}null!==(d=s.callback)&&(e.flags|=64,f&&(e.flags|=8192),null===(f=i.callbacks)?i.callbacks=[d]:f.push(d))}else f={lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,o|=d;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(f=s).next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null===a&&(i.shared.lanes=0),Sc|=o,e.lanes=o,e.memoizedState=h}}function Pa(e,t){if("function"!=typeof e)throw Error(o(191,e));e.call(t)}function Ea(e,t){var r=e.callbacks;if(null!==r)for(e.callbacks=null,e=0;e<r.length;e++)Pa(r[e],t)}var Ca=N(null),Ma=N(0);function ka(e,t){j(Ma,e=wc),j(Ca,t),wc=e|t.baseLanes}function Ia(){j(Ma,wc),j(Ca,Ca.current)}function Aa(){wc=Ma.current,V(Ca),V(Ma)}var za=N(null),Da=null;function La(e){var t=e.alternate;j(Na,1&Na.current),j(za,e),null===Da&&(null===t||null!==Ca.current||null!==t.memoizedState)&&(Da=e)}function Ra(e){j(Na,Na.current),j(za,e),null===Da&&(Da=e)}function Fa(e){22===e.tag?(j(Na,Na.current),j(za,e),null===Da&&(Da=e)):Ba()}function Ba(){j(Na,Na.current),j(za,za.current)}function Oa(e){V(za),Da===e&&(Da=null),V(Na)}var Na=N(0);function Va(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||Ah(r)||zh(r)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(128&t.flags)return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ja=0,Ua=null,Ga=null,qa=null,$a=!1,Za=!1,Ha=!1,Wa=0,Xa=0,Ya=null,Ka=0;function Qa(){throw Error(o(321))}function Ja(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Kr(e[r],t[r]))return!1;return!0}function eo(e,t,r,n,i,a){return ja=a,Ua=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,L.H=null===e||null===e.memoizedState?gs:_s,Ha=!1,a=r(n,i),Ha=!1,Za&&(a=ro(t,r,n,i)),to(e),a}function to(e){L.H=ms;var t=null!==Ga&&null!==Ga.next;if(ja=0,qa=Ga=Ua=null,$a=!1,Xa=0,Ya=null,t)throw Error(o(300));null===e||Ds||null!==(e=e.dependencies)&&Ii(e)&&(Ds=!0)}function ro(e,t,r,n){Ua=e;var i=0;do{if(Za&&(Ya=null),Xa=0,Za=!1,25<=i)throw Error(o(301));if(i+=1,qa=Ga=null,null!=e.updateQueue){var a=e.updateQueue;a.lastEffect=null,a.events=null,a.stores=null,null!=a.memoCache&&(a.memoCache.index=0)}L.H=ys,a=t(r,n)}while(Za);return a}function no(){var e=L.H,t=e.useState()[0];return t="function"==typeof t.then?co(t):t,e=e.useState()[0],(null!==Ga?Ga.memoizedState:null)!==e&&(Ua.flags|=1024),t}function io(){var e=0!==Wa;return Wa=0,e}function ao(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function oo(e){if($a){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}$a=!1}ja=0,qa=Ga=Ua=null,Za=!1,Xa=Wa=0,Ya=null}function so(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===qa?Ua.memoizedState=qa=e:qa=qa.next=e,qa}function lo(){if(null===Ga){var e=Ua.alternate;e=null!==e?e.memoizedState:null}else e=Ga.next;var t=null===qa?Ua.memoizedState:qa.next;if(null!==t)qa=t,Ga=e;else{if(null===e){if(null===Ua.alternate)throw Error(o(467));throw Error(o(310))}e={memoizedState:(Ga=e).memoizedState,baseState:Ga.baseState,baseQueue:Ga.baseQueue,queue:Ga.queue,next:null},null===qa?Ua.memoizedState=qa=e:qa=qa.next=e}return qa}function co(e){var t=Xa;return Xa+=1,null===Ya&&(Ya=[]),e=ra(Ya,e,t),t=Ua,null===(null===qa?t.memoizedState:qa.next)&&(t=t.alternate,L.H=null===t||null===t.memoizedState?gs:_s),e}function uo(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return co(e);if(e.$$typeof===x)return zi(e)}throw Error(o(438,String(e)))}function ho(e){var t=null,r=Ua.updateQueue;if(null!==r&&(t=r.memoCache),null==t){var n=Ua.alternate;null!==n&&null!==(n=n.updateQueue)&&null!=(n=n.memoCache)&&(t={data:n.data.map(function(e){return e.slice()}),index:0})}if(null==t&&(t={data:[],index:0}),null===r&&(r={lastEffect:null,events:null,stores:null,memoCache:null},Ua.updateQueue=r),r.memoCache=t,void 0===(r=t.data[t.index]))for(r=t.data[t.index]=Array(e),n=0;n<e;n++)r[n]=M;return t.index++,r}function po(e,t){return"function"==typeof t?t(e):t}function fo(e){return mo(lo(),Ga,e)}function mo(e,t,r){var n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=r;var i=e.baseQueue,a=n.pending;if(null!==a){if(null!==i){var s=i.next;i.next=a.next,a.next=s}t.baseQueue=i=a,n.pending=null}if(a=e.baseState,null===i)e.memoizedState=a;else{var l=s=null,c=null,u=t=i.next,h=!1;do{var d=-536870913&u.lane;if(d!==u.lane?(gc&d)===d:(ja&d)===d){var p=u.revertLane;if(0===p)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),d===Gi&&(h=!0);else{if((ja&p)===p){u=u.next,p===Gi&&(h=!0);continue}d={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=d,s=a):c=c.next=d,Ua.lanes|=p,Sc|=p}d=u.action,Ha&&r(a,d),a=u.hasEagerState?u.eagerState:r(a,d)}else p={lane:d,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=p,s=a):c=c.next=p,Ua.lanes|=d,Sc|=d;u=u.next}while(null!==u&&u!==t);if(null===c?s=a:c.next=l,!Kr(a,e.memoizedState)&&(Ds=!0,h&&null!==(r=qi)))throw r;e.memoizedState=a,e.baseState=s,e.baseQueue=c,n.lastRenderedState=a}return null===i&&(n.lanes=0),[e.memoizedState,n.dispatch]}function go(e){var t=lo(),r=t.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(null!==i){r.pending=null;var s=i=i.next;do{a=e(a,s.action),s=s.next}while(s!==i);Kr(a,t.memoizedState)||(Ds=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function _o(e,t,r){var n=Ua,i=lo(),a=hi;if(a){if(void 0===r)throw Error(o(407));r=r()}else r=t();var s=!Kr((Ga||i).memoizedState,r);if(s&&(i.memoizedState=r,Ds=!0),i=i.queue,Uo(bo.bind(null,n,i,e),[e]),i.getSnapshot!==t||s||null!==qa&&1&qa.memoizedState.tag){if(n.flags|=2048,Bo(9,{destroy:void 0},vo.bind(null,n,i,r,t),null),null===fc)throw Error(o(349));a||127&ja||yo(n,t,r)}return r}function yo(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=Ua.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Ua.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function vo(e,t,r,n){t.value=r,t.getSnapshot=n,xo(t)&&wo(e)}function bo(e,t,r){return r(function(){xo(t)&&wo(e)})}function xo(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Kr(e,r)}catch(e){return!0}}function wo(e){var t=Dn(e,2);null!==t&&Wc(t,0,2)}function To(e){var t=so();if("function"==typeof e){var r=e;if(e=r(),Ha){ve(!0);try{r()}finally{ve(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:po,lastRenderedState:e},t}function So(e,t,r,n){return e.baseState=r,mo(e,Ga,"function"==typeof n?n:po)}function Po(e,t,r,n,i){if(ds(e))throw Error(o(485));if(null!==(e=t.action)){var a={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){a.listeners.push(e)}};null!==L.T?r(!0):a.isTransition=!1,n(a),null===(r=t.pending)?(a.next=t.pending=a,Eo(t,a)):(a.next=r.next,t.pending=r.next=a)}}function Eo(e,t){var r=t.action,n=t.payload,i=e.state;if(t.isTransition){var a=L.T,o={};L.T=o;try{var s=r(i,n),l=L.S;null!==l&&l(o,s),Co(e,t,s)}catch(r){ko(e,t,r)}finally{null!==a&&null!==o.types&&(a.types=o.types),L.T=a}}else try{Co(e,t,a=r(i,n))}catch(r){ko(e,t,r)}}function Co(e,t,r){null!==r&&"object"==typeof r&&"function"==typeof r.then?r.then(function(r){Mo(e,t,r)},function(r){return ko(e,t,r)}):Mo(e,t,r)}function Mo(e,t,r){t.status="fulfilled",t.value=r,Io(t),e.state=r,null!==(t=e.pending)&&((r=t.next)===t?e.pending=null:(r=r.next,t.next=r,Eo(e,r)))}function ko(e,t,r){var n=e.pending;if(e.pending=null,null!==n){n=n.next;do{t.status="rejected",t.reason=r,Io(t),t=t.next}while(t!==n)}e.action=null}function Io(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Ao(e,t){return t}function zo(e,t){if(hi){var r=fc.formState;if(null!==r){e:{var n=Ua;if(hi){if(ui){t:{for(var i=ui,a=pi;8!==i.nodeType;){if(!a){i=null;break t}if(null===(i=Dh(i.nextSibling))){i=null;break t}}i="F!"===(a=i.data)||"F"===a?i:null}if(i){ui=Dh(i.nextSibling),n="F!"===i.data;break e}}mi(n)}n=!1}n&&(t=r[0])}}return(r=so()).memoizedState=r.baseState=t,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ao,lastRenderedState:t},r.queue=n,r=cs.bind(null,Ua,n),n.dispatch=r,n=To(!1),a=hs.bind(null,Ua,!1,n.queue),i={state:t,dispatch:null,action:e,pending:null},(n=so()).queue=i,r=Po.bind(null,Ua,i,a,r),i.dispatch=r,n.memoizedState=e,[t,r,!1]}function Do(e){return Lo(lo(),Ga,e)}function Lo(e,t,r){if(t=mo(e,t,Ao)[0],e=fo(po)[0],"object"==typeof t&&null!==t&&"function"==typeof t.then)try{var n=co(t)}catch(e){if(e===Ki)throw Ji;throw e}else n=t;var i=(t=lo()).queue,a=i.dispatch;return r!==t.memoizedState&&(Ua.flags|=2048,Bo(9,{destroy:void 0},Ro.bind(null,i,r),null)),[n,a,e]}function Ro(e,t){e.action=t}function Fo(e){var t=lo(),r=Ga;if(null!==r)return Lo(t,r,e);lo(),t=t.memoizedState;var n=(r=lo()).queue.dispatch;return r.memoizedState=e,[t,n,!1]}function Bo(e,t,r,n){return e={tag:e,create:r,deps:n,inst:t,next:null},null===(t=Ua.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Ua.updateQueue=t),null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function Oo(){return lo().memoizedState}function No(e,t,r,n){var i=so();Ua.flags|=e,i.memoizedState=Bo(1|t,{destroy:void 0},r,void 0===n?null:n)}function Vo(e,t,r,n){var i=lo();n=void 0===n?null:n;var a=i.memoizedState.inst;null!==Ga&&null!==n&&Ja(n,Ga.memoizedState.deps)?i.memoizedState=Bo(t,a,r,n):(Ua.flags|=e,i.memoizedState=Bo(1|t,a,r,n))}function jo(e,t){No(8390656,8,e,t)}function Uo(e,t){Vo(2048,8,e,t)}function Go(e){var t=lo().memoizedState;return function(e){Ua.flags|=4;var t=Ua.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},Ua.updateQueue=t,t.events=[e];else{var r=t.events;null===r?t.events=[e]:r.push(e)}}({ref:t,nextImpl:e}),function(){if(2&pc)throw Error(o(440));return t.impl.apply(void 0,arguments)}}function qo(e,t){return Vo(4,2,e,t)}function $o(e,t){return Vo(4,4,e,t)}function Zo(e,t){if("function"==typeof t){e=e();var r=t(e);return function(){"function"==typeof r?r():t(null)}}if(null!=t)return e=e(),t.current=e,function(){t.current=null}}function Ho(e,t,r){r=null!=r?r.concat([e]):null,Vo(4,4,Zo.bind(null,t,e),r)}function Wo(){}function Xo(e,t){var r=lo();t=void 0===t?null:t;var n=r.memoizedState;return null!==t&&Ja(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Yo(e,t){var r=lo();t=void 0===t?null:t;var n=r.memoizedState;if(null!==t&&Ja(t,n[1]))return n[0];if(n=e(),Ha){ve(!0);try{e()}finally{ve(!1)}}return r.memoizedState=[n,t],n}function Ko(e,t,r){return void 0===r||1073741824&ja&&!(261930&gc)?e.memoizedState=t:(e.memoizedState=r,e=Hc(),Ua.lanes|=e,Sc|=e,r)}function Qo(e,t,r,n){return Kr(r,t)?r:null!==Ca.current?(e=Ko(e,r,n),Kr(e,t)||(Ds=!0),e):42&ja&&(!(1073741824&ja)||261930&gc)?(e=Hc(),Ua.lanes|=e,Sc|=e,t):(Ds=!0,e.memoizedState=r)}function Jo(e,t,r,n,i){var a=R.p;R.p=0!==a&&8>a?a:8;var o,s,l,c=L.T,u={};L.T=u,hs(e,!1,t,r);try{var h=i(),d=L.S;null!==d&&d(u,h),null!==h&&"object"==typeof h&&"function"==typeof h.then?us(e,t,(o=n,s=[],l={status:"pending",value:null,reason:null,then:function(e){s.push(e)}},h.then(function(){l.status="fulfilled",l.value=o;for(var e=0;e<s.length;e++)(0,s[e])(o)},function(e){for(l.status="rejected",l.reason=e,e=0;e<s.length;e++)(0,s[e])(void 0)}),l),Zc()):us(e,t,n,Zc())}catch(r){us(e,t,{then:function(){},status:"rejected",reason:r},Zc())}finally{R.p=a,null!==c&&null!==u.types&&(c.types=u.types),L.T=c}}function es(){}function ts(e,t,r,n){if(5!==e.tag)throw Error(o(476));var i=rs(e).queue;Jo(e,i,t,F,null===r?es:function(){return ns(e),r(n)})}function rs(e){var t=e.memoizedState;if(null!==t)return t;var r={};return(t={memoizedState:F,baseState:F,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:po,lastRenderedState:F},next:null}).next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:po,lastRenderedState:r},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function ns(e){var t=rs(e);null===t.next&&(t=e.alternate.memoizedState),us(e,t.next.queue,{},Zc())}function is(){return zi(ud)}function as(){return lo().memoizedState}function os(){return lo().memoizedState}function ss(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var r=Zc(),n=va(t,e=ya(r),r);return null!==n&&(Wc(n,0,r),ba(n,t,r)),t={cache:Ni()},void(e.payload=t)}t=t.return}}function ls(e,t,r){var n=Zc();r={lane:n,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},ds(e)?ps(t,r):null!==(r=zn(e,t,r,n))&&(Wc(r,0,n),fs(r,t,n))}function cs(e,t,r){us(e,t,r,Zc())}function us(e,t,r,n){var i={lane:n,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(ds(e))ps(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=a(o,r);if(i.hasEagerState=!0,i.eagerState=s,Kr(s,o))return An(e,t,i,0),null===fc&&In(),!1}catch(e){}if(null!==(r=zn(e,t,i,n)))return Wc(r,0,n),fs(r,t,n),!0}return!1}function hs(e,t,r,n){if(n={lane:2,revertLane:Uu(),gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},ds(e)){if(t)throw Error(o(479))}else null!==(t=zn(e,r,n,2))&&Wc(t,0,2)}function ds(e){var t=e.alternate;return e===Ua||null!==t&&t===Ua}function ps(e,t){Za=$a=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function fs(e,t,r){if(4194048&r){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,Le(e,r)}}var ms={readContext:zi,use:uo,useCallback:Qa,useContext:Qa,useEffect:Qa,useImperativeHandle:Qa,useLayoutEffect:Qa,useInsertionEffect:Qa,useMemo:Qa,useReducer:Qa,useRef:Qa,useState:Qa,useDebugValue:Qa,useDeferredValue:Qa,useTransition:Qa,useSyncExternalStore:Qa,useId:Qa,useHostTransitionStatus:Qa,useFormState:Qa,useActionState:Qa,useOptimistic:Qa,useMemoCache:Qa,useCacheRefresh:Qa};ms.useEffectEvent=Qa;var gs={readContext:zi,use:uo,useCallback:function(e,t){return so().memoizedState=[e,void 0===t?null:t],e},useContext:zi,useEffect:jo,useImperativeHandle:function(e,t,r){r=null!=r?r.concat([e]):null,No(4194308,4,Zo.bind(null,t,e),r)},useLayoutEffect:function(e,t){return No(4194308,4,e,t)},useInsertionEffect:function(e,t){No(4,2,e,t)},useMemo:function(e,t){var r=so();t=void 0===t?null:t;var n=e();if(Ha){ve(!0);try{e()}finally{ve(!1)}}return r.memoizedState=[n,t],n},useReducer:function(e,t,r){var n=so();if(void 0!==r){var i=r(t);if(Ha){ve(!0);try{r(t)}finally{ve(!1)}}}else i=t;return n.memoizedState=n.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},n.queue=e,e=e.dispatch=ls.bind(null,Ua,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},so().memoizedState=e},useState:function(e){var t=(e=To(e)).queue,r=cs.bind(null,Ua,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:Wo,useDeferredValue:function(e,t){return Ko(so(),e,t)},useTransition:function(){var e=To(!1);return e=Jo.bind(null,Ua,e.queue,!0,!1),so().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var n=Ua,i=so();if(hi){if(void 0===r)throw Error(o(407));r=r()}else{if(r=t(),null===fc)throw Error(o(349));127&gc||yo(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,jo(bo.bind(null,n,a,e),[e]),n.flags|=2048,Bo(9,{destroy:void 0},vo.bind(null,n,a,r,t),null),r},useId:function(){var e=so(),t=fc.identifierPrefix;if(hi){var r=ni;t="_"+t+"R_"+(r=(ri&~(1<<32-be(ri)-1)).toString(32)+r),0<(r=Wa++)&&(t+="H"+r.toString(32)),t+="_"}else t="_"+t+"r_"+(r=Ka++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:is,useFormState:zo,useActionState:zo,useOptimistic:function(e){var t=so();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=hs.bind(null,Ua,!0,r),r.dispatch=t,[e,t]},useMemoCache:ho,useCacheRefresh:function(){return so().memoizedState=ss.bind(null,Ua)},useEffectEvent:function(e){var t=so(),r={impl:e};return t.memoizedState=r,function(){if(2&pc)throw Error(o(440));return r.impl.apply(void 0,arguments)}}},_s={readContext:zi,use:uo,useCallback:Xo,useContext:zi,useEffect:Uo,useImperativeHandle:Ho,useInsertionEffect:qo,useLayoutEffect:$o,useMemo:Yo,useReducer:fo,useRef:Oo,useState:function(){return fo(po)},useDebugValue:Wo,useDeferredValue:function(e,t){return Qo(lo(),Ga.memoizedState,e,t)},useTransition:function(){var e=fo(po)[0],t=lo().memoizedState;return["boolean"==typeof e?e:co(e),t]},useSyncExternalStore:_o,useId:as,useHostTransitionStatus:is,useFormState:Do,useActionState:Do,useOptimistic:function(e,t){return So(lo(),0,e,t)},useMemoCache:ho,useCacheRefresh:os};_s.useEffectEvent=Go;var ys={readContext:zi,use:uo,useCallback:Xo,useContext:zi,useEffect:Uo,useImperativeHandle:Ho,useInsertionEffect:qo,useLayoutEffect:$o,useMemo:Yo,useReducer:go,useRef:Oo,useState:function(){return go(po)},useDebugValue:Wo,useDeferredValue:function(e,t){var r=lo();return null===Ga?Ko(r,e,t):Qo(r,Ga.memoizedState,e,t)},useTransition:function(){var e=go(po)[0],t=lo().memoizedState;return["boolean"==typeof e?e:co(e),t]},useSyncExternalStore:_o,useId:as,useHostTransitionStatus:is,useFormState:Fo,useActionState:Fo,useOptimistic:function(e,t){var r=lo();return null!==Ga?So(r,0,e,t):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:ho,useCacheRefresh:os};function vs(e,t,r,n){r=null==(r=r(n,t=e.memoizedState))?t:p({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}ys.useEffectEvent=Go;var bs={enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Zc(),i=ya(n);i.payload=t,null!=r&&(i.callback=r),null!==(t=va(e,i,n))&&(Wc(t,0,n),ba(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Zc(),i=ya(n);i.tag=1,i.payload=t,null!=r&&(i.callback=r),null!==(t=va(e,i,n))&&(Wc(t,0,n),ba(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Zc(),n=ya(r);n.tag=2,null!=t&&(n.callback=t),null!==(t=va(e,n,r))&&(Wc(t,0,r),ba(t,e,r))}};function xs(e,t,r,n,i,a,o){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,a,o):!(t.prototype&&t.prototype.isPureReactComponent&&Qr(r,n)&&Qr(i,a))}function ws(e,t,r,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&bs.enqueueReplaceState(t,t.state,null)}function Ts(e,t){var r=t;if("ref"in t)for(var n in r={},t)"ref"!==n&&(r[n]=t[n]);if(e=e.defaultProps)for(var i in r===t&&(r=p({},r)),e)void 0===r[i]&&(r[i]=e[i]);return r}function Ss(e){En(e)}function Ps(e){console.error(e)}function Es(e){En(e)}function Cs(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(e){setTimeout(function(){throw e})}}function Ms(e,t,r){try{(0,e.onCaughtError)(r.value,{componentStack:r.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(e){setTimeout(function(){throw e})}}function ks(e,t,r){return(r=ya(r)).tag=3,r.payload={element:null},r.callback=function(){Cs(e,t)},r}function Is(e){return(e=ya(e)).tag=3,e}function As(e,t,r,n){var i=r.type.getDerivedStateFromError;if("function"==typeof i){var a=n.value;e.payload=function(){return i(a)},e.callback=function(){Ms(t,r,n)}}var o=r.stateNode;null!==o&&"function"==typeof o.componentDidCatch&&(e.callback=function(){Ms(t,r,n),"function"!=typeof i&&(null===Fc?Fc=new Set([this]):Fc.add(this));var e=n.stack;this.componentDidCatch(n.value,{componentStack:null!==e?e:""})})}var zs=Error(o(461)),Ds=!1;function Ls(e,t,r,n){t.child=null===e?fa(t,null,r,n):pa(t,e.child,r,n)}function Rs(e,t,r,n,i){r=r.render;var a=t.ref;if("ref"in n){var o={};for(var s in n)"ref"!==s&&(o[s]=n[s])}else o=n;return Ai(t),n=eo(e,t,r,o,a,i),s=io(),null===e||Ds?(hi&&s&&oi(t),t.flags|=1,Ls(e,t,n,i),t.child):(ao(e,t,i),il(e,t,i))}function Fs(e,t,r,n,i){if(null===e){var a=r.type;return"function"!=typeof a||Nn(a)||void 0!==a.defaultProps||null!==r.compare?((e=Un(r.type,null,n,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Bs(e,t,a,n,i))}if(a=e.child,!al(e,i)){var o=a.memoizedProps;if((r=null!==(r=r.compare)?r:Qr)(o,n)&&e.ref===t.ref)return il(e,t,i)}return t.flags|=1,(e=Vn(a,n)).ref=t.ref,e.return=t,t.child=e}function Bs(e,t,r,n,i){if(null!==e){var a=e.memoizedProps;if(Qr(a,n)&&e.ref===t.ref){if(Ds=!1,t.pendingProps=n=a,!al(e,i))return t.lanes=e.lanes,il(e,t,i);131072&e.flags&&(Ds=!0)}}return qs(e,t,r,n,i)}function Os(e,t,r,n){var i=n.children,a=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===n.mode){if(128&t.flags){if(a=null!==a?a.baseLanes|r:r,null!==e){for(n=t.child=e.child,i=0;null!==n;)i=i|n.lanes|n.childLanes,n=n.sibling;n=i&~a}else n=0,t.child=null;return Vs(e,t,a,r,n)}if(!(536870912&r))return n=t.lanes=536870912,Vs(e,t,null!==a?a.baseLanes|r:r,r,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Xi(0,null!==a?a.cachePool:null),null!==a?ka(t,a):Ia(),Fa(t)}else null!==a?(Xi(0,a.cachePool),ka(t,a),Ba(),t.memoizedState=null):(null!==e&&Xi(0,null),Ia(),Ba());return Ls(e,t,i,r),t.child}function Ns(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Vs(e,t,r,n,i){var a=Wi();return a=null===a?null:{parent:Oi._currentValue,pool:a},t.memoizedState={baseLanes:r,cachePool:a},null!==e&&Xi(0,null),Ia(),Fa(t),null!==e&&ki(e,t,n,!0),t.childLanes=i,null}function js(e,t){return(t=Js({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function Us(e,t,r){return pa(t,e.child,null,r),(e=js(t,t.pendingProps)).flags|=2,Oa(t),t.memoizedState=null,e}function Gs(e,t){var r=t.ref;if(null===r)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!=typeof r&&"object"!=typeof r)throw Error(o(284));null!==e&&e.ref===r||(t.flags|=4194816)}}function qs(e,t,r,n,i){return Ai(t),r=eo(e,t,r,n,void 0,i),n=io(),null===e||Ds?(hi&&n&&oi(t),t.flags|=1,Ls(e,t,r,i),t.child):(ao(e,t,i),il(e,t,i))}function $s(e,t,r,n,i,a){return Ai(t),t.updateQueue=null,r=ro(t,n,r,i),to(e),n=io(),null===e||Ds?(hi&&n&&oi(t),t.flags|=1,Ls(e,t,r,a),t.child):(ao(e,t,a),il(e,t,a))}function Zs(e,t,r,n,i){if(Ai(t),null===t.stateNode){var a=Fn,o=r.contextType;"object"==typeof o&&null!==o&&(a=zi(o)),a=new r(n,a),t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,a.updater=bs,t.stateNode=a,a._reactInternals=t,(a=t.stateNode).props=n,a.state=t.memoizedState,a.refs={},ga(t),o=r.contextType,a.context="object"==typeof o&&null!==o?zi(o):Fn,a.state=t.memoizedState,"function"==typeof(o=r.getDerivedStateFromProps)&&(vs(t,r,o,n),a.state=t.memoizedState),"function"==typeof r.getDerivedStateFromProps||"function"==typeof a.getSnapshotBeforeUpdate||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||(o=a.state,"function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),o!==a.state&&bs.enqueueReplaceState(a,a.state,null),Sa(t,n,a,i),Ta(),a.state=t.memoizedState),"function"==typeof a.componentDidMount&&(t.flags|=4194308),n=!0}else if(null===e){a=t.stateNode;var s=t.memoizedProps,l=Ts(r,s);a.props=l;var c=a.context,u=r.contextType;o=Fn,"object"==typeof u&&null!==u&&(o=zi(u));var h=r.getDerivedStateFromProps;u="function"==typeof h||"function"==typeof a.getSnapshotBeforeUpdate,s=t.pendingProps!==s,u||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s||c!==o)&&ws(t,a,n,o),ma=!1;var d=t.memoizedState;a.state=d,Sa(t,n,a,i),Ta(),c=t.memoizedState,s||d!==c||ma?("function"==typeof h&&(vs(t,r,h,n),c=t.memoizedState),(l=ma||xs(t,r,l,n,d,c,o))?(u||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(t.flags|=4194308)):("function"==typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),a.props=n,a.state=c,a.context=o,n=l):("function"==typeof a.componentDidMount&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,_a(e,t),u=Ts(r,o=t.memoizedProps),a.props=u,h=t.pendingProps,d=a.context,c=r.contextType,l=Fn,"object"==typeof c&&null!==c&&(l=zi(c)),(c="function"==typeof(s=r.getDerivedStateFromProps)||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(o!==h||d!==l)&&ws(t,a,n,l),ma=!1,d=t.memoizedState,a.state=d,Sa(t,n,a,i),Ta();var p=t.memoizedState;o!==h||d!==p||ma||null!==e&&null!==e.dependencies&&Ii(e.dependencies)?("function"==typeof s&&(vs(t,r,s,n),p=t.memoizedState),(u=ma||xs(t,r,u,n,d,p,l)||null!==e&&null!==e.dependencies&&Ii(e.dependencies))?(c||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(n,p,l),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(n,p,l)),"function"==typeof a.componentDidUpdate&&(t.flags|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof a.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),a.props=n,a.state=p,a.context=l,n=u):("function"!=typeof a.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return a=n,Gs(e,t),n=!!(128&t.flags),a||n?(a=t.stateNode,r=n&&"function"!=typeof r.getDerivedStateFromError?null:a.render(),t.flags|=1,null!==e&&n?(t.child=pa(t,e.child,null,i),t.child=pa(t,null,r,i)):Ls(e,t,r,i),t.memoizedState=a.state,e=t.child):e=il(e,t,i),e}function Hs(e,t,r,n){return vi(),t.flags|=256,Ls(e,t,r,n),t.child}var Ws={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Xs(e){return{baseLanes:e,cachePool:Yi()}}function Ys(e,t,r){return e=null!==e?e.childLanes&~r:0,t&&(e|=Cc),e}function Ks(e,t,r){var n,i=t.pendingProps,a=!1,s=!!(128&t.flags);if((n=s)||(n=(null===e||null!==e.memoizedState)&&!!(2&Na.current)),n&&(a=!0,t.flags&=-129),n=!!(32&t.flags),t.flags&=-33,null===e){if(hi){if(a?La(t):Ba(),(e=ui)?null!==(e=null!==(e=Ih(e,pi))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ti?{id:ri,overflow:ni}:null,retryLane:536870912,hydrationErrors:null},(r=$n(e)).return=t,t.child=r,ci=t,ui=null):e=null,null===e)throw mi(t);return zh(e)?t.lanes=32:t.lanes=536870912,null}var l=i.children;return i=i.fallback,a?(Ba(),l=Js({mode:"hidden",children:l},a=t.mode),i=Gn(i,a,r,null),l.return=t,i.return=t,l.sibling=i,t.child=l,(i=t.child).memoizedState=Xs(r),i.childLanes=Ys(e,n,r),t.memoizedState=Ws,Ns(null,i)):(La(t),Qs(t,l))}var c=e.memoizedState;if(null!==c&&null!==(l=c.dehydrated)){if(s)256&t.flags?(La(t),t.flags&=-257,t=el(e,t,r)):null!==t.memoizedState?(Ba(),t.child=e.child,t.flags|=128,t=null):(Ba(),l=i.fallback,a=t.mode,i=Js({mode:"visible",children:i.children},a),(l=Gn(l,a,r,null)).flags|=2,i.return=t,l.return=t,i.sibling=l,t.child=i,pa(t,e.child,null,r),(i=t.child).memoizedState=Xs(r),i.childLanes=Ys(e,n,r),t.memoizedState=Ws,t=Ns(null,i));else if(La(t),zh(l)){if(n=l.nextSibling&&l.nextSibling.dataset)var u=n.dgst;n=u,(i=Error(o(419))).stack="",i.digest=n,xi({value:i,source:null,stack:null}),t=el(e,t,r)}else if(Ds||ki(e,t,r,!1),n=0!==(r&e.childLanes),Ds||n){if(null!==(n=fc)&&0!==(i=Re(n,r))&&i!==c.retryLane)throw c.retryLane=i,Dn(e,i),Wc(n,0,i),zs;Ah(l)||ou(),t=el(e,t,r)}else Ah(l)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,ui=Dh(l.nextSibling),ci=t,hi=!0,di=null,pi=!1,null!==e&&li(t,e),(t=Qs(t,i.children)).flags|=4096);return t}return a?(Ba(),l=i.fallback,a=t.mode,u=(c=e.child).sibling,(i=Vn(c,{mode:"hidden",children:i.children})).subtreeFlags=65011712&c.subtreeFlags,null!==u?l=Vn(u,l):(l=Gn(l,a,r,null)).flags|=2,l.return=t,i.return=t,i.sibling=l,t.child=i,Ns(null,i),i=t.child,null===(l=e.child.memoizedState)?l=Xs(r):(null!==(a=l.cachePool)?(c=Oi._currentValue,a=a.parent!==c?{parent:c,pool:c}:a):a=Yi(),l={baseLanes:l.baseLanes|r,cachePool:a}),i.memoizedState=l,i.childLanes=Ys(e,n,r),t.memoizedState=Ws,Ns(e.child,i)):(La(t),e=(r=e.child).sibling,(r=Vn(r,{mode:"visible",children:i.children})).return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r)}function Qs(e,t){return(t=Js({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Js(e,t){return(e=On(22,e,null,t)).lanes=0,e}function el(e,t,r){return pa(t,e.child,null,r),(e=Qs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function tl(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Ci(e.return,t,r)}function rl(e,t,r,n,i,a){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i,treeForkCount:a}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=i,o.treeForkCount=a)}function nl(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;n=n.children;var o=Na.current,s=!!(2&o);if(s?(o=1&o|2,t.flags|=128):o&=1,j(Na,o),Ls(e,t,n,r),n=hi?Qn:0,!s&&null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&tl(e,r,t);else if(19===e.tag)tl(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(i){case"forwards":for(r=t.child,i=null;null!==r;)null!==(e=r.alternate)&&null===Va(e)&&(i=r),r=r.sibling;null===(r=i)?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),rl(t,!1,i,r,a,n);break;case"backwards":case"unstable_legacy-backwards":for(r=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Va(e)){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}rl(t,!0,r,null,a,n);break;case"together":rl(t,!1,null,null,void 0,n);break;default:t.memoizedState=null}return t.child}function il(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Sc|=t.lanes,0===(r&t.childLanes)){if(null===e)return null;if(ki(e,t,r,!1),0===(r&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(r=Vn(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Vn(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function al(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Ii(e))}function ol(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps)Ds=!0;else{if(!(al(e,r)||128&t.flags))return Ds=!1,function(e,t,r){switch(t.tag){case 3:W(t,t.stateNode.containerInfo),Pi(0,Oi,e.memoizedState.cache),vi();break;case 27:case 5:Y(t);break;case 4:W(t,t.stateNode.containerInfo);break;case 10:Pi(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Ra(t),null;break;case 13:var n=t.memoizedState;if(null!==n)return null!==n.dehydrated?(La(t),t.flags|=128,null):0!==(r&t.child.childLanes)?Ks(e,t,r):(La(t),null!==(e=il(e,t,r))?e.sibling:null);La(t);break;case 19:var i=!!(128&e.flags);if((n=0!==(r&t.childLanes))||(ki(e,t,r,!1),n=0!==(r&t.childLanes)),i){if(n)return nl(e,t,r);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),j(Na,Na.current),n)break;return null;case 22:return t.lanes=0,Os(e,t,r,t.pendingProps);case 24:Pi(0,Oi,e.memoizedState.cache)}return il(e,t,r)}(e,t,r);Ds=!!(131072&e.flags)}else Ds=!1,hi&&1048576&t.flags&&ai(t,Qn,t.index);switch(t.lanes=0,t.tag){case 16:e:{var n=t.pendingProps;if(e=na(t.elementType),t.type=e,"function"!=typeof e){if(null!=e){var i=e.$$typeof;if(i===w){t.tag=11,t=Rs(null,t,e,n,r);break e}if(i===P){t.tag=14,t=Fs(null,t,e,n,r);break e}}throw t=z(e)||e,Error(o(306,t,""))}Nn(e)?(n=Ts(e,n),t.tag=1,t=Zs(null,t,e,n,r)):(t.tag=0,t=qs(null,t,e,n,r))}return t;case 0:return qs(e,t,t.type,t.pendingProps,r);case 1:return Zs(e,t,n=t.type,i=Ts(n,t.pendingProps),r);case 3:e:{if(W(t,t.stateNode.containerInfo),null===e)throw Error(o(387));n=t.pendingProps;var a=t.memoizedState;i=a.element,_a(e,t),Sa(t,n,null,r);var s=t.memoizedState;if(n=s.cache,Pi(0,Oi,n),n!==a.cache&&Mi(t,[Oi],r,!0),Ta(),n=s.element,a.isDehydrated){if(a={element:n,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Hs(e,t,n,r);break e}if(n!==i){xi(i=Wn(Error(o(424)),t)),t=Hs(e,t,n,r);break e}for(e=9===(e=t.stateNode.containerInfo).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,ui=Dh(e.firstChild),ci=t,hi=!0,di=null,pi=!0,r=fa(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(vi(),n===i){t=il(e,t,r);break e}Ls(e,t,n,r)}t=t.child}return t;case 26:return Gs(e,t),null===e?(r=$h(t.type,null,t.pendingProps,null))?t.memoizedState=r:hi||(r=t.type,e=t.pendingProps,(n=gh(Z.current).createElement(r))[je]=t,n[Ue]=e,dh(n,r,e),et(n),t.stateNode=n):t.memoizedState=$h(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Y(t),null===e&&hi&&(n=t.stateNode=Bh(t.type,t.pendingProps,Z.current),ci=t,pi=!0,i=ui,Eh(t.type)?(Lh=i,ui=Dh(n.firstChild)):ui=i),Ls(e,t,t.pendingProps.children,r),Gs(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&hi&&((i=n=ui)&&(null!==(n=function(e,t,r,n){for(;1===e.nodeType;){var i=r;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!n&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(n){if(!e[We])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(a=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(a!==i.rel||e.getAttribute("href")!==(null==i.href||""===i.href?null:i.href)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin)||e.getAttribute("title")!==(null==i.title?null:i.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((a=e.getAttribute("src"))!==(null==i.src?null:i.src)||e.getAttribute("type")!==(null==i.type?null:i.type)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin))&&a&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var a=null==i.name?null:""+i.name;if("hidden"===i.type&&e.getAttribute("name")===a)return e}if(null===(e=Dh(e.nextSibling)))break}return null}(n,t.type,t.pendingProps,pi))?(t.stateNode=n,ci=t,ui=Dh(n.firstChild),pi=!1,i=!0):i=!1),i||mi(t)),Y(t),i=t.type,a=t.pendingProps,s=null!==e?e.memoizedProps:null,n=a.children,vh(i,a)?n=null:null!==s&&vh(i,s)&&(t.flags|=32),null!==t.memoizedState&&(i=eo(e,t,no,null,null,r),ud._currentValue=i),Gs(e,t),Ls(e,t,n,r),t.child;case 6:return null===e&&hi&&((e=r=ui)&&(null!==(r=function(e,t,r){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!r)return null;if(null===(e=Dh(e.nextSibling)))return null}return e}(r,t.pendingProps,pi))?(t.stateNode=r,ci=t,ui=null,e=!0):e=!1),e||mi(t)),null;case 13:return Ks(e,t,r);case 4:return W(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=pa(t,null,n,r):Ls(e,t,n,r),t.child;case 11:return Rs(e,t,t.type,t.pendingProps,r);case 7:return Ls(e,t,t.pendingProps,r),t.child;case 8:case 12:return Ls(e,t,t.pendingProps.children,r),t.child;case 10:return n=t.pendingProps,Pi(0,t.type,n.value),Ls(e,t,n.children,r),t.child;case 9:return i=t.type._context,n=t.pendingProps.children,Ai(t),n=n(i=zi(i)),t.flags|=1,Ls(e,t,n,r),t.child;case 14:return Fs(e,t,t.type,t.pendingProps,r);case 15:return Bs(e,t,t.type,t.pendingProps,r);case 19:return nl(e,t,r);case 31:return function(e,t,r){var n=t.pendingProps,i=!!(128&t.flags);if(t.flags&=-129,null===e){if(hi){if("hidden"===n.mode)return e=js(t,n),t.lanes=536870912,Ns(null,e);if(Ra(t),(e=ui)?null!==(e=null!==(e=Ih(e,pi))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ti?{id:ri,overflow:ni}:null,retryLane:536870912,hydrationErrors:null},(r=$n(e)).return=t,t.child=r,ci=t,ui=null):e=null,null===e)throw mi(t);return t.lanes=536870912,null}return js(t,n)}var a=e.memoizedState;if(null!==a){var s=a.dehydrated;if(Ra(t),i)if(256&t.flags)t.flags&=-257,t=Us(e,t,r);else{if(null===t.memoizedState)throw Error(o(558));t.child=e.child,t.flags|=128,t=null}else if(Ds||ki(e,t,r,!1),i=0!==(r&e.childLanes),Ds||i){if(null!==(n=fc)&&0!==(s=Re(n,r))&&s!==a.retryLane)throw a.retryLane=s,Dn(e,s),Wc(n,0,s),zs;ou(),t=Us(e,t,r)}else e=a.treeContext,ui=Dh(s.nextSibling),ci=t,hi=!0,di=null,pi=!1,null!==e&&li(t,e),(t=js(t,n)).flags|=4096;return t}return(e=Vn(e.child,{mode:n.mode,children:n.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,r);case 22:return Os(e,t,r,t.pendingProps);case 24:return Ai(t),n=zi(Oi),null===e?(null===(i=Wi())&&(i=fc,a=Ni(),i.pooledCache=a,a.refCount++,null!==a&&(i.pooledCacheLanes|=r),i=a),t.memoizedState={parent:n,cache:i},ga(t),Pi(0,Oi,i)):(0!==(e.lanes&r)&&(_a(e,t),Sa(t,null,null,r),Ta()),i=e.memoizedState,a=t.memoizedState,i.parent!==n?(i={parent:n,cache:n},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),Pi(0,Oi,n)):(n=a.cache,Pi(0,Oi,n),n!==i.cache&&Mi(t,[Oi],r,!0))),Ls(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(o(156,t.tag))}function sl(e){e.flags|=4}function ll(e,t,r,n,i){if((t=!!(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&i)===i)if(e.stateNode.complete)e.flags|=8192;else{if(!nu())throw ia=ea,Qi;e.flags|=8192}}else e.flags&=-16777217}function cl(e,t){if("stylesheet"!==t.type||4&t.state.loading)e.flags&=-16777217;else if(e.flags|=16777216,!id(t)){if(!nu())throw ia=ea,Qi;e.flags|=8192}}function ul(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Ie():536870912,e.lanes|=t,Mc|=t)}function hl(e,t){if(!hi)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function dl(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=65011712&i.subtreeFlags,n|=65011712&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function pl(e,t,r){var n=t.pendingProps;switch(si(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return dl(t),null;case 3:return r=t.stateNode,n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ei(Oi),X(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(yi(t)?sl(t):null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,bi())),dl(t),null;case 26:var i=t.type,a=t.memoizedState;return null===e?(sl(t),null!==a?(dl(t),cl(t,a)):(dl(t),ll(t,i,0,0,r))):a?a!==e.memoizedState?(sl(t),dl(t),cl(t,a)):(dl(t),t.flags&=-16777217):((e=e.memoizedProps)!==n&&sl(t),dl(t),ll(t,i,0,0,r)),null;case 27:if(K(t),r=Z.current,i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==n&&sl(t);else{if(!n){if(null===t.stateNode)throw Error(o(166));return dl(t),null}e=q.current,yi(t)?gi(t):(e=Bh(i,n,r),t.stateNode=e,sl(t))}return dl(t),null;case 5:if(K(t),i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==n&&sl(t);else{if(!n){if(null===t.stateNode)throw Error(o(166));return dl(t),null}if(a=q.current,yi(t))gi(t);else{var s=gh(Z.current);switch(a){case 1:a=s.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:a=s.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":a=s.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":a=s.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":(a=s.createElement("div")).innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a="string"==typeof n.is?s.createElement("select",{is:n.is}):s.createElement("select"),n.multiple?a.multiple=!0:n.size&&(a.size=n.size);break;default:a="string"==typeof n.is?s.createElement(i,{is:n.is}):s.createElement(i)}}a[je]=t,a[Ue]=n;e:for(s=t.child;null!==s;){if(5===s.tag||6===s.tag)a.appendChild(s.stateNode);else if(4!==s.tag&&27!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;null===s.sibling;){if(null===s.return||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=a;e:switch(dh(a,i,n),i){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&sl(t)}}return dl(t),ll(t,t.type,null===e||e.memoizedProps,t.pendingProps,r),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==n&&sl(t);else{if("string"!=typeof n&&null===t.stateNode)throw Error(o(166));if(e=Z.current,yi(t)){if(e=t.stateNode,r=t.memoizedProps,n=null,null!==(i=ci))switch(i.tag){case 27:case 5:n=i.memoizedProps}e[je]=t,(e=!!(e.nodeValue===r||null!==n&&!0===n.suppressHydrationWarning||ch(e.nodeValue,r)))||mi(t,!0)}else(e=gh(e).createTextNode(n))[je]=t,t.stateNode=e}return dl(t),null;case 31:if(r=t.memoizedState,null===e||null!==e.memoizedState){if(n=yi(t),null!==r){if(null===e){if(!n)throw Error(o(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(o(557));e[je]=t}else vi(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;dl(t),e=!1}else r=bi(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=r),e=!0;if(!e)return 256&t.flags?(Oa(t),t):(Oa(t),null);if(128&t.flags)throw Error(o(558))}return dl(t),null;case 13:if(n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=yi(t),null!==n&&null!==n.dehydrated){if(null===e){if(!i)throw Error(o(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(o(317));i[je]=t}else vi(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;dl(t),i=!1}else i=bi(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(Oa(t),t):(Oa(t),null)}return Oa(t),128&t.flags?(t.lanes=r,t):(r=null!==n,e=null!==e&&null!==e.memoizedState,r&&(i=null,null!==(n=t.child).alternate&&null!==n.alternate.memoizedState&&null!==n.alternate.memoizedState.cachePool&&(i=n.alternate.memoizedState.cachePool.pool),a=null,null!==n.memoizedState&&null!==n.memoizedState.cachePool&&(a=n.memoizedState.cachePool.pool),a!==i&&(n.flags|=2048)),r!==e&&r&&(t.child.flags|=8192),ul(t,t.updateQueue),dl(t),null);case 4:return X(),null===e&&Ju(t.stateNode.containerInfo),dl(t),null;case 10:return Ei(t.type),dl(t),null;case 19:if(V(Na),null===(n=t.memoizedState))return dl(t),null;if(i=!!(128&t.flags),null===(a=n.rendering))if(i)hl(n,!1);else{if(0!==Tc||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(a=Va(e))){for(t.flags|=128,hl(n,!1),e=a.updateQueue,t.updateQueue=e,ul(t,e),t.subtreeFlags=0,e=r,r=t.child;null!==r;)jn(r,e),r=r.sibling;return j(Na,1&Na.current|2),hi&&ii(t,n.treeForkCount),t.child}e=e.sibling}null!==n.tail&&le()>Lc&&(t.flags|=128,i=!0,hl(n,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=Va(a))){if(t.flags|=128,i=!0,e=e.updateQueue,t.updateQueue=e,ul(t,e),hl(n,!0),null===n.tail&&"hidden"===n.tailMode&&!a.alternate&&!hi)return dl(t),null}else 2*le()-n.renderingStartTime>Lc&&536870912!==r&&(t.flags|=128,i=!0,hl(n,!1),t.lanes=4194304);n.isBackwards?(a.sibling=t.child,t.child=a):(null!==(e=n.last)?e.sibling=a:t.child=a,n.last=a)}return null!==n.tail?(e=n.tail,n.rendering=e,n.tail=e.sibling,n.renderingStartTime=le(),e.sibling=null,r=Na.current,j(Na,i?1&r|2:1&r),hi&&ii(t,n.treeForkCount),e):(dl(t),null);case 22:case 23:return Oa(t),Aa(),n=null!==t.memoizedState,null!==e?null!==e.memoizedState!==n&&(t.flags|=8192):n&&(t.flags|=8192),n?!!(536870912&r)&&!(128&t.flags)&&(dl(t),6&t.subtreeFlags&&(t.flags|=8192)):dl(t),null!==(r=t.updateQueue)&&ul(t,r.retryQueue),r=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(r=e.memoizedState.cachePool.pool),n=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(n=t.memoizedState.cachePool.pool),n!==r&&(t.flags|=2048),null!==e&&V(Hi),null;case 24:return r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Ei(Oi),dl(t),null;case 25:case 30:return null}throw Error(o(156,t.tag))}function fl(e,t){switch(si(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ei(Oi),X(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return K(t),null;case 31:if(null!==t.memoizedState){if(Oa(t),null===t.alternate)throw Error(o(340));vi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(Oa(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));vi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return V(Na),null;case 4:return X(),null;case 10:return Ei(t.type),null;case 22:case 23:return Oa(t),Aa(),null!==e&&V(Hi),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Ei(Oi),null;default:return null}}function ml(e,t){switch(si(t),t.tag){case 3:Ei(Oi),X();break;case 26:case 27:case 5:K(t);break;case 4:X();break;case 31:null!==t.memoizedState&&Oa(t);break;case 13:Oa(t);break;case 19:V(Na);break;case 10:Ei(t.type);break;case 22:case 23:Oa(t),Aa(),null!==e&&V(Hi);break;case 24:Ei(Oi)}}function gl(e,t){try{var r=t.updateQueue,n=null!==r?r.lastEffect:null;if(null!==n){var i=n.next;r=i;do{if((r.tag&e)===e){n=void 0;var a=r.create,o=r.inst;n=a(),o.destroy=n}r=r.next}while(r!==i)}}catch(e){Tu(t,t.return,e)}}function _l(e,t,r){try{var n=t.updateQueue,i=null!==n?n.lastEffect:null;if(null!==i){var a=i.next;n=a;do{if((n.tag&e)===e){var o=n.inst,s=o.destroy;if(void 0!==s){o.destroy=void 0,i=t;var l=r,c=s;try{c()}catch(e){Tu(i,l,e)}}}n=n.next}while(n!==a)}}catch(e){Tu(t,t.return,e)}}function yl(e){var t=e.updateQueue;if(null!==t){var r=e.stateNode;try{Ea(t,r)}catch(t){Tu(e,e.return,t)}}}function vl(e,t,r){r.props=Ts(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(r){Tu(e,t,r)}}function bl(e,t){try{var r=e.ref;if(null!==r){switch(e.tag){case 26:case 27:case 5:var n=e.stateNode;break;default:n=e.stateNode}"function"==typeof r?e.refCleanup=r(n):r.current=n}}catch(r){Tu(e,t,r)}}function xl(e,t){var r=e.ref,n=e.refCleanup;if(null!==r)if("function"==typeof n)try{n()}catch(r){Tu(e,t,r)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"==typeof r)try{r(null)}catch(r){Tu(e,t,r)}else r.current=null}function wl(e){var t=e.type,r=e.memoizedProps,n=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":r.autoFocus&&n.focus();break e;case"img":r.src?n.src=r.src:r.srcSet&&(n.srcset=r.srcSet)}}catch(t){Tu(e,e.return,t)}}function Tl(e,t,r){try{var n=e.stateNode;!function(e,t,r,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,a=null,s=null,l=null,c=null,u=null,h=null;for(f in r){var d=r[f];if(r.hasOwnProperty(f)&&null!=d)switch(f){case"checked":case"value":break;case"defaultValue":c=d;default:n.hasOwnProperty(f)||uh(e,t,f,null,n,d)}}for(var p in n){var f=n[p];if(d=r[p],n.hasOwnProperty(p)&&(null!=f||null!=d))switch(p){case"type":a=f;break;case"name":i=f;break;case"checked":u=f;break;case"defaultChecked":h=f;break;case"value":s=f;break;case"defaultValue":l=f;break;case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(o(137,t));break;default:f!==d&&uh(e,t,p,f,n,d)}}return void yt(e,s,l,c,u,h,a,i);case"select":for(a in f=s=l=p=null,r)if(c=r[a],r.hasOwnProperty(a)&&null!=c)switch(a){case"value":break;case"multiple":f=c;default:n.hasOwnProperty(a)||uh(e,t,a,null,n,c)}for(i in n)if(a=n[i],c=r[i],n.hasOwnProperty(i)&&(null!=a||null!=c))switch(i){case"value":p=a;break;case"defaultValue":l=a;break;case"multiple":s=a;default:a!==c&&uh(e,t,i,a,n,c)}return t=l,r=s,n=f,void(null!=p?xt(e,!!r,p,!1):!!n!=!!r&&(null!=t?xt(e,!!r,t,!0):xt(e,!!r,r?[]:"",!1)));case"textarea":for(l in f=p=null,r)if(i=r[l],r.hasOwnProperty(l)&&null!=i&&!n.hasOwnProperty(l))switch(l){case"value":case"children":break;default:uh(e,t,l,null,n,i)}for(s in n)if(i=n[s],a=r[s],n.hasOwnProperty(s)&&(null!=i||null!=a))switch(s){case"value":p=i;break;case"defaultValue":f=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(o(91));break;default:i!==a&&uh(e,t,s,i,n,a)}return void wt(e,p,f);case"option":for(var m in r)p=r[m],r.hasOwnProperty(m)&&null!=p&&!n.hasOwnProperty(m)&&("selected"===m?e.selected=!1:uh(e,t,m,null,n,p));for(c in n)p=n[c],f=r[c],!n.hasOwnProperty(c)||p===f||null==p&&null==f||("selected"===c?e.selected=p&&"function"!=typeof p&&"symbol"!=typeof p:uh(e,t,c,p,n,f));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in r)p=r[g],r.hasOwnProperty(g)&&null!=p&&!n.hasOwnProperty(g)&&uh(e,t,g,null,n,p);for(u in n)if(p=n[u],f=r[u],n.hasOwnProperty(u)&&p!==f&&(null!=p||null!=f))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(o(137,t));break;default:uh(e,t,u,p,n,f)}return;default:if(Mt(t)){for(var _ in r)p=r[_],r.hasOwnProperty(_)&&void 0!==p&&!n.hasOwnProperty(_)&&hh(e,t,_,void 0,n,p);for(h in n)p=n[h],f=r[h],!n.hasOwnProperty(h)||p===f||void 0===p&&void 0===f||hh(e,t,h,p,n,f);return}}for(var y in r)p=r[y],r.hasOwnProperty(y)&&null!=p&&!n.hasOwnProperty(y)&&uh(e,t,y,null,n,p);for(d in n)p=n[d],f=r[d],!n.hasOwnProperty(d)||p===f||null==p&&null==f||uh(e,t,d,p,n,f)}(n,e.type,r,t),n[Ue]=t}catch(t){Tu(e,e.return,t)}}function Sl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Eh(e.type)||4===e.tag}function Pl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Eh(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function El(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?(9===r.nodeType?r.body:"HTML"===r.nodeName?r.ownerDocument.body:r).insertBefore(e,t):((t=9===r.nodeType?r.body:"HTML"===r.nodeName?r.ownerDocument.body:r).appendChild(e),null!=(r=r._reactRootContainer)||null!==t.onclick||(t.onclick=zt));else if(4!==n&&(27===n&&Eh(e.type)&&(r=e.stateNode,t=null),null!==(e=e.child)))for(El(e,t,r),e=e.sibling;null!==e;)El(e,t,r),e=e.sibling}function Cl(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&(27===n&&Eh(e.type)&&(r=e.stateNode),null!==(e=e.child)))for(Cl(e,t,r),e=e.sibling;null!==e;)Cl(e,t,r),e=e.sibling}function Ml(e){var t=e.stateNode,r=e.memoizedProps;try{for(var n=e.type,i=t.attributes;i.length;)t.removeAttributeNode(i[0]);dh(t,n,r),t[je]=e,t[Ue]=r}catch(t){Tu(e,e.return,t)}}var kl=!1,Il=!1,Al=!1,zl="function"==typeof WeakSet?WeakSet:Set,Dl=null;function Ll(e,t,r){var n=r.flags;switch(r.tag){case 0:case 11:case 15:Wl(e,r),4&n&&gl(5,r);break;case 1:if(Wl(e,r),4&n)if(e=r.stateNode,null===t)try{e.componentDidMount()}catch(e){Tu(r,r.return,e)}else{var i=Ts(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(e){Tu(r,r.return,e)}}64&n&&yl(r),512&n&&bl(r,r.return);break;case 3:if(Wl(e,r),64&n&&null!==(e=r.updateQueue)){if(t=null,null!==r.child)switch(r.child.tag){case 27:case 5:case 1:t=r.child.stateNode}try{Ea(e,t)}catch(e){Tu(r,r.return,e)}}break;case 27:null===t&&4&n&&Ml(r);case 26:case 5:Wl(e,r),null===t&&4&n&&wl(r),512&n&&bl(r,r.return);break;case 12:Wl(e,r);break;case 31:Wl(e,r),4&n&&Vl(e,r);break;case 13:Wl(e,r),4&n&&jl(e,r),64&n&&null!==(e=r.memoizedState)&&null!==(e=e.dehydrated)&&function(e,t){var r=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==r.readyState)t();else{var n=function(){t(),r.removeEventListener("DOMContentLoaded",n)};r.addEventListener("DOMContentLoaded",n),e._reactRetry=n}}(e,r=Cu.bind(null,r));break;case 22:if(!(n=null!==r.memoizedState||kl)){t=null!==t&&null!==t.memoizedState||Il,i=kl;var a=Il;kl=n,(Il=t)&&!a?Yl(e,r,!!(8772&r.subtreeFlags)):Wl(e,r),kl=i,Il=a}break;case 30:break;default:Wl(e,r)}}function Rl(e){var t=e.alternate;null!==t&&(e.alternate=null,Rl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&Xe(t),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Fl=null,Bl=!1;function Ol(e,t,r){for(r=r.child;null!==r;)Nl(e,t,r),r=r.sibling}function Nl(e,t,r){if(ye&&"function"==typeof ye.onCommitFiberUnmount)try{ye.onCommitFiberUnmount(_e,r)}catch(e){}switch(r.tag){case 26:Il||xl(r,t),Ol(e,t,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode).parentNode.removeChild(r);break;case 27:Il||xl(r,t);var n=Fl,i=Bl;Eh(r.type)&&(Fl=r.stateNode,Bl=!1),Ol(e,t,r),Oh(r.stateNode),Fl=n,Bl=i;break;case 5:Il||xl(r,t);case 6:if(n=Fl,i=Bl,Fl=null,Ol(e,t,r),Bl=i,null!==(Fl=n))if(Bl)try{(9===Fl.nodeType?Fl.body:"HTML"===Fl.nodeName?Fl.ownerDocument.body:Fl).removeChild(r.stateNode)}catch(e){Tu(r,t,e)}else try{Fl.removeChild(r.stateNode)}catch(e){Tu(r,t,e)}break;case 18:null!==Fl&&(Bl?(Ch(9===(e=Fl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,r.stateNode),qd(e)):Ch(Fl,r.stateNode));break;case 4:n=Fl,i=Bl,Fl=r.stateNode.containerInfo,Bl=!0,Ol(e,t,r),Fl=n,Bl=i;break;case 0:case 11:case 14:case 15:_l(2,r,t),Il||_l(4,r,t),Ol(e,t,r);break;case 1:Il||(xl(r,t),"function"==typeof(n=r.stateNode).componentWillUnmount&&vl(r,t,n)),Ol(e,t,r);break;case 21:Ol(e,t,r);break;case 22:Il=(n=Il)||null!==r.memoizedState,Ol(e,t,r),Il=n;break;default:Ol(e,t,r)}}function Vl(e,t){if(null===t.memoizedState&&null!==(e=t.alternate)&&null!==(e=e.memoizedState)){e=e.dehydrated;try{qd(e)}catch(e){Tu(t,t.return,e)}}}function jl(e,t){if(null===t.memoizedState&&null!==(e=t.alternate)&&null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))try{qd(e)}catch(e){Tu(t,t.return,e)}}function Ul(e,t){var r=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new zl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new zl),t;default:throw Error(o(435,e.tag))}}(e);t.forEach(function(t){if(!r.has(t)){r.add(t);var n=Mu.bind(null,e,t);t.then(n,n)}})}function Gl(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var i=r[n],a=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 27:if(Eh(l.type)){Fl=l.stateNode,Bl=!1;break e}break;case 5:Fl=l.stateNode,Bl=!1;break e;case 3:case 4:Fl=l.stateNode.containerInfo,Bl=!0;break e}l=l.return}if(null===Fl)throw Error(o(160));Nl(a,s,i),Fl=null,Bl=!1,null!==(a=i.alternate)&&(a.return=null),i.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)$l(t,e),t=t.sibling}var ql=null;function $l(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Gl(t,e),Zl(e),4&n&&(_l(3,e,e.return),gl(3,e),_l(5,e,e.return));break;case 1:Gl(t,e),Zl(e),512&n&&(Il||null===r||xl(r,r.return)),64&n&&kl&&null!==(e=e.updateQueue)&&null!==(n=e.callbacks)&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===r?n:r.concat(n));break;case 26:var i=ql;if(Gl(t,e),Zl(e),512&n&&(Il||null===r||xl(r,r.return)),4&n){var a=null!==r?r.memoizedState:null;if(n=e.memoizedState,null===r)if(null===n)if(null===e.stateNode){e:{n=e.type,r=e.memoizedProps,i=i.ownerDocument||i;t:switch(n){case"title":(!(a=i.getElementsByTagName("title")[0])||a[We]||a[je]||"http://www.w3.org/2000/svg"===a.namespaceURI||a.hasAttribute("itemprop"))&&(a=i.createElement(n),i.head.insertBefore(a,i.querySelector("head > title"))),dh(a,n,r),a[je]=e,et(a),n=a;break e;case"link":var s=rd("link","href",i).get(n+(r.href||""));if(s)for(var l=0;l<s.length;l++)if((a=s[l]).getAttribute("href")===(null==r.href||""===r.href?null:r.href)&&a.getAttribute("rel")===(null==r.rel?null:r.rel)&&a.getAttribute("title")===(null==r.title?null:r.title)&&a.getAttribute("crossorigin")===(null==r.crossOrigin?null:r.crossOrigin)){s.splice(l,1);break t}dh(a=i.createElement(n),n,r),i.head.appendChild(a);break;case"meta":if(s=rd("meta","content",i).get(n+(r.content||"")))for(l=0;l<s.length;l++)if((a=s[l]).getAttribute("content")===(null==r.content?null:""+r.content)&&a.getAttribute("name")===(null==r.name?null:r.name)&&a.getAttribute("property")===(null==r.property?null:r.property)&&a.getAttribute("http-equiv")===(null==r.httpEquiv?null:r.httpEquiv)&&a.getAttribute("charset")===(null==r.charSet?null:r.charSet)){s.splice(l,1);break t}dh(a=i.createElement(n),n,r),i.head.appendChild(a);break;default:throw Error(o(468,n))}a[je]=e,et(a),n=a}e.stateNode=n}else nd(i,e.type,e.stateNode);else e.stateNode=Kh(i,n,e.memoizedProps);else a!==n?(null===a?null!==r.stateNode&&(r=r.stateNode).parentNode.removeChild(r):a.count--,null===n?nd(i,e.type,e.stateNode):Kh(i,n,e.memoizedProps)):null===n&&null!==e.stateNode&&Tl(e,e.memoizedProps,r.memoizedProps)}break;case 27:Gl(t,e),Zl(e),512&n&&(Il||null===r||xl(r,r.return)),null!==r&&4&n&&Tl(e,e.memoizedProps,r.memoizedProps);break;case 5:if(Gl(t,e),Zl(e),512&n&&(Il||null===r||xl(r,r.return)),32&e.flags){i=e.stateNode;try{St(i,"")}catch(t){Tu(e,e.return,t)}}4&n&&null!=e.stateNode&&Tl(e,i=e.memoizedProps,null!==r?r.memoizedProps:i),1024&n&&(Al=!0);break;case 6:if(Gl(t,e),Zl(e),4&n){if(null===e.stateNode)throw Error(o(162));n=e.memoizedProps,r=e.stateNode;try{r.nodeValue=n}catch(t){Tu(e,e.return,t)}}break;case 3:if(td=null,i=ql,ql=jh(t.containerInfo),Gl(t,e),ql=i,Zl(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{qd(t.containerInfo)}catch(t){Tu(e,e.return,t)}Al&&(Al=!1,Hl(e));break;case 4:n=ql,ql=jh(e.stateNode.containerInfo),Gl(t,e),Zl(e),ql=n;break;case 12:default:Gl(t,e),Zl(e);break;case 31:case 19:Gl(t,e),Zl(e),4&n&&null!==(n=e.updateQueue)&&(e.updateQueue=null,Ul(e,n));break;case 13:Gl(t,e),Zl(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==r&&null!==r.memoizedState)&&(zc=le()),4&n&&null!==(n=e.updateQueue)&&(e.updateQueue=null,Ul(e,n));break;case 22:i=null!==e.memoizedState;var c=null!==r&&null!==r.memoizedState,u=kl,h=Il;if(kl=u||i,Il=h||c,Gl(t,e),Il=h,kl=u,Zl(e),8192&n)e:for(t=e.stateNode,t._visibility=i?-2&t._visibility:1|t._visibility,i&&(null===r||c||kl||Il||Xl(e)),r=null,t=e;;){if(5===t.tag||26===t.tag){if(null===r){c=r=t;try{if(a=c.stateNode,i)"function"==typeof(s=a.style).setProperty?s.setProperty("display","none","important"):s.display="none";else{l=c.stateNode;var d=c.memoizedProps.style,p=null!=d&&d.hasOwnProperty("display")?d.display:null;l.style.display=null==p||"boolean"==typeof p?"":(""+p).trim()}}catch(e){Tu(c,c.return,e)}}}else if(6===t.tag){if(null===r){c=t;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(e){Tu(c,c.return,e)}}}else if(18===t.tag){if(null===r){c=t;try{var f=c.stateNode;i?Mh(f,!0):Mh(c.stateNode,!1)}catch(e){Tu(c,c.return,e)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}4&n&&null!==(n=e.updateQueue)&&null!==(r=n.retryQueue)&&(n.retryQueue=null,Ul(e,r));case 30:case 21:}}function Zl(e){var t=e.flags;if(2&t){try{for(var r,n=e.return;null!==n;){if(Sl(n)){r=n;break}n=n.return}if(null==r)throw Error(o(160));switch(r.tag){case 27:var i=r.stateNode;Cl(e,Pl(e),i);break;case 5:var a=r.stateNode;32&r.flags&&(St(a,""),r.flags&=-33),Cl(e,Pl(e),a);break;case 3:case 4:var s=r.stateNode.containerInfo;El(e,Pl(e),s);break;default:throw Error(o(161))}}catch(t){Tu(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Hl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Hl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Wl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Ll(e,t.alternate,t),t=t.sibling}function Xl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:_l(4,t,t.return),Xl(t);break;case 1:xl(t,t.return);var r=t.stateNode;"function"==typeof r.componentWillUnmount&&vl(t,t.return,r),Xl(t);break;case 27:Oh(t.stateNode);case 26:case 5:xl(t,t.return),Xl(t);break;case 22:null===t.memoizedState&&Xl(t);break;default:Xl(t)}e=e.sibling}}function Yl(e,t,r){for(r=r&&!!(8772&t.subtreeFlags),t=t.child;null!==t;){var n=t.alternate,i=e,a=t,o=a.flags;switch(a.tag){case 0:case 11:case 15:Yl(i,a,r),gl(4,a);break;case 1:if(Yl(i,a,r),"function"==typeof(i=(n=a).stateNode).componentDidMount)try{i.componentDidMount()}catch(e){Tu(n,n.return,e)}if(null!==(i=(n=a).updateQueue)){var s=n.stateNode;try{var l=i.shared.hiddenCallbacks;if(null!==l)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)Pa(l[i],s)}catch(e){Tu(n,n.return,e)}}r&&64&o&&yl(a),bl(a,a.return);break;case 27:Ml(a);case 26:case 5:Yl(i,a,r),r&&null===n&&4&o&&wl(a),bl(a,a.return);break;case 12:Yl(i,a,r);break;case 31:Yl(i,a,r),r&&4&o&&Vl(i,a);break;case 13:Yl(i,a,r),r&&4&o&&jl(i,a);break;case 22:null===a.memoizedState&&Yl(i,a,r),bl(a,a.return);break;case 30:break;default:Yl(i,a,r)}t=t.sibling}}function Kl(e,t){var r=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(r=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==r&&(null!=e&&e.refCount++,null!=r&&Vi(r))}function Ql(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Vi(e))}function Jl(e,t,r,n){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)ec(e,t,r,n),t=t.sibling}function ec(e,t,r,n){var i=t.flags;switch(t.tag){case 0:case 11:case 15:Jl(e,t,r,n),2048&i&&gl(9,t);break;case 1:case 31:case 13:default:Jl(e,t,r,n);break;case 3:Jl(e,t,r,n),2048&i&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Vi(e)));break;case 12:if(2048&i){Jl(e,t,r,n),e=t.stateNode;try{var a=t.memoizedProps,o=a.id,s=a.onPostCommit;"function"==typeof s&&s(o,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(e){Tu(t,t.return,e)}}else Jl(e,t,r,n);break;case 23:break;case 22:a=t.stateNode,o=t.alternate,null!==t.memoizedState?2&a._visibility?Jl(e,t,r,n):rc(e,t):2&a._visibility?Jl(e,t,r,n):(a._visibility|=2,tc(e,t,r,n,!!(10256&t.subtreeFlags)||!1)),2048&i&&Kl(o,t);break;case 24:Jl(e,t,r,n),2048&i&&Ql(t.alternate,t)}}function tc(e,t,r,n,i){for(i=i&&(!!(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var a=e,o=t,s=r,l=n,c=o.flags;switch(o.tag){case 0:case 11:case 15:tc(a,o,s,l,i),gl(8,o);break;case 23:break;case 22:var u=o.stateNode;null!==o.memoizedState?2&u._visibility?tc(a,o,s,l,i):rc(a,o):(u._visibility|=2,tc(a,o,s,l,i)),i&&2048&c&&Kl(o.alternate,o);break;case 24:tc(a,o,s,l,i),i&&2048&c&&Ql(o.alternate,o);break;default:tc(a,o,s,l,i)}t=t.sibling}}function rc(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var r=e,n=t,i=n.flags;switch(n.tag){case 22:rc(r,n),2048&i&&Kl(n.alternate,n);break;case 24:rc(r,n),2048&i&&Ql(n.alternate,n);break;default:rc(r,n)}t=t.sibling}}var nc=8192;function ic(e,t,r){if(e.subtreeFlags&nc)for(e=e.child;null!==e;)ac(e,t,r),e=e.sibling}function ac(e,t,r){switch(e.tag){case 26:ic(e,t,r),e.flags&nc&&null!==e.memoizedState&&function(e,t,r,n){if(!("stylesheet"!==r.type||"string"==typeof n.media&&!1===matchMedia(n.media).matches||4&r.state.loading)){if(null===r.instance){var i=Zh(n.href),a=t.querySelector(Hh(i));if(a)return null!==(t=a._p)&&"object"==typeof t&&"function"==typeof t.then&&(e.count++,e=od.bind(e),t.then(e,e)),r.state.loading|=4,r.instance=a,void et(a);a=t.ownerDocument||t,n=Wh(n),(i=Nh.get(i))&&Jh(n,i),et(a=a.createElement("link"));var o=a;o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),dh(a,"link",n),r.instance=a}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(r,t),(t=r.state.preload)&&!(3&r.state.loading)&&(e.count++,r=od.bind(e),t.addEventListener("load",r),t.addEventListener("error",r))}}(r,ql,e.memoizedState,e.memoizedProps);break;case 5:default:ic(e,t,r);break;case 3:case 4:var n=ql;ql=jh(e.stateNode.containerInfo),ic(e,t,r),ql=n;break;case 22:null===e.memoizedState&&(null!==(n=e.alternate)&&null!==n.memoizedState?(n=nc,nc=16777216,ic(e,t,r),nc=n):ic(e,t,r))}}function oc(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function sc(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var r=0;r<t.length;r++){var n=t[r];Dl=n,uc(n,e)}oc(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)lc(e),e=e.sibling}function lc(e){switch(e.tag){case 0:case 11:case 15:sc(e),2048&e.flags&&_l(9,e,e.return);break;case 3:case 12:default:sc(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,cc(e)):sc(e)}}function cc(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var r=0;r<t.length;r++){var n=t[r];Dl=n,uc(n,e)}oc(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:_l(8,t,t.return),cc(t);break;case 22:2&(r=t.stateNode)._visibility&&(r._visibility&=-3,cc(t));break;default:cc(t)}e=e.sibling}}function uc(e,t){for(;null!==Dl;){var r=Dl;switch(r.tag){case 0:case 11:case 15:_l(8,r,t);break;case 23:case 22:if(null!==r.memoizedState&&null!==r.memoizedState.cachePool){var n=r.memoizedState.cachePool.pool;null!=n&&n.refCount++}break;case 24:Vi(r.memoizedState.cache)}if(null!==(n=r.child))n.return=r,Dl=n;else e:for(r=e;null!==Dl;){var i=(n=Dl).sibling,a=n.return;if(Rl(n),n===r){Dl=null;break e}if(null!==i){i.return=a,Dl=i;break e}Dl=a}}}var hc={getCacheForType:function(e){var t=zi(Oi),r=t.data.get(e);return void 0===r&&(r=e(),t.data.set(e,r)),r},cacheSignal:function(){return zi(Oi).controller.signal}},dc="function"==typeof WeakMap?WeakMap:Map,pc=0,fc=null,mc=null,gc=0,_c=0,yc=null,vc=!1,bc=!1,xc=!1,wc=0,Tc=0,Sc=0,Pc=0,Ec=0,Cc=0,Mc=0,kc=null,Ic=null,Ac=!1,zc=0,Dc=0,Lc=1/0,Rc=null,Fc=null,Bc=0,Oc=null,Nc=null,Vc=0,jc=0,Uc=null,Gc=null,qc=0,$c=null;function Zc(){return 2&pc&&0!==gc?gc&-gc:null!==L.T?Uu():Oe()}function Hc(){if(0===Cc)if(536870912&gc&&!hi)Cc=536870912;else{var e=Se;!(3932160&(Se<<=1))&&(Se=262144),Cc=e}return null!==(e=za.current)&&(e.flags|=32),Cc}function Wc(e,t,r){(e!==fc||2!==_c&&9!==_c)&&null===e.cancelPendingCommit||(tu(e,0),Qc(e,gc,Cc,!1)),ze(e,r),2&pc&&e===fc||(e===fc&&(!(2&pc)&&(Pc|=r),4===Tc&&Qc(e,gc,Cc,!1)),Ru(e))}function Xc(e,t,r){if(6&pc)throw Error(o(327));for(var n=!r&&!(127&t)&&0===(t&e.expiredLanes)||Me(e,t),i=n?function(e,t){var r=pc;pc|=2;var n=iu(),i=au();fc!==e||gc!==t?(Rc=null,Lc=le()+500,tu(e,t)):bc=Me(e,t);e:for(;;)try{if(0!==_c&&null!==mc){t=mc;var a=yc;t:switch(_c){case 1:_c=0,yc=null,du(e,t,a,1);break;case 2:case 9:if(ta(a)){_c=0,yc=null,hu(t);break}t=function(){2!==_c&&9!==_c||fc!==e||(_c=7),Ru(e)},a.then(t,t);break e;case 3:_c=7;break e;case 4:_c=5;break e;case 7:ta(a)?(_c=0,yc=null,hu(t)):(_c=0,yc=null,du(e,t,a,7));break;case 5:var s=null;switch(mc.tag){case 26:s=mc.memoizedState;case 5:case 27:var l=mc;if(s?id(s):l.stateNode.complete){_c=0,yc=null;var c=l.sibling;if(null!==c)mc=c;else{var u=l.return;null!==u?(mc=u,pu(u)):mc=null}break t}}_c=0,yc=null,du(e,t,a,5);break;case 6:_c=0,yc=null,du(e,t,a,6);break;case 8:eu(),Tc=6;break e;default:throw Error(o(462))}}cu();break}catch(t){ru(e,t)}return Si=Ti=null,L.H=n,L.A=i,pc=r,null!==mc?0:(fc=null,gc=0,In(),Tc)}(e,t):su(e,t,!0),a=n;;){if(0===i){bc&&!n&&Qc(e,t,0,!1);break}if(r=e.current.alternate,!a||Kc(r)){if(2===i){if(a=t,e.errorRecoveryDisabledLanes&a)var s=0;else s=0!=(s=-536870913&e.pendingLanes)?s:536870912&s?536870912:0;if(0!==s){t=s;e:{var l=e;i=kc;var c=l.current.memoizedState.isDehydrated;if(c&&(tu(l,s).flags|=256),2!==(s=su(l,s,!1))){if(xc&&!c){l.errorRecoveryDisabledLanes|=a,Pc|=a,i=4;break e}a=Ic,Ic=i,null!==a&&(null===Ic?Ic=a:Ic.push.apply(Ic,a))}i=s}if(a=!1,2!==i)continue}}if(1===i){tu(e,0),Qc(e,t,0,!0);break}e:{switch(n=e,a=i){case 0:case 1:throw Error(o(345));case 4:if((4194048&t)!==t)break;case 6:Qc(n,t,Cc,!vc);break e;case 2:Ic=null;break;case 3:case 5:break;default:throw Error(o(329))}if((62914560&t)===t&&10<(i=zc+300-le())){if(Qc(n,t,Cc,!vc),0!==Ce(n,0,!0))break e;Vc=t,n.timeoutHandle=xh(Yc.bind(null,n,r,Ic,Rc,Ac,t,Cc,Pc,Mc,vc,a,"Throttled",-0,0),i)}else Yc(n,r,Ic,Rc,Ac,t,Cc,Pc,Mc,vc,a,null,-0,0)}break}i=su(e,t,!1),a=!1}Ru(e)}function Yc(e,t,r,n,i,a,o,s,l,c,u,h,d,p){if(e.timeoutHandle=-1,8192&(h=t.subtreeFlags)||!(16785408&~h)){ac(t,a,h={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:zt});var f=(62914560&a)===a?zc-le():(4194048&a)===a?Dc-le():0;if(null!==(f=function(e,t){return e.stylesheets&&0===e.count&&ld(e,e.stylesheets),0<e.count||0<e.imgCount?function(r){var n=setTimeout(function(){if(e.stylesheets&&ld(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===ad&&(ad=62500*function(){if("function"==typeof performance.getEntriesByType){for(var e=0,t=0,r=performance.getEntriesByType("resource"),n=0;n<r.length;n++){var i=r[n],a=i.transferSize,o=i.initiatorType,s=i.duration;if(a&&s&&ph(o)){for(o=0,s=i.responseEnd,n+=1;n<r.length;n++){var l=r[n],c=l.startTime;if(c>s)break;var u=l.transferSize,h=l.initiatorType;u&&ph(h)&&(o+=u*((l=l.responseEnd)<s?1:(s-c)/(l-c)))}if(--n,t+=8*(a+o)/(i.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"==typeof(e=navigator.connection.downlink)?e:5}());var i=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&ld(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>ad?50:800)+t);return e.unsuspend=r,function(){e.unsuspend=null,clearTimeout(n),clearTimeout(i)}}:null}(h,f)))return Vc=a,e.cancelPendingCommit=f(mu.bind(null,e,t,a,r,n,i,o,s,l,u,h,null,d,p)),void Qc(e,a,o,!c)}mu(e,t,a,r,n,i,o,s,l)}function Kc(e){for(var t=e;;){var r=t.tag;if((0===r||11===r||15===r)&&16384&t.flags&&null!==(r=t.updateQueue)&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!Kr(a(),i))return!1}catch(e){return!1}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Qc(e,t,r,n){t&=~Ec,t&=~Pc,e.suspendedLanes|=t,e.pingedLanes&=~t,n&&(e.warmLanes|=t),n=e.expirationTimes;for(var i=t;0<i;){var a=31-be(i),o=1<<a;n[a]=-1,i&=~o}0!==r&&De(e,r,t)}function Jc(){return!!(6&pc)||(Fu(0,!1),!1)}function eu(){if(null!==mc){if(0===_c)var e=mc.return;else Si=Ti=null,oo(e=mc),sa=null,la=0,e=mc;for(;null!==e;)ml(e.alternate,e),e=e.return;mc=null}}function tu(e,t){var r=e.timeoutHandle;-1!==r&&(e.timeoutHandle=-1,wh(r)),null!==(r=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,r()),Vc=0,eu(),fc=e,mc=r=Vn(e.current,null),gc=t,_c=0,yc=null,vc=!1,bc=Me(e,t),xc=!1,Mc=Cc=Ec=Pc=Sc=Tc=0,Ic=kc=null,Ac=!1,8&t&&(t|=32&t);var n=e.entangledLanes;if(0!==n)for(e=e.entanglements,n&=t;0<n;){var i=31-be(n),a=1<<i;t|=e[i],n&=~a}return wc=t,In(),r}function ru(e,t){Ua=null,L.H=ms,t===Ki||t===Ji?(t=aa(),_c=3):t===Qi?(t=aa(),_c=4):_c=t===zs?8:null!==t&&"object"==typeof t&&"function"==typeof t.then?6:1,yc=t,null===mc&&(Tc=1,Cs(e,Wn(t,e.current)))}function nu(){var e=za.current;return null===e||((4194048&gc)===gc?null===Da:!!((62914560&gc)===gc||536870912&gc)&&e===Da)}function iu(){var e=L.H;return L.H=ms,null===e?ms:e}function au(){var e=L.A;return L.A=hc,e}function ou(){Tc=4,vc||(4194048&gc)!==gc&&null!==za.current||(bc=!0),!(134217727&Sc)&&!(134217727&Pc)||null===fc||Qc(fc,gc,Cc,!1)}function su(e,t,r){var n=pc;pc|=2;var i=iu(),a=au();fc===e&&gc===t||(Rc=null,tu(e,t)),t=!1;var o=Tc;e:for(;;)try{if(0!==_c&&null!==mc){var s=mc,l=yc;switch(_c){case 8:eu(),o=6;break e;case 3:case 2:case 9:case 6:null===za.current&&(t=!0);var c=_c;if(_c=0,yc=null,du(e,s,l,c),r&&bc){o=0;break e}break;default:c=_c,_c=0,yc=null,du(e,s,l,c)}}lu(),o=Tc;break}catch(t){ru(e,t)}return t&&e.shellSuspendCounter++,Si=Ti=null,pc=n,L.H=i,L.A=a,null===mc&&(fc=null,gc=0,In()),o}function lu(){for(;null!==mc;)uu(mc)}function cu(){for(;null!==mc&&!oe();)uu(mc)}function uu(e){var t=ol(e.alternate,e,wc);e.memoizedProps=e.pendingProps,null===t?pu(e):mc=t}function hu(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=$s(r,t,t.pendingProps,t.type,void 0,gc);break;case 11:t=$s(r,t,t.pendingProps,t.type.render,t.ref,gc);break;case 5:oo(t);default:ml(r,t),t=ol(r,t=mc=jn(t,wc),wc)}e.memoizedProps=e.pendingProps,null===t?pu(e):mc=t}function du(e,t,r,n){Si=Ti=null,oo(t),sa=null,la=0;var i=t.return;try{if(function(e,t,r,n,i){if(r.flags|=32768,null!==n&&"object"==typeof n&&"function"==typeof n.then){if(null!==(t=r.alternate)&&ki(t,r,i,!0),null!==(r=za.current)){switch(r.tag){case 31:case 13:return null===Da?ou():null===r.alternate&&0===Tc&&(Tc=3),r.flags&=-257,r.flags|=65536,r.lanes=i,n===ea?r.flags|=16384:(null===(t=r.updateQueue)?r.updateQueue=new Set([n]):t.add(n),Su(e,n,i)),!1;case 22:return r.flags|=65536,n===ea?r.flags|=16384:(null===(t=r.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([n])},r.updateQueue=t):null===(r=t.retryQueue)?t.retryQueue=new Set([n]):r.add(n),Su(e,n,i)),!1}throw Error(o(435,r.tag))}return Su(e,n,i),ou(),!1}if(hi)return null!==(t=za.current)?(!(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,n!==fi&&xi(Wn(e=Error(o(422),{cause:n}),r))):(n!==fi&&xi(Wn(t=Error(o(423),{cause:n}),r)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,n=Wn(n,r),xa(e,i=ks(e.stateNode,n,i)),4!==Tc&&(Tc=2)),!1;var a=Error(o(520),{cause:n});if(a=Wn(a,r),null===kc?kc=[a]:kc.push(a),4!==Tc&&(Tc=2),null===t)return!0;n=Wn(n,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=i&-i,r.lanes|=e,xa(r,e=ks(r.stateNode,n,e)),!1;case 1:if(t=r.type,a=r.stateNode,!(128&r.flags||"function"!=typeof t.getDerivedStateFromError&&(null===a||"function"!=typeof a.componentDidCatch||null!==Fc&&Fc.has(a))))return r.flags|=65536,i&=-i,r.lanes|=i,As(i=Is(i),e,r,n),xa(r,i),!1}r=r.return}while(null!==r);return!1}(e,i,t,r,gc))return Tc=1,Cs(e,Wn(r,e.current)),void(mc=null)}catch(t){if(null!==i)throw mc=i,t;return Tc=1,Cs(e,Wn(r,e.current)),void(mc=null)}32768&t.flags?(hi||1===n?e=!0:bc||536870912&gc?e=!1:(vc=e=!0,(2===n||9===n||3===n||6===n)&&null!==(n=za.current)&&13===n.tag&&(n.flags|=16384)),fu(t,e)):pu(t)}function pu(e){var t=e;do{if(32768&t.flags)return void fu(t,vc);e=t.return;var r=pl(t.alternate,t,wc);if(null!==r)return void(mc=r);if(null!==(t=t.sibling))return void(mc=t);mc=t=e}while(null!==t);0===Tc&&(Tc=5)}function fu(e,t){do{var r=fl(e.alternate,e);if(null!==r)return r.flags&=32767,void(mc=r);if(null!==(r=e.return)&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&null!==(e=e.sibling))return void(mc=e);mc=e=r}while(null!==e);Tc=6,mc=null}function mu(e,t,r,n,i,a,s,l,c){e.cancelPendingCommit=null;do{bu()}while(0!==Bc);if(6&pc)throw Error(o(327));if(null!==t){if(t===e.current)throw Error(o(177));if(a=t.lanes|t.childLanes,function(e,t,r,n,i,a){var o=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var s=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(r=o&~r;0<r;){var u=31-be(r),h=1<<u;s[u]=0,l[u]=-1;var d=c[u];if(null!==d)for(c[u]=null,u=0;u<d.length;u++){var p=d[u];null!==p&&(p.lane&=-536870913)}r&=~h}0!==n&&De(e,n,0),0!==a&&0===i&&0!==e.tag&&(e.suspendedLanes|=a&~(o&~t))}(e,r,a|=kn,s,l,c),e===fc&&(mc=fc=null,gc=0),Nc=t,Oc=e,Vc=r,jc=a,Uc=i,Gc=n,10256&t.subtreeFlags||10256&t.flags?(e.callbackNode=null,e.callbackPriority=0,ie(de,function(){return xu(),null})):(e.callbackNode=null,e.callbackPriority=0),n=!!(13878&t.flags),13878&t.subtreeFlags||n){n=L.T,L.T=null,i=R.p,R.p=2,s=pc,pc|=4;try{!function(e,t){if(e=e.containerInfo,fh=vd,nn(e=rn(e))){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch(e){r=null;break e}var s=0,l=-1,c=-1,u=0,h=0,d=e,p=null;t:for(;;){for(var f;d!==r||0!==i&&3!==d.nodeType||(l=s+i),d!==a||0!==n&&3!==d.nodeType||(c=s+n),3===d.nodeType&&(s+=d.nodeValue.length),null!==(f=d.firstChild);)p=d,d=f;for(;;){if(d===e)break t;if(p===r&&++u===i&&(l=s),p===a&&++h===n&&(c=s),null!==(f=d.nextSibling))break;p=(d=p).parentNode}d=f}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(mh={focusedElem:e,selectionRange:r},vd=!1,Dl=t;null!==Dl;)if(e=(t=Dl).child,1028&t.subtreeFlags&&null!==e)e.return=t,Dl=e;else for(;null!==Dl;){switch(a=(t=Dl).alternate,e=t.flags,t.tag){case 0:if(4&e&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(r=0;r<e.length;r++)(i=e[r]).ref.impl=i.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(1024&e&&null!==a){e=void 0,r=t,i=a.memoizedProps,a=a.memoizedState,n=r.stateNode;try{var m=Ts(r.type,i);e=n.getSnapshotBeforeUpdate(m,a),n.__reactInternalSnapshotBeforeUpdate=e}catch(e){Tu(r,r.return,e)}}break;case 3:if(1024&e)if(9===(r=(e=t.stateNode.containerInfo).nodeType))kh(e);else if(1===r)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":kh(e);break;default:e.textContent=""}break;default:if(1024&e)throw Error(o(163))}if(null!==(e=t.sibling)){e.return=t.return,Dl=e;break}Dl=t.return}}(e,t)}finally{pc=s,R.p=i,L.T=n}}Bc=1,gu(),_u(),yu()}}function gu(){if(1===Bc){Bc=0;var e=Oc,t=Nc,r=!!(13878&t.flags);if(13878&t.subtreeFlags||r){r=L.T,L.T=null;var n=R.p;R.p=2;var i=pc;pc|=4;try{$l(t,e);var a=mh,o=rn(e.containerInfo),s=a.focusedElem,l=a.selectionRange;if(o!==s&&s&&s.ownerDocument&&tn(s.ownerDocument.documentElement,s)){if(null!==l&&nn(s)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in s)s.selectionStart=c,s.selectionEnd=Math.min(u,s.value.length);else{var h=s.ownerDocument||document,d=h&&h.defaultView||window;if(d.getSelection){var p=d.getSelection(),f=s.textContent.length,m=Math.min(l.start,f),g=void 0===l.end?m:Math.min(l.end,f);!p.extend&&m>g&&(o=g,g=m,m=o);var _=en(s,m),y=en(s,g);if(_&&y&&(1!==p.rangeCount||p.anchorNode!==_.node||p.anchorOffset!==_.offset||p.focusNode!==y.node||p.focusOffset!==y.offset)){var v=h.createRange();v.setStart(_.node,_.offset),p.removeAllRanges(),m>g?(p.addRange(v),p.extend(y.node,y.offset)):(v.setEnd(y.node,y.offset),p.addRange(v))}}}}for(h=[],p=s;p=p.parentNode;)1===p.nodeType&&h.push({element:p,left:p.scrollLeft,top:p.scrollTop});for("function"==typeof s.focus&&s.focus(),s=0;s<h.length;s++){var b=h[s];b.element.scrollLeft=b.left,b.element.scrollTop=b.top}}vd=!!fh,mh=fh=null}finally{pc=i,R.p=n,L.T=r}}e.current=t,Bc=2}}function _u(){if(2===Bc){Bc=0;var e=Oc,t=Nc,r=!!(8772&t.flags);if(8772&t.subtreeFlags||r){r=L.T,L.T=null;var n=R.p;R.p=2;var i=pc;pc|=4;try{Ll(e,t.alternate,t)}finally{pc=i,R.p=n,L.T=r}}Bc=3}}function yu(){if(4===Bc||3===Bc){Bc=0,se();var e=Oc,t=Nc,r=Vc,n=Gc;10256&t.subtreeFlags||10256&t.flags?Bc=5:(Bc=0,Nc=Oc=null,vu(e,e.pendingLanes));var i=e.pendingLanes;if(0===i&&(Fc=null),Be(r),t=t.stateNode,ye&&"function"==typeof ye.onCommitFiberRoot)try{ye.onCommitFiberRoot(_e,t,void 0,!(128&~t.current.flags))}catch(e){}if(null!==n){t=L.T,i=R.p,R.p=2,L.T=null;try{for(var a=e.onRecoverableError,o=0;o<n.length;o++){var s=n[o];a(s.value,{componentStack:s.stack})}}finally{L.T=t,R.p=i}}3&Vc&&bu(),Ru(e),i=e.pendingLanes,261930&r&&42&i?e===$c?qc++:(qc=0,$c=e):qc=0,Fu(0,!1)}}function vu(e,t){0===(e.pooledCacheLanes&=t)&&null!=(t=e.pooledCache)&&(e.pooledCache=null,Vi(t))}function bu(){return gu(),_u(),yu(),xu()}function xu(){if(5!==Bc)return!1;var e=Oc,t=jc;jc=0;var r=Be(Vc),n=L.T,i=R.p;try{R.p=32>r?32:r,L.T=null,r=Uc,Uc=null;var a=Oc,s=Vc;if(Bc=0,Nc=Oc=null,Vc=0,6&pc)throw Error(o(331));var l=pc;if(pc|=4,lc(a.current),ec(a,a.current,s,r),pc=l,Fu(0,!1),ye&&"function"==typeof ye.onPostCommitFiberRoot)try{ye.onPostCommitFiberRoot(_e,a)}catch(e){}return!0}finally{R.p=i,L.T=n,vu(e,t)}}function wu(e,t,r){t=Wn(r,t),null!==(e=va(e,t=ks(e.stateNode,t,2),2))&&(ze(e,2),Ru(e))}function Tu(e,t,r){if(3===e.tag)wu(e,e,r);else for(;null!==t;){if(3===t.tag){wu(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof n.componentDidCatch&&(null===Fc||!Fc.has(n))){e=Wn(r,e),null!==(n=va(t,r=Is(2),2))&&(As(r,n,t,e),ze(n,2),Ru(n));break}}t=t.return}}function Su(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new dc;var i=new Set;n.set(t,i)}else void 0===(i=n.get(t))&&(i=new Set,n.set(t,i));i.has(r)||(xc=!0,i.add(r),e=Pu.bind(null,e,t,r),t.then(e,e))}function Pu(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,fc===e&&(gc&r)===r&&(4===Tc||3===Tc&&(62914560&gc)===gc&&300>le()-zc?!(2&pc)&&tu(e,0):Ec|=r,Mc===gc&&(Mc=0)),Ru(e)}function Eu(e,t){0===t&&(t=Ie()),null!==(e=Dn(e,t))&&(ze(e,t),Ru(e))}function Cu(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Eu(e,r)}function Mu(e,t){var r=0;switch(e.tag){case 31:case 13:var n=e.stateNode,i=e.memoizedState;null!==i&&(r=i.retryLane);break;case 19:n=e.stateNode;break;case 22:n=e.stateNode._retryCache;break;default:throw Error(o(314))}null!==n&&n.delete(t),Eu(e,r)}var ku=null,Iu=null,Au=!1,zu=!1,Du=!1,Lu=0;function Ru(e){e!==Iu&&null===e.next&&(null===Iu?ku=Iu=e:Iu=Iu.next=e),zu=!0,Au||(Au=!0,Sh(function(){6&pc?ie(ue,Bu):Ou()}))}function Fu(e,t){if(!Du&&zu){Du=!0;do{for(var r=!1,n=ku;null!==n;){if(!t)if(0!==e){var i=n.pendingLanes;if(0===i)var a=0;else{var o=n.suspendedLanes,s=n.pingedLanes;a=(1<<31-be(42|e)+1)-1,a=201326741&(a&=i&~(o&~s))?201326741&a|1:a?2|a:0}0!==a&&(r=!0,ju(n,a))}else a=gc,!(3&(a=Ce(n,n===fc?a:0,null!==n.cancelPendingCommit||-1!==n.timeoutHandle)))||Me(n,a)||(r=!0,ju(n,a));n=n.next}}while(r);Du=!1}}function Bu(){Ou()}function Ou(){zu=Au=!1;var e,t=0;0!==Lu&&((e=window.event)&&"popstate"===e.type?e!==bh&&(bh=e,1):(bh=null,0))&&(t=Lu);for(var r=le(),n=null,i=ku;null!==i;){var a=i.next,o=Nu(i,r);0===o?(i.next=null,null===n?ku=a:n.next=a,null===a&&(Iu=n)):(n=i,(0!==t||3&o)&&(zu=!0)),i=a}0!==Bc&&5!==Bc||Fu(t,!1),0!==Lu&&(Lu=0)}function Nu(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=-62914561&e.pendingLanes;0<a;){var o=31-be(a),s=1<<o,l=i[o];-1===l?0!==(s&r)&&0===(s&n)||(i[o]=ke(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}if(r=gc,r=Ce(e,e===(t=fc)?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),n=e.callbackNode,0===r||e===t&&(2===_c||9===_c)||null!==e.cancelPendingCommit)return null!==n&&null!==n&&ae(n),e.callbackNode=null,e.callbackPriority=0;if(!(3&r)||Me(e,r)){if((t=r&-r)===e.callbackPriority)return t;switch(null!==n&&ae(n),Be(r)){case 2:case 8:r=he;break;case 32:default:r=de;break;case 268435456:r=fe}return n=Vu.bind(null,e),r=ie(r,n),e.callbackPriority=t,e.callbackNode=r,t}return null!==n&&null!==n&&ae(n),e.callbackPriority=2,e.callbackNode=null,2}function Vu(e,t){if(0!==Bc&&5!==Bc)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(bu()&&e.callbackNode!==r)return null;var n=gc;return 0===(n=Ce(e,e===fc?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Xc(e,n,t),Nu(e,le()),null!=e.callbackNode&&e.callbackNode===r?Vu.bind(null,e):null)}function ju(e,t){if(bu())return null;Xc(e,t,!0)}function Uu(){if(0===Lu){var e=Gi;0===e&&(e=Te,!(261888&(Te<<=1))&&(Te=256)),Lu=e}return Lu}function Gu(e){return null==e||"symbol"==typeof e||"boolean"==typeof e?null:"function"==typeof e?e:At(""+e)}function qu(e,t){var r=t.ownerDocument.createElement("input");return r.name=t.name,r.value=t.value,e.id&&r.setAttribute("form",e.id),t.parentNode.insertBefore(r,t),e=new FormData(e),r.parentNode.removeChild(r),e}for(var $u=0;$u<Sn.length;$u++){var Zu=Sn[$u];Pn(Zu.toLowerCase(),"on"+(Zu[0].toUpperCase()+Zu.slice(1)))}Pn(gn,"onAnimationEnd"),Pn(_n,"onAnimationIteration"),Pn(yn,"onAnimationStart"),Pn("dblclick","onDoubleClick"),Pn("focusin","onFocus"),Pn("focusout","onBlur"),Pn(vn,"onTransitionRun"),Pn(bn,"onTransitionStart"),Pn(xn,"onTransitionCancel"),Pn(wn,"onTransitionEnd"),it("onMouseEnter",["mouseout","mouseover"]),it("onMouseLeave",["mouseout","mouseover"]),it("onPointerEnter",["pointerout","pointerover"]),it("onPointerLeave",["pointerout","pointerover"]),nt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),nt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),nt("onBeforeInput",["compositionend","keypress","textInput","paste"]),nt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),nt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),nt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Hu));function Xu(e,t){t=!!(4&t);for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var s=n[o],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==a&&i.isPropagationStopped())break e;a=s,i.currentTarget=c;try{a(i)}catch(e){En(e)}i.currentTarget=null,a=l}else for(o=0;o<n.length;o++){if(l=(s=n[o]).instance,c=s.currentTarget,s=s.listener,l!==a&&i.isPropagationStopped())break e;a=s,i.currentTarget=c;try{a(i)}catch(e){En(e)}i.currentTarget=null,a=l}}}}function Yu(e,t){var r=t[qe];void 0===r&&(r=t[qe]=new Set);var n=e+"__bubble";r.has(n)||(eh(t,e,2,!1),r.add(n))}function Ku(e,t,r){var n=0;t&&(n|=4),eh(r,e,n,t)}var Qu="_reactListening"+Math.random().toString(36).slice(2);function Ju(e){if(!e[Qu]){e[Qu]=!0,tt.forEach(function(t){"selectionchange"!==t&&(Wu.has(t)||Ku(t,!1,e),Ku(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Qu]||(t[Qu]=!0,Ku("selectionchange",!1,t))}}function eh(e,t,r,n){switch(Ed(t)){case 2:var i=bd;break;case 8:i=xd;break;default:i=wd}r=i.bind(null,t,r,e),i=void 0,!Ut||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),n?void 0!==i?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):void 0!==i?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function th(e,t,r,n,i){var a=n;if(!(1&t||2&t||null===n))e:for(;;){if(null===n)return;var o=n.tag;if(3===o||4===o){var s=n.stateNode.containerInfo;if(s===i)break;if(4===o)for(o=n.return;null!==o;){var c=o.tag;if((3===c||4===c)&&o.stateNode.containerInfo===i)return;o=o.return}for(;null!==s;){if(null===(o=Ye(s)))return;if(5===(c=o.tag)||6===c||26===c||27===c){n=a=o;continue e}s=s.parentNode}}n=n.return}Nt(function(){var n=a,i=Lt(r),o=[];e:{var s=Tn.get(e);if(void 0!==s){var c=rr,u=e;switch(e){case"keypress":if(0===Wt(r))break e;case"keydown":case"keyup":c=_r;break;case"focusin":u="focus",c=lr;break;case"focusout":u="blur",c=lr;break;case"beforeblur":case"afterblur":c=lr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=or;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=sr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=vr;break;case gn:case _n:case yn:c=cr;break;case wn:c=br;break;case"scroll":case"scrollend":c=ir;break;case"wheel":c=xr;break;case"copy":case"cut":case"paste":c=ur;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=yr;break;case"toggle":case"beforetoggle":c=wr}var h=!!(4&t),d=!h&&("scroll"===e||"scrollend"===e),p=h?null!==s?s+"Capture":null:s;h=[];for(var f,m=n;null!==m;){var g=m;if(f=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===f||null===p||null!=(g=Vt(m,p))&&h.push(rh(m,g,f)),d)break;m=m.return}0<h.length&&(s=new c(s,u,null,r,i),o.push({event:s,listeners:h}))}}if(!(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||r===Dt||!(u=r.relatedTarget||r.fromElement)||!Ye(u)&&!u[Ge])&&(c||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,c?(c=n,null!==(u=(u=r.relatedTarget||r.toElement)?Ye(u):null)&&(d=l(u),h=u.tag,u!==d||5!==h&&27!==h&&6!==h)&&(u=null)):(c=null,u=n),c!==u)){if(h=or,g="onMouseLeave",p="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(h=yr,g="onPointerLeave",p="onPointerEnter",m="pointer"),d=null==c?s:Qe(c),f=null==u?s:Qe(u),(s=new h(g,m+"leave",c,r,i)).target=d,s.relatedTarget=f,g=null,Ye(i)===n&&((h=new h(p,m+"enter",u,r,i)).target=f,h.relatedTarget=d,g=h),d=g,c&&u)e:{for(h=ih,m=u,f=0,g=p=c;g;g=h(g))f++;g=0;for(var _=m;_;_=h(_))g++;for(;0<f-g;)p=h(p),f--;for(;0<g-f;)m=h(m),g--;for(;f--;){if(p===m||null!==m&&p===m.alternate){h=p;break e}p=h(p),m=h(m)}h=null}else h=null;null!==c&&ah(o,s,c,h,!1),null!==u&&null!==d&&ah(o,d,u,h,!0)}if("select"===(c=(s=n?Qe(n):window).nodeName&&s.nodeName.toLowerCase())||"input"===c&&"file"===s.type)var y=Vr;else if(Lr(s))if(jr)y=Yr;else{y=Wr;var v=Hr}else!(c=s.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==s.type&&"radio"!==s.type?n&&Mt(n.elementType)&&(y=Vr):y=Xr;switch(y&&(y=y(e,n))?Rr(o,y,r,i):(v&&v(e,s,n),"focusout"===e&&n&&"number"===s.type&&null!=n.memoizedProps.value&&bt(s,"number",s.value)),v=n?Qe(n):window,e){case"focusin":(Lr(v)||"true"===v.contentEditable)&&(on=v,sn=n,ln=null);break;case"focusout":ln=sn=on=null;break;case"mousedown":cn=!0;break;case"contextmenu":case"mouseup":case"dragend":cn=!1,un(o,r,i);break;case"selectionchange":if(an)break;case"keydown":case"keyup":un(o,r,i)}var b;if(Sr)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else zr?Ir(e,r)&&(x="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(x="onCompositionStart");x&&(Cr&&"ko"!==r.locale&&(zr||"onCompositionStart"!==x?"onCompositionEnd"===x&&zr&&(b=Ht()):($t="value"in(qt=i)?qt.value:qt.textContent,zr=!0)),0<(v=nh(n,x)).length&&(x=new hr(x,e,null,r,i),o.push({event:x,listeners:v}),(b||null!==(b=Ar(r)))&&(x.data=b))),(b=Er?function(e,t){switch(e){case"compositionend":return Ar(t);case"keypress":return 32!==t.which?null:(kr=!0,Mr);case"textInput":return(e=t.data)===Mr&&kr?null:e;default:return null}}(e,r):function(e,t){if(zr)return"compositionend"===e||!Sr&&Ir(e,t)?(e=Ht(),Zt=$t=qt=null,zr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Cr&&"ko"!==t.locale?null:t.data}}(e,r))&&0<(x=nh(n,"onBeforeInput")).length&&(v=new hr("onBeforeInput","beforeinput",null,r,i),o.push({event:v,listeners:x}),v.data=b),function(e,t,r,n,i){if("submit"===t&&r&&r.stateNode===i){var a=Gu((i[Ue]||null).action),o=n.submitter;o&&null!==(t=(t=o[Ue]||null)?Gu(t.formAction):o.getAttribute("formAction"))&&(a=t,o=null);var s=new rr("action","action",null,n,i);e.push({event:s,listeners:[{instance:null,listener:function(){if(n.defaultPrevented){if(0!==Lu){var e=o?qu(i,o):new FormData(i);ts(r,{pending:!0,data:e,method:i.method,action:a},null,e)}}else"function"==typeof a&&(s.preventDefault(),e=o?qu(i,o):new FormData(i),ts(r,{pending:!0,data:e,method:i.method,action:a},a,e))},currentTarget:i}]})}}(o,e,n,r,i)}Xu(o,t)})}function rh(e,t,r){return{instance:e,listener:t,currentTarget:r}}function nh(e,t){for(var r=t+"Capture",n=[];null!==e;){var i=e,a=i.stateNode;if(5!==(i=i.tag)&&26!==i&&27!==i||null===a||(null!=(i=Vt(e,r))&&n.unshift(rh(e,i,a)),null!=(i=Vt(e,t))&&n.push(rh(e,i,a))),3===e.tag)return n;e=e.return}return[]}function ih(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function ah(e,t,r,n,i){for(var a=t._reactName,o=[];null!==r&&r!==n;){var s=r,l=s.alternate,c=s.stateNode;if(s=s.tag,null!==l&&l===n)break;5!==s&&26!==s&&27!==s||null===c||(l=c,i?null!=(c=Vt(r,a))&&o.unshift(rh(r,c,l)):i||null!=(c=Vt(r,a))&&o.push(rh(r,c,l))),r=r.return}0!==o.length&&e.push({event:t,listeners:o})}var oh=/\r\n?/g,sh=/\u0000|\uFFFD/g;function lh(e){return("string"==typeof e?e:""+e).replace(oh,"\n").replace(sh,"")}function ch(e,t){return t=lh(t),lh(e)===t}function uh(e,t,r,n,i,a){switch(r){case"children":"string"==typeof n?"body"===t||"textarea"===t&&""===n||St(e,n):("number"==typeof n||"bigint"==typeof n)&&"body"!==t&&St(e,""+n);break;case"className":ct(e,"class",n);break;case"tabIndex":ct(e,"tabindex",n);break;case"dir":case"role":case"viewBox":case"width":case"height":ct(e,r,n);break;case"style":Ct(e,n,a);break;case"data":if("object"!==t){ct(e,"data",n);break}case"src":case"href":if(""===n&&("a"!==t||"href"!==r)){e.removeAttribute(r);break}if(null==n||"function"==typeof n||"symbol"==typeof n||"boolean"==typeof n){e.removeAttribute(r);break}n=At(""+n),e.setAttribute(r,n);break;case"action":case"formAction":if("function"==typeof n){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"==typeof a&&("formAction"===r?("input"!==t&&uh(e,t,"name",i.name,i,null),uh(e,t,"formEncType",i.formEncType,i,null),uh(e,t,"formMethod",i.formMethod,i,null),uh(e,t,"formTarget",i.formTarget,i,null)):(uh(e,t,"encType",i.encType,i,null),uh(e,t,"method",i.method,i,null),uh(e,t,"target",i.target,i,null))),null==n||"symbol"==typeof n||"boolean"==typeof n){e.removeAttribute(r);break}n=At(""+n),e.setAttribute(r,n);break;case"onClick":null!=n&&(e.onclick=zt);break;case"onScroll":null!=n&&Yu("scroll",e);break;case"onScrollEnd":null!=n&&Yu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!=typeof n||!("__html"in n))throw Error(o(61));if(null!=(r=n.__html)){if(null!=i.children)throw Error(o(60));e.innerHTML=r}}break;case"multiple":e.multiple=n&&"function"!=typeof n&&"symbol"!=typeof n;break;case"muted":e.muted=n&&"function"!=typeof n&&"symbol"!=typeof n;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==n||"function"==typeof n||"boolean"==typeof n||"symbol"==typeof n){e.removeAttribute("xlink:href");break}r=At(""+n),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=n&&"function"!=typeof n&&"symbol"!=typeof n?e.setAttribute(r,""+n):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":n&&"function"!=typeof n&&"symbol"!=typeof n?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":!0===n?e.setAttribute(r,""):!1!==n&&null!=n&&"function"!=typeof n&&"symbol"!=typeof n?e.setAttribute(r,n):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":null!=n&&"function"!=typeof n&&"symbol"!=typeof n&&!isNaN(n)&&1<=n?e.setAttribute(r,n):e.removeAttribute(r);break;case"rowSpan":case"start":null==n||"function"==typeof n||"symbol"==typeof n||isNaN(n)?e.removeAttribute(r):e.setAttribute(r,n);break;case"popover":Yu("beforetoggle",e),Yu("toggle",e),lt(e,"popover",n);break;case"xlinkActuate":ut(e,"http://www.w3.org/1999/xlink","xlink:actuate",n);break;case"xlinkArcrole":ut(e,"http://www.w3.org/1999/xlink","xlink:arcrole",n);break;case"xlinkRole":ut(e,"http://www.w3.org/1999/xlink","xlink:role",n);break;case"xlinkShow":ut(e,"http://www.w3.org/1999/xlink","xlink:show",n);break;case"xlinkTitle":ut(e,"http://www.w3.org/1999/xlink","xlink:title",n);break;case"xlinkType":ut(e,"http://www.w3.org/1999/xlink","xlink:type",n);break;case"xmlBase":ut(e,"http://www.w3.org/XML/1998/namespace","xml:base",n);break;case"xmlLang":ut(e,"http://www.w3.org/XML/1998/namespace","xml:lang",n);break;case"xmlSpace":ut(e,"http://www.w3.org/XML/1998/namespace","xml:space",n);break;case"is":lt(e,"is",n);break;case"innerText":case"textContent":break;default:(!(2<r.length)||"o"!==r[0]&&"O"!==r[0]||"n"!==r[1]&&"N"!==r[1])&&lt(e,r=kt.get(r)||r,n)}}function hh(e,t,r,n,i,a){switch(r){case"style":Ct(e,n,a);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!=typeof n||!("__html"in n))throw Error(o(61));if(null!=(r=n.__html)){if(null!=i.children)throw Error(o(60));e.innerHTML=r}}break;case"children":"string"==typeof n?St(e,n):("number"==typeof n||"bigint"==typeof n)&&St(e,""+n);break;case"onScroll":null!=n&&Yu("scroll",e);break;case"onScrollEnd":null!=n&&Yu("scrollend",e);break;case"onClick":null!=n&&(e.onclick=zt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:rt.hasOwnProperty(r)||("o"!==r[0]||"n"!==r[1]||(i=r.endsWith("Capture"),t=r.slice(2,i?r.length-7:void 0),"function"==typeof(a=null!=(a=e[Ue]||null)?a[r]:null)&&e.removeEventListener(t,a,i),"function"!=typeof n)?r in e?e[r]=n:!0===n?e.setAttribute(r,""):lt(e,r,n):("function"!=typeof a&&null!==a&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(t,n,i)))}}function dh(e,t,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Yu("error",e),Yu("load",e);var n,i=!1,a=!1;for(n in r)if(r.hasOwnProperty(n)){var s=r[n];if(null!=s)switch(n){case"src":i=!0;break;case"srcSet":a=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:uh(e,t,n,s,r,null)}}return a&&uh(e,t,"srcSet",r.srcSet,r,null),void(i&&uh(e,t,"src",r.src,r,null));case"input":Yu("invalid",e);var l=n=s=a=null,c=null,u=null;for(i in r)if(r.hasOwnProperty(i)){var h=r[i];if(null!=h)switch(i){case"name":a=h;break;case"type":s=h;break;case"checked":c=h;break;case"defaultChecked":u=h;break;case"value":n=h;break;case"defaultValue":l=h;break;case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(o(137,t));break;default:uh(e,t,i,h,r,null)}}return void vt(e,n,l,c,u,s,a,!1);case"select":for(a in Yu("invalid",e),i=s=n=null,r)if(r.hasOwnProperty(a)&&null!=(l=r[a]))switch(a){case"value":n=l;break;case"defaultValue":s=l;break;case"multiple":i=l;default:uh(e,t,a,l,r,null)}return t=n,r=s,e.multiple=!!i,void(null!=t?xt(e,!!i,t,!1):null!=r&&xt(e,!!i,r,!0));case"textarea":for(s in Yu("invalid",e),n=a=i=null,r)if(r.hasOwnProperty(s)&&null!=(l=r[s]))switch(s){case"value":i=l;break;case"defaultValue":a=l;break;case"children":n=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(o(91));break;default:uh(e,t,s,l,r,null)}return void Tt(e,i,a,n);case"option":for(c in r)r.hasOwnProperty(c)&&null!=(i=r[c])&&("selected"===c?e.selected=i&&"function"!=typeof i&&"symbol"!=typeof i:uh(e,t,c,i,r,null));return;case"dialog":Yu("beforetoggle",e),Yu("toggle",e),Yu("cancel",e),Yu("close",e);break;case"iframe":case"object":Yu("load",e);break;case"video":case"audio":for(i=0;i<Hu.length;i++)Yu(Hu[i],e);break;case"image":Yu("error",e),Yu("load",e);break;case"details":Yu("toggle",e);break;case"embed":case"source":case"link":Yu("error",e),Yu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in r)if(r.hasOwnProperty(u)&&null!=(i=r[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:uh(e,t,u,i,r,null)}return;default:if(Mt(t)){for(h in r)r.hasOwnProperty(h)&&void 0!==(i=r[h])&&hh(e,t,h,i,r,void 0);return}}for(l in r)r.hasOwnProperty(l)&&null!=(i=r[l])&&uh(e,t,l,i,r,null)}function ph(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var fh=null,mh=null;function gh(e){return 9===e.nodeType?e:e.ownerDocument}function _h(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function yh(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function vh(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"bigint"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var bh=null,xh="function"==typeof setTimeout?setTimeout:void 0,wh="function"==typeof clearTimeout?clearTimeout:void 0,Th="function"==typeof Promise?Promise:void 0,Sh="function"==typeof queueMicrotask?queueMicrotask:void 0!==Th?function(e){return Th.resolve(null).then(e).catch(Ph)}:xh;function Ph(e){setTimeout(function(){throw e})}function Eh(e){return"head"===e}function Ch(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&8===i.nodeType)if("/$"===(r=i.data)||"/&"===r){if(0===n)return e.removeChild(i),void qd(t);n--}else if("$"===r||"$?"===r||"$~"===r||"$!"===r||"&"===r)n++;else if("html"===r)Oh(e.ownerDocument.documentElement);else if("head"===r){Oh(r=e.ownerDocument.head);for(var a=r.firstChild;a;){var o=a.nextSibling,s=a.nodeName;a[We]||"SCRIPT"===s||"STYLE"===s||"LINK"===s&&"stylesheet"===a.rel.toLowerCase()||r.removeChild(a),a=o}}else"body"===r&&Oh(e.ownerDocument.body);r=i}while(r);qd(t)}function Mh(e,t){var r=e;e=0;do{var n=r.nextSibling;if(1===r.nodeType?t?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",""===r.getAttribute("style")&&r.removeAttribute("style")):3===r.nodeType&&(t?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),n&&8===n.nodeType)if("/$"===(r=n.data)){if(0===e)break;e--}else"$"!==r&&"$?"!==r&&"$~"!==r&&"$!"!==r||e++;r=n}while(r)}function kh(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var r=t;switch(t=t.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":kh(r),Xe(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===r.rel.toLowerCase())continue}e.removeChild(r)}}function Ih(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Dh(e.nextSibling)))return null}return e}function Ah(e){return"$?"===e.data||"$~"===e.data}function zh(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Dh(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Lh=null;function Rh(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r||"/&"===r){if(0===t)return Dh(e.nextSibling);t--}else"$"!==r&&"$!"!==r&&"$?"!==r&&"$~"!==r&&"&"!==r||t++}e=e.nextSibling}return null}function Fh(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r||"$~"===r||"&"===r){if(0===t)return e;t--}else"/$"!==r&&"/&"!==r||t++}e=e.previousSibling}return null}function Bh(e,t,r){switch(t=gh(r),e){case"html":if(!(e=t.documentElement))throw Error(o(452));return e;case"head":if(!(e=t.head))throw Error(o(453));return e;case"body":if(!(e=t.body))throw Error(o(454));return e;default:throw Error(o(451))}}function Oh(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Xe(e)}var Nh=new Map,Vh=new Set;function jh(e){return"function"==typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Uh=R.d;R.d={f:function(){var e=Uh.f(),t=Jc();return e||t},r:function(e){var t=Ke(e);null!==t&&5===t.tag&&"form"===t.type?ns(t):Uh.r(e)},D:function(e){Uh.D(e),qh("dns-prefetch",e,null)},C:function(e,t){Uh.C(e,t),qh("preconnect",e,t)},L:function(e,t,r){Uh.L(e,t,r);var n=Gh;if(n&&e&&t){var i='link[rel="preload"][as="'+_t(t)+'"]';"image"===t&&r&&r.imageSrcSet?(i+='[imagesrcset="'+_t(r.imageSrcSet)+'"]',"string"==typeof r.imageSizes&&(i+='[imagesizes="'+_t(r.imageSizes)+'"]')):i+='[href="'+_t(e)+'"]';var a=i;switch(t){case"style":a=Zh(e);break;case"script":a=Xh(e)}Nh.has(a)||(e=p({rel:"preload",href:"image"===t&&r&&r.imageSrcSet?void 0:e,as:t},r),Nh.set(a,e),null!==n.querySelector(i)||"style"===t&&n.querySelector(Hh(a))||"script"===t&&n.querySelector(Yh(a))||(dh(t=n.createElement("link"),"link",e),et(t),n.head.appendChild(t)))}},m:function(e,t){Uh.m(e,t);var r=Gh;if(r&&e){var n=t&&"string"==typeof t.as?t.as:"script",i='link[rel="modulepreload"][as="'+_t(n)+'"][href="'+_t(e)+'"]',a=i;switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":a=Xh(e)}if(!Nh.has(a)&&(e=p({rel:"modulepreload",href:e},t),Nh.set(a,e),null===r.querySelector(i))){switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(Yh(a)))return}dh(n=r.createElement("link"),"link",e),et(n),r.head.appendChild(n)}}},X:function(e,t){Uh.X(e,t);var r=Gh;if(r&&e){var n=Je(r).hoistableScripts,i=Xh(e),a=n.get(i);a||((a=r.querySelector(Yh(i)))||(e=p({src:e,async:!0},t),(t=Nh.get(i))&&ed(e,t),et(a=r.createElement("script")),dh(a,"link",e),r.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},n.set(i,a))}},S:function(e,t,r){Uh.S(e,t,r);var n=Gh;if(n&&e){var i=Je(n).hoistableStyles,a=Zh(e);t=t||"default";var o=i.get(a);if(!o){var s={loading:0,preload:null};if(o=n.querySelector(Hh(a)))s.loading=5;else{e=p({rel:"stylesheet",href:e,"data-precedence":t},r),(r=Nh.get(a))&&Jh(e,r);var l=o=n.createElement("link");et(l),dh(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){s.loading|=1}),l.addEventListener("error",function(){s.loading|=2}),s.loading|=4,Qh(o,t,n)}o={type:"stylesheet",instance:o,count:1,state:s},i.set(a,o)}}},M:function(e,t){Uh.M(e,t);var r=Gh;if(r&&e){var n=Je(r).hoistableScripts,i=Xh(e),a=n.get(i);a||((a=r.querySelector(Yh(i)))||(e=p({src:e,async:!0,type:"module"},t),(t=Nh.get(i))&&ed(e,t),et(a=r.createElement("script")),dh(a,"link",e),r.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},n.set(i,a))}}};var Gh="undefined"==typeof document?null:document;function qh(e,t,r){var n=Gh;if(n&&"string"==typeof t&&t){var i=_t(t);i='link[rel="'+e+'"][href="'+i+'"]',"string"==typeof r&&(i+='[crossorigin="'+r+'"]'),Vh.has(i)||(Vh.add(i),e={rel:e,crossOrigin:r,href:t},null===n.querySelector(i)&&(dh(t=n.createElement("link"),"link",e),et(t),n.head.appendChild(t)))}}function $h(e,t,r,n){var i,a,s,l,c=(c=Z.current)?jh(c):null;if(!c)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return"string"==typeof r.precedence&&"string"==typeof r.href?(t=Zh(r.href),(n=(r=Je(c).hoistableStyles).get(t))||(n={type:"style",instance:null,count:0,state:null},r.set(t,n)),n):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===r.rel&&"string"==typeof r.href&&"string"==typeof r.precedence){e=Zh(r.href);var u=Je(c).hoistableStyles,h=u.get(e);if(h||(c=c.ownerDocument||c,h={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,h),(u=c.querySelector(Hh(e)))&&!u._p&&(h.instance=u,h.state.loading=5),Nh.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},Nh.set(e,r),u||(i=c,a=e,s=r,l=h.state,i.querySelector('link[rel="preload"][as="style"]['+a+"]")?l.loading=1:(a=i.createElement("link"),l.preload=a,a.addEventListener("load",function(){return l.loading|=1}),a.addEventListener("error",function(){return l.loading|=2}),dh(a,"link",s),et(a),i.head.appendChild(a))))),t&&null===n)throw Error(o(528,""));return h}if(t&&null!==n)throw Error(o(529,""));return null;case"script":return t=r.async,"string"==typeof(r=r.src)&&t&&"function"!=typeof t&&"symbol"!=typeof t?(t=Xh(r),(n=(r=Je(c).hoistableScripts).get(t))||(n={type:"script",instance:null,count:0,state:null},r.set(t,n)),n):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function Zh(e){return'href="'+_t(e)+'"'}function Hh(e){return'link[rel="stylesheet"]['+e+"]"}function Wh(e){return p({},e,{"data-precedence":e.precedence,precedence:null})}function Xh(e){return'[src="'+_t(e)+'"]'}function Yh(e){return"script[async]"+e}function Kh(e,t,r){if(t.count++,null===t.instance)switch(t.type){case"style":var n=e.querySelector('style[data-href~="'+_t(r.href)+'"]');if(n)return t.instance=n,et(n),n;var i=p({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return et(n=(e.ownerDocument||e).createElement("style")),dh(n,"style",i),Qh(n,r.precedence,e),t.instance=n;case"stylesheet":i=Zh(r.href);var a=e.querySelector(Hh(i));if(a)return t.state.loading|=4,t.instance=a,et(a),a;n=Wh(r),(i=Nh.get(i))&&Jh(n,i),et(a=(e.ownerDocument||e).createElement("link"));var s=a;return s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),dh(a,"link",n),t.state.loading|=4,Qh(a,r.precedence,e),t.instance=a;case"script":return a=Xh(r.src),(i=e.querySelector(Yh(a)))?(t.instance=i,et(i),i):(n=r,(i=Nh.get(a))&&ed(n=p({},r),i),et(i=(e=e.ownerDocument||e).createElement("script")),dh(i,"link",n),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(o(443,t.type))}else"stylesheet"===t.type&&!(4&t.state.loading)&&(n=t.instance,t.state.loading|=4,Qh(n,r.precedence,e));return t.instance}function Qh(e,t,r){for(var n=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=n.length?n[n.length-1]:null,a=i,o=0;o<n.length;o++){var s=n[o];if(s.dataset.precedence===t)a=s;else if(a!==i)break}a?a.parentNode.insertBefore(e,a.nextSibling):(t=9===r.nodeType?r.head:r).insertBefore(e,t.firstChild)}function Jh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function ed(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var td=null;function rd(e,t,r){if(null===td){var n=new Map,i=td=new Map;i.set(r,n)}else(n=(i=td).get(r))||(n=new Map,i.set(r,n));if(n.has(e))return n;for(n.set(e,null),r=r.getElementsByTagName(e),i=0;i<r.length;i++){var a=r[i];if(!(a[We]||a[je]||"link"===e&&"stylesheet"===a.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==a.namespaceURI){var o=a.getAttribute(t)||"";o=e+o;var s=n.get(o);s?s.push(a):n.set(o,[a])}}return n}function nd(e,t,r){(e=e.ownerDocument||e).head.insertBefore(r,"title"===t?e.querySelector("head > title"):null)}function id(e){return!!("stylesheet"!==e.type||3&e.state.loading)}var ad=0;function od(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)ld(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var sd=null;function ld(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,sd=new Map,t.forEach(cd,e),sd=null,od.call(e))}function cd(e,t){if(!(4&t.state.loading)){var r=sd.get(e);if(r)var n=r.get(null);else{r=new Map,sd.set(e,r);for(var i=e.querySelectorAll("link[data-precedence],style[data-precedence]"),a=0;a<i.length;a++){var o=i[a];"LINK"!==o.nodeName&&"not all"===o.getAttribute("media")||(r.set(o.dataset.precedence,o),n=o)}n&&r.set(null,n)}o=(i=t.instance).getAttribute("data-precedence"),(a=r.get(o)||n)===n&&r.set(null,i),r.set(o,i),this.count++,n=od.bind(this),i.addEventListener("load",n),i.addEventListener("error",n),a?a.parentNode.insertBefore(i,a.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(i,e.firstChild),t.state.loading|=4}}var ud={$$typeof:x,Provider:null,Consumer:null,_currentValue:F,_currentValue2:F,_threadCount:0};function hd(e,t,r,n,i,a,o,s,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ae(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ae(0),this.hiddenUpdates=Ae(null),this.identifierPrefix=n,this.onUncaughtError=i,this.onCaughtError=a,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function dd(e,t,r,n,i,a,o,s,l,c,u,h){return e=new hd(e,t,r,o,l,c,u,h,s),t=1,!0===a&&(t|=24),a=On(3,null,null,t),e.current=a,a.stateNode=e,(t=Ni()).refCount++,e.pooledCache=t,t.refCount++,a.memoizedState={element:n,isDehydrated:r,cache:t},ga(a),e}function pd(e){return e?e=Fn:Fn}function fd(e,t,r,n,i,a){i=pd(i),null===n.context?n.context=i:n.pendingContext=i,(n=ya(t)).payload={element:r},null!==(a=void 0===a?null:a)&&(n.callback=a),null!==(r=va(e,n,t))&&(Wc(r,0,t),ba(r,e,t))}function md(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function gd(e,t){md(e,t),(e=e.alternate)&&md(e,t)}function _d(e){if(13===e.tag||31===e.tag){var t=Dn(e,67108864);null!==t&&Wc(t,0,67108864),gd(e,67108864)}}function yd(e){if(13===e.tag||31===e.tag){var t=Zc(),r=Dn(e,t=Fe(t));null!==r&&Wc(r,0,t),gd(e,t)}}var vd=!0;function bd(e,t,r,n){var i=L.T;L.T=null;var a=R.p;try{R.p=2,wd(e,t,r,n)}finally{R.p=a,L.T=i}}function xd(e,t,r,n){var i=L.T;L.T=null;var a=R.p;try{R.p=8,wd(e,t,r,n)}finally{R.p=a,L.T=i}}function wd(e,t,r,n){if(vd){var i=Td(n);if(null===i)th(e,t,n,Sd,r),Rd(e,n);else if(function(e,t,r,n,i){switch(t){case"focusin":return Md=Fd(Md,e,t,r,n,i),!0;case"dragenter":return kd=Fd(kd,e,t,r,n,i),!0;case"mouseover":return Id=Fd(Id,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return Ad.set(a,Fd(Ad.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,zd.set(a,Fd(zd.get(a)||null,e,t,r,n,i)),!0}return!1}(i,e,t,r,n))n.stopPropagation();else if(Rd(e,n),4&t&&-1<Ld.indexOf(e)){for(;null!==i;){var a=Ke(i);if(null!==a)switch(a.tag){case 3:if((a=a.stateNode).current.memoizedState.isDehydrated){var o=Ee(a.pendingLanes);if(0!==o){var s=a;for(s.pendingLanes|=2,s.entangledLanes|=2;o;){var l=1<<31-be(o);s.entanglements[1]|=l,o&=~l}Ru(a),!(6&pc)&&(Lc=le()+500,Fu(0,!1))}}break;case 31:case 13:null!==(s=Dn(a,2))&&Wc(s,0,2),Jc(),gd(a,2)}if(null===(a=Td(n))&&th(e,t,n,Sd,r),a===i)break;i=a}null!==i&&n.stopPropagation()}else th(e,t,n,null,r)}}function Td(e){return Pd(e=Lt(e))}var Sd=null;function Pd(e){if(Sd=null,null!==(e=Ye(e))){var t=l(e);if(null===t)e=null;else{var r=t.tag;if(13===r){if(null!==(e=c(t)))return e;e=null}else if(31===r){if(null!==(e=u(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Sd=e,null}function Ed(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case ue:return 2;case he:return 8;case de:case pe:return 32;case fe:return 268435456;default:return 32}default:return 32}}var Cd=!1,Md=null,kd=null,Id=null,Ad=new Map,zd=new Map,Dd=[],Ld="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Rd(e,t){switch(e){case"focusin":case"focusout":Md=null;break;case"dragenter":case"dragleave":kd=null;break;case"mouseover":case"mouseout":Id=null;break;case"pointerover":case"pointerout":Ad.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":zd.delete(t.pointerId)}}function Fd(e,t,r,n,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},null!==t&&null!==(t=Ke(t))&&_d(t),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Bd(e){var t=Ye(e.target);if(null!==t){var r=l(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=c(r)))return e.blockedOn=t,void Ne(e.priority,function(){yd(r)})}else if(31===t){if(null!==(t=u(r)))return e.blockedOn=t,void Ne(e.priority,function(){yd(r)})}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Od(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Td(e.nativeEvent);if(null!==r)return null!==(t=Ke(r))&&_d(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);Dt=n,r.target.dispatchEvent(n),Dt=null,t.shift()}return!0}function Nd(e,t,r){Od(e)&&r.delete(t)}function Vd(){Cd=!1,null!==Md&&Od(Md)&&(Md=null),null!==kd&&Od(kd)&&(kd=null),null!==Id&&Od(Id)&&(Id=null),Ad.forEach(Nd),zd.forEach(Nd)}function jd(e,t){e.blockedOn===t&&(e.blockedOn=null,Cd||(Cd=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Vd)))}var Ud=null;function Gd(e){Ud!==e&&(Ud=e,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Ud===e&&(Ud=null);for(var t=0;t<e.length;t+=3){var r=e[t],n=e[t+1],i=e[t+2];if("function"!=typeof n){if(null===Pd(n||r))continue;break}var a=Ke(r);null!==a&&(e.splice(t,3),t-=3,ts(a,{pending:!0,data:i,method:r.method,action:n},n,i))}}))}function qd(e){function t(t){return jd(t,e)}null!==Md&&jd(Md,e),null!==kd&&jd(kd,e),null!==Id&&jd(Id,e),Ad.forEach(t),zd.forEach(t);for(var r=0;r<Dd.length;r++){var n=Dd[r];n.blockedOn===e&&(n.blockedOn=null)}for(;0<Dd.length&&null===(r=Dd[0]).blockedOn;)Bd(r),null===r.blockedOn&&Dd.shift();if(null!=(r=(e.ownerDocument||e).$$reactFormReplay))for(n=0;n<r.length;n+=3){var i=r[n],a=r[n+1],o=i[Ue]||null;if("function"==typeof a)o||Gd(r);else if(o){var s=null;if(a&&a.hasAttribute("formAction")){if(i=a,o=a[Ue]||null)s=o.formAction;else if(null!==Pd(i))continue}else s=o.action;"function"==typeof s?r[n+1]=s:(r.splice(n,3),n-=3),Gd(r)}}}function $d(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return i=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==i&&(i(),i=null),n||setTimeout(r,20)}function r(){if(!n&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"==typeof navigation){var n=!1,i=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(r,100),function(){n=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==i&&(i(),i=null)}}}function Zd(e){this._internalRoot=e}function Hd(e){this._internalRoot=e}Hd.prototype.render=Zd.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));fd(t.current,Zc(),e,t,null,null)},Hd.prototype.unmount=Zd.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;fd(e.current,2,null,e,null,null),Jc(),t[Ge]=null}},Hd.prototype.unstable_scheduleHydration=function(e){if(e){var t=Oe();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Dd.length&&0!==t&&t<Dd[r].priority;r++);Dd.splice(r,0,e),0===r&&Bd(e)}};var Wd=i.version;if("19.2.0"!==Wd)throw Error(o(527,Wd,"19.2.0"));R.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(o(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(n=i.return)){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return h(i),e;if(a===n)return h(i),t;a=a.sibling}throw Error(o(188))}if(r.return!==n.return)r=i,n=a;else{for(var s=!1,c=i.child;c;){if(c===r){s=!0,r=i,n=a;break}if(c===n){s=!0,n=i,r=a;break}c=c.sibling}if(!s){for(c=a.child;c;){if(c===r){s=!0,r=a,n=i;break}if(c===n){s=!0,n=a,r=i;break}c=c.sibling}if(!s)throw Error(o(189))}}if(r.alternate!==n)throw Error(o(190))}if(3!==r.tag)throw Error(o(188));return r.stateNode.current===r?e:t}(t),null===(e=null!==e?d(e):null)?null:e.stateNode};var Xd={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.2.0"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Yd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yd.isDisabled&&Yd.supportsFiber)try{_e=Yd.inject(Xd),ye=Yd}catch(e){}}t.createRoot=function(e,t){if(!s(e))throw Error(o(299));var r=!1,n="",i=Ss,a=Ps,l=Es;return null!=t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onUncaughtError&&(i=t.onUncaughtError),void 0!==t.onCaughtError&&(a=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),t=dd(e,1,!1,null,0,r,n,null,i,a,l,$d),e[Ge]=t.current,Ju(e),new Zd(t)},t.hydrateRoot=function(e,t,r){if(!s(e))throw Error(o(299));var n=!1,i="",a=Ss,l=Ps,c=Es,u=null;return null!=r&&(!0===r.unstable_strictMode&&(n=!0),void 0!==r.identifierPrefix&&(i=r.identifierPrefix),void 0!==r.onUncaughtError&&(a=r.onUncaughtError),void 0!==r.onCaughtError&&(l=r.onCaughtError),void 0!==r.onRecoverableError&&(c=r.onRecoverableError),void 0!==r.formState&&(u=r.formState)),(t=dd(e,1,!0,t,0,n,i,u,a,l,c,$d)).context=pd(null),r=t.current,(i=ya(n=Fe(n=Zc()))).callback=null,va(r,i,n),r=n,t.current.lanes=r,ze(t,r),Ru(t),e[Ge]=t.current,Ju(e),new Hd(t)},t.version="19.2.0"},1353:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>_});var n=r(5072),i=r.n(n),a=r(7825),o=r.n(a),s=r(7659),l=r.n(s),c=r(5056),u=r.n(c),h=r(540),d=r.n(h),p=r(1113),f=r.n(p),m=r(2676),g={};g.styleTagTransform=f(),g.setAttributes=u(),g.insert=l().bind(null,"head"),g.domAPI=o(),g.insertStyleElement=d(),i()(m.A,g);const _=m.A&&m.A.locals?m.A.locals:void 0},1413:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z%27/%3E%3C/svg%3E"},1601:e=>{"use strict";e.exports=function(e){return e[1]}},1872:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(1601),i=r.n(n),a=r(6314),o=r.n(a)()(i());o.push([e.id,".map-frame{position:relative;display:block;height:100vh;width:100%}.map-frame *{line-height:unset}",""]);const s=o},1907:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27m10.5 14 4-8 4 8z%27/%3E%3Cpath fill=%27%23ccc%27 d=%27m10.5 16 4 8 4-8z%27/%3E%3C/svg%3E"},2228:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%2333b5e5%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3C/svg%3E"},2353:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2722%27 height=%2722%27 fill=%27none%27 stroke=%27%2333b5e5%27 viewBox=%270 0 22 22%27%3E%3Ccircle cx=%2711%27 cy=%2711%27 r=%278.5%27/%3E%3Cpath d=%27M17.5 11c0 4.819-3.02 8.5-6.5 8.5S4.5 15.819 4.5 11 7.52 2.5 11 2.5s6.5 3.681 6.5 8.5Z%27/%3E%3Cpath d=%27M13.5 11c0 2.447-.331 4.64-.853 6.206-.262.785-.562 1.384-.872 1.777-.314.399-.58.517-.775.517s-.461-.118-.775-.517c-.31-.393-.61-.992-.872-1.777C8.831 15.64 8.5 13.446 8.5 11s.331-4.64.853-6.206c.262-.785.562-1.384.872-1.777.314-.399.58-.517.775-.517s.461.118.775.517c.31.393.61.992.872 1.777.522 1.565.853 3.76.853 6.206Z%27/%3E%3Cpath d=%27M11 7.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138q.07-.058.224-.138c.299-.151.763-.302 1.379-.434C7.378 5.666 9.091 5.5 11 5.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138q-.07.058-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428ZM4.486 6.436ZM11 16.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138 1.3 1.3 0 0 1 .224-.138c.299-.151.763-.302 1.379-.434C7.378 14.666 9.091 14.5 11 14.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138a1.3 1.3 0 0 1-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428Zm-6.514-1.064ZM11 12.5c-2.46 0-4.672-.222-6.255-.574-.796-.177-1.406-.38-1.805-.59a1.5 1.5 0 0 1-.39-.272.3.3 0 0 1-.047-.064.3.3 0 0 1 .048-.064c.066-.073.189-.167.389-.272.399-.21 1.009-.413 1.805-.59C6.328 9.722 8.54 9.5 11 9.5s4.672.222 6.256.574c.795.177 1.405.38 1.804.59.2.105.323.2.39.272a.3.3 0 0 1 .047.064.3.3 0 0 1-.048.064 1.4 1.4 0 0 1-.389.272c-.399.21-1.009.413-1.804.59-1.584.352-3.796.574-6.256.574Zm-8.501-1.51v.002zm0 .018v.002zm17.002.002v-.002zm0-.018v-.002z%27/%3E%3C/svg%3E"},2676:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(1601),i=r.n(n),a=r(6314),o=r.n(a)()(i());o.push([e.id,".main{margin-top:10.5rem;grid-column:3/11;position:relative;height:max-content;width:100%}",""]);const s=o},3363:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5%27/%3E%3C/svg%3E"},3470:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23333%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5%27/%3E%3C/svg%3E"},3490:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23333%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z%27/%3E%3C/svg%3E"},3737:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23666%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3Cpath fill=%27red%27 d=%27m14 5 1 1-9 9-1-1z%27/%3E%3C/svg%3E"},3849:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(1601),i=r.n(n),a=r(6314),o=r.n(a)()(i());o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700;900&display=swap);"]),o.push([e.id,'*,*::before,*::after{all:unset;display:revert;line-height:100%;letter-spacing:0}:root{--grid-column-width: 10.1rem;--grid-gap: 2rem;--color-orange: #f53;--color-black: #262a2f;--color-grey: #868686;--color-white: #fff}h1,h2,h3,p{color:var(--color-black);display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis}h2,h3{font-weight:700}h3{font-size:1.6rem}p{font-size:1.8rem}a{color:var(--color-grey);font-weight:500}html{font-size:62.5%}#root{font-family:"Rubik",sans-serif;background-color:var(--color-white);font-size:1.9rem;font-weight:400;position:relative}',""]);const s=o},3913:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z%27/%3E%3C/svg%3E"},4417:e=>{"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},4420:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23333%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3C/svg%3E"},4477:(e,t)=>{"use strict";function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,i=e[n];if(!(0<a(i,t)))break e;e[n]=t,e[r]=i,r=n}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,i=e.length,o=i>>>1;n<o;){var s=2*(n+1)-1,l=e[s],c=s+1,u=e[c];if(0>a(l,r))c<i&&0>a(u,l)?(e[n]=u,e[c]=r,n=c):(e[n]=l,e[s]=r,n=s);else{if(!(c<i&&0>a(u,r)))break e;e[n]=u,e[c]=r,n=c}}}return t}function a(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if(t.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],u=[],h=1,d=null,p=3,f=!1,m=!1,g=!1,_=!1,y="function"==typeof setTimeout?setTimeout:null,v="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function x(e){for(var t=n(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,r(c,t)}t=n(u)}}function w(e){if(g=!1,x(e),!m)if(null!==n(c))m=!0,S||(S=!0,T());else{var t=n(u);null!==t&&z(w,t.startTime-e)}}var T,S=!1,P=-1,E=5,C=-1;function M(){return!(!_&&t.unstable_now()-C<E)}function k(){if(_=!1,S){var e=t.unstable_now();C=e;var r=!0;try{e:{m=!1,g&&(g=!1,v(P),P=-1),f=!0;var a=p;try{t:{for(x(e),d=n(c);null!==d&&!(d.expirationTime>e&&M());){var o=d.callback;if("function"==typeof o){d.callback=null,p=d.priorityLevel;var s=o(d.expirationTime<=e);if(e=t.unstable_now(),"function"==typeof s){d.callback=s,x(e),r=!0;break t}d===n(c)&&i(c),x(e)}else i(c);d=n(c)}if(null!==d)r=!0;else{var l=n(u);null!==l&&z(w,l.startTime-e),r=!1}}break e}finally{d=null,p=a,f=!1}r=void 0}}finally{r?T():S=!1}}}if("function"==typeof b)T=function(){b(k)};else if("undefined"!=typeof MessageChannel){var I=new MessageChannel,A=I.port2;I.port1.onmessage=k,T=function(){A.postMessage(null)}}else T=function(){y(k,0)};function z(e,r){P=y(function(){e(t.unstable_now())},r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var r=p;p=t;try{return e()}finally{p=r}},t.unstable_requestPaint=function(){_=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=p;p=e;try{return t()}finally{p=r}},t.unstable_scheduleCallback=function(e,i,a){var o=t.unstable_now();switch(a="object"==typeof a&&null!==a&&"number"==typeof(a=a.delay)&&0<a?o+a:o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>o?(e.sortIndex=a,r(u,e),null===n(c)&&e===n(u)&&(g?(v(P),P=-1):g=!0,z(w,a-o))):(e.sortIndex=s,r(c,e),m||f||(m=!0,S||(S=!0,T()))),e},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(e){var t=p;return function(){var r=p;p=t;try{return e.apply(this,arguments)}finally{p=r}}}},4643:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z%27/%3E%3C/svg%3E"},4665:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5%27/%3E%3C/svg%3E"},4890:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z%27/%3E%3C/svg%3E"},5018:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>_});var n=r(5072),i=r.n(n),a=r(7825),o=r.n(a),s=r(7659),l=r.n(s),c=r(5056),u=r.n(c),h=r(540),d=r.n(h),p=r(1113),f=r.n(p),m=r(9739),g={};g.styleTagTransform=f(),g.setAttributes=u(),g.insert=l().bind(null,"head"),g.domAPI=o(),g.insertStyleElement=d(),i()(m.A,g);const _=m.A&&m.A.locals?m.A.locals:void 0},5056:(e,t,r)=>{"use strict";e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},5072:e=>{"use strict";var t=[];function r(e){for(var r=-1,n=0;n<t.length;n++)if(t[n].identifier===e){r=n;break}return r}function n(e,n){for(var a={},o=[],s=0;s<e.length;s++){var l=e[s],c=n.base?l[0]+n.base:l[0],u=a[c]||0,h="".concat(c," ").concat(u);a[c]=u+1;var d=r(h),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)t[d].references++,t[d].updater(p);else{var f=i(p,n);n.byIndex=s,t.splice(s,0,{identifier:h,updater:f,references:1})}o.push(h)}return o}function i(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,i){var a=n(e=e||[],i=i||{});return function(e){e=e||[];for(var o=0;o<a.length;o++){var s=r(a[o]);t[s].references--}for(var l=n(e,i),c=0;c<a.length;c++){var u=r(a[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}a=l}}},5338:(e,t,r)=>{"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=r(1247)},5446:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2722%27 height=%2722%27 fill=%27%23333%27 viewBox=%270 0 22 22%27%3E%3Cpath d=%27m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0%27/%3E%3C/svg%3E"},5582:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function s(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,s)}l((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var r,n,i,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(l){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MapFrame=void 0;var o=a(r(6540));r(6153);var s=r(6443);r(5018),t.MapFrame=function(){var e=o.default.useRef(null),t=o.default.useRef(null);o.default.useEffect(function(){if(e.current){var n=t.current=new s.Map({container:e.current,style:"https://americanamap.org/style.json",center:[15,30],zoom:1.4,maxZoom:18,maxPitch:85});n.addControl(new s.GeolocateControl({fitBoundsOptions:{maxZoom:20},positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0})),n.addControl(new s.NavigationControl),n.on("load",function(){n.addSource("planes",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),n.addLayer({id:"planes-layer",type:"symbol",source:"planes",layout:{"icon-image":"oneway_black","icon-size":1.2,"icon-allow-overlap":!0,"icon-rotate":["get","direction"],"icon-rotation-alignment":"map"}}),r(),setInterval(r,2e3)})}},[]);var r=function(){return n(void 0,void 0,void 0,function(){var e,r,n,a,o;return i(this,function(i){switch(i.label){case 0:e="https://flight-radar1.p.rapidapi.com/flights/list-in-boundary?bl_lat=13.607884&bl_lng=100.641975&tr_lat=13.771029&tr_lng=100.861566&limit=300",r={method:"GET",headers:{"x-rapidapi-key":"d6f394051bmsh7dd37d398817e93p1fa0a4jsn89e2993a4a51","x-rapidapi-host":"flight-radar1.p.rapidapi.com"}},i.label=1;case 1:return i.trys.push([1,4,,5]),[4,fetch(e,r)];case 2:return[4,i.sent().json()];case 3:return(n=i.sent()).aircraft&&t.current?(a={type:"FeatureCollection",features:n.aircraft.filter(function(e){return e[3]&&e[2]}).map(function(e){return{type:"Feature",geometry:{type:"Point",coordinates:[e[3],e[2]]},properties:{direction:e[4]||0,flight:e[14],reg:e[10],type:e[9],airline:e[19]}}})},t.current.getSource("planes").setData(a),[3,5]):[2];case 4:throw o=i.sent(),new Error("API error: ".concat(String(o)));case 5:return[2]}})})};return o.default.createElement("div",{className:"map-frame",ref:e,style:{width:"100%",height:"100vh"}})}},5796:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23aaa%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3Cpath fill=%27red%27 d=%27m14 5 1 1-9 9-1-1z%27/%3E%3C/svg%3E"},6117:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2724%27 height=%2724%27 fill-rule=%27evenodd%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0%27/%3E%3C/svg%3E"},6153:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>_});var n=r(5072),i=r.n(n),a=r(7825),o=r.n(a),s=r(7659),l=r.n(s),c=r(5056),u=r.n(c),h=r(540),d=r.n(h),p=r(1113),f=r.n(p),m=r(1872),g={};g.styleTagTransform=f(),g.setAttributes=u(),g.insert=l().bind(null,"head"),g.domAPI=o(),g.insertStyleElement=d(),i()(m.A,g);const _=m.A&&m.A.locals?m.A.locals:void 0},6221:(e,t,r)=>{"use strict";var n=r(6540);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var o={d:{f:a,r:function(){throw Error(i(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},s=Symbol.for("react.portal"),l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"==typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(i(299));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:s,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.flushSync=function(e){var t=l.T,r=o.p;try{if(l.T=null,o.p=2,e)return e()}finally{l.T=t,o.p=r,o.d.f()}},t.preconnect=function(e,t){"string"==typeof e&&(t=t?"string"==typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:null,o.d.C(e,t))},t.prefetchDNS=function(e){"string"==typeof e&&o.d.D(e)},t.preinit=function(e,t){if("string"==typeof e&&t&&"string"==typeof t.as){var r=t.as,n=c(r,t.crossOrigin),i="string"==typeof t.integrity?t.integrity:void 0,a="string"==typeof t.fetchPriority?t.fetchPriority:void 0;"style"===r?o.d.S(e,"string"==typeof t.precedence?t.precedence:void 0,{crossOrigin:n,integrity:i,fetchPriority:a}):"script"===r&&o.d.X(e,{crossOrigin:n,integrity:i,fetchPriority:a,nonce:"string"==typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"==typeof e)if("object"==typeof t&&null!==t){if(null==t.as||"script"===t.as){var r=c(t.as,t.crossOrigin);o.d.M(e,{crossOrigin:r,integrity:"string"==typeof t.integrity?t.integrity:void 0,nonce:"string"==typeof t.nonce?t.nonce:void 0})}}else null==t&&o.d.M(e)},t.preload=function(e,t){if("string"==typeof e&&"object"==typeof t&&null!==t&&"string"==typeof t.as){var r=t.as,n=c(r,t.crossOrigin);o.d.L(e,r,{crossOrigin:n,integrity:"string"==typeof t.integrity?t.integrity:void 0,nonce:"string"==typeof t.nonce?t.nonce:void 0,type:"string"==typeof t.type?t.type:void 0,fetchPriority:"string"==typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"==typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"==typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"==typeof t.imageSizes?t.imageSizes:void 0,media:"string"==typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"==typeof e)if(t){var r=c(t.as,t.crossOrigin);o.d.m(e,{as:"string"==typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:r,integrity:"string"==typeof t.integrity?t.integrity:void 0})}else o.d.m(e)},t.requestFormReset=function(e){o.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,r){return l.H.useFormState(e,t,r)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.2.0"},6311:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2724%27 height=%2724%27 fill=%27%23fff%27 fill-rule=%27evenodd%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0%27/%3E%3C/svg%3E"},6314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r}).join("")},t.i=function(e,r,n,i,a){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(n)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(o[l]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);n&&o[u[0]]||(void 0!==a&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=a),r&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=r):u[2]=r),i&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=i):u[4]="".concat(i)),t.push(u))}},t}},6443:function(e){e.exports=function(){"use strict";var e={},t={};function r(r,n,i){if(t[r]=i,"index"===r){var a="var sharedModule = {}; ("+t.shared+")(sharedModule); ("+t.worker+")(sharedModule);",o={};return t.shared(o),t.index(e,o),"undefined"!=typeof window&&e.setWorkerUrl(window.URL.createObjectURL(new Blob([a],{type:"text/javascript"}))),e}}return r("shared",0,function(e){function t(e,t,r,n){return new(r||(r=Promise))(function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function s(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,s)}l((n=n.apply(e,t||[])).next())})}function r(e,t){this.x=e,this.y=t}function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var i,a;"function"==typeof SuppressedError&&SuppressedError,r.prototype={clone(){return new r(this.x,this.y)},add(e){return this.clone()._add(e)},sub(e){return this.clone()._sub(e)},multByPoint(e){return this.clone()._multByPoint(e)},divByPoint(e){return this.clone()._divByPoint(e)},mult(e){return this.clone()._mult(e)},div(e){return this.clone()._div(e)},rotate(e){return this.clone()._rotate(e)},rotateAround(e,t){return this.clone()._rotateAround(e,t)},matMult(e){return this.clone()._matMult(e)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(e){return this.x===e.x&&this.y===e.y},dist(e){return Math.sqrt(this.distSqr(e))},distSqr(e){const t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle(){return Math.atan2(this.y,this.x)},angleTo(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith(e){return this.angleWithSep(e.x,e.y)},angleWithSep(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult(e){const t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add(e){return this.x+=e.x,this.y+=e.y,this},_sub(e){return this.x-=e.x,this.y-=e.y,this},_mult(e){return this.x*=e,this.y*=e,this},_div(e){return this.x/=e,this.y/=e,this},_multByPoint(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint(e){return this.x/=e.x,this.y/=e.y,this},_unit(){return this._div(this.mag()),this},_perp(){const e=this.y;return this.y=this.x,this.x=-e,this},_rotate(e){const t=Math.cos(e),r=Math.sin(e),n=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=n,this},_rotateAround(e,t){const r=Math.cos(e),n=Math.sin(e),i=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-n*(this.y-t.y),this.y=i,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:r},r.convert=function(e){if(e instanceof r)return e;if(Array.isArray(e))return new r(+e[0],+e[1]);if(void 0!==e.x&&void 0!==e.y)return new r(+e.x,+e.y);throw new Error("Expected [x, y] or {x, y} point format")};var o=function(){if(a)return i;function e(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=n}return a=1,i=e,e.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,n=0;n<8;n++){var i=this.sampleCurveX(r)-e;if(Math.abs(i)<t)return r;var a=this.sampleCurveDerivativeX(r);if(Math.abs(a)<1e-6)break;r-=i/a}var o=0,s=1;for(r=e,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-e)<t));n++)e>i?o=r:s=r,r=.5*(s-o)+o;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}},i}(),s=n(o);let l,c;function u(){return null==l&&(l="undefined"!=typeof OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),l}function h(){if(null==c&&(c=!1,u())){const e=5,t=new OffscreenCanvas(e,e).getContext("2d",{willReadFrequently:!0});if(t){for(let r=0;r<e*e;r++){const n=4*r;t.fillStyle=`rgb(${n},${n+1},${n+2})`,t.fillRect(r%e,Math.floor(r/e),1,1)}const r=t.getImageData(0,0,e,e).data;for(let t=0;t<e*e*4;t++)if(t%4!=3&&r[t]!==t){c=!0;break}}}return c||!1}var d=1e-6,p="undefined"!=typeof Float32Array?Float32Array:Array;function f(){var e=new p(9);return p!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function m(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function g(){var e=new p(3);return p!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function _(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function y(e,t,r){var n=new p(3);return n[0]=e,n[1]=t,n[2]=r,n}function v(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function b(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function x(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],l=r[2];return e[0]=i*l-a*s,e[1]=a*o-n*l,e[2]=n*s-i*o,e}var w,T=_;function S(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,e}function P(){var e=new p(4);return p!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function E(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"zyx",a=Math.PI/360;t*=a,n*=a,r*=a;var o=Math.sin(t),s=Math.cos(t),l=Math.sin(r),c=Math.cos(r),u=Math.sin(n),h=Math.cos(n);switch(i){case"xyz":e[0]=o*c*h+s*l*u,e[1]=s*l*h-o*c*u,e[2]=s*c*u+o*l*h,e[3]=s*c*h-o*l*u;break;case"xzy":e[0]=o*c*h-s*l*u,e[1]=s*l*h-o*c*u,e[2]=s*c*u+o*l*h,e[3]=s*c*h+o*l*u;break;case"yxz":e[0]=o*c*h+s*l*u,e[1]=s*l*h-o*c*u,e[2]=s*c*u-o*l*h,e[3]=s*c*h+o*l*u;break;case"yzx":e[0]=o*c*h+s*l*u,e[1]=s*l*h+o*c*u,e[2]=s*c*u-o*l*h,e[3]=s*c*h-o*l*u;break;case"zxy":e[0]=o*c*h-s*l*u,e[1]=s*l*h+o*c*u,e[2]=s*c*u+o*l*h,e[3]=s*c*h-o*l*u;break;case"zyx":e[0]=o*c*h-s*l*u,e[1]=s*l*h+o*c*u,e[2]=s*c*u-o*l*h,e[3]=s*c*h+o*l*u;break;default:throw new Error("Unknown angle order "+i)}return e}function C(){var e=new p(2);return p!=Float32Array&&(e[0]=0,e[1]=0),e}function M(e,t){var r=new p(2);return r[0]=e,r[1]=t,r}g(),w=new p(4),p!=Float32Array&&(w[0]=0,w[1]=0,w[2]=0,w[3]=0),g(),y(1,0,0),y(0,1,0),P(),P(),f(),C();const k=8192;function I(e,t,r){return t*(k/(e.tileSize*Math.pow(2,r-e.tileID.overscaledZ)))}function A(e,t){return(e%t+t)%t}function z(e,t,r){return e*(1-r)+t*r}function D(e){if(e<=0)return 0;if(e>=1)return 1;const t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}function L(e,t,r,n){const i=new s(e,t,r,n);return e=>i.solve(e)}const R=L(.25,.1,.25,1);function F(e,t,r){return Math.min(r,Math.max(t,e))}function B(e,t,r){const n=r-t,i=((e-t)%n+n)%n+t;return i===t?r:i}function O(e,...t){for(const r of t)for(const t in r)e[t]=r[t];return e}let N=1;function V(e,t,r){const n={};for(const r in e)n[r]=t.call(this,e[r],r,e);return n}function j(e,t,r){const n={};for(const r in e)t.call(this,e[r],r,e)&&(n[r]=e[r]);return n}function U(e){return Array.isArray(e)?e.map(U):"object"==typeof e&&e?V(e,U):e}const G={};function q(e){G[e]||("undefined"!=typeof console&&console.warn(e),G[e]=!0)}function $(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function Z(e){return"undefined"!=typeof WorkerGlobalScope&&void 0!==e&&e instanceof WorkerGlobalScope}let H=null;function W(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap}const X="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Y(e,r,n,i,a){return t(this,void 0,void 0,function*(){if("undefined"==typeof VideoFrame)throw new Error("VideoFrame not supported");const t=new VideoFrame(e,{timestamp:0});try{const o=null==t?void 0:t.format;if(!o||!o.startsWith("BGR")&&!o.startsWith("RGB"))throw new Error(`Unrecognized format ${o}`);const s=o.startsWith("BGR"),l=new Uint8ClampedArray(i*a*4);if(yield t.copyTo(l,function(e,t,r,n,i){const a=4*Math.max(-t,0),o=(Math.max(0,r)-r)*n*4+a,s=4*n,l=Math.max(0,t),c=Math.max(0,r);return{rect:{x:l,y:c,width:Math.min(e.width,t+n)-l,height:Math.min(e.height,r+i)-c},layout:[{offset:o,stride:s}]}}(e,r,n,i,a)),s)for(let e=0;e<l.length;e+=4){const t=l[e];l[e]=l[e+2],l[e+2]=t}return l}finally{t.close()}})}let K,Q;function J(e,t,r,n){return e.addEventListener(t,r,n),{unsubscribe:()=>{e.removeEventListener(t,r,n)}}}function ee(e){return e*Math.PI/180}function te(e){return e/Math.PI*180}const re={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},ne={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},ie="AbortError";function ae(){return new Error(ie)}const oe={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function se(e){return oe.REGISTERED_PROTOCOLS[e.substring(0,e.indexOf("://"))]}const le="global-dispatcher";class ce extends Error{constructor(e,t,r,n){super(`AJAXError: ${t} (${e}): ${r}`),this.status=e,this.statusText=t,this.url=r,this.body=n}}const ue=()=>Z(self)?self.worker&&self.worker.referrer:("blob:"===window.location.protocol?window.parent:window).location.href,he=function(e,r){if(/:\/\//.test(e.url)&&!/^https?:|^file:/.test(e.url)){const t=se(e.url);if(t)return t(e,r);if(Z(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:e,targetMapId:le},r)}if(!(/^file:/.test(n=e.url)||/^file:/.test(ue())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(e,r){return t(this,void 0,void 0,function*(){const t=new Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,cache:e.cache,referrer:ue(),signal:r.signal});let n,i;"json"!==e.type||t.headers.has("Accept")||t.headers.set("Accept","application/json");try{n=yield fetch(t)}catch(t){throw new ce(0,t.message,e.url,new Blob)}if(!n.ok){const t=yield n.blob();throw new ce(n.status,n.statusText,e.url,t)}i="arrayBuffer"===e.type||"image"===e.type?n.arrayBuffer():"json"===e.type?n.json():n.text();const a=yield i;if(r.signal.aborted)throw ae();return{data:a,cacheControl:n.headers.get("Cache-Control"),expires:n.headers.get("Expires")}})}(e,r);if(Z(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:e,mustQueue:!0,targetMapId:le},r)}var n;return function(e,t){return new Promise((r,n)=>{var i;const a=new XMLHttpRequest;a.open(e.method||"GET",e.url,!0),"arrayBuffer"!==e.type&&"image"!==e.type||(a.responseType="arraybuffer");for(const t in e.headers)a.setRequestHeader(t,e.headers[t]);"json"===e.type&&(a.responseType="text",(null===(i=e.headers)||void 0===i?void 0:i.Accept)||a.setRequestHeader("Accept","application/json")),a.withCredentials="include"===e.credentials,a.onerror=()=>{n(new Error(a.statusText))},a.onload=()=>{if(!t.signal.aborted)if((a.status>=200&&a.status<300||0===a.status)&&null!==a.response){let t=a.response;if("json"===e.type)try{t=JSON.parse(a.response)}catch(e){return void n(e)}r({data:t,cacheControl:a.getResponseHeader("Cache-Control"),expires:a.getResponseHeader("Expires")})}else{const t=new Blob([a.response],{type:a.getResponseHeader("Content-Type")});n(new ce(a.status,a.statusText,e.url,t))}},t.signal.addEventListener("abort",()=>{a.abort(),n(ae())}),a.send(e.body)})}(e,r)};function de(e){if(!e||e.indexOf("://")<=0||0===e.indexOf("data:image/")||0===e.indexOf("blob:"))return!0;const t=new URL(e),r=window.location;return t.protocol===r.protocol&&t.host===r.host}function pe(e,t,r){r[e]&&-1!==r[e].indexOf(t)||(r[e]=r[e]||[],r[e].push(t))}function fe(e,t,r){if(r&&r[e]){const n=r[e].indexOf(t);-1!==n&&r[e].splice(n,1)}}class me{constructor(e,t={}){O(this,t),this.type=e}}class ge extends me{constructor(e,t={}){super("error",O({error:e},t))}}class _e{on(e,t){return this._listeners=this._listeners||{},pe(e,t,this._listeners),{unsubscribe:()=>{this.off(e,t)}}}off(e,t){return fe(e,t,this._listeners),fe(e,t,this._oneTimeListeners),this}once(e,t){return t?(this._oneTimeListeners=this._oneTimeListeners||{},pe(e,t,this._oneTimeListeners),this):new Promise(t=>this.once(e,t))}fire(e,t){"string"==typeof e&&(e=new me(e,t||{}));const r=e.type;if(this.listens(r)){e.target=this;const t=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];for(const r of t)r.call(this,e);const n=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];for(const t of n)fe(r,t,this._oneTimeListeners),t.call(this,e);const i=this._eventedParent;i&&(O(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),i.fire(e))}else e instanceof ge&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,t){return this._eventedParent=e,this._eventedParentData=t,this}}var ye={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ve=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function be(e,t){const r={};for(const t in e)"ref"!==t&&(r[t]=e[t]);return ve.forEach(e=>{e in t&&(r[e]=t[e])}),r}function xe(e,t){if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!xe(e[r],t[r]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==t){if("object"!=typeof t)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!xe(e[r],t[r]))return!1;return!0}return e===t}function we(e,t){e.push(t)}function Te(e,t,r){we(r,{command:"addSource",args:[e,t[e]]})}function Se(e,t,r){we(t,{command:"removeSource",args:[e]}),r[e]=!0}function Pe(e,t,r,n){Se(e,r,n),Te(e,t,r)}function Ee(e,t,r){let n;for(n in e[r])if(Object.prototype.hasOwnProperty.call(e[r],n)&&"data"!==n&&!xe(e[r][n],t[r][n]))return!1;for(n in t[r])if(Object.prototype.hasOwnProperty.call(t[r],n)&&"data"!==n&&!xe(e[r][n],t[r][n]))return!1;return!0}function Ce(e,t,r,n,i,a){e=e||{},t=t||{};for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&(xe(e[o],t[o])||r.push({command:a,args:[n,o,t[o],i]}));for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&!Object.prototype.hasOwnProperty.call(e,o)&&(xe(e[o],t[o])||r.push({command:a,args:[n,o,t[o],i]}))}function Me(e){return e.id}function ke(e,t){return e[t.id]=t,e}class Ie{constructor(e,t,r,n){this.message=(e?`${e}: `:"")+r,n&&(this.identifier=n),null!=t&&t.__line__&&(this.line=t.__line__)}}function Ae(e,...t){for(const r of t)for(const t in r)e[t]=r[t];return e}class ze extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}class De{constructor(e,t=[]){this.parent=e,this.bindings={};for(const[e,r]of t)this.bindings[e]=r}concat(e){return new De(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Le={kind:"null"},Re={kind:"number"},Fe={kind:"string"},Be={kind:"boolean"},Oe={kind:"color"},Ne={kind:"projectionDefinition"},Ve={kind:"object"},je={kind:"value"},Ue={kind:"collator"},Ge={kind:"formatted"},qe={kind:"padding"},$e={kind:"colorArray"},Ze={kind:"numberArray"},He={kind:"resolvedImage"},We={kind:"variableAnchorOffsetCollection"};function Xe(e,t){return{kind:"array",itemType:e,N:t}}function Ye(e){if("array"===e.kind){const t=Ye(e.itemType);return"number"==typeof e.N?`array<${t}, ${e.N}>`:"value"===e.itemType.kind?"array":`array<${t}>`}return e.kind}const Ke=[Le,Re,Fe,Be,Oe,Ne,Ge,Ve,Xe(je),qe,Ze,$e,He,We];function Qe(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!Qe(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const e of Ke)if(!Qe(e,t))return null}return`Expected ${Ye(e)} but found ${Ye(t)} instead.`}function Je(e,t){return t.some(t=>t.kind===e.kind)}function et(e,t){return t.some(t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e)}function tt(e,t){return"array"===e.kind&&"array"===t.kind?e.itemType.kind===t.itemType.kind&&"number"==typeof e.N:e.kind===t.kind}const rt=.96422,nt=.82521,it=4/29,at=6/29,ot=3*at*at,st=at*at*at,lt=Math.PI/180,ct=180/Math.PI;function ut(e){return(e%=360)<0&&(e+=360),e}function ht([e,t,r,n]){let i,a;const o=pt((.2225045*(e=dt(e))+.7168786*(t=dt(t))+.0606169*(r=dt(r)))/1);e===t&&t===r?i=a=o:(i=pt((.4360747*e+.3850649*t+.1430804*r)/rt),a=pt((.0139322*e+.0971045*t+.7141733*r)/nt));const s=116*o-16;return[s<0?0:s,500*(i-o),200*(o-a),n]}function dt(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function pt(e){return e>st?Math.pow(e,1/3):e/ot+it}function ft([e,t,r,n]){let i=(e+16)/116,a=isNaN(t)?i:i+t/500,o=isNaN(r)?i:i-r/200;return i=1*gt(i),a=rt*gt(a),o=nt*gt(o),[mt(3.1338561*a-1.6168667*i-.4906146*o),mt(-.9787684*a+1.9161415*i+.033454*o),mt(.0719453*a-.2289914*i+1.4052427*o),n]}function mt(e){return(e=e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055)<0?0:e>1?1:e}function gt(e){return e>at?e*e*e:ot*(e-it)}const _t=Object.hasOwn||function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};function yt(e,t){return _t(e,t)?e[t]:void 0}function vt(e){return parseInt(e.padEnd(2,e),16)/255}function bt(e,t){return xt(t?e/100:e,0,1)}function xt(e,t,r){return Math.min(Math.max(t,e),r)}function wt(e){return!e.some(Number.isNaN)}const Tt={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function St(e,t,r){return e+r*(t-e)}function Pt(e,t,r){return e.map((e,n)=>St(e,t[n],r))}class Et{constructor(e,t,r,n=1,i=!0){this.r=e,this.g=t,this.b=r,this.a=n,i||(this.r*=n,this.g*=n,this.b*=n,n||this.overwriteGetter("rgb",[e,t,r,n]))}static parse(e){if(e instanceof Et)return e;if("string"!=typeof e)return;const t=function(e){if("transparent"===(e=e.toLowerCase().trim()))return[0,0,0,0];const t=yt(Tt,e);if(t){const[e,r,n]=t;return[e/255,r/255,n/255,1]}if(e.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(e)){const t=e.length<6?1:2;let r=1;return[vt(e.slice(r,r+=t)),vt(e.slice(r,r+=t)),vt(e.slice(r,r+=t)),vt(e.slice(r,r+t)||"ff")]}if(e.startsWith("rgb")){const t=e.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(t){const[e,r,n,i,a,o,s,l,c,u,h,d]=t,p=[i||" ",s||" ",u].join("");if("  "===p||"  /"===p||",,"===p||",,,"===p){const e=[n,o,c].join(""),t="%%%"===e?100:""===e?255:0;if(t){const e=[xt(+r/t,0,1),xt(+a/t,0,1),xt(+l/t,0,1),h?bt(+h,d):1];if(wt(e))return e}}return}}const r=e.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(r){const[e,t,n,i,a,o,s,l,c]=r,u=[n||" ",a||" ",s].join("");if("  "===u||"  /"===u||",,"===u||",,,"===u){const e=[+t,xt(+i,0,100),xt(+o,0,100),l?bt(+l,c):1];if(wt(e))return function([e,t,r,n]){function i(n){const i=(n+e/30)%12,a=t*Math.min(r,1-r);return r-a*Math.max(-1,Math.min(i-3,9-i,1))}return e=ut(e),t/=100,r/=100,[i(0),i(8),i(4),n]}(e)}}}(e);return t?new Et(...t,!1):void 0}get rgb(){const{r:e,g:t,b:r,a:n}=this,i=n||1/0;return this.overwriteGetter("rgb",[e/i,t/i,r/i,n])}get hcl(){return this.overwriteGetter("hcl",function(e){const[t,r,n,i]=ht(e),a=Math.sqrt(r*r+n*n);return[Math.round(1e4*a)?ut(Math.atan2(n,r)*ct):NaN,a,t,i]}(this.rgb))}get lab(){return this.overwriteGetter("lab",ht(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){const[e,t,r,n]=this.rgb;return`rgba(${[e,t,r].map(e=>Math.round(255*e)).join(",")},${n})`}static interpolate(e,t,r,n="rgb"){switch(n){case"rgb":{const[n,i,a,o]=Pt(e.rgb,t.rgb,r);return new Et(n,i,a,o,!1)}case"hcl":{const[n,i,a,o]=e.hcl,[s,l,c,u]=t.hcl;let h,d;if(isNaN(n)||isNaN(s))isNaN(n)?isNaN(s)?h=NaN:(h=s,1!==a&&0!==a||(d=l)):(h=n,1!==c&&0!==c||(d=i));else{let e=s-n;s>n&&e>180?e-=360:s<n&&n-s>180&&(e+=360),h=n+r*e}const[p,f,m,g]=function([e,t,r,n]){return e=isNaN(e)?0:e*lt,ft([r,Math.cos(e)*t,Math.sin(e)*t,n])}([h,null!=d?d:St(i,l,r),St(a,c,r),St(o,u,r)]);return new Et(p,f,m,g,!1)}case"lab":{const[n,i,a,o]=ft(Pt(e.lab,t.lab,r));return new Et(n,i,a,o,!1)}}}}Et.black=new Et(0,0,0,1),Et.white=new Et(1,1,1,1),Et.transparent=new Et(0,0,0,0),Et.red=new Et(1,0,0,1);class Ct{constructor(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Mt=["bottom","center","top"];class kt{constructor(e,t,r,n,i,a){this.text=e,this.image=t,this.scale=r,this.fontStack=n,this.textColor=i,this.verticalAlign=a}}class It{constructor(e){this.sections=e}static fromString(e){return new It([new kt(e,null,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof It?e:It.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}}class At{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof At)return e;if("number"==typeof e)return new At([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const t of e)if("number"!=typeof t)return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new At(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){return new At(Pt(e.values,t.values,r))}}class zt{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof zt)return e;if("number"==typeof e)return new zt([e]);if(Array.isArray(e)){for(const t of e)if("number"!=typeof t)return;return new zt(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){return new zt(Pt(e.values,t.values,r))}}class Dt{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Dt)return e;if("string"==typeof e){const t=Et.parse(e);if(!t)return;return new Dt([t])}if(!Array.isArray(e))return;const t=[];for(const r of e){if("string"!=typeof r)return;const e=Et.parse(r);if(!e)return;t.push(e)}return new Dt(t)}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r,n="rgb"){const i=[];if(e.values.length!=t.values.length)throw new Error(`colorArray: Arrays have mismatched length (${e.values.length} vs. ${t.values.length}), cannot interpolate.`);for(let a=0;a<e.values.length;a++)i.push(Et.interpolate(e.values[a],t.values[a],r,n));return new Dt(i)}}class Lt extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}}const Rt=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Ft{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Ft)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let t=0;t<e.length;t+=2){const r=e[t],n=e[t+1];if("string"!=typeof r||!Rt.has(r))return;if(!Array.isArray(n)||2!==n.length||"number"!=typeof n[0]||"number"!=typeof n[1])return}return new Ft(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){const n=e.values,i=t.values;if(n.length!==i.length)throw new Lt(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${t.toString()}`);const a=[];for(let e=0;e<n.length;e+=2){if(n[e]!==i[e])throw new Lt(`Cannot interpolate values containing mismatched anchors. from[${e}]: ${n[e]}, to[${e}]: ${i[e]}`);a.push(n[e]);const[t,o]=n[e+1],[s,l]=i[e+1];a.push([St(t,s,r),St(o,l,r)])}return new Ft(a)}}class Bt{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Bt({name:e,available:!1}):null}}class Ot{constructor(e,t,r){this.from=e,this.to=t,this.transition=r}static interpolate(e,t,r){return new Ot(e,t,r)}static parse(e){return e instanceof Ot?e:Array.isArray(e)&&3===e.length&&"string"==typeof e[0]&&"string"==typeof e[1]&&"number"==typeof e[2]?new Ot(e[0],e[1],e[2]):"object"==typeof e&&"string"==typeof e.from&&"string"==typeof e.to&&"number"==typeof e.transition?new Ot(e.from,e.to,e.transition):"string"==typeof e?new Ot(e,e,1):void 0}}function Nt(e,t,r,n){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:`Invalid rgba value [${[e,t,r,n].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof n?[e,t,r,n]:[e,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Vt(e){if(null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e||e instanceof Ot||e instanceof Et||e instanceof Ct||e instanceof It||e instanceof At||e instanceof zt||e instanceof Dt||e instanceof Ft||e instanceof Bt)return!0;if(Array.isArray(e)){for(const t of e)if(!Vt(t))return!1;return!0}if("object"==typeof e){for(const t in e)if(!Vt(e[t]))return!1;return!0}return!1}function jt(e){if(null===e)return Le;if("string"==typeof e)return Fe;if("boolean"==typeof e)return Be;if("number"==typeof e)return Re;if(e instanceof Et)return Oe;if(e instanceof Ot)return Ne;if(e instanceof Ct)return Ue;if(e instanceof It)return Ge;if(e instanceof At)return qe;if(e instanceof zt)return Ze;if(e instanceof Dt)return $e;if(e instanceof Ft)return We;if(e instanceof Bt)return He;if(Array.isArray(e)){const t=e.length;let r;for(const t of e){const e=jt(t);if(r){if(r===e)continue;r=je;break}r=e}return Xe(r||je,t)}return Ve}function Ut(e){const t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Et||e instanceof Ot||e instanceof It||e instanceof At||e instanceof zt||e instanceof Dt||e instanceof Ft||e instanceof Bt?e.toString():JSON.stringify(e)}class Gt{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Vt(e[1]))return t.error("invalid value");const r=e[1];let n=jt(r);const i=t.expectedType;return"array"!==n.kind||0!==n.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(n=i),new Gt(n,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const qt={string:Fe,number:Re,boolean:Be,object:Ve};class $t{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r,n=1;const i=e[0];if("array"===i){let i,a;if(e.length>2){const r=e[1];if("string"!=typeof r||!(r in qt)||"object"===r)return t.error('The item type argument of "array" must be one of string, number, boolean',1);i=qt[r],n++}else i=je;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);a=e[2],n++}r=Xe(i,a)}else{if(!qt[i])throw new Error(`Types doesn't contain name = ${i}`);r=qt[i]}const a=[];for(;n<e.length;n++){const r=t.parse(e[n],n,je);if(!r)return null;a.push(r)}return new $t(r,a)}evaluate(e){for(let t=0;t<this.args.length;t++){const r=this.args[t].evaluate(e);if(!Qe(this.type,jt(r)))return r;if(t===this.args.length-1)throw new Lt(`Expected value to be of type ${Ye(this.type)}, but found ${Ye(jt(r))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const Zt={"to-boolean":Be,"to-color":Oe,"to-number":Re,"to-string":Fe};class Ht{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const r=e[0];if(!Zt[r])throw new Error(`Can't parse ${r} as it is not part of the known types`);if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return t.error("Expected one argument.");const n=Zt[r],i=[];for(let r=1;r<e.length;r++){const n=t.parse(e[r],r,je);if(!n)return null;i.push(n)}return new Ht(n,i)}evaluate(e){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(e));case"color":{let t,r;for(const n of this.args){if(t=n.evaluate(e),r=null,t instanceof Et)return t;if("string"==typeof t){const r=e.parseColor(t);if(r)return r}else if(Array.isArray(t)&&(r=t.length<3||t.length>4?`Invalid rgba value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:Nt(t[0],t[1],t[2],t[3]),!r))return new Et(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Lt(r||`Could not parse color from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"padding":{let t;for(const r of this.args){t=r.evaluate(e);const n=At.parse(t);if(n)return n}throw new Lt(`Could not parse padding from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"numberArray":{let t;for(const r of this.args){t=r.evaluate(e);const n=zt.parse(t);if(n)return n}throw new Lt(`Could not parse numberArray from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"colorArray":{let t;for(const r of this.args){t=r.evaluate(e);const n=Dt.parse(t);if(n)return n}throw new Lt(`Could not parse colorArray from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"variableAnchorOffsetCollection":{let t;for(const r of this.args){t=r.evaluate(e);const n=Ft.parse(t);if(n)return n}throw new Lt(`Could not parse variableAnchorOffsetCollection from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"number":{let t=null;for(const r of this.args){if(t=r.evaluate(e),null===t)return 0;const n=Number(t);if(!isNaN(n))return n}throw new Lt(`Could not convert ${JSON.stringify(t)} to number.`)}case"formatted":return It.fromString(Ut(this.args[0].evaluate(e)));case"resolvedImage":return Bt.fromString(Ut(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return Ut(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const Wt=["Unknown","Point","LineString","Polygon"];class Xt{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Wt[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache.get(e);return t||(t=Et.parse(e),this._parseColorCache.set(e,t)),t}}class Yt{constructor(e,t,r=[],n,i=new De,a=[]){this.registry=e,this.path=r,this.key=r.map(e=>`[${e}]`).join(""),this.scope=i,this.errors=a,this.expectedType=n,this._isConstant=t}parse(e,t,r,n,i={}){return t?this.concat(t,r,n)._parse(e,i):this._parse(e,i)}_parse(e,t){function r(e,t,r){return"assert"===r?new $t(t,[e]):"coerce"===r?new Ht(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const n=e[0];if("string"!=typeof n)return this.error(`Expression name must be a string, but found ${typeof n} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const i=this.registry[n];if(i){let n=i.parse(e,this);if(!n)return null;if(this.expectedType){const e=this.expectedType,i=n.type;if("string"!==e.kind&&"number"!==e.kind&&"boolean"!==e.kind&&"object"!==e.kind&&"array"!==e.kind||"value"!==i.kind){if("projectionDefinition"===e.kind&&["string","array"].includes(i.kind)||["color","formatted","resolvedImage"].includes(e.kind)&&["value","string"].includes(i.kind)||["padding","numberArray"].includes(e.kind)&&["value","number","array"].includes(i.kind)||"colorArray"===e.kind&&["value","string","array"].includes(i.kind)||"variableAnchorOffsetCollection"===e.kind&&["value","array"].includes(i.kind))n=r(n,e,t.typeAnnotation||"coerce");else if(this.checkSubtype(e,i))return null}else n=r(n,e,t.typeAnnotation||"assert")}if(!(n instanceof Gt)&&"resolvedImage"!==n.type.kind&&this._isConstant(n)){const t=new Xt;try{n=new Gt(n.type,n.evaluate(t))}catch(e){return this.error(e.message),null}}return n}return this.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,t,r){const n="number"==typeof e?this.path.concat(e):this.path,i=r?this.scope.concat(r):this.scope;return new Yt(this.registry,this._isConstant,n,t||null,i,this.errors)}error(e,...t){const r=`${this.key}${t.map(e=>`[${e}]`).join("")}`;this.errors.push(new ze(r,e))}checkSubtype(e,t){const r=Qe(e,t);return r&&this.error(r),r}}class Kt{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const r=[];for(let n=1;n<e.length-1;n+=2){const i=e[n];if("string"!=typeof i)return t.error(`Expected string, but found ${typeof i} instead.`,n);if(/[^a-zA-Z0-9_]/.test(i))return t.error("Variable names must contain only alphanumeric characters or '_'.",n);const a=t.parse(e[n+1],n+1);if(!a)return null;r.push([i,a])}const n=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return n?new Kt(r,n):null}outputDefined(){return this.result.outputDefined()}}class Qt{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");const r=e[1];return t.scope.has(r)?new Qt(r,t.scope.get(r)):t.error(`Unknown variable "${r}". Make sure "${r}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Jt{constructor(e,t,r){this.type=e,this.index=t,this.input=r}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,Re),n=t.parse(e[2],2,Xe(t.expectedType||je));return r&&n?new Jt(n.type.itemType,r,n):null}evaluate(e){const t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new Lt(`Array index out of bounds: ${t} < 0.`);if(t>=r.length)throw new Lt(`Array index out of bounds: ${t} > ${r.length-1}.`);if(t!==Math.floor(t))throw new Lt(`Array index must be an integer, but found ${t} instead.`);return r[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class er{constructor(e,t){this.type=Be,this.needle=e,this.haystack=t}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,je),n=t.parse(e[2],2,je);return r&&n?Je(r.type,[Be,Fe,Re,Le,je])?new er(r,n):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ye(r.type)} instead`):null}evaluate(e){const t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!et(t,["boolean","string","number","null"]))throw new Lt(`Expected first argument to be of type boolean, string, number or null, but found ${Ye(jt(t))} instead.`);if(!et(r,["string","array"]))throw new Lt(`Expected second argument to be of type array or string, but found ${Ye(jt(r))} instead.`);return r.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class tr{constructor(e,t,r){this.type=Re,this.needle=e,this.haystack=t,this.fromIndex=r}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,je),n=t.parse(e[2],2,je);if(!r||!n)return null;if(!Je(r.type,[Be,Fe,Re,Le,je]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ye(r.type)} instead`);if(4===e.length){const i=t.parse(e[3],3,Re);return i?new tr(r,n,i):null}return new tr(r,n)}evaluate(e){const t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!et(t,["boolean","string","number","null"]))throw new Lt(`Expected first argument to be of type boolean, string, number or null, but found ${Ye(jt(t))} instead.`);let n;if(this.fromIndex&&(n=this.fromIndex.evaluate(e)),et(r,["string"])){const e=r.indexOf(t,n);return-1===e?-1:[...r.slice(0,e)].length}if(et(r,["array"]))return r.indexOf(t,n);throw new Lt(`Expected second argument to be of type array or string, but found ${Ye(jt(r))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class rr{constructor(e,t,r,n,i,a){this.inputType=e,this.type=t,this.input=r,this.cases=n,this.outputs=i,this.otherwise=a}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return t.error("Expected an even number of arguments.");let r,n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);const i={},a=[];for(let o=2;o<e.length-1;o+=2){let s=e[o];const l=e[o+1];Array.isArray(s)||(s=[s]);const c=t.concat(o);if(0===s.length)return c.error("Expected at least one branch label.");for(const e of s){if("number"!=typeof e&&"string"!=typeof e)return c.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return c.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof e&&Math.floor(e)!==e)return c.error("Numeric branch labels must be integer values.");if(r){if(c.checkSubtype(r,jt(e)))return null}else r=jt(e);if(void 0!==i[String(e)])return c.error("Branch labels must be unique.");i[String(e)]=a.length}const u=t.parse(l,o,n);if(!u)return null;n=n||u.type,a.push(u)}const o=t.parse(e[1],1,je);if(!o)return null;const s=t.parse(e[e.length-1],e.length-1,n);return s?"value"!==o.type.kind&&t.concat(1).checkSubtype(r,o.type)?null:new rr(r,n,o,i,a,s):null}evaluate(e){const t=this.input.evaluate(e);return(jt(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class nr{constructor(e,t,r){this.type=e,this.branches=t,this.otherwise=r}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return t.error("Expected an odd number of arguments.");let r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);const n=[];for(let i=1;i<e.length-1;i+=2){const a=t.parse(e[i],i,Be);if(!a)return null;const o=t.parse(e[i+1],i+1,r);if(!o)return null;n.push([a,o]),r=r||o.type}const i=t.parse(e[e.length-1],e.length-1,r);if(!i)return null;if(!r)throw new Error("Can't infer output type");return new nr(r,n,i)}evaluate(e){for(const[t,r]of this.branches)if(t.evaluate(e))return r.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,r]of this.branches)e(t),e(r);e(this.otherwise)}outputDefined(){return this.branches.every(([e,t])=>t.outputDefined())&&this.otherwise.outputDefined()}}class ir{constructor(e,t,r,n){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,je),n=t.parse(e[2],2,Re);if(!r||!n)return null;if(!Je(r.type,[Xe(je),Fe,je]))return t.error(`Expected first argument to be of type array or string, but found ${Ye(r.type)} instead`);if(4===e.length){const i=t.parse(e[3],3,Re);return i?new ir(r.type,r,n,i):null}return new ir(r.type,r,n)}evaluate(e){const t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);let n;if(this.endIndex&&(n=this.endIndex.evaluate(e)),et(t,["string"]))return[...t].slice(r,n).join("");if(et(t,["array"]))return t.slice(r,n);throw new Lt(`Expected first argument to be of type array or string, but found ${Ye(jt(t))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function ar(e,t){const r=e.length-1;let n,i,a=0,o=r,s=0;for(;a<=o;)if(s=Math.floor((a+o)/2),n=e[s],i=e[s+1],n<=t){if(s===r||t<i)return s;a=s+1}else{if(!(n>t))throw new Lt("Input is not a number.");o=s-1}return 0}class or{constructor(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[e,t]of r)this.labels.push(e),this.outputs.push(t)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");const r=t.parse(e[1],1,Re);if(!r)return null;const n=[];let i=null;t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);for(let r=1;r<e.length;r+=2){const a=1===r?-1/0:e[r],o=e[r+1],s=r,l=r+1;if("number"!=typeof a)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',s);if(n.length&&n[n.length-1][0]>=a)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',s);const c=t.parse(o,l,i);if(!c)return null;i=i||c.type,n.push([a,c])}return new or(i,r,n)}evaluate(e){const t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);const i=t.length;return n>=t[i-1]?r[i-1].evaluate(e):r[ar(t,n)].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}var sr,lr,cr=function(){if(lr)return sr;function e(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=n}return lr=1,sr=e,e.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,n=0;n<8;n++){var i=this.sampleCurveX(r)-e;if(Math.abs(i)<t)return r;var a=this.sampleCurveDerivativeX(r);if(Math.abs(a)<1e-6)break;r-=i/a}var o=0,s=1;for(r=e,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-e)<t));n++)e>i?o=r:s=r,r=.5*(s-o)+o;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}},sr}(),ur=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(cr);class hr{constructor(e,t,r,n,i){this.type=e,this.operator=t,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(const[e,t]of i)this.labels.push(e),this.outputs.push(t)}static interpolationFactor(e,t,r,n){let i=0;if("exponential"===e.name)i=dr(t,e.base,r,n);else if("linear"===e.name)i=dr(t,1,r,n);else if("cubic-bezier"===e.name){const a=e.controlPoints;i=new ur(a[0],a[1],a[2],a[3]).solve(dr(t,1,r,n))}return i}static parse(e,t){let[r,n,i,...a]=e;if(!Array.isArray(n)||0===n.length)return t.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){const e=n[1];if("number"!=typeof e)return t.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:e}}else{if("cubic-bezier"!==n[0])return t.error(`Unknown interpolation type ${String(n[0])}`,1,0);{const e=n.slice(1);if(4!==e.length||e.some(e=>"number"!=typeof e||e<0||e>1))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:e}}}if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(i=t.parse(i,2,Re),!i)return null;const o=[];let s=null;"interpolate-hcl"!==r&&"interpolate-lab"!==r||t.expectedType==$e?t.expectedType&&"value"!==t.expectedType.kind&&(s=t.expectedType):s=Oe;for(let e=0;e<a.length;e+=2){const r=a[e],n=a[e+1],i=e+3,l=e+4;if("number"!=typeof r)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',i);if(o.length&&o[o.length-1][0]>=r)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',i);const c=t.parse(n,l,s);if(!c)return null;s=s||c.type,o.push([r,c])}return tt(s,Re)||tt(s,Ne)||tt(s,Oe)||tt(s,qe)||tt(s,Ze)||tt(s,$e)||tt(s,We)||tt(s,Xe(Re))?new hr(s,r,n,i,o):t.error(`Type ${Ye(s)} is not interpolatable.`)}evaluate(e){const t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);const i=t.length;if(n>=t[i-1])return r[i-1].evaluate(e);const a=ar(t,n),o=hr.interpolationFactor(this.interpolation,n,t[a],t[a+1]),s=r[a].evaluate(e),l=r[a+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return St(s,l,o);case"color":return Et.interpolate(s,l,o);case"padding":return At.interpolate(s,l,o);case"colorArray":return Dt.interpolate(s,l,o);case"numberArray":return zt.interpolate(s,l,o);case"variableAnchorOffsetCollection":return Ft.interpolate(s,l,o);case"array":return Pt(s,l,o);case"projectionDefinition":return Ot.interpolate(s,l,o)}case"interpolate-hcl":switch(this.type.kind){case"color":return Et.interpolate(s,l,o,"hcl");case"colorArray":return Dt.interpolate(s,l,o,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Et.interpolate(s,l,o,"lab");case"colorArray":return Dt.interpolate(s,l,o,"lab")}}}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function dr(e,t,r,n){const i=n-r,a=e-r;return 0===i?0:1===t?a/i:(Math.pow(t,a)-1)/(Math.pow(t,i)-1)}const pr={color:Et.interpolate,number:St,padding:At.interpolate,numberArray:zt.interpolate,colorArray:Dt.interpolate,variableAnchorOffsetCollection:Ft.interpolate,array:Pt};class fr{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=null;const n=t.expectedType;n&&"value"!==n.kind&&(r=n);const i=[];for(const n of e.slice(1)){const e=t.parse(n,1+i.length,r,void 0,{typeAnnotation:"omit"});if(!e)return null;r=r||e.type,i.push(e)}if(!r)throw new Error("No output type");const a=n&&i.some(e=>Qe(n,e.type));return new fr(a?je:r,i)}evaluate(e){let t,r=null,n=0;for(const i of this.args)if(n++,r=i.evaluate(e),r&&r instanceof Bt&&!r.available&&(t||(t=r.name),r=null,n===this.args.length&&(r=t)),null!==r)break;return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}function mr(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function gr(e,t,r,n){return 0===n.compare(t,r)}function _r(e,t,r){const n="=="!==e&&"!="!==e;return class i{constructor(e,t,r){this.type=Be,this.lhs=e,this.rhs=t,this.collator=r,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");const r=e[0];let a=t.parse(e[1],1,je);if(!a)return null;if(!mr(r,a.type))return t.concat(1).error(`"${r}" comparisons are not supported for type '${Ye(a.type)}'.`);let o=t.parse(e[2],2,je);if(!o)return null;if(!mr(r,o.type))return t.concat(2).error(`"${r}" comparisons are not supported for type '${Ye(o.type)}'.`);if(a.type.kind!==o.type.kind&&"value"!==a.type.kind&&"value"!==o.type.kind)return t.error(`Cannot compare types '${Ye(a.type)}' and '${Ye(o.type)}'.`);n&&("value"===a.type.kind&&"value"!==o.type.kind?a=new $t(o.type,[a]):"value"!==a.type.kind&&"value"===o.type.kind&&(o=new $t(a.type,[o])));let s=null;if(4===e.length){if("string"!==a.type.kind&&"string"!==o.type.kind&&"value"!==a.type.kind&&"value"!==o.type.kind)return t.error("Cannot use collator to compare non-string types.");if(s=t.parse(e[3],3,Ue),!s)return null}return new i(a,o,s)}evaluate(i){const a=this.lhs.evaluate(i),o=this.rhs.evaluate(i);if(n&&this.hasUntypedArgument){const t=jt(a),r=jt(o);if(t.kind!==r.kind||"string"!==t.kind&&"number"!==t.kind)throw new Lt(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${t.kind}, ${r.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){const e=jt(a),r=jt(o);if("string"!==e.kind||"string"!==r.kind)return t(i,a,o)}return this.collator?r(i,a,o,this.collator.evaluate(i)):t(i,a,o)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}}}const yr=_r("==",function(e,t,r){return t===r},gr),vr=_r("!=",function(e,t,r){return t!==r},function(e,t,r,n){return!gr(0,t,r,n)}),br=_r("<",function(e,t,r){return t<r},function(e,t,r,n){return n.compare(t,r)<0}),xr=_r(">",function(e,t,r){return t>r},function(e,t,r,n){return n.compare(t,r)>0}),wr=_r("<=",function(e,t,r){return t<=r},function(e,t,r,n){return n.compare(t,r)<=0}),Tr=_r(">=",function(e,t,r){return t>=r},function(e,t,r,n){return n.compare(t,r)>=0});class Sr{constructor(e,t,r){this.type=Ue,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");const r=e[1];if("object"!=typeof r||Array.isArray(r))return t.error("Collator options argument must be an object.");const n=t.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,Be);if(!n)return null;const i=t.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,Be);if(!i)return null;let a=null;return r.locale&&(a=t.parse(r.locale,1,Fe),!a)?null:new Sr(n,i,a)}evaluate(e){return new Ct(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Pr{constructor(e,t,r,n,i){this.type=Fe,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=n,this.maxFractionDigits=i}static parse(e,t){if(3!==e.length)return t.error("Expected two arguments.");const r=t.parse(e[1],1,Re);if(!r)return null;const n=e[2];if("object"!=typeof n||Array.isArray(n))return t.error("NumberFormat options argument must be an object.");let i=null;if(n.locale&&(i=t.parse(n.locale,1,Fe),!i))return null;let a=null;if(n.currency&&(a=t.parse(n.currency,1,Fe),!a))return null;let o=null;if(n["min-fraction-digits"]&&(o=t.parse(n["min-fraction-digits"],1,Re),!o))return null;let s=null;return n["max-fraction-digits"]&&(s=t.parse(n["max-fraction-digits"],1,Re),!s)?null:new Pr(r,i,a,o,s)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Er{constructor(e){this.type=Ge,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const r=e[1];if(!Array.isArray(r)&&"object"==typeof r)return t.error("First argument must be an image or text section.");const n=[];let i=!1;for(let r=1;r<=e.length-1;++r){const a=e[r];if(i&&"object"==typeof a&&!Array.isArray(a)){i=!1;let e=null;if(a["font-scale"]&&(e=t.parse(a["font-scale"],1,Re),!e))return null;let r=null;if(a["text-font"]&&(r=t.parse(a["text-font"],1,Xe(Fe)),!r))return null;let o=null;if(a["text-color"]&&(o=t.parse(a["text-color"],1,Oe),!o))return null;let s=null;if(a["vertical-align"]){if("string"==typeof a["vertical-align"]&&!Mt.includes(a["vertical-align"]))return t.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${a["vertical-align"]}' instead.`);if(s=t.parse(a["vertical-align"],1,Fe),!s)return null}const l=n[n.length-1];l.scale=e,l.font=r,l.textColor=o,l.verticalAlign=s}else{const a=t.parse(e[r],1,je);if(!a)return null;const o=a.type.kind;if("string"!==o&&"value"!==o&&"null"!==o&&"resolvedImage"!==o)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,n.push({content:a,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Er(n)}evaluate(e){return new It(this.sections.map(t=>{const r=t.content.evaluate(e);return jt(r)===He?new kt("",r,null,null,null,t.verticalAlign?t.verticalAlign.evaluate(e):null):new kt(Ut(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null,t.verticalAlign?t.verticalAlign.evaluate(e):null)}))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor),t.verticalAlign&&e(t.verticalAlign)}outputDefined(){return!1}}class Cr{constructor(e){this.type=He,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected two arguments.");const r=t.parse(e[1],1,Fe);return r?new Cr(r):t.error("No image name provided.")}evaluate(e){const t=this.input.evaluate(e),r=Bt.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r}eachChild(e){e(this.input)}outputDefined(){return!1}}class Mr{constructor(e){this.type=Re,this.input=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const r=t.parse(e[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?t.error(`Expected argument of type string or array, but found ${Ye(r.type)} instead.`):new Mr(r):null}evaluate(e){const t=this.input.evaluate(e);if("string"==typeof t)return[...t].length;if(Array.isArray(t))return t.length;throw new Lt(`Expected value to be of type string or array, but found ${Ye(jt(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const kr=8192;function Ir(e,t){const r=(180+e[0])/360,n=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,i=Math.pow(2,t.z);return[Math.round(r*i*kr),Math.round(n*i*kr)]}function Ar(e,t){const r=Math.pow(2,t.z);return[(i=(e[0]/kr+t.x)/r,360*i-180),(n=(e[1]/kr+t.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90)];var n,i}function zr(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Dr(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function Lr(e,t,r){const n=e[0]-t[0],i=e[1]-t[1],a=e[0]-r[0],o=e[1]-r[1];return n*o-a*i==0&&n*a<=0&&i*o<=0}function Rr(e,t,r,n){return 0!=(i=[n[0]-r[0],n[1]-r[1]])[0]*(a=[t[0]-e[0],t[1]-e[1]])[1]-i[1]*a[0]&&!(!jr(e,t,r,n)||!jr(r,n,e,t));var i,a}function Fr(e,t,r){for(const n of r)for(let r=0;r<n.length-1;++r)if(Rr(e,t,n[r],n[r+1]))return!0;return!1}function Br(e,t,r=!1){let n=!1;for(const s of t)for(let t=0;t<s.length-1;t++){if(Lr(e,s[t],s[t+1]))return r;(a=s[t])[1]>(i=e)[1]!=(o=s[t+1])[1]>i[1]&&i[0]<(o[0]-a[0])*(i[1]-a[1])/(o[1]-a[1])+a[0]&&(n=!n)}var i,a,o;return n}function Or(e,t){for(const r of t)if(Br(e,r))return!0;return!1}function Nr(e,t){for(const r of e)if(!Br(r,t))return!1;for(let r=0;r<e.length-1;++r)if(Fr(e[r],e[r+1],t))return!1;return!0}function Vr(e,t){for(const r of t)if(Nr(e,r))return!0;return!1}function jr(e,t,r,n){const i=n[0]-r[0],a=n[1]-r[1],o=(e[0]-r[0])*a-i*(e[1]-r[1]),s=(t[0]-r[0])*a-i*(t[1]-r[1]);return o>0&&s<0||o<0&&s>0}function Ur(e,t,r){const n=[];for(let i=0;i<e.length;i++){const a=[];for(let n=0;n<e[i].length;n++){const o=Ir(e[i][n],r);zr(t,o),a.push(o)}n.push(a)}return n}function Gr(e,t,r){const n=[];for(let i=0;i<e.length;i++){const a=Ur(e[i],t,r);n.push(a)}return n}function qr(e,t,r,n){if(e[0]<r[0]||e[0]>r[2]){const t=.5*n;let i=e[0]-r[0]>t?-n:r[0]-e[0]>t?n:0;0===i&&(i=e[0]-r[2]>t?-n:r[2]-e[0]>t?n:0),e[0]+=i}zr(t,e)}function $r(e,t,r,n){const i=Math.pow(2,n.z)*kr,a=[n.x*kr,n.y*kr],o=[];for(const n of e)for(const e of n){const n=[e.x+a[0],e.y+a[1]];qr(n,t,r,i),o.push(n)}return o}function Zr(e,t,r,n){const i=Math.pow(2,n.z)*kr,a=[n.x*kr,n.y*kr],o=[];for(const r of e){const e=[];for(const n of r){const r=[n.x+a[0],n.y+a[1]];zr(t,r),e.push(r)}o.push(e)}if(t[2]-t[0]<=i/2){(s=t)[0]=s[1]=1/0,s[2]=s[3]=-1/0;for(const e of o)for(const n of e)qr(n,t,r,i)}var s;return o}class Hr{constructor(e,t){this.type=Be,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Vt(e[1])){const t=e[1];if("FeatureCollection"===t.type){const e=[];for(const r of t.features){const{type:t,coordinates:n}=r.geometry;"Polygon"===t&&e.push(n),"MultiPolygon"===t&&e.push(...n)}if(e.length)return new Hr(t,{type:"MultiPolygon",coordinates:e})}else if("Feature"===t.type){const e=t.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new Hr(t,t.geometry)}else if("Polygon"===t.type||"MultiPolygon"===t.type)return new Hr(t,t)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if("Polygon"===t.type){const a=Ur(t.coordinates,n,i),o=$r(e.geometry(),r,n,i);if(!Dr(r,n))return!1;for(const e of o)if(!Br(e,a))return!1}if("MultiPolygon"===t.type){const a=Gr(t.coordinates,n,i),o=$r(e.geometry(),r,n,i);if(!Dr(r,n))return!1;for(const e of o)if(!Or(e,a))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if("Polygon"===t.type){const a=Ur(t.coordinates,n,i),o=Zr(e.geometry(),r,n,i);if(!Dr(r,n))return!1;for(const e of o)if(!Nr(e,a))return!1}if("MultiPolygon"===t.type){const a=Gr(t.coordinates,n,i),o=Zr(e.geometry(),r,n,i);if(!Dr(r,n))return!1;for(const e of o)if(!Vr(e,a))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Wr=class{constructor(e=[],t=(e,t)=>e<t?-1:e>t?1:0){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let e=(this.length>>1)-1;e>=0;e--)this._down(e)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:r}=this,n=t[e];for(;e>0;){const i=e-1>>1,a=t[i];if(r(n,a)>=0)break;t[e]=a,e=i}t[e]=n}_down(e){const{data:t,compare:r}=this,n=this.length>>1,i=t[e];for(;e<n;){let n=1+(e<<1);const a=n+1;if(a<this.length&&r(t[a],t[n])<0&&(n=a),r(t[n],i)>=0)break;t[e]=t[n],e=n}t[e]=i}};function Xr(e,t,r=0,n=e.length-1,i=Kr){for(;n>r;){if(n-r>600){const a=n-r+1,o=t-r+1,s=Math.log(a),l=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*l*(a-l)/a)*(o-a/2<0?-1:1);Xr(e,t,Math.max(r,Math.floor(t-o*l/a+c)),Math.min(n,Math.floor(t+(a-o)*l/a+c)),i)}const a=e[t];let o=r,s=n;for(Yr(e,r,t),i(e[n],a)>0&&Yr(e,r,n);o<s;){for(Yr(e,o,s),o++,s--;i(e[o],a)<0;)o++;for(;i(e[s],a)>0;)s--}0===i(e[r],a)?Yr(e,r,s):(s++,Yr(e,s,n)),s<=t&&(r=s+1),t<=s&&(n=s-1)}}function Yr(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function Kr(e,t){return e<t?-1:e>t?1:0}function Qr(e,t){if(e.length<=1)return[e];const r=[];let n,i;for(const t of e){const e=en(t);0!==e&&(t.area=Math.abs(e),void 0===i&&(i=e<0),i===e<0?(n&&r.push(n),n=[t]):n.push(t))}if(n&&r.push(n),t>1)for(let e=0;e<r.length;e++)r[e].length<=t||(Xr(r[e],t,1,r[e].length-1,Jr),r[e]=r[e].slice(0,t));return r}function Jr(e,t){return t.area-e.area}function en(e){let t=0;for(let r,n,i=0,a=e.length,o=a-1;i<a;o=i++)r=e[i],n=e[o],t+=(n.x-r.x)*(r.y+n.y);return t}const tn=1/298.257223563,rn=tn*(2-tn),nn=Math.PI/180;class an{constructor(e){const t=6378.137*nn*1e3,r=Math.cos(e*nn),n=1/(1-rn*(1-r*r)),i=Math.sqrt(n);this.kx=t*i*r,this.ky=t*i*n*(1-rn)}distance(e,t){const r=this.wrap(e[0]-t[0])*this.kx,n=(e[1]-t[1])*this.ky;return Math.sqrt(r*r+n*n)}pointOnLine(e,t){let r,n,i,a,o=1/0;for(let s=0;s<e.length-1;s++){let l=e[s][0],c=e[s][1],u=this.wrap(e[s+1][0]-l)*this.kx,h=(e[s+1][1]-c)*this.ky,d=0;0===u&&0===h||(d=(this.wrap(t[0]-l)*this.kx*u+(t[1]-c)*this.ky*h)/(u*u+h*h),d>1?(l=e[s+1][0],c=e[s+1][1]):d>0&&(l+=u/this.kx*d,c+=h/this.ky*d)),u=this.wrap(t[0]-l)*this.kx,h=(t[1]-c)*this.ky;const p=u*u+h*h;p<o&&(o=p,r=l,n=c,i=s,a=d)}return{point:[r,n],index:i,t:Math.max(0,Math.min(1,a))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function on(e,t){return t[0]-e[0]}function sn(e){return e[1]-e[0]+1}function ln(e,t){return e[1]>=e[0]&&e[1]<t}function cn(e,t){if(e[0]>e[1])return[null,null];const r=sn(e);if(t){if(2===r)return[e,null];const t=Math.floor(r/2);return[[e[0],e[0]+t],[e[0]+t,e[1]]]}if(1===r)return[e,null];const n=Math.floor(r/2)-1;return[[e[0],e[0]+n],[e[0]+n+1,e[1]]]}function un(e,t){if(!ln(t,e.length))return[1/0,1/0,-1/0,-1/0];const r=[1/0,1/0,-1/0,-1/0];for(let n=t[0];n<=t[1];++n)zr(r,e[n]);return r}function hn(e){const t=[1/0,1/0,-1/0,-1/0];for(const r of e)for(const e of r)zr(t,e);return t}function dn(e){return e[0]!==-1/0&&e[1]!==-1/0&&e[2]!==1/0&&e[3]!==1/0}function pn(e,t,r){if(!dn(e)||!dn(t))return NaN;let n=0,i=0;return e[2]<t[0]&&(n=t[0]-e[2]),e[0]>t[2]&&(n=e[0]-t[2]),e[1]>t[3]&&(i=e[1]-t[3]),e[3]<t[1]&&(i=t[1]-e[3]),r.distance([0,0],[n,i])}function fn(e,t,r){const n=r.pointOnLine(t,e);return r.distance(e,n.point)}function mn(e,t,r,n,i){const a=Math.min(fn(e,[r,n],i),fn(t,[r,n],i)),o=Math.min(fn(r,[e,t],i),fn(n,[e,t],i));return Math.min(a,o)}function gn(e,t,r,n,i){if(!ln(t,e.length)||!ln(n,r.length))return 1/0;let a=1/0;for(let o=t[0];o<t[1];++o){const t=e[o],s=e[o+1];for(let e=n[0];e<n[1];++e){const n=r[e],o=r[e+1];if(Rr(t,s,n,o))return 0;a=Math.min(a,mn(t,s,n,o,i))}}return a}function _n(e,t,r,n,i){if(!ln(t,e.length)||!ln(n,r.length))return NaN;let a=1/0;for(let o=t[0];o<=t[1];++o)for(let t=n[0];t<=n[1];++t)if(a=Math.min(a,i.distance(e[o],r[t])),0===a)return a;return a}function yn(e,t,r){if(Br(e,t,!0))return 0;let n=1/0;for(const i of t){const t=i[0],a=i[i.length-1];if(t!==a&&(n=Math.min(n,fn(e,[a,t],r)),0===n))return n;const o=r.pointOnLine(i,e);if(n=Math.min(n,r.distance(e,o.point)),0===n)return n}return n}function vn(e,t,r,n){if(!ln(t,e.length))return NaN;for(let n=t[0];n<=t[1];++n)if(Br(e[n],r,!0))return 0;let i=1/0;for(let a=t[0];a<t[1];++a){const t=e[a],o=e[a+1];for(const e of r)for(let r=0,a=e.length,s=a-1;r<a;s=r++){const a=e[s],l=e[r];if(Rr(t,o,a,l))return 0;i=Math.min(i,mn(t,o,a,l,n))}}return i}function bn(e,t){for(const r of e)for(const e of r)if(Br(e,t,!0))return!0;return!1}function xn(e,t,r,n=1/0){const i=hn(e),a=hn(t);if(n!==1/0&&pn(i,a,r)>=n)return n;if(Dr(i,a)){if(bn(e,t))return 0}else if(bn(t,e))return 0;let o=1/0;for(const n of e)for(let e=0,i=n.length,a=i-1;e<i;a=e++){const i=n[a],s=n[e];for(const e of t)for(let t=0,n=e.length,a=n-1;t<n;a=t++){const n=e[a],l=e[t];if(Rr(i,s,n,l))return 0;o=Math.min(o,mn(i,s,n,l,r))}}return o}function wn(e,t,r,n,i,a){if(!a)return;const o=pn(un(n,a),i,r);o<t&&e.push([o,a,[0,0]])}function Tn(e,t,r,n,i,a,o){if(!a||!o)return;const s=pn(un(n,a),un(i,o),r);s<t&&e.push([s,a,o])}function Sn(e,t,r,n,i=1/0){let a=Math.min(n.distance(e[0],r[0][0]),i);if(0===a)return a;const o=new Wr([[0,[0,e.length-1],[0,0]]],on),s=hn(r);for(;o.length>0;){const i=o.pop();if(i[0]>=a)continue;const l=i[1],c=t?50:100;if(sn(l)<=c){if(!ln(l,e.length))return NaN;if(t){const t=vn(e,l,r,n);if(isNaN(t)||0===t)return t;a=Math.min(a,t)}else for(let t=l[0];t<=l[1];++t){const i=yn(e[t],r,n);if(a=Math.min(a,i),0===a)return 0}}else{const r=cn(l,t);wn(o,a,n,e,s,r[0]),wn(o,a,n,e,s,r[1])}}return a}function Pn(e,t,r,n,i,a=1/0){let o=Math.min(a,i.distance(e[0],r[0]));if(0===o)return o;const s=new Wr([[0,[0,e.length-1],[0,r.length-1]]],on);for(;s.length>0;){const a=s.pop();if(a[0]>=o)continue;const l=a[1],c=a[2],u=t?50:100,h=n?50:100;if(sn(l)<=u&&sn(c)<=h){if(!ln(l,e.length)&&ln(c,r.length))return NaN;let a;if(t&&n)a=gn(e,l,r,c,i),o=Math.min(o,a);else if(t&&!n){const t=e.slice(l[0],l[1]+1);for(let e=c[0];e<=c[1];++e)if(a=fn(r[e],t,i),o=Math.min(o,a),0===o)return o}else if(!t&&n){const t=r.slice(c[0],c[1]+1);for(let r=l[0];r<=l[1];++r)if(a=fn(e[r],t,i),o=Math.min(o,a),0===o)return o}else a=_n(e,l,r,c,i),o=Math.min(o,a)}else{const a=cn(l,t),u=cn(c,n);Tn(s,o,i,e,r,a[0],u[0]),Tn(s,o,i,e,r,a[0],u[1]),Tn(s,o,i,e,r,a[1],u[0]),Tn(s,o,i,e,r,a[1],u[1])}}return o}function En(e){return"MultiPolygon"===e.type?e.coordinates.map(e=>({type:"Polygon",coordinates:e})):"MultiLineString"===e.type?e.coordinates.map(e=>({type:"LineString",coordinates:e})):"MultiPoint"===e.type?e.coordinates.map(e=>({type:"Point",coordinates:e})):[e]}class Cn{constructor(e,t){this.type=Re,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Vt(e[1])){const t=e[1];if("FeatureCollection"===t.type)return new Cn(t,t.features.map(e=>En(e.geometry)).flat());if("Feature"===t.type)return new Cn(t,En(t.geometry));if("type"in t&&"coordinates"in t)return new Cn(t,En(t))}return t.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const r=e.geometry(),n=r.flat().map(t=>Ar([t.x,t.y],e.canonical));if(0===r.length)return NaN;const i=new an(n[0][1]);let a=1/0;for(const e of t){switch(e.type){case"Point":a=Math.min(a,Pn(n,!1,[e.coordinates],!1,i,a));break;case"LineString":a=Math.min(a,Pn(n,!1,e.coordinates,!0,i,a));break;case"Polygon":a=Math.min(a,Sn(n,!1,e.coordinates,i,a))}if(0===a)return a}return a}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const r=e.geometry(),n=r.flat().map(t=>Ar([t.x,t.y],e.canonical));if(0===r.length)return NaN;const i=new an(n[0][1]);let a=1/0;for(const e of t){switch(e.type){case"Point":a=Math.min(a,Pn(n,!0,[e.coordinates],!1,i,a));break;case"LineString":a=Math.min(a,Pn(n,!0,e.coordinates,!0,i,a));break;case"Polygon":a=Math.min(a,Sn(n,!0,e.coordinates,i,a))}if(0===a)return a}return a}(e,this.geometries);if("Polygon"===e.geometryType())return function(e,t){const r=e.geometry();if(0===r.length||0===r[0].length)return NaN;const n=Qr(r,0).map(t=>t.map(t=>t.map(t=>Ar([t.x,t.y],e.canonical)))),i=new an(n[0][0][0][1]);let a=1/0;for(const e of t)for(const t of n){switch(e.type){case"Point":a=Math.min(a,Sn([e.coordinates],!1,t,i,a));break;case"LineString":a=Math.min(a,Sn(e.coordinates,!0,t,i,a));break;case"Polygon":a=Math.min(a,xn(t,e.coordinates,i,a))}if(0===a)return a}return a}(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Mn{constructor(e){this.type=je,this.key=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const r=e[1];return null==r?t.error("Global state property must be defined."):"string"!=typeof r?t.error(`Global state property must be string, but found ${typeof e[1]} instead.`):new Mn(r)}evaluate(e){var t;const r=null===(t=e.globals)||void 0===t?void 0:t.globalState;return r&&0!==Object.keys(r).length?yt(r,this.key):null}eachChild(){}outputDefined(){return!1}}const kn={"==":yr,"!=":vr,">":xr,"<":br,">=":Tr,"<=":wr,array:$t,at:Jt,boolean:$t,case:nr,coalesce:fr,collator:Sr,format:Er,image:Cr,in:er,"index-of":tr,interpolate:hr,"interpolate-hcl":hr,"interpolate-lab":hr,length:Mr,let:Kt,literal:Gt,match:rr,number:$t,"number-format":Pr,object:$t,slice:ir,step:or,string:$t,"to-boolean":Ht,"to-color":Ht,"to-number":Ht,"to-string":Ht,var:Qt,within:Hr,distance:Cn,"global-state":Mn};class In{constructor(e,t,r,n){this.name=e,this.type=t,this._evaluate=r,this.args=n}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){const r=e[0],n=In.definitions[r];if(!n)return t.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);const i=Array.isArray(n)?n[0]:n.type,a=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,o=a.filter(([t])=>!Array.isArray(t)||t.length===e.length-1);let s=null;for(const[n,a]of o){s=new Yt(t.registry,Rn,t.path,null,t.scope);const o=[];let l=!1;for(let t=1;t<e.length;t++){const r=e[t],i=Array.isArray(n)?n[t-1]:n.type,a=s.parse(r,1+o.length,i);if(!a){l=!0;break}o.push(a)}if(!l)if(Array.isArray(n)&&n.length!==o.length)s.error(`Expected ${n.length} arguments, but found ${o.length} instead.`);else{for(let e=0;e<o.length;e++){const t=Array.isArray(n)?n[e]:n.type,r=o[e];s.concat(e+1).checkSubtype(t,r.type)}if(0===s.errors.length)return new In(r,i,a,o)}}if(1===o.length)t.errors.push(...s.errors);else{const r=(o.length?o:a).map(([e])=>{return t=e,Array.isArray(t)?`(${t.map(Ye).join(", ")})`:`(${Ye(t.type)}...)`;var t}).join(" | "),n=[];for(let r=1;r<e.length;r++){const i=t.parse(e[r],1+n.length);if(!i)return null;n.push(Ye(i.type))}t.error(`Expected arguments of type ${r}, but found (${n.join(", ")}) instead.`)}return null}static register(e,t){In.definitions=t;for(const r in t)e[r]=In}}function An(e,[t,r,n,i]){t=t.evaluate(e),r=r.evaluate(e),n=n.evaluate(e);const a=i?i.evaluate(e):1,o=Nt(t,r,n,a);if(o)throw new Lt(o);return new Et(t/255,r/255,n/255,a,!1)}function zn(e,t){return e in t}function Dn(e,t){const r=t[e];return void 0===r?null:r}function Ln(e){return{type:e}}function Rn(e){if(e instanceof Qt)return Rn(e.boundExpression);if(e instanceof In&&"error"===e.name)return!1;if(e instanceof Sr)return!1;if(e instanceof Hr)return!1;if(e instanceof Cn)return!1;if(e instanceof Mn)return!1;const t=e instanceof Ht||e instanceof $t;let r=!0;return e.eachChild(e=>{r=t?r&&Rn(e):r&&e instanceof Gt}),!!r&&Fn(e)&&On(e,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Fn(e){if(e instanceof In){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof Hr)return!1;if(e instanceof Cn)return!1;let t=!0;return e.eachChild(e=>{t&&!Fn(e)&&(t=!1)}),t}function Bn(e){if(e instanceof In&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild(e=>{t&&!Bn(e)&&(t=!1)}),t}function On(e,t){if(e instanceof In&&t.indexOf(e.name)>=0)return!1;let r=!0;return e.eachChild(e=>{r&&!On(e,t)&&(r=!1)}),r}function Nn(e){return{result:"success",value:e}}function Vn(e){return{result:"error",value:e}}function jn(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function Un(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Gn(e){return!!e.expression&&e.expression.interpolated}function qn(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function $n(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)&&jt(e)===Ve}function Zn(e){return e}function Hn(e,t){const r=e.stops&&"object"==typeof e.stops[0][0],n=r||!(r||void 0!==e.property),i=e.type||(Gn(t)?"exponential":"interval"),a=function(e){switch(e.type){case"color":return Et.parse;case"padding":return At.parse;case"numberArray":return zt.parse;case"colorArray":return Dt.parse;default:return null}}(t);if(a&&((e=Ae({},e)).stops&&(e.stops=e.stops.map(e=>[e[0],a(e[1])])),e.default=a(e.default?e.default:t.default)),e.colorSpace&&"rgb"!==(o=e.colorSpace)&&"hcl"!==o&&"lab"!==o)throw new Error(`Unknown color space: "${e.colorSpace}"`);var o;const s=function(e){switch(e){case"exponential":return Kn;case"interval":return Yn;case"categorical":return Xn;case"identity":return Qn;default:throw new Error(`Unknown function type "${e}"`)}}(i);let l,c;if("categorical"===i){l=Object.create(null);for(const t of e.stops)l[t[0]]=t[1];c=typeof e.stops[0][0]}if(r){const r={},n=[];for(let t=0;t<e.stops.length;t++){const i=e.stops[t],a=i[0].zoom;void 0===r[a]&&(r[a]={zoom:a,type:e.type,property:e.property,default:e.default,stops:[]},n.push(a)),r[a].stops.push([i[0].value,i[1]])}const i=[];for(const e of n)i.push([r[e].zoom,Hn(r[e],t)]);const a={name:"linear"};return{kind:"composite",interpolationType:a,interpolationFactor:hr.interpolationFactor.bind(void 0,a),zoomStops:i.map(e=>e[0]),evaluate:({zoom:r},n)=>Kn({stops:i,base:e.base},t,r).evaluate(r,n)}}if(n){const r="exponential"===i?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:r,interpolationFactor:hr.interpolationFactor.bind(void 0,r),zoomStops:e.stops.map(e=>e[0]),evaluate:({zoom:r})=>s(e,t,r,l,c)}}return{kind:"source",evaluate(r,n){const i=n&&n.properties?n.properties[e.property]:void 0;return void 0===i?Wn(e.default,t.default):s(e,t,i,l,c)}}}function Wn(e,t,r){return void 0!==e?e:void 0!==t?t:void 0!==r?r:void 0}function Xn(e,t,r,n,i){return Wn(typeof r===i?n[r]:void 0,e.default,t.default)}function Yn(e,t,r){if("number"!==qn(r))return Wn(e.default,t.default);const n=e.stops.length;if(1===n)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[n-1][0])return e.stops[n-1][1];const i=ar(e.stops.map(e=>e[0]),r);return e.stops[i][1]}function Kn(e,t,r){const n=void 0!==e.base?e.base:1;if("number"!==qn(r))return Wn(e.default,t.default);const i=e.stops.length;if(1===i)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[i-1][0])return e.stops[i-1][1];const a=ar(e.stops.map(e=>e[0]),r),o=function(e,t,r,n){const i=n-r,a=e-r;return 0===i?0:1===t?a/i:(Math.pow(t,a)-1)/(Math.pow(t,i)-1)}(r,n,e.stops[a][0],e.stops[a+1][0]),s=e.stops[a][1],l=e.stops[a+1][1],c=pr[t.type]||Zn;return"function"==typeof s.evaluate?{evaluate(...t){const r=s.evaluate.apply(void 0,t),n=l.evaluate.apply(void 0,t);if(void 0!==r&&void 0!==n)return c(r,n,o,e.colorSpace)}}:c(s,l,o,e.colorSpace)}function Qn(e,t,r){switch(t.type){case"color":r=Et.parse(r);break;case"formatted":r=It.fromString(r.toString());break;case"resolvedImage":r=Bt.fromString(r.toString());break;case"padding":r=At.parse(r);break;case"colorArray":r=Dt.parse(r);break;case"numberArray":r=zt.parse(r);break;default:qn(r)===t.type||"enum"===t.type&&t.values[r]||(r=void 0)}return Wn(r,e.default,t.default)}In.register(kn,{error:[{kind:"error"},[Fe],(e,[t])=>{throw new Lt(t.evaluate(e))}],typeof:[Fe,[je],(e,[t])=>Ye(jt(t.evaluate(e)))],"to-rgba":[Xe(Re,4),[Oe],(e,[t])=>{const[r,n,i,a]=t.evaluate(e).rgb;return[255*r,255*n,255*i,a]}],rgb:[Oe,[Re,Re,Re],An],rgba:[Oe,[Re,Re,Re,Re],An],has:{type:Be,overloads:[[[Fe],(e,[t])=>zn(t.evaluate(e),e.properties())],[[Fe,Ve],(e,[t,r])=>zn(t.evaluate(e),r.evaluate(e))]]},get:{type:je,overloads:[[[Fe],(e,[t])=>Dn(t.evaluate(e),e.properties())],[[Fe,Ve],(e,[t,r])=>Dn(t.evaluate(e),r.evaluate(e))]]},"feature-state":[je,[Fe],(e,[t])=>Dn(t.evaluate(e),e.featureState||{})],properties:[Ve,[],e=>e.properties()],"geometry-type":[Fe,[],e=>e.geometryType()],id:[je,[],e=>e.id()],zoom:[Re,[],e=>e.globals.zoom],"heatmap-density":[Re,[],e=>e.globals.heatmapDensity||0],elevation:[Re,[],e=>e.globals.elevation||0],"line-progress":[Re,[],e=>e.globals.lineProgress||0],accumulated:[je,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[Re,Ln(Re),(e,t)=>{let r=0;for(const n of t)r+=n.evaluate(e);return r}],"*":[Re,Ln(Re),(e,t)=>{let r=1;for(const n of t)r*=n.evaluate(e);return r}],"-":{type:Re,overloads:[[[Re,Re],(e,[t,r])=>t.evaluate(e)-r.evaluate(e)],[[Re],(e,[t])=>-t.evaluate(e)]]},"/":[Re,[Re,Re],(e,[t,r])=>t.evaluate(e)/r.evaluate(e)],"%":[Re,[Re,Re],(e,[t,r])=>t.evaluate(e)%r.evaluate(e)],ln2:[Re,[],()=>Math.LN2],pi:[Re,[],()=>Math.PI],e:[Re,[],()=>Math.E],"^":[Re,[Re,Re],(e,[t,r])=>Math.pow(t.evaluate(e),r.evaluate(e))],sqrt:[Re,[Re],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[Re,[Re],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[Re,[Re],(e,[t])=>Math.log(t.evaluate(e))],log2:[Re,[Re],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[Re,[Re],(e,[t])=>Math.sin(t.evaluate(e))],cos:[Re,[Re],(e,[t])=>Math.cos(t.evaluate(e))],tan:[Re,[Re],(e,[t])=>Math.tan(t.evaluate(e))],asin:[Re,[Re],(e,[t])=>Math.asin(t.evaluate(e))],acos:[Re,[Re],(e,[t])=>Math.acos(t.evaluate(e))],atan:[Re,[Re],(e,[t])=>Math.atan(t.evaluate(e))],min:[Re,Ln(Re),(e,t)=>Math.min(...t.map(t=>t.evaluate(e)))],max:[Re,Ln(Re),(e,t)=>Math.max(...t.map(t=>t.evaluate(e)))],abs:[Re,[Re],(e,[t])=>Math.abs(t.evaluate(e))],round:[Re,[Re],(e,[t])=>{const r=t.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[Re,[Re],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[Re,[Re],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[Be,[Fe,je],(e,[t,r])=>e.properties()[t.value]===r.value],"filter-id-==":[Be,[je],(e,[t])=>e.id()===t.value],"filter-type-==":[Be,[Fe],(e,[t])=>e.geometryType()===t.value],"filter-<":[Be,[Fe,je],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n<i}],"filter-id-<":[Be,[je],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r<n}],"filter->":[Be,[Fe,je],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n>i}],"filter-id->":[Be,[je],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r>n}],"filter-<=":[Be,[Fe,je],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n<=i}],"filter-id-<=":[Be,[je],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r<=n}],"filter->=":[Be,[Fe,je],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n>=i}],"filter-id->=":[Be,[je],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r>=n}],"filter-has":[Be,[je],(e,[t])=>t.value in e.properties()],"filter-has-id":[Be,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[Be,[Xe(Fe)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[Be,[Xe(je)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[Be,[Fe,Xe(je)],(e,[t,r])=>r.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[Be,[Fe,Xe(je)],(e,[t,r])=>function(e,t,r,n){for(;r<=n;){const i=r+n>>1;if(t[i]===e)return!0;t[i]>e?n=i-1:r=i+1}return!1}(e.properties()[t.value],r.value,0,r.value.length-1)],all:{type:Be,overloads:[[[Be,Be],(e,[t,r])=>t.evaluate(e)&&r.evaluate(e)],[Ln(Be),(e,t)=>{for(const r of t)if(!r.evaluate(e))return!1;return!0}]]},any:{type:Be,overloads:[[[Be,Be],(e,[t,r])=>t.evaluate(e)||r.evaluate(e)],[Ln(Be),(e,t)=>{for(const r of t)if(r.evaluate(e))return!0;return!1}]]},"!":[Be,[Be],(e,[t])=>!t.evaluate(e)],"is-supported-script":[Be,[Fe],(e,[t])=>{const r=e.globals&&e.globals.isSupportedScript;return!r||r(t.evaluate(e))}],upcase:[Fe,[Fe],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[Fe,[Fe],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[Fe,Ln(je),(e,t)=>t.map(t=>Ut(t.evaluate(e))).join("")],"resolved-locale":[Fe,[Ue],(e,[t])=>t.evaluate(e).resolvedLocale()]});class Jn{constructor(e,t,r){this.expression=e,this._warningHistory={},this._evaluator=new Xt,this._defaultValue=t?function(e){if("color"===e.type&&$n(e.default))return new Et(0,0,0,0);switch(e.type){case"color":return Et.parse(e.default)||null;case"padding":return At.parse(e.default)||null;case"numberArray":return zt.parse(e.default)||null;case"colorArray":return Dt.parse(e.default)||null;case"variableAnchorOffsetCollection":return Ft.parse(e.default)||null;case"projectionDefinition":return Ot.parse(e.default)||null;default:return void 0===e.default?null:e.default}}(t):null,this._enumValues=t&&"enum"===t.type?t.values:null,this._globalState=r}evaluateWithoutErrorHandling(e,t,r,n,i,a){return this._globalState&&(e=li(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)}evaluate(e,t,r,n,i,a){this._globalState&&(e=li(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=a||null;try{const e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new Lt(`Expected value to be one of ${Object.keys(this._enumValues).map(e=>JSON.stringify(e)).join(", ")}, but found ${JSON.stringify(e)} instead.`);return e}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}function ei(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in kn}function ti(e,t,r){const n=new Yt(kn,Rn,[],t?function(e){const t={color:Oe,string:Fe,number:Re,enum:Fe,boolean:Be,formatted:Ge,padding:qe,numberArray:Ze,colorArray:$e,projectionDefinition:Ne,resolvedImage:He,variableAnchorOffsetCollection:We};return"array"===e.type?Xe(t[e.value]||je,e.length):t[e.type]}(t):void 0),i=n.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return i?Nn(new Jn(i,t,r)):Vn(n.errors)}class ri{constructor(e,t,r){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!Bn(t.expression),this.globalStateRefs=si(t.expression),this._globalState=r}evaluateWithoutErrorHandling(e,t,r,n,i,a){return this._globalState&&(e=li(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,a)}evaluate(e,t,r,n,i,a){return this._globalState&&(e=li(e,this._globalState)),this._styleExpression.evaluate(e,t,r,n,i,a)}}class ni{constructor(e,t,r,n,i){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!Bn(t.expression),this.globalStateRefs=si(t.expression),this.interpolationType=n,this._globalState=i}evaluateWithoutErrorHandling(e,t,r,n,i,a){return this._globalState&&(e=li(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,a)}evaluate(e,t,r,n,i,a){return this._globalState&&(e=li(e,this._globalState)),this._styleExpression.evaluate(e,t,r,n,i,a)}interpolationFactor(e,t,r){return this.interpolationType?hr.interpolationFactor(this.interpolationType,e,t,r):0}}function ii(e,t,r){const n=ti(e,t,r);if("error"===n.result)return n;const i=n.value.expression,a=Fn(i);if(!a&&!jn(t))return Vn([new ze("","data expressions not supported")]);const o=On(i,["zoom"]);if(!o&&!Un(t))return Vn([new ze("","zoom expressions not supported")]);const s=oi(i);return s||o?s instanceof ze?Vn([s]):s instanceof hr&&!Gn(t)?Vn([new ze("",'"interpolate" expressions cannot be used with this property')]):Nn(s?new ni(a?"camera":"composite",n.value,s.labels,s instanceof hr?s.interpolation:void 0,r):new ri(a?"constant":"source",n.value,r)):Vn([new ze("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ai{constructor(e,t){this._parameters=e,this._specification=t,Ae(this,Hn(this._parameters,this._specification))}static deserialize(e){return new ai(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function oi(e){let t=null;if(e instanceof Kt)t=oi(e.result);else if(e instanceof fr){for(const r of e.args)if(t=oi(r),t)break}else(e instanceof or||e instanceof hr)&&e.input instanceof In&&"zoom"===e.input.name&&(t=e);return t instanceof ze||e.eachChild(e=>{const r=oi(e);r instanceof ze?t=r:!t&&r?t=new ze("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&r&&t!==r&&(t=new ze("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function si(e,t=new Set){return e instanceof Mn&&t.add(e.key),e.eachChild(e=>{si(e,t)}),t}function li(e,t){const{zoom:r,heatmapDensity:n,elevation:i,lineProgress:a,isSupportedScript:o,accumulated:s}=null!=e?e:{};return{zoom:r,heatmapDensity:n,elevation:i,lineProgress:a,isSupportedScript:o,accumulated:s,globalState:t}}function ci(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!ci(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}const ui={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function hi(e,t){if(null==e)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};ci(e)||(e=fi(e));const r=ti(e,ui,t);if("error"===r.result)throw new Error(r.value.map(e=>`${e.key}: ${e.message}`).join(", "));return{filter:(e,t,n)=>r.value.evaluate(e,t,{},n),needGeometry:pi(e),getGlobalStateRefs:()=>si(r.value.expression)}}function di(e,t){return e<t?-1:e>t?1:0}function pi(e){if(!Array.isArray(e))return!1;if("within"===e[0]||"distance"===e[0])return!0;for(let t=1;t<e.length;t++)if(pi(e[t]))return!0;return!1}function fi(e){if(!e)return!0;const t=e[0];return e.length<=1?"any"!==t:"=="===t?mi(e[1],e[2],"=="):"!="===t?yi(mi(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?mi(e[1],e[2],t):"any"===t?(r=e.slice(1),["any"].concat(r.map(fi))):"all"===t?["all"].concat(e.slice(1).map(fi)):"none"===t?["all"].concat(e.slice(1).map(fi).map(yi)):"in"===t?gi(e[1],e.slice(2)):"!in"===t?yi(gi(e[1],e.slice(2))):"has"===t?_i(e[1]):"!has"!==t||yi(_i(e[1]));var r}function mi(e,t,r){switch(e){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,e,t]}}function gi(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(e=>typeof e!=typeof t[0])?["filter-in-large",e,["literal",t.sort(di)]]:["filter-in-small",e,["literal",t]]}}function _i(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function yi(e){return["!",e]}function vi(e){const t=typeof e;if("number"===t||"boolean"===t||"string"===t||null==e)return JSON.stringify(e);if(Array.isArray(e)){let t="[";for(const r of e)t+=`${vi(r)},`;return`${t}]`}const r=Object.keys(e).sort();let n="{";for(let t=0;t<r.length;t++)n+=`${JSON.stringify(r[t])}:${vi(e[r[t]])},`;return`${n}}`}function bi(e){let t="";for(const r of ve)t+=`/${vi(e[r])}`;return t}function xi(e){const t=e.value;return t?[new Ie(e.key,t,"constants have been deprecated as of v8")]:[]}function wi(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Ti(e){if(Array.isArray(e))return e.map(Ti);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const r in e)t[r]=Ti(e[r]);return t}return wi(e)}function Si(e){const t=e.key,r=e.value,n=e.valueSpec||{},i=e.objectElementValidators||{},a=e.style,o=e.styleSpec,s=e.validateSpec;let l=[];const c=qn(r);if("object"!==c)return[new Ie(t,r,`object expected, ${c} found`)];for(const e in r){const c=e.split(".")[0],u=yt(n,c)||n["*"];let h;if(yt(i,c))h=i[c];else if(yt(n,c))h=s;else if(i["*"])h=i["*"];else{if(!n["*"]){l.push(new Ie(t,r[e],`unknown property "${e}"`));continue}h=s}l=l.concat(h({key:(t?`${t}.`:t)+e,value:r[e],valueSpec:u,style:a,styleSpec:o,object:r,objectKey:e,validateSpec:s},r))}for(const e in n)i[e]||n[e].required&&void 0===n[e].default&&void 0===r[e]&&l.push(new Ie(t,r,`missing required property "${e}"`));return l}function Pi(e){const t=e.value,r=e.valueSpec,n=e.style,i=e.styleSpec,a=e.key,o=e.arrayElementValidator||e.validateSpec;if("array"!==qn(t))return[new Ie(a,t,`array expected, ${qn(t)} found`)];if(r.length&&t.length!==r.length)return[new Ie(a,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new Ie(a,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let s={type:r.value,values:r.values};i.$version<7&&(s.function=r.function),"object"===qn(r.value)&&(s=r.value);let l=[];for(let r=0;r<t.length;r++)l=l.concat(o({array:t,arrayIndex:r,value:t[r],valueSpec:s,validateSpec:e.validateSpec,style:n,styleSpec:i,key:`${a}[${r}]`}));return l}function Ei(e){const t=e.key,r=e.value,n=e.valueSpec;let i=qn(r);return"number"===i&&r!=r&&(i="NaN"),"number"!==i?[new Ie(t,r,`number expected, ${i} found`)]:"minimum"in n&&r<n.minimum?[new Ie(t,r,`${r} is less than the minimum value ${n.minimum}`)]:"maximum"in n&&r>n.maximum?[new Ie(t,r,`${r} is greater than the maximum value ${n.maximum}`)]:[]}function Ci(e){const t=e.valueSpec,r=wi(e.value.type);let n,i,a,o={};const s="categorical"!==r&&void 0===e.value.property,l=!s,c="array"===qn(e.value.stops)&&"array"===qn(e.value.stops[0])&&"object"===qn(e.value.stops[0][0]),u=Si({key:e.key,value:e.value,valueSpec:e.styleSpec.function,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===r)return[new Ie(e.key,e.value,'identity function may not have a "stops" property')];let t=[];const n=e.value;return t=t.concat(Pi({key:e.key,value:n,valueSpec:e.valueSpec,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:h})),"array"===qn(n)&&0===n.length&&t.push(new Ie(e.key,n,"array must have at least one stop")),t},default:function(e){return e.validateSpec({key:e.key,value:e.value,valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===r&&s&&u.push(new Ie(e.key,e.value,'missing required property "property"')),"identity"===r||e.value.stops||u.push(new Ie(e.key,e.value,'missing required property "stops"')),"exponential"===r&&e.valueSpec.expression&&!Gn(e.valueSpec)&&u.push(new Ie(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(l&&!jn(e.valueSpec)?u.push(new Ie(e.key,e.value,"property functions not supported")):s&&!Un(e.valueSpec)&&u.push(new Ie(e.key,e.value,"zoom functions not supported"))),"categorical"!==r&&!c||void 0!==e.value.property||u.push(new Ie(e.key,e.value,'"property" property is required')),u;function h(e){let r=[];const n=e.value,s=e.key;if("array"!==qn(n))return[new Ie(s,n,`array expected, ${qn(n)} found`)];if(2!==n.length)return[new Ie(s,n,`array length 2 expected, length ${n.length} found`)];if(c){if("object"!==qn(n[0]))return[new Ie(s,n,`object expected, ${qn(n[0])} found`)];if(void 0===n[0].zoom)return[new Ie(s,n,"object stop key must have zoom")];if(void 0===n[0].value)return[new Ie(s,n,"object stop key must have value")];if(a&&a>wi(n[0].zoom))return[new Ie(s,n[0].zoom,"stop zoom values must appear in ascending order")];wi(n[0].zoom)!==a&&(a=wi(n[0].zoom),i=void 0,o={}),r=r.concat(Si({key:`${s}[0]`,value:n[0],valueSpec:{zoom:{}},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:Ei,value:d}}))}else r=r.concat(d({key:`${s}[0]`,value:n[0],validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec},n));return ei(Ti(n[1]))?r.concat([new Ie(`${s}[1]`,n[1],"expressions are not allowed in function stops.")]):r.concat(e.validateSpec({key:`${s}[1]`,value:n[1],valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec}))}function d(e,a){const s=qn(e.value),l=wi(e.value),c=null!==e.value?e.value:a;if(n){if(s!==n)return[new Ie(e.key,c,`${s} stop domain type must match previous stop domain type ${n}`)]}else n=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new Ie(e.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==r){let n=`number expected, ${s} found`;return jn(t)&&void 0===r&&(n+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ie(e.key,c,n)]}return"categorical"!==r||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==r&&"number"===s&&void 0!==i&&l<i?[new Ie(e.key,c,"stop domain values must appear in ascending order")]:(i=l,"categorical"===r&&l in o?[new Ie(e.key,c,"stop domain values must be unique")]:(o[l]=!0,[])):[new Ie(e.key,c,`integer expected, found ${l}`)]}}function Mi(e){const t=("property"===e.expressionContext?ii:ti)(Ti(e.value),e.valueSpec);if("error"===t.result)return t.value.map(t=>new Ie(`${e.key}${t.key}`,e.value,t.message));const r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!r.outputDefined())return[new Ie(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===e.expressionContext&&"layout"===e.propertyType&&!Bn(r))return[new Ie(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!Bn(r))return[new Ie(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!On(r,["zoom","feature-state"]))return[new Ie(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!Fn(r))return[new Ie(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ki(e){const t=e.key,r=e.value,n=qn(r);return"string"!==n?[new Ie(t,r,`color expected, ${n} found`)]:Et.parse(String(r))?[]:[new Ie(t,r,`color expected, "${r}" found`)]}function Ii(e){const t=e.key,r=e.value,n=e.valueSpec,i=[];return Array.isArray(n.values)?-1===n.values.indexOf(wi(r))&&i.push(new Ie(t,r,`expected one of [${n.values.join(", ")}], ${JSON.stringify(r)} found`)):-1===Object.keys(n.values).indexOf(wi(r))&&i.push(new Ie(t,r,`expected one of [${Object.keys(n.values).join(", ")}], ${JSON.stringify(r)} found`)),i}function Ai(e){return ci(Ti(e.value))?Mi(Ae({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):zi(e)}function zi(e){const t=e.value,r=e.key;if("array"!==qn(t))return[new Ie(r,t,`array expected, ${qn(t)} found`)];const n=e.styleSpec;let i,a=[];if(t.length<1)return[new Ie(r,t,"filter array must have at least 1 element")];switch(a=a.concat(Ii({key:`${r}[0]`,value:t[0],valueSpec:n.filter_operator,style:e.style,styleSpec:e.styleSpec})),wi(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&"$type"===wi(t[1])&&a.push(new Ie(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":3!==t.length&&a.push(new Ie(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(i=qn(t[1]),"string"!==i&&a.push(new Ie(`${r}[1]`,t[1],`string expected, ${i} found`)));for(let o=2;o<t.length;o++)i=qn(t[o]),"$type"===wi(t[1])?a=a.concat(Ii({key:`${r}[${o}]`,value:t[o],valueSpec:n.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&a.push(new Ie(`${r}[${o}]`,t[o],`string, number, or boolean expected, ${i} found`));break;case"any":case"all":case"none":for(let n=1;n<t.length;n++)a=a.concat(zi({key:`${r}[${n}]`,value:t[n],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=qn(t[1]),2!==t.length?a.push(new Ie(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):"string"!==i&&a.push(new Ie(`${r}[1]`,t[1],`string expected, ${i} found`))}return a}function Di(e,t){const r=e.key,n=e.validateSpec,i=e.style,a=e.styleSpec,o=e.value,s=e.objectKey,l=a[`${t}_${e.layerType}`];if(!l)return[];const c=s.match(/^(.*)-transition$/);if("paint"===t&&c&&l[c[1]]&&l[c[1]].transition)return n({key:r,value:o,valueSpec:a.transition,style:i,styleSpec:a});const u=e.valueSpec||l[s];if(!u)return[new Ie(r,o,`unknown property "${s}"`)];let h;if("string"===qn(o)&&jn(u)&&!u.tokens&&(h=/^{([^}]+)}$/.exec(o)))return[new Ie(r,o,`"${s}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(h[1])} }\`.`)];const d=[];return"symbol"===e.layerType&&"text-font"===s&&$n(Ti(o))&&"identity"===wi(o.type)&&d.push(new Ie(r,o,'"text-font" does not support identity functions')),d.concat(n({key:e.key,value:o,valueSpec:u,style:i,styleSpec:a,expressionContext:"property",propertyType:t,propertyKey:s}))}function Li(e){return Di(e,"paint")}function Ri(e){return Di(e,"layout")}function Fi(e){let t=[];const r=e.value,n=e.key,i=e.style,a=e.styleSpec;if("object"!==qn(r))return[new Ie(n,r,`object expected, ${qn(r)} found`)];r.type||r.ref||t.push(new Ie(n,r,'either "type" or "ref" is required'));let o=wi(r.type);const s=wi(r.ref);if(r.id){const a=wi(r.id);for(let o=0;o<e.arrayIndex;o++){const e=i.layers[o];wi(e.id)===a&&t.push(new Ie(n,r.id,`duplicate layer id "${r.id}", previously used at line ${e.id.__line__}`))}}if("ref"in r){let e;["type","source","source-layer","filter","layout"].forEach(e=>{e in r&&t.push(new Ie(n,r[e],`"${e}" is prohibited for ref layers`))}),i.layers.forEach(t=>{wi(t.id)===s&&(e=t)}),e?e.ref?t.push(new Ie(n,r.ref,"ref cannot reference another ref layer")):o=wi(e.type):t.push(new Ie(n,r.ref,`ref layer "${s}" not found`))}else if("background"!==o)if(r.source){const e=i.sources&&i.sources[r.source],a=e&&wi(e.type);e?"vector"===a&&"raster"===o?t.push(new Ie(n,r.source,`layer "${r.id}" requires a raster source`)):"raster-dem"!==a&&"hillshade"===o||"raster-dem"!==a&&"color-relief"===o?t.push(new Ie(n,r.source,`layer "${r.id}" requires a raster-dem source`)):"raster"===a&&"raster"!==o?t.push(new Ie(n,r.source,`layer "${r.id}" requires a vector source`)):"vector"!==a||r["source-layer"]?"raster-dem"===a&&"hillshade"!==o&&"color-relief"!==o?t.push(new Ie(n,r.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):"line"!==o||!r.paint||!r.paint["line-gradient"]||"geojson"===a&&e.lineMetrics||t.push(new Ie(n,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Ie(n,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new Ie(n,r.source,`source "${r.source}" not found`))}else t.push(new Ie(n,r,'missing required property "source"'));return t=t.concat(Si({key:n,value:r,valueSpec:a.layer,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":()=>[],type:()=>e.validateSpec({key:`${n}.type`,value:r.type,valueSpec:a.layer.type,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,object:r,objectKey:"type"}),filter:Ai,layout:e=>Si({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>Ri(Ae({layerType:o},e))}}),paint:e=>Si({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>Li(Ae({layerType:o},e))}})}})),t}function Bi(e){const t=e.value,r=e.key,n=qn(t);return"string"!==n?[new Ie(r,t,`string expected, ${n} found`)]:[]}const Oi={promoteId:function({key:e,value:t}){if("string"===qn(t))return Bi({key:e,value:t});{const r=[];for(const n in t)r.push(...Bi({key:`${e}.${n}`,value:t[n]}));return r}}};function Ni(e){const t=e.value,r=e.key,n=e.styleSpec,i=e.style,a=e.validateSpec;if(!t.type)return[new Ie(r,t,'"type" is required')];const o=wi(t.type);let s;switch(o){case"vector":case"raster":return s=Si({key:r,value:t,valueSpec:n[`source_${o.replace("-","_")}`],style:e.style,styleSpec:n,objectElementValidators:Oi,validateSpec:a}),s;case"raster-dem":return s=function(e){var t;const r=null!==(t=e.sourceName)&&void 0!==t?t:"",n=e.value,i=e.styleSpec,a=i.source_raster_dem,o=e.style;let s=[];const l=qn(n);if(void 0===n)return s;if("object"!==l)return s.push(new Ie("source_raster_dem",n,`object expected, ${l} found`)),s;const c="custom"===wi(n.encoding),u=["redFactor","greenFactor","blueFactor","baseShift"],h=e.value.encoding?`"${e.value.encoding}"`:"Default";for(const t in n)!c&&u.includes(t)?s.push(new Ie(t,n[t],`In "${r}": "${t}" is only valid when "encoding" is set to "custom". ${h} encoding found`)):a[t]?s=s.concat(e.validateSpec({key:t,value:n[t],valueSpec:a[t],validateSpec:e.validateSpec,style:o,styleSpec:i})):s.push(new Ie(t,n[t],`unknown property "${t}"`));return s}({sourceName:r,value:t,style:e.style,styleSpec:n,validateSpec:a}),s;case"geojson":if(s=Si({key:r,value:t,valueSpec:n.source_geojson,style:i,styleSpec:n,validateSpec:a,objectElementValidators:Oi}),t.cluster)for(const e in t.clusterProperties){const[n,i]=t.clusterProperties[e],a="string"==typeof n?[n,["accumulated"],["get",e]]:n;s.push(...Mi({key:`${r}.${e}.map`,value:i,expressionContext:"cluster-map"})),s.push(...Mi({key:`${r}.${e}.reduce`,value:a,expressionContext:"cluster-reduce"}))}return s;case"video":return Si({key:r,value:t,valueSpec:n.source_video,style:i,validateSpec:a,styleSpec:n});case"image":return Si({key:r,value:t,valueSpec:n.source_image,style:i,validateSpec:a,styleSpec:n});case"canvas":return[new Ie(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ii({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Vi(e){const t=e.value,r=e.styleSpec,n=r.light,i=e.style;let a=[];const o=qn(t);if(void 0===t)return a;if("object"!==o)return a=a.concat([new Ie("light",t,`object expected, ${o} found`)]),a;for(const o in t){const s=o.match(/^(.*)-transition$/);a=a.concat(s&&n[s[1]]&&n[s[1]].transition?e.validateSpec({key:o,value:t[o],valueSpec:r.transition,validateSpec:e.validateSpec,style:i,styleSpec:r}):n[o]?e.validateSpec({key:o,value:t[o],valueSpec:n[o],validateSpec:e.validateSpec,style:i,styleSpec:r}):[new Ie(o,t[o],`unknown property "${o}"`)])}return a}function ji(e){const t=e.value,r=e.styleSpec,n=r.sky,i=e.style,a=qn(t);if(void 0===t)return[];if("object"!==a)return[new Ie("sky",t,`object expected, ${a} found`)];let o=[];for(const a in t)o=o.concat(n[a]?e.validateSpec({key:a,value:t[a],valueSpec:n[a],style:i,styleSpec:r}):[new Ie(a,t[a],`unknown property "${a}"`)]);return o}function Ui(e){const t=e.value,r=e.styleSpec,n=r.terrain,i=e.style;let a=[];const o=qn(t);if(void 0===t)return a;if("object"!==o)return a=a.concat([new Ie("terrain",t,`object expected, ${o} found`)]),a;for(const o in t)a=a.concat(n[o]?e.validateSpec({key:o,value:t[o],valueSpec:n[o],validateSpec:e.validateSpec,style:i,styleSpec:r}):[new Ie(o,t[o],`unknown property "${o}"`)]);return a}function Gi(e){let t=[];const r=e.value,n=e.key;if(Array.isArray(r)){const i=[],a=[];for(const o in r)r[o].id&&i.includes(r[o].id)&&t.push(new Ie(n,r,`all the sprites' ids must be unique, but ${r[o].id} is duplicated`)),i.push(r[o].id),r[o].url&&a.includes(r[o].url)&&t.push(new Ie(n,r,`all the sprites' URLs must be unique, but ${r[o].url} is duplicated`)),a.push(r[o].url),t=t.concat(Si({key:`${n}[${o}]`,value:r[o],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:e.validateSpec}));return t}return Bi({key:n,value:r})}function qi(e){return t=e.value,Boolean(t)&&t.constructor===Object?[]:[new Ie(e.key,e.value,`object expected, ${qn(e.value)} found`)];var t}const $i={"*":()=>[],array:Pi,boolean:function(e){const t=e.value,r=e.key,n=qn(t);return"boolean"!==n?[new Ie(r,t,`boolean expected, ${n} found`)]:[]},number:Ei,color:ki,constants:xi,enum:Ii,filter:Ai,function:Ci,layer:Fi,object:Si,source:Ni,light:Vi,sky:ji,terrain:Ui,projection:function(e){const t=e.value,r=e.styleSpec,n=r.projection,i=e.style,a=qn(t);if(void 0===t)return[];if("object"!==a)return[new Ie("projection",t,`object expected, ${a} found`)];let o=[];for(const a in t)o=o.concat(n[a]?e.validateSpec({key:a,value:t[a],valueSpec:n[a],style:i,styleSpec:r}):[new Ie(a,t[a],`unknown property "${a}"`)]);return o},projectionDefinition:function(e){const t=e.key;let r=e.value;r=r instanceof String?r.valueOf():r;const n=qn(r);return"array"!==n||function(e){return Array.isArray(e)&&3===e.length&&"string"==typeof e[0]&&"string"==typeof e[1]&&"number"==typeof e[2]}(r)||function(e){return!!["interpolate","step","literal"].includes(e[0])}(r)?["array","string"].includes(n)?[]:[new Ie(t,r,`projection expected, invalid type "${n}" found`)]:[new Ie(t,r,`projection expected, invalid array ${JSON.stringify(r)} found`)]},string:Bi,formatted:function(e){return 0===Bi(e).length?[]:Mi(e)},resolvedImage:function(e){return 0===Bi(e).length?[]:Mi(e)},padding:function(e){const t=e.key,r=e.value;if("array"===qn(r)){if(r.length<1||r.length>4)return[new Ie(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];const n={type:"number"};let i=[];for(let a=0;a<r.length;a++)i=i.concat(e.validateSpec({key:`${t}[${a}]`,value:r[a],validateSpec:e.validateSpec,valueSpec:n}));return i}return Ei({key:t,value:r,valueSpec:{}})},numberArray:function(e){const t=e.key,r=e.value;if("array"===qn(r)){const n={type:"number"};if(r.length<1)return[new Ie(t,r,"array length at least 1 expected, length 0 found")];let i=[];for(let a=0;a<r.length;a++)i=i.concat(e.validateSpec({key:`${t}[${a}]`,value:r[a],validateSpec:e.validateSpec,valueSpec:n}));return i}return Ei({key:t,value:r,valueSpec:{}})},colorArray:function(e){const t=e.key,r=e.value;if("array"===qn(r)){if(r.length<1)return[new Ie(t,r,"array length at least 1 expected, length 0 found")];let e=[];for(let n=0;n<r.length;n++)e=e.concat(ki({key:`${t}[${n}]`,value:r[n]}));return e}return ki({key:t,value:r})},variableAnchorOffsetCollection:function(e){const t=e.key,r=e.value,n=qn(r),i=e.styleSpec;if("array"!==n||r.length<1||r.length%2!=0)return[new Ie(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let a=[];for(let n=0;n<r.length;n+=2)a=a.concat(Ii({key:`${t}[${n}]`,value:r[n],valueSpec:i.layout_symbol["text-anchor"]})),a=a.concat(Pi({key:`${t}[${n+1}]`,value:r[n+1],valueSpec:{length:2,value:"number"},validateSpec:e.validateSpec,style:e.style,styleSpec:i}));return a},sprite:Gi,state:qi};function Zi(e){const t=e.value,r=e.valueSpec,n=e.styleSpec;return e.validateSpec=Zi,r.expression&&$n(wi(t))?Ci(e):r.expression&&ei(Ti(t))?Mi(e):r.type&&$i[r.type]?$i[r.type](e):Si(Ae({},e,{valueSpec:r.type?n[r.type]:r}))}function Hi(e){const t=e.value,r=e.key,n=Bi(e);return n.length||(-1===t.indexOf("{fontstack}")&&n.push(new Ie(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&n.push(new Ie(r,t,'"glyphs" url must include a "{range}" token'))),n}function Wi(e,t=ye){let r=[];return r=r.concat(Zi({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,validateSpec:Zi,objectElementValidators:{glyphs:Hi,"*":()=>[]}})),e.constants&&(r=r.concat(xi({key:"constants",value:e.constants}))),Yi(r)}function Xi(e){return function(t){return e(Object.assign({},t,{validateSpec:Zi}))}}function Yi(e){return[].concat(e).sort((e,t)=>e.line-t.line)}function Ki(e){return function(...t){return Yi(e.apply(this,t))}}Wi.source=Ki(Xi(Ni)),Wi.sprite=Ki(Xi(Gi)),Wi.glyphs=Ki(Xi(Hi)),Wi.light=Ki(Xi(Vi)),Wi.sky=Ki(Xi(ji)),Wi.terrain=Ki(Xi(Ui)),Wi.state=Ki(Xi(qi)),Wi.layer=Ki(Xi(Fi)),Wi.filter=Ki(Xi(Ai)),Wi.paintProperty=Ki(Xi(Li)),Wi.layoutProperty=Ki(Xi(Ri));const Qi=ye,Ji=Wi,ea=Ji.light,ta=Ji.sky,ra=Ji.paintProperty,na=Ji.layoutProperty;function ia(e,t){let r=!1;if(t&&t.length)for(const n of t)e.fire(new ge(new Error(n.message))),r=!0;return r}class aa{constructor(e,t,r){const n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const i=new Int32Array(this.arrayBuffer);e=i[0],this.d=(t=i[1])+2*(r=i[2]);for(let e=0;e<this.d*this.d;e++){const t=i[3+e],r=i[3+e+1];n.push(t===r?null:i.subarray(t,r))}const a=i[3+n.length+1];this.keys=i.subarray(i[3+n.length],a),this.bboxes=i.subarray(a),this.insert=this._insertReadonly}else{this.d=t+2*r;for(let e=0;e<this.d*this.d;e++)n.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;const i=r/t*e;this.min=-i,this.max=e+i}insert(e,t,r,n,i){this._forEachCell(t,r,n,i,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,t,r,n,i,a){this.cells[i].push(a)}query(e,t,r,n,i){const a=this.min,o=this.max;if(e<=a&&t<=a&&o<=r&&o<=n&&!i)return Array.prototype.slice.call(this.keys);{const a=[];return this._forEachCell(e,t,r,n,this._queryCell,a,{},i),a}}_queryCell(e,t,r,n,i,a,o,s){const l=this.cells[i];if(null!==l){const i=this.keys,c=this.bboxes;for(let u=0;u<l.length;u++){const h=l[u];if(void 0===o[h]){const l=4*h;(s?s(c[l+0],c[l+1],c[l+2],c[l+3]):e<=c[l+2]&&t<=c[l+3]&&r>=c[l+0]&&n>=c[l+1])?(o[h]=!0,a.push(i[h])):o[h]=!1}}}}_forEachCell(e,t,r,n,i,a,o,s){const l=this._convertToCellCoord(e),c=this._convertToCellCoord(t),u=this._convertToCellCoord(r),h=this._convertToCellCoord(n);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++){const c=this.d*l+d;if((!s||s(this._convertFromCellCoord(d),this._convertFromCellCoord(l),this._convertFromCellCoord(d+1),this._convertFromCellCoord(l+1)))&&i.call(this,e,t,r,n,c,a,o,s))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,t=3+this.cells.length+1+1;let r=0;for(let e=0;e<this.cells.length;e++)r+=this.cells[e].length;const n=new Int32Array(t+r+this.keys.length+this.bboxes.length);n[0]=this.extent,n[1]=this.n,n[2]=this.padding;let i=t;for(let t=0;t<e.length;t++){const r=e[t];n[3+t]=i,n.set(r,i),i+=r.length}return n[3+e.length]=i,n.set(this.keys,i),i+=this.keys.length,n[3+e.length+1]=i,n.set(this.bboxes,i),i+=this.bboxes.length,n.buffer}static serialize(e,t){const r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}}static deserialize(e){return new aa(e.buffer)}}const oa={};function sa(e,t,r={}){if(oa[e])throw new Error(`${e} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),oa[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}sa("Object",Object),sa("Set",Set),sa("TransferableGridIndex",aa),sa("Color",Et),sa("Error",Error),sa("AJAXError",ce),sa("ResolvedImage",Bt),sa("StylePropertyFunction",ai),sa("StyleExpression",Jn,{omit:["_evaluator"]}),sa("ZoomDependentExpression",ni),sa("ZoomConstantExpression",ri),sa("CompoundExpression",In,{omit:["_evaluate"]});for(const e in kn)kn[e]._classRegistryKey||sa(`Expression_${e}`,kn[e]);function la(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function ca(e){return e.$name||e.constructor._classRegistryKey}function ua(e){return!function(e){if(null===e||"object"!=typeof e)return!1;const t=ca(e);return!(!t||"Object"===t)}(e)&&(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof Blob||e instanceof Error||la(e)||W(e)||ArrayBuffer.isView(e)||e instanceof ImageData)}function ha(e,t){if(ua(e))return(la(e)||W(e))&&t&&t.push(e),ArrayBuffer.isView(e)&&t&&t.push(e.buffer),e instanceof ImageData&&t&&t.push(e.data.buffer),e;if(Array.isArray(e)){const r=[];for(const n of e)r.push(ha(n,t));return r}if("object"!=typeof e)throw new Error("can't serialize object of type "+typeof e);const r=ca(e);if(!r)throw new Error(`can't serialize object of unregistered class ${e.constructor.name}`);if(!oa[r])throw new Error(`${r} is not registered.`);const{klass:n}=oa[r],i=n.serialize?n.serialize(e,t):{};if(n.serialize){if(t&&i===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const n in e){if(!e.hasOwnProperty(n))continue;if(oa[r].omit.indexOf(n)>=0)continue;const a=e[n];i[n]=oa[r].shallow.indexOf(n)>=0?a:ha(a,t)}e instanceof Error&&(i.message=e.message)}if(i.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==r&&(i.$name=r),i}function da(e){if(ua(e))return e;if(Array.isArray(e))return e.map(da);if("object"!=typeof e)throw new Error("can't deserialize object of type "+typeof e);const t=ca(e)||"Object";if(!oa[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:r}=oa[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(e);const n=Object.create(r.prototype);for(const r of Object.keys(e)){if("$name"===r)continue;const i=e[r];n[r]=oa[t].shallow.indexOf(r)>=0?i:da(i)}return n}class pa{constructor(){this.first=!0}update(e,t){const r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))}}function fa(e){return/[\u02EA\u02EB\u2E80-\u2FDF\u2FF0-\u303F\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FD-\u30FF\u3105-\u312F\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(e))}function ma(e){return/[\u02EA\u02EB\u1100-\u11FF\u1400-\u167F\u18B0-\u18F5\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303F\u3041-\u3096\u309D-\u30FB\u30FD-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE48\uFE50-\uFE57\uFE5F-\uFE62\uFE67-\uFE6F\uFF00-\uFF07\uFF0A-\uFF0C\uFF0E-\uFF19\uFF1F-\uFF3A\uFF3C\uFF3E\uFF40-\uFF5A\uFFE0-\uFFE2\uFFE4-\uFFE7]|\uD802[\uDD80-\uDD9F]|\uD805[\uDD80-\uDDFF]|\uD806[\uDE00-\uDEBF]|\uD811[\uDC00-\uDE7F]|\uD81B[\uDFE0-\uDFE4\uDFF0-\uDFF6]|[\uD81C-\uD822\uD83D\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD30-\uDEFB]|\uD833[\uDEC0-\uDFCF]|\uD834[\uDC00-\uDDFF\uDEE0-\uDF7F]|\uD836[\uDC00-\uDEAF]|\uD83C[\uDC00-\uDE00\uDF00-\uDFFF]|\uD83E[\uDD00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(e))}function ga(e){return/\s/u.test(String.fromCodePoint(e))}function _a(e){for(const t of e)if(ma(t.codePointAt(0)))return!0;return!1}function ya(e){for(const t of e)if(!xa(t.codePointAt(0)))return!1;return!0}function va(e){const t=e.map(e=>{try{return new RegExp(`\\p{sc=${e}}`,"u").source}catch(e){return null}}).filter(e=>e);return new RegExp(t.join("|"),"u")}const ba=va(["Arab","Dupl","Mong","Ougr","Syrc"]);function xa(e){return!ba.test(String.fromCodePoint(e))}function wa(e){return!(ma(e)||(t=e,/[\xA7\xA9\xAE\xB1\xBC-\xBE\xD7\xF7\u2016\u2020\u2021\u2030\u2031\u203B\u203C\u2042\u2047-\u2049\u2051\u2100-\u218F\u221E\u2234\u2235\u2300-\u2307\u230C-\u231F\u2324-\u2328\u232B\u237D-\u239A\u23BE-\u23CD\u23CF\u23D1-\u23DB\u23E2-\u2422\u2424-\u24FF\u25A0-\u2619\u2620-\u2767\u2776-\u2793\u2B12-\u2B2F\u2B50-\u2B59\u2BB8-\u2BEB\u3000-\u303F\u30A0-\u30FF\uE000-\uF8FF\uFE30-\uFE6F\uFF00-\uFFEF\uFFFC\uFFFD]|[\uDB80-\uDBFF][\uDC00-\uDFFF]/gim.test(String.fromCodePoint(t))));var t}const Ta=va(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Sa(e){return Ta.test(String.fromCodePoint(e))}function Pa(e,t){return!(!t&&Sa(e)||/[\u0900-\u0DFF\u0F00-\u109F\u1780-\u17FF]/gim.test(String.fromCodePoint(e)))}function Ea(e){for(const t of e)if(Sa(t.codePointAt(0)))return!0;return!1}const Ca=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(e){this.pluginStatus=e.pluginStatus,this.pluginURL=e.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(e){if(Ca.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=e.applyArabicShaping,this.processBidirectionalText=e.processBidirectionalText,this.processStyledBidirectionalText=e.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return null!=this.applyArabicShaping&&null!=this.processBidirectionalText&&null!=this.processStyledBidirectionalText}getRTLTextPluginStatus(){return this.pluginStatus}syncState(e,r){return t(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if("loading"!==e.pluginStatus)return this.setState(e),e;const t=e.pluginURL,n=new Promise(e=>{this.loadScriptResolve=e});r(t);const i=new Promise(e=>setTimeout(()=>e(),this.TIMEOUT));if(yield Promise.race([n,i]),this.isParsed()){const e={pluginStatus:"loaded",pluginURL:t};return this.setState(e),e}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${t}`)})}};class Ma{constructor(e,t){this.isSupportedScript=ka,this.zoom=e,t?(this.now=t.now||0,this.fadeDuration=t.fadeDuration||0,this.zoomHistory=t.zoomHistory||new pa,this.transition=t.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new pa,this.transition={})}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}}}function ka(e){return function(e,t){for(const r of e)if(!Pa(r.codePointAt(0),t))return!1;return!0}(e,"loaded"===Ca.getRTLTextPluginStatus())}const Ia="-transition";class Aa{constructor(e,t,r){this.property=e,this.value=t,this.expression=function(e,t,r){if($n(e))return new ai(e,t);if(ei(e)){const n=ii(e,t,r);if("error"===n.result)throw new Error(n.value.map(e=>`${e.key}: ${e.message}`).join(", "));return n.value}{let r=e;return"color"===t.type&&"string"==typeof e?r=Et.parse(e):"padding"!==t.type||"number"!=typeof e&&!Array.isArray(e)?"numberArray"!==t.type||"number"!=typeof e&&!Array.isArray(e)?"colorArray"!==t.type||"string"!=typeof e&&!Array.isArray(e)?"variableAnchorOffsetCollection"===t.type&&Array.isArray(e)?r=Ft.parse(e):"projectionDefinition"===t.type&&"string"==typeof e&&(r=Ot.parse(e)):r=Dt.parse(e):r=zt.parse(e):r=At.parse(e),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>r}}}(void 0===t?e.specification.default:t,e.specification,r)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)}}class za{constructor(e,t){this.property=e,this.value=new Aa(e,void 0,t)}transitioned(e,t){return new La(this.property,this.value,t,O({},e.transition,this.transition),e.now)}untransitioned(){return new La(this.property,this.value,null,{},0)}}class Da{constructor(e,t){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._globalState=t}getValue(e){return U(this._values[e].value.value)}setValue(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new za(this._values[e].property,this._globalState)),this._values[e].value=new Aa(this._values[e].property,null===t?void 0:U(t),this._globalState)}getTransition(e){return U(this._values[e].transition)}setTransition(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new za(this._values[e].property,this._globalState)),this._values[e].transition=U(t)||void 0}serialize(){const e={};for(const t of Object.keys(this._values)){const r=this.getValue(t);void 0!==r&&(e[t]=r);const n=this.getTransition(t);void 0!==n&&(e[`${t}${Ia}`]=n)}return e}transitioned(e,t){const r=new Ra(this._properties);for(const n of Object.keys(this._values))r._values[n]=this._values[n].transitioned(e,t._values[n]);return r}untransitioned(){const e=new Ra(this._properties);for(const t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}}class La{constructor(e,t,r,n,i){this.property=e,this.value=t,this.begin=i+n.delay||0,this.end=this.begin+n.duration||0,e.specification.transition&&(n.delay||n.duration)&&(this.prior=r)}possiblyEvaluate(e,t,r){const n=e.now||0,i=this.value.possiblyEvaluate(e,t,r),a=this.prior;if(a){if(n>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(n<this.begin)return a.possiblyEvaluate(e,t,r);{const o=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(e,t,r),i,D(o))}}return i}}class Ra{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,r){const n=new Oa(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].possiblyEvaluate(e,t,r);return n}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Fa{constructor(e,t){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._globalState=t}hasValue(e){return void 0!==this._values[e].value}getValue(e){return U(this._values[e].value)}setValue(e,t){this._values[e]=new Aa(this._values[e].property,null===t?void 0:U(t),this._globalState)}serialize(){const e={};for(const t of Object.keys(this._values)){const r=this.getValue(t);void 0!==r&&(e[t]=r)}return e}possiblyEvaluate(e,t,r){const n=new Oa(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].possiblyEvaluate(e,t,r);return n}}class Ba{constructor(e,t,r){this.property=e,this.value=t,this.parameters=r}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,t,r,n){return this.property.evaluate(this.value,this.parameters,e,t,r,n)}}class Oa{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Na{constructor(e){this.specification=e}possiblyEvaluate(e,t){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(t)}interpolate(e,t,r){const n=pr[this.specification.type];return n?n(e,t,r):e}}class Va{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,r,n){return new Ba(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},r,n)}:e.expression,t)}interpolate(e,t,r){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new Ba(this,{kind:"constant",value:void 0},e.parameters);const n=pr[this.specification.type];if(n){const i=n(e.value.value,t.value.value,r);return new Ba(this,{kind:"constant",value:i},e.parameters)}return e}evaluate(e,t,r,n,i,a){return"constant"===e.kind?e.value:e.evaluate(t,r,n,i,a)}}class ja extends Va{possiblyEvaluate(e,t,r,n){if(void 0===e.value)return new Ba(this,{kind:"constant",value:void 0},t);if("constant"===e.expression.kind){const i=e.expression.evaluate(t,null,{},r,n),a="resolvedImage"===e.property.specification.type&&"string"!=typeof i?i.name:i,o=this._calculate(a,a,a,t);return new Ba(this,{kind:"constant",value:o},t)}if("camera"===e.expression.kind){const r=this._calculate(e.expression.evaluate({zoom:t.zoom-1}),e.expression.evaluate({zoom:t.zoom}),e.expression.evaluate({zoom:t.zoom+1}),t);return new Ba(this,{kind:"constant",value:r},t)}return new Ba(this,e.expression,t)}evaluate(e,t,r,n,i,a){if("source"===e.kind){const o=e.evaluate(t,r,n,i,a);return this._calculate(o,o,o,t)}return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(t.zoom)-1},r,n),e.evaluate({zoom:Math.floor(t.zoom)},r,n),e.evaluate({zoom:Math.floor(t.zoom)+1},r,n),t):e.value}_calculate(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}}interpolate(e){return e}}class Ua{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,n){if(void 0!==e.value){if("constant"===e.expression.kind){const i=e.expression.evaluate(t,null,{},r,n);return this._calculate(i,i,i,t)}return this._calculate(e.expression.evaluate(new Ma(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Ma(Math.floor(t.zoom),t)),e.expression.evaluate(new Ma(Math.floor(t.zoom+1),t)),t)}}_calculate(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}}interpolate(e){return e}}class Ga{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,n){return!!e.expression.evaluate(t,null,{},r,n)}interpolate(){return!1}}class qa{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const t in e){const r=e[t];r.specification.overridable&&this.overridableProperties.push(t);const n=this.defaultPropertyValues[t]=new Aa(r,void 0,void 0),i=this.defaultTransitionablePropertyValues[t]=new za(r,void 0);this.defaultTransitioningPropertyValues[t]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=n.possiblyEvaluate({})}}}sa("DataDrivenProperty",Va),sa("DataConstantProperty",Na),sa("CrossFadedDataDrivenProperty",ja),sa("CrossFadedProperty",Ua),sa("ColorRampProperty",Ga);class $a extends _e{constructor(e,t,r){if(super(),this.id=e.id,this.type=e.type,this._globalState=r,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter,this._featureFilter=hi(e.filter,r)),t.layout&&(this._unevaluatedLayout=new Fa(t.layout,r)),t.paint)){this._transitionablePaint=new Da(t.paint,r);for(const t in e.paint)this.setPaintProperty(t,e.paint[t],{validate:!1});for(const t in e.layout)this.setLayoutProperty(t,e.layout[t],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Oa(t.paint)}}setFilter(e){this.filter=e,this._featureFilter=hi(e,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}getLayoutAffectingGlobalStateRefs(){const e=new Set;if(this._unevaluatedLayout)for(const t in this._unevaluatedLayout._values){const r=this._unevaluatedLayout._values[t];for(const t of r.getGlobalStateRefs())e.add(t)}for(const t of this._featureFilter.getGlobalStateRefs())e.add(t);return e}getPaintAffectingGlobalStateRefs(){var e;const t=new globalThis.Map;if(this._transitionablePaint)for(const r in this._transitionablePaint._values){const n=this._transitionablePaint._values[r].value;for(const i of n.getGlobalStateRefs()){const a=null!==(e=t.get(i))&&void 0!==e?e:[];a.push({name:r,value:n.value}),t.set(i,a)}}return t}setLayoutProperty(e,t,r={}){null!=t&&this._validate(na,`layers.${this.id}.layout.${e}`,e,t,r)||("visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t)}getPaintProperty(e){return e.endsWith(Ia)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t,r={}){if(null!=t&&this._validate(ra,`layers.${this.id}.paint.${e}`,e,t,r))return!1;if(e.endsWith(Ia))return this._transitionablePaint.setTransition(e.slice(0,-11),t||void 0),!1;{const r=this._transitionablePaint._values[e],n="cross-faded-data-driven"===r.property.specification["property-type"],i=r.value.isDataDriven(),a=r.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);const o=this._transitionablePaint._values[e].value;return o.isDataDriven()||i||n||this._handleOverridablePaintPropertyUpdate(e,a,o)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,t,r){return!1}isHidden(e,t=!1){return!!(this.minzoom&&e<(t?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),j(e,(e,t)=>!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length))}_validate(e,t,r,n,i={}){return(!i||!1!==i.validate)&&ia(this,e.call(Ji,{key:t,layerType:this.type,objectKey:r,value:n,styleSpec:ye,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const t=this.paint.get(e);if(t instanceof Ba&&jn(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1}}let Za;var Ha={get paint(){return Za=Za||new qa({"raster-opacity":new Na(ye.paint_raster["raster-opacity"]),"raster-hue-rotate":new Na(ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Na(ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Na(ye.paint_raster["raster-brightness-max"]),"raster-saturation":new Na(ye.paint_raster["raster-saturation"]),"raster-contrast":new Na(ye.paint_raster["raster-contrast"]),"raster-resampling":new Na(ye.paint_raster["raster-resampling"]),"raster-fade-duration":new Na(ye.paint_raster["raster-fade-duration"])})}};class Wa extends $a{constructor(e,t){super(e,Ha,t)}}const Xa={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ya{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ka{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Qa(e,t=1){let r=0,n=0;return{members:e.map(e=>{const i=Xa[e.type].BYTES_PER_ELEMENT,a=r=Ja(r,Math.max(t,i)),o=e.components||1;return n=Math.max(n,i),r+=i*o,{name:e.name,type:e.type,components:o,offset:a}}),size:Ja(r,Math.max(n,t)),alignment:t}}function Ja(e,t){return Math.ceil(e/t)*t}class eo extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){const r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){const n=2*e;return this.int16[n+0]=t,this.int16[n+1]=r,e}}eo.prototype.bytesPerElement=4,sa("StructArrayLayout2i4",eo);class to extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.int16[i+0]=t,this.int16[i+1]=r,this.int16[i+2]=n,e}}to.prototype.bytesPerElement=6,sa("StructArrayLayout3i6",to);class ro extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){const a=4*e;return this.int16[a+0]=t,this.int16[a+1]=r,this.int16[a+2]=n,this.int16[a+3]=i,e}}ro.prototype.bytesPerElement=8,sa("StructArrayLayout4i8",ro);class no extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,a){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i,a)}emplace(e,t,r,n,i,a,o){const s=6*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.int16[s+2]=n,this.int16[s+3]=i,this.int16[s+4]=a,this.int16[s+5]=o,e}}no.prototype.bytesPerElement=12,sa("StructArrayLayout2i4i12",no);class io extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,a){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i,a)}emplace(e,t,r,n,i,a,o){const s=4*e,l=8*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.uint8[l+4]=n,this.uint8[l+5]=i,this.uint8[l+6]=a,this.uint8[l+7]=o,e}}io.prototype.bytesPerElement=8,sa("StructArrayLayout2i4ub8",io);class ao extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){const r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){const n=2*e;return this.float32[n+0]=t,this.float32[n+1]=r,e}}ao.prototype.bytesPerElement=8,sa("StructArrayLayout2f8",ao);class oo extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,a,o,s,l,c){const u=this.length;return this.resize(u+1),this.emplace(u,e,t,r,n,i,a,o,s,l,c)}emplace(e,t,r,n,i,a,o,s,l,c,u){const h=10*e;return this.uint16[h+0]=t,this.uint16[h+1]=r,this.uint16[h+2]=n,this.uint16[h+3]=i,this.uint16[h+4]=a,this.uint16[h+5]=o,this.uint16[h+6]=s,this.uint16[h+7]=l,this.uint16[h+8]=c,this.uint16[h+9]=u,e}}oo.prototype.bytesPerElement=20,sa("StructArrayLayout10ui20",oo);class so extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,a,o,s){const l=this.length;return this.resize(l+1),this.emplace(l,e,t,r,n,i,a,o,s)}emplace(e,t,r,n,i,a,o,s,l){const c=8*e;return this.uint16[c+0]=t,this.uint16[c+1]=r,this.uint16[c+2]=n,this.uint16[c+3]=i,this.uint16[c+4]=a,this.uint16[c+5]=o,this.uint16[c+6]=s,this.uint16[c+7]=l,e}}so.prototype.bytesPerElement=16,sa("StructArrayLayout8ui16",so);class lo extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,a,o,s,l,c,u,h){const d=this.length;return this.resize(d+1),this.emplace(d,e,t,r,n,i,a,o,s,l,c,u,h)}emplace(e,t,r,n,i,a,o,s,l,c,u,h,d){const p=12*e;return this.int16[p+0]=t,this.int16[p+1]=r,this.int16[p+2]=n,this.int16[p+3]=i,this.uint16[p+4]=a,this.uint16[p+5]=o,this.uint16[p+6]=s,this.uint16[p+7]=l,this.int16[p+8]=c,this.int16[p+9]=u,this.int16[p+10]=h,this.int16[p+11]=d,e}}lo.prototype.bytesPerElement=24,sa("StructArrayLayout4i4ui4i24",lo);class co extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.float32[i+0]=t,this.float32[i+1]=r,this.float32[i+2]=n,e}}co.prototype.bytesPerElement=12,sa("StructArrayLayout3f12",co);class uo extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint32[1*e+0]=t,e}}uo.prototype.bytesPerElement=4,sa("StructArrayLayout1ul4",uo);class ho extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,a,o,s,l){const c=this.length;return this.resize(c+1),this.emplace(c,e,t,r,n,i,a,o,s,l)}emplace(e,t,r,n,i,a,o,s,l,c){const u=10*e,h=5*e;return this.int16[u+0]=t,this.int16[u+1]=r,this.int16[u+2]=n,this.int16[u+3]=i,this.int16[u+4]=a,this.int16[u+5]=o,this.uint32[h+3]=s,this.uint16[u+8]=l,this.uint16[u+9]=c,e}}ho.prototype.bytesPerElement=20,sa("StructArrayLayout6i1ul2ui20",ho);class po extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,a){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i,a)}emplace(e,t,r,n,i,a,o){const s=6*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.int16[s+2]=n,this.int16[s+3]=i,this.int16[s+4]=a,this.int16[s+5]=o,e}}po.prototype.bytesPerElement=12,sa("StructArrayLayout2i2i2i12",po);class fo extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n,i)}emplace(e,t,r,n,i,a){const o=4*e,s=8*e;return this.float32[o+0]=t,this.float32[o+1]=r,this.float32[o+2]=n,this.int16[s+6]=i,this.int16[s+7]=a,e}}fo.prototype.bytesPerElement=16,sa("StructArrayLayout2f1f2i16",fo);class mo extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,a){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i,a)}emplace(e,t,r,n,i,a,o){const s=16*e,l=4*e,c=8*e;return this.uint8[s+0]=t,this.uint8[s+1]=r,this.float32[l+1]=n,this.float32[l+2]=i,this.int16[c+6]=a,this.int16[c+7]=o,e}}mo.prototype.bytesPerElement=16,sa("StructArrayLayout2ub2f2i16",mo);class go extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.uint16[i+0]=t,this.uint16[i+1]=r,this.uint16[i+2]=n,e}}go.prototype.bytesPerElement=6,sa("StructArrayLayout3ui6",go);class _o extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,a,o,s,l,c,u,h,d,p,f,m,g){const _=this.length;return this.resize(_+1),this.emplace(_,e,t,r,n,i,a,o,s,l,c,u,h,d,p,f,m,g)}emplace(e,t,r,n,i,a,o,s,l,c,u,h,d,p,f,m,g,_){const y=24*e,v=12*e,b=48*e;return this.int16[y+0]=t,this.int16[y+1]=r,this.uint16[y+2]=n,this.uint16[y+3]=i,this.uint32[v+2]=a,this.uint32[v+3]=o,this.uint32[v+4]=s,this.uint16[y+10]=l,this.uint16[y+11]=c,this.uint16[y+12]=u,this.float32[v+7]=h,this.float32[v+8]=d,this.uint8[b+36]=p,this.uint8[b+37]=f,this.uint8[b+38]=m,this.uint32[v+10]=g,this.int16[y+22]=_,e}}_o.prototype.bytesPerElement=48,sa("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",_o);class yo extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,a,o,s,l,c,u,h,d,p,f,m,g,_,y,v,b,x,w,T,S,P,E,C){const M=this.length;return this.resize(M+1),this.emplace(M,e,t,r,n,i,a,o,s,l,c,u,h,d,p,f,m,g,_,y,v,b,x,w,T,S,P,E,C)}emplace(e,t,r,n,i,a,o,s,l,c,u,h,d,p,f,m,g,_,y,v,b,x,w,T,S,P,E,C,M){const k=32*e,I=16*e;return this.int16[k+0]=t,this.int16[k+1]=r,this.int16[k+2]=n,this.int16[k+3]=i,this.int16[k+4]=a,this.int16[k+5]=o,this.int16[k+6]=s,this.int16[k+7]=l,this.uint16[k+8]=c,this.uint16[k+9]=u,this.uint16[k+10]=h,this.uint16[k+11]=d,this.uint16[k+12]=p,this.uint16[k+13]=f,this.uint16[k+14]=m,this.uint16[k+15]=g,this.uint16[k+16]=_,this.uint16[k+17]=y,this.uint16[k+18]=v,this.uint16[k+19]=b,this.uint16[k+20]=x,this.uint16[k+21]=w,this.uint16[k+22]=T,this.uint32[I+12]=S,this.float32[I+13]=P,this.float32[I+14]=E,this.uint16[k+30]=C,this.uint16[k+31]=M,e}}yo.prototype.bytesPerElement=64,sa("StructArrayLayout8i15ui1ul2f2ui64",yo);class vo extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.float32[1*e+0]=t,e}}vo.prototype.bytesPerElement=4,sa("StructArrayLayout1f4",vo);class bo extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.uint16[6*e+0]=t,this.float32[i+1]=r,this.float32[i+2]=n,e}}bo.prototype.bytesPerElement=12,sa("StructArrayLayout1ui2f12",bo);class xo extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=4*e;return this.uint32[2*e+0]=t,this.uint16[i+2]=r,this.uint16[i+3]=n,e}}xo.prototype.bytesPerElement=8,sa("StructArrayLayout1ul2ui8",xo);class wo extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){const r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){const n=2*e;return this.uint16[n+0]=t,this.uint16[n+1]=r,e}}wo.prototype.bytesPerElement=4,sa("StructArrayLayout2ui4",wo);class To extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint16[1*e+0]=t,e}}To.prototype.bytesPerElement=2,sa("StructArrayLayout1ui2",To);class So extends Ka{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){const a=4*e;return this.float32[a+0]=t,this.float32[a+1]=r,this.float32[a+2]=n,this.float32[a+3]=i,e}}So.prototype.bytesPerElement=16,sa("StructArrayLayout4f16",So);class Po extends Ya{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new r(this.anchorPointX,this.anchorPointY)}}Po.prototype.size=20;class Eo extends ho{get(e){return new Po(this,e)}}sa("CollisionBoxArray",Eo);class Co extends Ya{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Co.prototype.size=48;class Mo extends _o{get(e){return new Co(this,e)}}sa("PlacedSymbolArray",Mo);class ko extends Ya{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ko.prototype.size=64;class Io extends yo{get(e){return new ko(this,e)}}sa("SymbolInstanceArray",Io);class Ao extends vo{getoffsetX(e){return this.float32[1*e+0]}}sa("GlyphOffsetArray",Ao);class zo extends to{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}sa("SymbolLineVertexArray",zo);class Do extends Ya{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Do.prototype.size=12;class Lo extends bo{get(e){return new Do(this,e)}}sa("TextAnchorOffsetArray",Lo);class Ro extends Ya{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ro.prototype.size=8;class Fo extends xo{get(e){return new Ro(this,e)}}sa("FeatureIndexArray",Fo);class Bo extends eo{}class Oo extends eo{}class No extends eo{}class Vo extends no{}class jo extends io{}class Uo extends ao{}class Go extends oo{}class qo extends so{}class $o extends lo{}class Zo extends co{}class Ho extends uo{}class Wo extends po{}class Xo extends mo{}class Yo extends go{}class Ko extends wo{}const Qo=Qa([{name:"a_pos",components:2,type:"Int16"}],4),{members:Jo}=Qo;class es{constructor(e=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=e}prepareSegment(e,t,r,n){const i=this.segments[this.segments.length-1];return e>es.MAX_VERTEX_ARRAY_LENGTH&&q(`Max vertices per segment is ${es.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${es.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!i||i.vertexLength+e>es.MAX_VERTEX_ARRAY_LENGTH||i.sortKey!==n?this.createNewSegment(t,r,n):i}createNewSegment(e,t,r){const n={vertexOffset:e.length,primitiveOffset:t.length,vertexLength:0,primitiveLength:0,vaos:{}};return void 0!==r&&(n.sortKey=r),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(n),n}getOrCreateLatestSegment(e,t,r){return this.prepareSegment(0,e,t,r)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const e of this.segments)for(const t in e.vaos)e.vaos[t].destroy()}static simpleSegment(e,t,r,n){return new es([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:n,vaos:{},sortKey:0}])}}function ts(e,t){return 256*(e=F(Math.floor(e),0,255))+F(Math.floor(t),0,255)}es.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,sa("SegmentVector",es);const rs=Qa([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),ns=Qa([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var is,as,os,ss={exports:{}},ls={exports:{}},cs={exports:{}},us=function(){if(os)return ss.exports;os=1;var e=(is||(is=1,ls.exports=function(e,t){var r,n,i,a,o,s,l,c;for(n=e.length-(r=3&e.length),i=t,o=3432918353,s=461845907,c=0;c<n;)l=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,i=27492+(65535&(a=5*(65535&(i=(i^=l=(65535&(l=(l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(a>>>16)&65535)<<16);switch(l=0,r){case 3:l^=(255&e.charCodeAt(c+2))<<16;case 2:l^=(255&e.charCodeAt(c+1))<<8;case 1:i^=l=(65535&(l=(l=(65535&(l^=255&e.charCodeAt(c)))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return i^=e.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}),ls.exports),t=(as||(as=1,cs.exports=function(e,t){for(var r,n=e.length,i=t^n,a=0;n>=4;)r=1540483477*(65535&(r=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24))+((1540483477*(r>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),n-=4,++a;switch(n){case 3:i^=(255&e.charCodeAt(a+2))<<16;case 2:i^=(255&e.charCodeAt(a+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(a)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0}),cs.exports);return ss.exports=e,ss.exports.murmur3=e,ss.exports.murmur2=t,ss.exports}(),hs=n(us);class ds{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,t,r,n){this.ids.push(ps(e)),this.positions.push(t,r,n)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const t=ps(e);let r=0,n=this.ids.length-1;for(;r<n;){const e=r+n>>1;this.ids[e]>=t?n=e:r=e+1}const i=[];for(;this.ids[r]===t;)i.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return i}static serialize(e,t){const r=new Float64Array(e.ids),n=new Uint32Array(e.positions);return fs(r,n,0,r.length-1),t&&t.push(r.buffer,n.buffer),{ids:r,positions:n}}static deserialize(e){const t=new ds;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t}}function ps(e){const t=+e;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:hs(String(e))}function fs(e,t,r,n){for(;r<n;){const i=e[r+n>>1];let a=r-1,o=n+1;for(;;){do{a++}while(e[a]<i);do{o--}while(e[o]>i);if(a>=o)break;ms(e,a,o),ms(t,3*a,3*o),ms(t,3*a+1,3*o+1),ms(t,3*a+2,3*o+2)}o-r<n-o?(fs(e,t,r,o),r=o+1):(fs(e,t,o+1,n),n=o)}}function ms(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}sa("FeaturePositionMap",ds);class gs{constructor(e,t){this.gl=e.gl,this.location=t}}class _s extends gs{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class ys extends gs{constructor(e,t){super(e,t),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class vs extends gs{constructor(e,t){super(e,t),this.current=Et.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const bs=new Float32Array(16);function xs(e){return[ts(255*e.r,255*e.g),ts(255*e.b,255*e.a)]}class ws{constructor(e,t,r){this.value=e,this.uniformNames=t.map(e=>`u_${e}`),this.type=r}setUniform(e,t,r){e.set(r.constantOr(this.value))}getBinding(e,t,r){return"color"===this.type?new vs(e,t):new _s(e,t)}}class Ts{constructor(e,t){this.uniformNames=t.map(e=>`u_${e}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr}setConstantDashPositions(e,t){this.dashTo=[0,e.y,e.height,e.width],this.dashFrom=[0,t.y,t.height,t.width]}setUniform(e,t,r,n){let i=null;"u_pattern_to"===n?i=this.patternTo:"u_pattern_from"===n?i=this.patternFrom:"u_dasharray_to"===n?i=this.dashTo:"u_dasharray_from"===n?i=this.dashFrom:"u_pixel_ratio_to"===n?i=this.pixelRatioTo:"u_pixel_ratio_from"===n&&(i=this.pixelRatioFrom),null!==i&&e.set(i)}getBinding(e,t,r){return"u_pattern"===r.substr(0,9)||"u_dasharray_"===r.substr(0,12)?new ys(e,t):new _s(e,t)}}class Ss{constructor(e,t,r,n){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map(e=>({name:`a_${e}`,type:"Float32",components:"color"===r?2:1,offset:0})),this.paintVertexArray=new n}populatePaintArray(e,t,r){const n=this.paintVertexArray.length,i=this.expression.evaluate(new Ma(0,r),t,{},r.canonical,[],r.formattedSection);this.paintVertexArray.resize(e),this._setPaintValue(n,e,i)}updatePaintArray(e,t,r,n,i){const a=this.expression.evaluate(new Ma(0,i),r,n);this._setPaintValue(e,t,a)}_setPaintValue(e,t,r){if("color"===this.type){const n=xs(r);for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,n[0],n[1])}else{for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ps{constructor(e,t,r,n,i,a){this.expression=e,this.uniformNames=t.map(e=>`u_${e}_t`),this.type=r,this.useIntegerZoom=n,this.zoom=i,this.maxValue=0,this.paintVertexAttributes=t.map(e=>({name:`a_${e}`,type:"Float32",components:"color"===r?4:2,offset:0})),this.paintVertexArray=new a}populatePaintArray(e,t,r){const n=this.expression.evaluate(new Ma(this.zoom,r),t,{},r.canonical,[],r.formattedSection),i=this.expression.evaluate(new Ma(this.zoom+1,r),t,{},r.canonical,[],r.formattedSection),a=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(a,e,n,i)}updatePaintArray(e,t,r,n,i){const a=this.expression.evaluate(new Ma(this.zoom,i),r,n),o=this.expression.evaluate(new Ma(this.zoom+1,i),r,n);this._setPaintValue(e,t,a,o)}_setPaintValue(e,t,r,n){if("color"===this.type){const i=xs(r),a=xs(n);for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,i[0],i[1],a[0],a[1])}else{for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,r,n);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t){const r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,n=F(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(n)}getBinding(e,t,r){return new _s(e,t)}}class Es{constructor(e,t,r,n,i,a){this.expression=e,this.type=t,this.useIntegerZoom=r,this.zoom=n,this.layerId=a,this.zoomInPaintVertexArray=new i,this.zoomOutPaintVertexArray=new i}populatePaintArray(e,t,r){const n=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(n,e,this.getPositionIds(t),r)}updatePaintArray(e,t,r,n,i){this._setPaintValues(e,t,this.getPositionIds(r),i)}_setPaintValues(e,t,r,n){const i=this.getPositions(n);if(!i||!r)return;const a=i[r.min],o=i[r.mid],s=i[r.max];if(a&&o&&s)for(let r=e;r<t;r++)this.emplace(this.zoomInPaintVertexArray,r,o,a),this.emplace(this.zoomOutPaintVertexArray,r,o,s)}upload(e){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const t=this.getVertexAttributes();this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,t,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,t,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Cs extends Es{getPositions(e){return e.imagePositions}getPositionIds(e){return e.patterns&&e.patterns[this.layerId]}getVertexAttributes(){return rs.members}emplace(e,t,r,n){e.emplace(t,r.tlbr[0],r.tlbr[1],r.tlbr[2],r.tlbr[3],n.tlbr[0],n.tlbr[1],n.tlbr[2],n.tlbr[3],r.pixelRatio,n.pixelRatio)}}class Ms extends Es{getPositions(e){return e.dashPositions}getPositionIds(e){return e.dashes&&e.dashes[this.layerId]}getVertexAttributes(){return ns.members}emplace(e,t,r,n){e.emplace(t,0,r.y,r.height,r.width,0,n.y,n.height,n.width)}}class ks{constructor(e,t,r){this.binders={},this._buffers=[];const n=[];for(const i in e.paint._values){if(!r(i))continue;const a=e.paint.get(i);if(!(a instanceof Ba&&jn(a.property.specification)))continue;const o=As(i,e.type),s=a.value,l=a.property.specification.type,c=a.property.useIntegerZoom,u=a.property.specification["property-type"],h="cross-faded"===u||"cross-faded-data-driven"===u;if("constant"===s.kind)this.binders[i]=h?new Ts(s.value,o):new ws(s.value,o,l),n.push(`/u_${i}`);else if("source"===s.kind||h){const r=zs(i,l,"source");this.binders[i]=h?"line-dasharray"===i?new Ms(s,l,c,t,r,e.id):new Cs(s,l,c,t,r,e.id):new Ss(s,o,l,r),n.push(`/a_${i}`)}else{const e=zs(i,l,"composite");this.binders[i]=new Ps(s,o,l,c,t,e),n.push(`/z_${i}`)}}this.cacheKey=n.sort().join("")}getMaxValue(e){const t=this.binders[e];return t instanceof Ss||t instanceof Ps?t.maxValue:0}populatePaintArrays(e,t,r){for(const n in this.binders){const i=this.binders[n];(i instanceof Ss||i instanceof Ps||i instanceof Es)&&i.populatePaintArray(e,t,r)}}setConstantPatternPositions(e,t){for(const r in this.binders){const n=this.binders[r];n instanceof Ts&&n.setConstantPatternPositions(e,t)}}setConstantDashPositions(e,t){for(const r in this.binders){const n=this.binders[r];n instanceof Ts&&n.setConstantDashPositions(e,t)}}updatePaintArrays(e,t,r,n,i){let a=!1;for(const o in e){const s=t.getPositions(o);for(const t of s){const s=r.feature(t.index);for(const r in this.binders){const l=this.binders[r];if((l instanceof Ss||l instanceof Ps||l instanceof Es)&&!0===l.expression.isStateDependent){const c=n.paint.get(r);l.expression=c.value,l.updatePaintArray(t.start,t.end,s,e[o],i),a=!0}}}}return a}defines(){const e=[];for(const t in this.binders){const r=this.binders[t];(r instanceof ws||r instanceof Ts)&&e.push(...r.uniformNames.map(e=>`#define HAS_UNIFORM_${e}`))}return e}getBinderAttributes(){const e=[];for(const t in this.binders){const r=this.binders[t];if(r instanceof Ss||r instanceof Ps)for(let t=0;t<r.paintVertexAttributes.length;t++)e.push(r.paintVertexAttributes[t].name);else if(r instanceof Es){const t=r.getVertexAttributes();for(const r of t)e.push(r.name)}}return e}getBinderUniforms(){const e=[];for(const t in this.binders){const r=this.binders[t];if(r instanceof ws||r instanceof Ts||r instanceof Ps)for(const t of r.uniformNames)e.push(t)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,t){const r=[];for(const n in this.binders){const i=this.binders[n];if(i instanceof ws||i instanceof Ts||i instanceof Ps)for(const a of i.uniformNames)if(t[a]){const o=i.getBinding(e,t[a],a);r.push({name:a,property:n,binding:o})}}return r}setUniforms(e,t,r,n){for(const{name:e,property:i,binding:a}of t)this.binders[i].setUniform(a,n,r.get(i),e)}updatePaintBuffers(e){this._buffers=[];for(const t in this.binders){const r=this.binders[t];if(e&&r instanceof Es){const t=2===e.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;t&&this._buffers.push(t)}else(r instanceof Ss||r instanceof Ps)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(e){for(const t in this.binders){const r=this.binders[t];(r instanceof Ss||r instanceof Ps||r instanceof Es)&&r.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const t=this.binders[e];(t instanceof Ss||t instanceof Ps||t instanceof Es)&&t.destroy()}}}class Is{constructor(e,t,r=()=>!0){this.programConfigurations={};for(const n of e)this.programConfigurations[n.id]=new ks(n,t,r);this.needsUpload=!1,this._featureMap=new ds,this._bufferOffset=0}populatePaintArrays(e,t,r,n){for(const r in this.programConfigurations)this.programConfigurations[r].populatePaintArrays(e,t,n);void 0!==t.id&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,r,n){for(const i of r)this.needsUpload=this.programConfigurations[i.id].updatePaintArrays(e,this._featureMap,t,i,n)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function As(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(`${t}-`,"").replace(/-/g,"_")]}function zs(e,t,r){const n={color:{source:ao,composite:So},number:{source:vo,composite:ao}},i=function(e){return{"line-pattern":{source:Go,composite:Go},"fill-pattern":{source:Go,composite:Go},"fill-extrusion-pattern":{source:Go,composite:Go},"line-dasharray":{source:qo,composite:qo}}[e]}(e);return i&&i[r]||n[t][r]}sa("ConstantBinder",ws),sa("CrossFadedConstantBinder",Ts),sa("SourceExpressionBinder",Ss),sa("CrossFadedPatternBinder",Cs),sa("CrossFadedDasharrayBinder",Ms),sa("CompositeExpressionBinder",Ps),sa("ProgramConfiguration",ks,{omit:["_buffers"]}),sa("ProgramConfigurationSet",Is);const Ds=Math.pow(2,14)-1,Ls=-Ds-1;function Rs(e){const t=k/e.extent,r=e.loadGeometry();for(let e=0;e<r.length;e++){const n=r[e];for(let e=0;e<n.length;e++){const r=n[e],i=Math.round(r.x*t),a=Math.round(r.y*t);r.x=F(i,Ls,Ds),r.y=F(a,Ls,Ds),(i<r.x||i>r.x+1||a<r.y||a>r.y+1)&&q("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function Fs(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?Rs(e):[]}}const Bs=-32768;function Os(e,t,r,n,i){e.emplaceBack(Bs+8*t+n,Bs+8*r+i)}class Ns{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new Oo,this.indexArray=new Yo,this.segments=new es,this.programConfigurations=new Is(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id)}populate(e,t,r){const n=this.layers[0],i=[];let a=null,o=!1,s="heatmap"===n.type;if("circle"===n.type){const e=n;a=e.layout.get("circle-sort-key"),o=!a.isConstant(),s=s||"map"===e.paint.get("circle-pitch-alignment")}const l=s?t.subdivisionGranularity.circle:1;for(const{feature:t,id:n,index:s,sourceLayerIndex:l}of e){const e=this.layers[0]._featureFilter.needGeometry,c=Fs(t,e);if(!this.layers[0]._featureFilter.filter(new Ma(this.zoom),c,r))continue;const u=o?a.evaluate(c,{},r):void 0,h={id:n,properties:t.properties,type:t.type,sourceLayerIndex:l,index:s,geometry:e?c.geometry:Rs(t),patterns:{},sortKey:u};i.push(h)}o&&i.sort((e,t)=>e.sortKey-t.sortKey);for(const n of i){const{geometry:i,index:a,sourceLayerIndex:o}=n,s=e[a].feature;this.addFeature(n,i,a,r,l),t.featureIndex.insert(s,i,a,o,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,{imagePositions:r})}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Jo),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,r,n,i=1){let a;switch(i){case 1:a=[0,7];break;case 3:a=[0,2,5,7];break;case 5:a=[0,1,3,4,6,7];break;case 7:a=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${i}; valid values are 1, 3, 5, 7.`)}const o=a.length;for(const r of t)for(const t of r){const r=t.x,n=t.y;if(r<0||r>=k||n<0||n>=k)continue;const i=this.segments.prepareSegment(o*o,this.layoutVertexArray,this.indexArray,e.sortKey),s=i.vertexLength;for(let e=0;e<o;e++)for(let t=0;t<o;t++)Os(this.layoutVertexArray,r,n,a[t],a[e]);for(let e=0;e<o-1;e++)for(let t=0;t<o-1;t++){const r=s+e*o+t,n=s+(e+1)*o+t;this.indexArray.emplaceBack(r,n+1,r+1),this.indexArray.emplaceBack(r,n,n+1)}i.vertexLength+=o*o,i.primitiveLength+=(o-1)*(o-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{imagePositions:{},canonical:n})}}function Vs(e,t){for(let r=0;r<e.length;r++)if(Xs(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(Xs(e,t[r]))return!0;return!!qs(e,t)}function js(e,t,r){return!!Xs(e,t)||!!Zs(t,e,r)}function Us(e,t){if(1===e.length)return Ws(t,e[0]);for(let r=0;r<t.length;r++){const n=t[r];for(let t=0;t<n.length;t++)if(Xs(e,n[t]))return!0}for(let r=0;r<e.length;r++)if(Ws(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(qs(e,t[r]))return!0;return!1}function Gs(e,t,r){if(e.length>1){if(qs(e,t))return!0;for(let n=0;n<t.length;n++)if(Zs(t[n],e,r))return!0}for(let n=0;n<e.length;n++)if(Zs(e[n],t,r))return!0;return!1}function qs(e,t){if(0===e.length||0===t.length)return!1;for(let r=0;r<e.length-1;r++){const n=e[r],i=e[r+1];for(let e=0;e<t.length-1;e++)if($s(n,i,t[e],t[e+1]))return!0}return!1}function $s(e,t,r,n){return $(e,r,n)!==$(t,r,n)&&$(e,t,r)!==$(e,t,n)}function Zs(e,t,r){const n=r*r;if(1===t.length)return e.distSqr(t[0])<n;for(let r=1;r<t.length;r++)if(Hs(e,t[r-1],t[r])<n)return!0;return!1}function Hs(e,t,r){const n=t.distSqr(r);if(0===n)return e.distSqr(t);const i=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/n;return e.distSqr(i<0?t:i>1?r:r.sub(t)._mult(i)._add(t))}function Ws(e,t){let r,n,i,a=!1;for(let o=0;o<e.length;o++){r=e[o];for(let e=0,o=r.length-1;e<r.length;o=e++)n=r[e],i=r[o],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(a=!a)}return a}function Xs(e,t){let r=!1;for(let n=0,i=e.length-1;n<e.length;i=n++){const a=e[n],o=e[i];a.y>t.y!=o.y>t.y&&t.x<(o.x-a.x)*(t.y-a.y)/(o.y-a.y)+a.x&&(r=!r)}return r}function Ys(e,t,r){const n=r[0],i=r[2];if(e.x<n.x&&t.x<n.x||e.x>i.x&&t.x>i.x||e.y<n.y&&t.y<n.y||e.y>i.y&&t.y>i.y)return!1;const a=$(e,t,r[0]);return a!==$(e,t,r[1])||a!==$(e,t,r[2])||a!==$(e,t,r[3])}function Ks(e,t,r){const n=t.paint.get(e).value;return"constant"===n.kind?n.value:r.programConfigurations.get(t.id).getMaxValue(e)}function Qs(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Js(e,t,n,i,a){if(!t[0]&&!t[1])return e;const o=r.convert(t)._mult(a);"viewport"===n&&o._rotate(-i);const s=[];for(let t=0;t<e.length;t++)s.push(e[t].sub(o));return s}function el({queryGeometry:e,size:t},r){return js(e,r,t)}function tl({queryGeometry:e,size:t,transform:r,unwrappedTileID:n,getElevation:i},a){return js(e,a,t*(r.projectTileCoordinates(a.x,a.y,n,i).signedDistanceFromCamera/r.cameraToCenterDistance))}function rl({queryGeometry:e,size:t,transform:r,unwrappedTileID:n,getElevation:i},a){const o=r.projectTileCoordinates(a.x,a.y,n,i).signedDistanceFromCamera,s=t*(r.cameraToCenterDistance/o);return js(e,al(a,r,n,i),s)}function nl({queryGeometry:e,size:t,transform:r,unwrappedTileID:n,getElevation:i},a){return js(e,al(a,r,n,i),t)}function il({queryGeometry:e,size:t,transform:r,unwrappedTileID:n,getElevation:i,pitchAlignment:a="map",pitchScale:o="map"},s){const l="map"===a?"map"===o?el:tl:"map"===o?rl:nl,c={queryGeometry:e,size:t,transform:r,unwrappedTileID:n,getElevation:i};for(const e of s)for(const t of e)if(l(c,t))return!0;return!1}function al(e,t,n,i){const a=t.projectTileCoordinates(e.x,e.y,n,i).point;return new r((.5*a.x+.5)*t.width,(.5*-a.y+.5)*t.height)}let ol,sl;sa("CircleBucket",Ns,{omit:["layers"]});var ll={get paint(){return sl=sl||new qa({"circle-radius":new Va(ye.paint_circle["circle-radius"]),"circle-color":new Va(ye.paint_circle["circle-color"]),"circle-blur":new Va(ye.paint_circle["circle-blur"]),"circle-opacity":new Va(ye.paint_circle["circle-opacity"]),"circle-translate":new Na(ye.paint_circle["circle-translate"]),"circle-translate-anchor":new Na(ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Na(ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Na(ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Va(ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Va(ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Va(ye.paint_circle["circle-stroke-opacity"])})},get layout(){return ol=ol||new qa({"circle-sort-key":new Va(ye.layout_circle["circle-sort-key"])})}};class cl extends $a{constructor(e,t){super(e,ll,t)}createBucket(e){return new Ns(e)}queryRadius(e){const t=e;return Ks("circle-radius",this,t)+Ks("circle-stroke-width",this,t)+Qs(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:e,feature:t,featureState:r,geometry:n,transform:i,pixelsToTileUnits:a,unwrappedTileID:o,getElevation:s}){const l=Js(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-i.bearingInRadians,a),c=this.paint.get("circle-radius").evaluate(t,r)+this.paint.get("circle-stroke-width").evaluate(t,r),u=this.paint.get("circle-pitch-scale"),h=this.paint.get("circle-pitch-alignment");let d,p;return"map"===h?(d=l,p=c*a):(d=function(e,t,r,n){return e.map(e=>al(e,t,r,n))}(l,i,o,s),p=c),il({queryGeometry:d,size:p,transform:i,unwrappedTileID:o,getElevation:s,pitchAlignment:h,pitchScale:u},n)}}class ul extends Ns{}let hl;sa("HeatmapBucket",ul,{omit:["layers"]});var dl={get paint(){return hl=hl||new qa({"heatmap-radius":new Va(ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Va(ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Na(ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ga(ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Na(ye.paint_heatmap["heatmap-opacity"])})}};function pl(e,{width:t,height:r},n,i){if(i){if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==t*r*n)throw new RangeError(`mismatched image size. expected: ${i.length} but got: ${t*r*n}`)}else i=new Uint8Array(t*r*n);return e.width=t,e.height=r,e.data=i,e}function fl(e,{width:t,height:r},n){if(t===e.width&&r===e.height)return;const i=pl({},{width:t,height:r},n);ml(e,i,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,t),height:Math.min(e.height,r)},n),e.width=t,e.height=r,e.data=i.data}function ml(e,t,r,n,i,a){if(0===i.width||0===i.height)return t;if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range destination coordinates for image copy");const o=e.data,s=t.data;if(o===s)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<i.height;l++){const c=((r.y+l)*e.width+r.x)*a,u=((n.y+l)*t.width+n.x)*a;for(let e=0;e<i.width*a;e++)s[u+e]=o[c+e]}return t}class gl{constructor(e,t){pl(this,e,1,t)}resize(e){fl(this,e,1)}clone(){return new gl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,n,i){ml(e,t,r,n,i,1)}}class _l{constructor(e,t){pl(this,e,4,t)}resize(e){fl(this,e,4)}replace(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new _l({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,n,i){ml(e,t,r,n,i,4)}setPixel(e,t,r){const n=4*(e*this.width+t);this.data[n+0]=Math.round(255*r.r/r.a),this.data[n+1]=Math.round(255*r.g/r.a),this.data[n+2]=Math.round(255*r.b/r.a),this.data[n+3]=Math.round(255*r.a)}}function yl(e){const t={},r=e.resolution||256,n=e.clips?e.clips.length:1,i=e.image||new _l({width:r,height:n});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);const a=(n,a,o)=>{t[e.evaluationKey]=o;const s=e.expression.evaluate(t);i.setPixel(n/4/r,a/4,s)};if(e.clips)for(let t=0,i=0;t<n;++t,i+=4*r)for(let n=0,o=0;n<r;n++,o+=4){const s=n/(r-1),{start:l,end:c}=e.clips[t];a(i,o,l*(1-s)+c*s)}else for(let e=0,t=0;e<r;e++,t+=4)a(0,t,e/(r-1));return i}sa("AlphaImage",gl),sa("RGBAImage",_l);const vl="big-fb";class bl extends $a{createBucket(e){return new ul(e)}constructor(e,t){super(e,dl,t),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"heatmap-color"===e&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=yl({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(vl)&&this.heatmapFbos.delete(vl)}queryRadius(e){return Ks("heatmap-radius",this,e)}queryIntersectsFeature({queryGeometry:e,feature:t,featureState:r,geometry:n,transform:i,pixelsToTileUnits:a,unwrappedTileID:o,getElevation:s}){return il({queryGeometry:e,size:this.paint.get("heatmap-radius").evaluate(t,r)*a,transform:i,unwrappedTileID:o,getElevation:s},n)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}}let xl;var wl={get paint(){return xl=xl||new qa({"hillshade-illumination-direction":new Na(ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Na(ye.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Na(ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Na(ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Na(ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Na(ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Na(ye.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Na(ye.paint_hillshade["hillshade-method"])})}};class Tl extends $a{constructor(e,t){super(e,wl,t),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let e=this.paint.get("hillshade-illumination-direction").values,t=this.paint.get("hillshade-illumination-altitude").values,r=this.paint.get("hillshade-highlight-color").values,n=this.paint.get("hillshade-shadow-color").values;const i=Math.max(e.length,t.length,r.length,n.length);e=e.concat(Array(i-e.length).fill(e.at(-1))),t=t.concat(Array(i-t.length).fill(t.at(-1))),r=r.concat(Array(i-r.length).fill(r.at(-1))),n=n.concat(Array(i-n.length).fill(n.at(-1)));const a=t.map(ee);return{directionRadians:e.map(ee),altitudeRadians:a,shadowColor:n,highlightColor:r}}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}}let Sl;var Pl={get paint(){return Sl=Sl||new qa({"color-relief-opacity":new Na(ye["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Ga(ye["paint_color-relief"]["color-relief-color"])})}};class El{constructor(e,t,r,n){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,n)}update(e,t,r){const{width:n,height:i}=e,a=!(this.size&&this.size[0]===n&&this.size[1]===i||r),{context:o}=this,{gl:s}=o;if(this.useMipmap=Boolean(t&&t.useMipmap),s.bindTexture(s.TEXTURE_2D,this.texture),o.pixelStoreUnpackFlipY.set(!1),o.pixelStoreUnpack.set(1),o.pixelStoreUnpackPremultiplyAlpha.set(this.format===s.RGBA&&(!t||!1!==t.premultiply)),a)this.size=[n,i],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||W(e)?s.texImage2D(s.TEXTURE_2D,0,this.format,this.format,s.UNSIGNED_BYTE,e):s.texImage2D(s.TEXTURE_2D,0,this.format,n,i,0,this.format,s.UNSIGNED_BYTE,e.data);else{const{x:t,y:a}=r||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||W(e)?s.texSubImage2D(s.TEXTURE_2D,0,t,a,s.RGBA,s.UNSIGNED_BYTE,e):s.texSubImage2D(s.TEXTURE_2D,0,t,a,n,i,s.RGBA,s.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&s.generateMipmap(s.TEXTURE_2D),o.pixelStoreUnpackFlipY.setDefault(),o.pixelStoreUnpack.setDefault(),o.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,t,r){const{context:n}=this,{gl:i}=n;i.bindTexture(i.TEXTURE_2D,this.texture),r!==i.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=i.LINEAR),e!==this.filter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,t),this.wrap=t)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class Cl{constructor(e,t,r,n=1,i=1,a=1,o=0){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(r&&!["mapbox","terrarium","custom"].includes(r))return void q(`"${r}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=t.height;const s=this.dim=t.height-2;switch(this.data=new Uint32Array(t.data.buffer),r){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=n,this.greenFactor=i,this.blueFactor=a,this.baseShift=o;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let e=0;e<s;e++)this.data[this._idx(-1,e)]=this.data[this._idx(0,e)],this.data[this._idx(s,e)]=this.data[this._idx(s-1,e)],this.data[this._idx(e,-1)]=this.data[this._idx(e,0)],this.data[this._idx(e,s)]=this.data[this._idx(e,s-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(s,-1)]=this.data[this._idx(s-1,0)],this.data[this._idx(-1,s)]=this.data[this._idx(0,s-1)],this.data[this._idx(s,s)]=this.data[this._idx(s-1,s-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let e=0;e<s;e++)for(let t=0;t<s;t++){const r=this.get(e,t);r>this.max&&(this.max=r),r<this.min&&(this.min=r)}}get(e,t){const r=new Uint8Array(this.data.buffer),n=4*this._idx(e,t);return this.unpack(r[n],r[n+1],r[n+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}unpack(e,t,r){return e*this.redFactor+t*this.greenFactor+r*this.blueFactor-this.baseShift}pack(e){return Ml(e,this.getUnpackVector())}getPixels(){return new _l({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let n=t*this.dim,i=t*this.dim+this.dim,a=r*this.dim,o=r*this.dim+this.dim;switch(t){case-1:n=i-1;break;case 1:i=n+1}switch(r){case-1:a=o-1;break;case 1:o=a+1}const s=-t*this.dim,l=-r*this.dim;for(let t=a;t<o;t++)for(let r=n;r<i;r++)this.data[this._idx(r,t)]=e.data[this._idx(r+s,t+l)]}}function Ml(e,t){const r=t[0],n=t[1],i=t[2],a=t[3],o=Math.min(r,n,i),s=Math.round((e+a)/o);return{r:Math.floor(s*o/r)%256,g:Math.floor(s*o/n)%256,b:Math.floor(s*o/i)%256}}sa("DEMData",Cl);class kl extends $a{constructor(e,t){super(e,Pl,t)}_createColorRamp(e){const t={elevationStops:[],colorStops:[]},r=this._transitionablePaint._values["color-relief-color"].value.expression;if(r instanceof ri&&r._styleExpression.expression instanceof hr){this.colorRampExpression=r;const e=r._styleExpression.expression;t.elevationStops=e.labels,t.colorStops=[];for(const r of t.elevationStops)t.colorStops.push(e.evaluate({globals:{elevation:r}}))}if(t.elevationStops.length<1&&(t.elevationStops=[0],t.colorStops=[Et.transparent]),t.elevationStops.length<2&&(t.elevationStops.push(t.elevationStops[0]+1),t.colorStops.push(t.colorStops[0])),t.elevationStops.length<=e)return t;const n={elevationStops:[],colorStops:[]},i=(t.elevationStops.length-1)/(e-1);for(let e=0;e<t.elevationStops.length-.5;e+=i)n.elevationStops.push(t.elevationStops[Math.round(e)]),n.colorStops.push(t.colorStops[Math.round(e)]);return q(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${e}, provided: ${t.elevationStops.length}`),n}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(e,t,r){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const n=this._createColorRamp(t),i=new _l({width:n.colorStops.length,height:1}),a=new _l({width:n.colorStops.length,height:1});for(let e=0;e<n.elevationStops.length;e++){const t=Ml(n.elevationStops[e],r);a.setPixel(0,e,new Et(t.r/255,t.g/255,t.b/255,1)),i.setPixel(0,e,n.colorStops[e])}return this.colorRampTextures={elevationTexture:new El(e,a,e.gl.RGBA),colorTexture:new El(e,i,e.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return"none"!==this.visibility&&!!this.colorRampTextures}}const Il=Qa([{name:"a_pos",components:2,type:"Int16"}],4),{members:Al}=Il;function zl(e,t,r){const n=r.patternDependencies;let i=!1;for(const r of t){const t=r.paint.get(`${e}-pattern`);t.isConstant()||(i=!0);const a=t.constantOr(null);a&&(i=!0,n[a.to]=!0,n[a.from]=!0)}return i}function Dl(e,t,r,n,i){const{zoom:a}=n,o=i.patternDependencies;for(const n of t){const t=n.paint.get(`${e}-pattern`).value;if("constant"!==t.kind){let e=t.evaluate({zoom:a-1},r,{},i.availableImages),s=t.evaluate({zoom:a},r,{},i.availableImages),l=t.evaluate({zoom:a+1},r,{},i.availableImages);e=e&&e.name?e.name:e,s=s&&s.name?s.name:s,l=l&&l.name?l.name:l,o[e]=!0,o[s]=!0,o[l]=!0,r.patterns[n.id]={min:e,mid:s,max:l}}}return r}function Ll(e,t,r,n,i){let a;if(i===function(e,t,r,n){let i=0;for(let a=t,o=r-n;a<r;a+=n)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}(e,t,r,n)>0)for(let i=t;i<r;i+=n)a=rc(i/n|0,e[i],e[i+1],a);else for(let i=r-n;i>=t;i-=n)a=rc(i/n|0,e[i],e[i+1],a);return a&&Yl(a,a.next)&&(nc(a),a=a.next),a}function Rl(e,t){if(!e)return e;t||(t=e);let r,n=e;do{if(r=!1,n.steiner||!Yl(n,n.next)&&0!==Xl(n.prev,n,n.next))n=n.next;else{if(nc(n),n=t=n.prev,n===n.next)break;r=!0}}while(r||n!==t);return t}function Fl(e,t,r,n,i,a,o){if(!e)return;!o&&a&&function(e,t,r,n){let i=e;do{0===i.z&&(i.z=ql(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){let t,r=1;do{let n,i=e;e=null;let a=null;for(t=0;i;){t++;let o=i,s=0;for(let e=0;e<r&&(s++,o=o.nextZ,o);e++);let l=r;for(;s>0||l>0&&o;)0!==s&&(0===l||!o||i.z<=o.z)?(n=i,i=i.nextZ,s--):(n=o,o=o.nextZ,l--),a?a.nextZ=n:e=n,n.prevZ=a,a=n;i=o}a.nextZ=null,r*=2}while(t>1)}(i)}(e,n,i,a);let s=e;for(;e.prev!==e.next;){const l=e.prev,c=e.next;if(a?Ol(e,n,i,a):Bl(e))t.push(l.i,e.i,c.i),nc(e),e=c.next,s=c.next;else if((e=c)===s){o?1===o?Fl(e=Nl(Rl(e),t),t,r,n,i,a,2):2===o&&Vl(e,t,r,n,i,a):Fl(Rl(e),t,r,n,i,a,1);break}}}function Bl(e){const t=e.prev,r=e,n=e.next;if(Xl(t,r,n)>=0)return!1;const i=t.x,a=r.x,o=n.x,s=t.y,l=r.y,c=n.y,u=Math.min(i,a,o),h=Math.min(s,l,c),d=Math.max(i,a,o),p=Math.max(s,l,c);let f=n.next;for(;f!==t;){if(f.x>=u&&f.x<=d&&f.y>=h&&f.y<=p&&Hl(i,s,a,l,o,c,f.x,f.y)&&Xl(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Ol(e,t,r,n){const i=e.prev,a=e,o=e.next;if(Xl(i,a,o)>=0)return!1;const s=i.x,l=a.x,c=o.x,u=i.y,h=a.y,d=o.y,p=Math.min(s,l,c),f=Math.min(u,h,d),m=Math.max(s,l,c),g=Math.max(u,h,d),_=ql(p,f,t,r,n),y=ql(m,g,t,r,n);let v=e.prevZ,b=e.nextZ;for(;v&&v.z>=_&&b&&b.z<=y;){if(v.x>=p&&v.x<=m&&v.y>=f&&v.y<=g&&v!==i&&v!==o&&Hl(s,u,l,h,c,d,v.x,v.y)&&Xl(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==i&&b!==o&&Hl(s,u,l,h,c,d,b.x,b.y)&&Xl(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;v&&v.z>=_;){if(v.x>=p&&v.x<=m&&v.y>=f&&v.y<=g&&v!==i&&v!==o&&Hl(s,u,l,h,c,d,v.x,v.y)&&Xl(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;b&&b.z<=y;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==i&&b!==o&&Hl(s,u,l,h,c,d,b.x,b.y)&&Xl(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function Nl(e,t){let r=e;do{const n=r.prev,i=r.next.next;!Yl(n,i)&&Kl(n,r,r.next,i)&&ec(n,i)&&ec(i,n)&&(t.push(n.i,r.i,i.i),nc(r),nc(r.next),r=e=i),r=r.next}while(r!==e);return Rl(r)}function Vl(e,t,r,n,i,a){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.i!==e.i&&Wl(o,e)){let s=tc(o,e);return o=Rl(o,o.next),s=Rl(s,s.next),Fl(o,t,r,n,i,a,0),void Fl(s,t,r,n,i,a,0)}e=e.next}o=o.next}while(o!==e)}function jl(e,t){let r=e.x-t.x;return 0===r&&(r=e.y-t.y,0===r)&&(r=(e.next.y-e.y)/(e.next.x-e.x)-(t.next.y-t.y)/(t.next.x-t.x)),r}function Ul(e,t){const r=function(e,t){let r=t;const n=e.x,i=e.y;let a,o=-1/0;if(Yl(e,r))return r;do{if(Yl(e,r.next))return r.next;if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){const e=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(e<=n&&e>o&&(o=e,a=r.x<r.next.x?r:r.next,e===n))return a}r=r.next}while(r!==t);if(!a)return null;const s=a,l=a.x,c=a.y;let u=1/0;r=a;do{if(n>=r.x&&r.x>=l&&n!==r.x&&Zl(i<c?n:o,i,l,c,i<c?o:n,i,r.x,r.y)){const t=Math.abs(i-r.y)/(n-r.x);ec(r,e)&&(t<u||t===u&&(r.x>a.x||r.x===a.x&&Gl(a,r)))&&(a=r,u=t)}r=r.next}while(r!==s);return a}(e,t);if(!r)return t;const n=tc(r,e);return Rl(n,n.next),Rl(r,r.next)}function Gl(e,t){return Xl(e.prev,e,t.prev)<0&&Xl(t.next,e,e.next)<0}function ql(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function $l(e){let t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function Zl(e,t,r,n,i,a,o,s){return(i-o)*(t-s)>=(e-o)*(a-s)&&(e-o)*(n-s)>=(r-o)*(t-s)&&(r-o)*(a-s)>=(i-o)*(n-s)}function Hl(e,t,r,n,i,a,o,s){return!(e===o&&t===s)&&Zl(e,t,r,n,i,a,o,s)}function Wl(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&Kl(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(ec(e,t)&&ec(t,e)&&function(e,t){let r=e,n=!1;const i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(Xl(e.prev,e,t.prev)||Xl(e,t.prev,t))||Yl(e,t)&&Xl(e.prev,e,e.next)>0&&Xl(t.prev,t,t.next)>0)}function Xl(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Yl(e,t){return e.x===t.x&&e.y===t.y}function Kl(e,t,r,n){const i=Jl(Xl(e,t,r)),a=Jl(Xl(e,t,n)),o=Jl(Xl(r,n,e)),s=Jl(Xl(r,n,t));return i!==a&&o!==s||!(0!==i||!Ql(e,r,t))||!(0!==a||!Ql(e,n,t))||!(0!==o||!Ql(r,e,n))||!(0!==s||!Ql(r,t,n))}function Ql(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Jl(e){return e>0?1:e<0?-1:0}function ec(e,t){return Xl(e.prev,e,e.next)<0?Xl(e,t,e.next)>=0&&Xl(e,e.prev,t)>=0:Xl(e,t,e.prev)<0||Xl(e,e.next,t)<0}function tc(e,t){const r=ic(e.i,e.x,e.y),n=ic(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function rc(e,t,r,n){const i=ic(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function nc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function ic(e,t,r){return{i:e,x:t,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class ac{constructor(e,t){if(t>e)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=e,this._minGranularity=t}getGranularityForZoomLevel(e){return Math.max(Math.floor(this._baseZoomGranularity/(1<<e)),this._minGranularity,1)}}class oc{constructor(e){this.fill=e.fill,this.line=e.line,this.tile=e.tile,this.stencil=e.stencil,this.circle=e.circle}}oc.noSubdivision=new oc({fill:new ac(0,0),line:new ac(0,0),tile:new ac(0,0),stencil:new ac(0,0),circle:1}),sa("SubdivisionGranularityExpression",ac),sa("SubdivisionGranularitySetting",oc);const sc=-32768,lc=32767;class cc{constructor(e,t){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=e,this._granularityCellSize=k/e,this._canonical=t}_getKey(e,t){return(e+=32768)<<16|t+32768}_vertexToIndex(e,t){if(e<-32768||t<-32768||e>32767||t>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const r=0|Math.round(e),n=0|Math.round(t),i=this._getKey(r,n);if(this._vertexDictionary.has(i))return this._vertexDictionary.get(i);const a=this._vertexBuffer.length/2;return this._vertexDictionary.set(i,a),this._vertexBuffer.push(r,n),a}_subdivideTrianglesScanline(e){if(this._granularity<2)return function(e,t){const r=[];for(let n=0;n<t.length;n+=3){const i=t[n],a=t[n+1],o=t[n+2],s=e[2*i],l=e[2*i+1];(e[2*a]-s)*(e[2*o+1]-l)-(e[2*a+1]-l)*(e[2*o]-s)>0?(r.push(i),r.push(o),r.push(a)):(r.push(i),r.push(a),r.push(o))}return r}(this._vertexBuffer,e);const t=[],r=e.length;for(let n=0;n<r;n+=3){const r=[e[n+0],e[n+1],e[n+2]],i=[this._vertexBuffer[2*e[n+0]+0],this._vertexBuffer[2*e[n+0]+1],this._vertexBuffer[2*e[n+1]+0],this._vertexBuffer[2*e[n+1]+1],this._vertexBuffer[2*e[n+2]+0],this._vertexBuffer[2*e[n+2]+1]];let a=1/0,o=1/0,s=-1/0,l=-1/0;for(let e=0;e<3;e++){const t=i[2*e],r=i[2*e+1];a=Math.min(a,t),s=Math.max(s,t),o=Math.min(o,r),l=Math.max(l,r)}if(a===s||o===l)continue;const c=Math.floor(a/this._granularityCellSize),u=Math.ceil(s/this._granularityCellSize),h=Math.floor(o/this._granularityCellSize),d=Math.ceil(l/this._granularityCellSize);if(c!==u||h!==d)for(let e=h;e<d;e++){const n=this._scanlineGenerateVertexRingForCellRow(e,i,r);dc(this._vertexBuffer,n,t)}else t.push(...r)}return t}_scanlineGenerateVertexRingForCellRow(e,t,r){const n=e*this._granularityCellSize,i=n+this._granularityCellSize,a=[];for(let e=0;e<3;e++){const o=t[2*e],s=t[2*e+1],l=t[2*(e+1)%6],c=t[(2*(e+1)+1)%6],u=t[2*(e+2)%6],h=t[(2*(e+2)+1)%6],d=l-o,p=c-s,f=0===d,m=0===p,g=(n-s)/p,_=(i-s)/p,y=Math.min(g,_),v=Math.max(g,_);if(!m&&(y>=1||v<=0)||m&&(s<n||s>i)){c>=n&&c<=i&&a.push(r[(e+1)%3]);continue}!m&&y>0&&a.push(this._vertexToIndex(o+d*y,s+p*y));const b=o+d*Math.max(y,0),x=o+d*Math.min(v,1);f||this._generateIntraEdgeVertices(a,o,s,l,c,b,x),!m&&v<1&&a.push(this._vertexToIndex(o+d*v,s+p*v)),(m||c>=n&&c<=i)&&a.push(r[(e+1)%3]),!m&&(c<=n||c>=i)&&this._generateInterEdgeVertices(a,o,s,l,c,u,h,x,n,i)}return a}_generateIntraEdgeVertices(e,t,r,n,i,a,o){const s=n-t,l=i-r,c=0===l,u=c?Math.min(t,n):Math.min(a,o),h=c?Math.max(t,n):Math.max(a,o),d=Math.floor(u/this._granularityCellSize)+1,p=Math.ceil(h/this._granularityCellSize)-1;if(c?t<n:a<o)for(let n=d;n<=p;n++){const i=n*this._granularityCellSize;e.push(this._vertexToIndex(i,r+l*(i-t)/s))}else for(let n=p;n>=d;n--){const i=n*this._granularityCellSize;e.push(this._vertexToIndex(i,r+l*(i-t)/s))}}_generateInterEdgeVertices(e,t,r,n,i,a,o,s,l,c){const u=i-r,h=a-n,d=o-i,p=(l-i)/d,f=(c-i)/d,m=Math.min(p,f),g=Math.max(p,f),_=n+h*m;let y=Math.floor(Math.min(_,s)/this._granularityCellSize)+1,v=Math.ceil(Math.max(_,s)/this._granularityCellSize)-1,b=s<_;const x=0===d;if(x&&(o===l||o===c))return;if(x||m>=1||g<=0){const e=r-o,n=a+(t-a)*Math.min((l-o)/e,(c-o)/e);y=Math.floor(Math.min(n,s)/this._granularityCellSize)+1,v=Math.ceil(Math.max(n,s)/this._granularityCellSize)-1,b=s<n}const w=u>0?c:l;if(b)for(let t=y;t<=v;t++)e.push(this._vertexToIndex(t*this._granularityCellSize,w));else for(let t=v;t>=y;t--)e.push(this._vertexToIndex(t*this._granularityCellSize,w))}_generateOutline(e){const t=[];for(const r of e){const e=hc(r,this._granularity,!0),n=this._pointArrayToIndices(e),i=[];for(let e=1;e<n.length;e++)i.push(n[e-1]),i.push(n[e]);t.push(i)}return t}_handlePoles(e){let t=!1,r=!1;this._canonical&&(0===this._canonical.y&&(t=!0),this._canonical.y===(1<<this._canonical.z)-1&&(r=!0)),(t||r)&&this._fillPoles(e,t,r)}_ensureNoPoleVertices(){const e=this._vertexBuffer;for(let t=0;t<e.length;t+=2){const r=e[t+1];r===sc&&(e[t+1]=-32767),r===lc&&(e[t+1]=32766)}}_generatePoleQuad(e,t,r,n,i,a){n>i!=(a===sc)?(e.push(t),e.push(r),e.push(this._vertexToIndex(n,a)),e.push(r),e.push(this._vertexToIndex(i,a)),e.push(this._vertexToIndex(n,a))):(e.push(r),e.push(t),e.push(this._vertexToIndex(n,a)),e.push(this._vertexToIndex(i,a)),e.push(r),e.push(this._vertexToIndex(n,a)))}_fillPoles(e,t,r){const n=this._vertexBuffer,i=k,a=e.length;for(let o=2;o<a;o+=3){const a=e[o-2],s=e[o-1],l=e[o],c=n[2*a],u=n[2*a+1],h=n[2*s],d=n[2*s+1],p=n[2*l],f=n[2*l+1];t&&(0===u&&0===d&&this._generatePoleQuad(e,a,s,c,h,sc),0===d&&0===f&&this._generatePoleQuad(e,s,l,h,p,sc),0===f&&0===u&&this._generatePoleQuad(e,l,a,p,c,sc)),r&&(u===i&&d===i&&this._generatePoleQuad(e,a,s,c,h,lc),d===i&&f===i&&this._generatePoleQuad(e,s,l,h,p,lc),f===i&&u===i&&this._generatePoleQuad(e,l,a,p,c,lc))}}_initializeVertices(e){for(let t=0;t<e.length;t+=2)this._vertexToIndex(e[t],e[t+1])}subdividePolygonInternal(e,t){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:r,holeIndices:n}=function(e){const t=[],r=[];for(const n of e)if(0!==n.length){n!==e[0]&&t.push(r.length/2);for(let e=0;e<n.length;e++)r.push(n[e].x),r.push(n[e].y)}return{flattened:r,holeIndices:t}}(e);let i;this._initializeVertices(r);try{const e=function(e,t,r=2){const n=t&&t.length,i=n?t[0]*r:e.length;let a=Ll(e,0,i,r,!0);const o=[];if(!a||a.next===a.prev)return o;let s,l,c;if(n&&(a=function(e,t,r,n){const i=[];for(let r=0,a=t.length;r<a;r++){const o=Ll(e,t[r]*n,r<a-1?t[r+1]*n:e.length,n,!1);o===o.next&&(o.steiner=!0),i.push($l(o))}i.sort(jl);for(let e=0;e<i.length;e++)r=Ul(i[e],r);return r}(e,t,a,r)),e.length>80*r){s=e[0],l=e[1];let t=s,n=l;for(let a=r;a<i;a+=r){const r=e[a],i=e[a+1];r<s&&(s=r),i<l&&(l=i),r>t&&(t=r),i>n&&(n=i)}c=Math.max(t-s,n-l),c=0!==c?32767/c:0}return Fl(a,o,r,s,l,c,0),o}(r,n),t=this._convertIndices(r,e);i=this._subdivideTrianglesScanline(t)}catch(e){console.error(e)}let a=[];return t&&(a=this._generateOutline(e)),this._ensureNoPoleVertices(),this._handlePoles(i),{verticesFlattened:this._vertexBuffer,indicesTriangles:i,indicesLineList:a}}_convertIndices(e,t){const r=[];for(let n=0;n<t.length;n++)r.push(this._vertexToIndex(e[2*t[n]],e[2*t[n]+1]));return r}_pointArrayToIndices(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r];t.push(this._vertexToIndex(n.x,n.y))}return t}}function uc(e,t,r,n=!0){return new cc(r,t).subdividePolygonInternal(e,n)}function hc(e,t,n=!1){if(!e||e.length<1)return[];if(e.length<2)return[];const i=e[0],a=e[e.length-1],o=n&&(i.x!==a.x||i.y!==a.y);if(t<2)return o?[...e,e[0]]:[...e];const s=Math.floor(k/t),l=[];l.push(new r(e[0].x,e[0].y));const c=e.length,u=o?c:c-1;for(let t=0;t<u;t++){const n=e[t],i=t<c-1?e[t+1]:e[0],a=n.x,o=n.y,u=i.x,h=i.y,d=a!==u,p=o!==h;if(!d&&!p)continue;const f=u-a,m=h-o,g=Math.abs(f),_=Math.abs(m);let y=a,v=o;for(;;){const e=f>0?(Math.floor(y/s)+1)*s:(Math.ceil(y/s)-1)*s,t=m>0?(Math.floor(v/s)+1)*s:(Math.ceil(v/s)-1)*s,n=Math.abs(y-e),i=Math.abs(v-t),a=Math.abs(y-u),o=Math.abs(v-h),c=d?n/g:Number.POSITIVE_INFINITY,b=p?i/_:Number.POSITIVE_INFINITY;if((a<=n||!d)&&(o<=i||!p))break;if(c<b&&d||!p){y=e,v+=m*c;const t=new r(y,Math.round(v));l[l.length-1].x===t.x&&l[l.length-1].y===t.y||l.push(t)}else{y+=f*b,v=t;const e=new r(Math.round(y),v);l[l.length-1].x===e.x&&l[l.length-1].y===e.y||l.push(e)}}const b=new r(u,h);l[l.length-1].x===b.x&&l[l.length-1].y===b.y||l.push(b)}return l}function dc(e,t,r){if(0===t.length)throw new Error("Subdivision vertex ring is empty.");let n=0,i=e[2*t[0]];for(let r=1;r<t.length;r++){const a=e[2*t[r]];a<i&&(i=a,n=r)}const a=t.length;let o=n,s=(o+1)%a;for(;;){const n=o-1>=0?o-1:a-1,i=(s+1)%a,l=e[2*t[n]],c=e[2*t[i]],u=e[2*t[o]],h=e[2*t[o]+1],d=e[2*t[s]+1];let p=!1;if(l<c)p=!0;else if(l>c)p=!1;else{const r=d-h,a=-(e[2*t[s]]-u),o=h<d?1:-1;((l-u)*r+(e[2*t[n]+1]-h)*a)*o>((c-u)*r+(e[2*t[i]+1]-h)*a)*o&&(p=!0)}if(p){const e=t[n],i=t[o],l=t[s];e!==i&&e!==l&&i!==l&&r.push(l,i,e),o--,o<0&&(o=a-1)}else{const e=t[i],n=t[o],l=t[s];e!==n&&e!==l&&n!==l&&r.push(l,n,e),s++,s>=a&&(s=0)}if(n===i)break}}function pc(e,t,r,n,i,a,o,s,l){const c=i.length/2,u=o&&s&&l;if(c<es.MAX_VERTEX_ARRAY_LENGTH){const h=t.prepareSegment(c,r,n),d=h.vertexLength;for(let e=0;e<a.length;e+=3)n.emplaceBack(d+a[e],d+a[e+1],d+a[e+2]);let p,f;h.vertexLength+=c,h.primitiveLength+=a.length/3,u&&(f=o.prepareSegment(c,r,s),p=f.vertexLength,f.vertexLength+=c);for(let t=0;t<i.length;t+=2)e(i[t],i[t+1]);if(u)for(let e=0;e<l.length;e++){const t=l[e];for(let e=1;e<t.length;e+=2)s.emplaceBack(p+t[e-1],p+t[e]);f.primitiveLength+=t.length/2}}else!function(e,t,r,n,i,a){const o=[];for(let e=0;e<n.length/2;e++)o.push(-1);const s={count:0};let l=0,c=e.getOrCreateLatestSegment(t,r),u=c.vertexLength;for(let h=2;h<i.length;h+=3){const d=i[h-2],p=i[h-1],f=i[h];let m=o[d]<l,g=o[p]<l,_=o[f]<l;c.vertexLength+((m?1:0)+(g?1:0)+(_?1:0))>es.MAX_VERTEX_ARRAY_LENGTH&&(c=e.createNewSegment(t,r),l=s.count,m=!0,g=!0,_=!0,u=0);const y=fc(o,n,a,s,d,m,c),v=fc(o,n,a,s,p,g,c),b=fc(o,n,a,s,f,_,c);r.emplaceBack(u+y-l,u+v-l,u+b-l),c.primitiveLength++}}(t,r,n,i,a,e),u&&function(e,t,r,n,i,a){const o=[];for(let e=0;e<n.length/2;e++)o.push(-1);const s={count:0};let l=0,c=e.getOrCreateLatestSegment(t,r),u=c.vertexLength;for(let h=0;h<i.length;h++){const d=i[h];for(let p=1;p<i[h].length;p+=2){const i=d[p-1],h=d[p];let f=o[i]<l,m=o[h]<l;c.vertexLength+((f?1:0)+(m?1:0))>es.MAX_VERTEX_ARRAY_LENGTH&&(c=e.createNewSegment(t,r),l=s.count,f=!0,m=!0,u=0);const g=fc(o,n,a,s,i,f,c),_=fc(o,n,a,s,h,m,c);r.emplaceBack(u+g-l,u+_-l),c.primitiveLength++}}}(o,r,s,i,l,e),t.forceNewSegmentOnNextPrepare(),null==o||o.forceNewSegmentOnNextPrepare()}function fc(e,t,r,n,i,a,o){if(a){const a=n.count;return r(t[2*i],t[2*i+1]),e[i]=n.count,n.count++,o.vertexLength++,a}return e[i]}class mc{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new No,this.indexArray=new Yo,this.indexArray2=new Ko,this.programConfigurations=new Is(e.layers,e.zoom),this.segments=new es,this.segments2=new es,this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id)}populate(e,t,r){this.hasDependencies=zl("fill",this.layers,t);const n=this.layers[0].layout.get("fill-sort-key"),i=!n.isConstant(),a=[];for(const{feature:o,id:s,index:l,sourceLayerIndex:c}of e){const e=this.layers[0]._featureFilter.needGeometry,u=Fs(o,e);if(!this.layers[0]._featureFilter.filter(new Ma(this.zoom),u,r))continue;const h=i?n.evaluate(u,{},r,t.availableImages):void 0,d={id:s,properties:o.properties,type:o.type,sourceLayerIndex:c,index:l,geometry:e?u.geometry:Rs(o),patterns:{},sortKey:h};a.push(d)}i&&a.sort((e,t)=>e.sortKey-t.sortKey);for(const n of a){const{geometry:i,index:a,sourceLayerIndex:o}=n;if(this.hasDependencies){const e=Dl("fill",this.layers,n,{zoom:this.zoom},t);this.patternFeatures.push(e)}else this.addFeature(n,i,a,r,{},t.subdivisionGranularity);t.featureIndex.insert(e[a].feature,i,a,o,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,{imagePositions:r})}addFeatures(e,t,r){for(const n of this.patternFeatures)this.addFeature(n,n.geometry,n.index,t,r,e.subdivisionGranularity)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Al),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,r,n,i,a){for(const e of Qr(t,500)){const t=uc(e,n,a.fill.getGranularityForZoomLevel(n.z)),r=this.layoutVertexArray;pc((e,t)=>{r.emplaceBack(e,t)},this.segments,this.layoutVertexArray,this.indexArray,t.verticesFlattened,t.indicesTriangles,this.segments2,this.indexArray2,t.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{imagePositions:i,canonical:n})}}let gc,_c;sa("FillBucket",mc,{omit:["layers","patternFeatures"]});var yc={get paint(){return _c=_c||new qa({"fill-antialias":new Na(ye.paint_fill["fill-antialias"]),"fill-opacity":new Va(ye.paint_fill["fill-opacity"]),"fill-color":new Va(ye.paint_fill["fill-color"]),"fill-outline-color":new Va(ye.paint_fill["fill-outline-color"]),"fill-translate":new Na(ye.paint_fill["fill-translate"]),"fill-translate-anchor":new Na(ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new ja(ye.paint_fill["fill-pattern"])})},get layout(){return gc=gc||new qa({"fill-sort-key":new Va(ye.layout_fill["fill-sort-key"])})}};class vc extends $a{constructor(e,t){super(e,yc,t)}recalculate(e,t){super.recalculate(e,t);const r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new mc(e)}queryRadius(){return Qs(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:e,geometry:t,transform:r,pixelsToTileUnits:n}){return Us(Js(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-r.bearingInRadians,n),t)}isTileClipped(){return!0}}const bc=Qa([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),xc=Qa([{name:"a_centroid",components:2,type:"Int16"}],4),{members:wc}=bc;class Tc{constructor(e,t,r,n,i){this.properties={},this.extent=r,this.type=0,this.id=void 0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=i,e.readFields(Sc,this,t)}loadGeometry(){const e=this._pbf;e.pos=this._geometry;const t=e.readVarint()+e.pos,n=[];let i,a=1,o=0,s=0,l=0;for(;e.pos<t;){if(o<=0){const t=e.readVarint();a=7&t,o=t>>3}if(o--,1===a||2===a)s+=e.readSVarint(),l+=e.readSVarint(),1===a&&(i&&n.push(i),i=[]),i&&i.push(new r(s,l));else{if(7!==a)throw new Error(`unknown command ${a}`);i&&i.push(i[0].clone())}}return i&&n.push(i),n}bbox(){const e=this._pbf;e.pos=this._geometry;const t=e.readVarint()+e.pos;let r=1,n=0,i=0,a=0,o=1/0,s=-1/0,l=1/0,c=-1/0;for(;e.pos<t;){if(n<=0){const t=e.readVarint();r=7&t,n=t>>3}if(n--,1===r||2===r)i+=e.readSVarint(),a+=e.readSVarint(),i<o&&(o=i),i>s&&(s=i),a<l&&(l=a),a>c&&(c=a);else if(7!==r)throw new Error(`unknown command ${r}`)}return[o,l,s,c]}toGeoJSON(e,t,r){const n=this.extent*Math.pow(2,r),i=this.extent*e,a=this.extent*t,o=this.loadGeometry();function s(e){return[360*(e.x+i)/n-180,360/Math.PI*Math.atan(Math.exp((1-2*(e.y+a)/n)*Math.PI))-90]}function l(e){return e.map(s)}let c;if(1===this.type){const e=[];for(const t of o)e.push(t[0]);const t=l(e);c=1===e.length?{type:"Point",coordinates:t[0]}:{type:"MultiPoint",coordinates:t}}else if(2===this.type){const e=o.map(l);c=1===e.length?{type:"LineString",coordinates:e[0]}:{type:"MultiLineString",coordinates:e}}else{if(3!==this.type)throw new Error("unknown feature type");{const e=function(e){const t=e.length;if(t<=1)return[e];const r=[];let n,i;for(let a=0;a<t;a++){const t=Pc(e[a]);0!==t&&(void 0===i&&(i=t<0),i===t<0?(n&&r.push(n),n=[e[a]]):n&&n.push(e[a]))}return n&&r.push(n),r}(o),t=[];for(const r of e)t.push(r.map(l));c=1===t.length?{type:"Polygon",coordinates:t[0]}:{type:"MultiPolygon",coordinates:t}}}const u={type:"Feature",geometry:c,properties:this.properties};return null!=this.id&&(u.id=this.id),u}}function Sc(e,t,r){1===e?t.id=r.readVarint():2===e?function(e,t){const r=e.readVarint()+e.pos;for(;e.pos<r;){const r=t._keys[e.readVarint()],n=t._values[e.readVarint()];t.properties[r]=n}}(r,t):3===e?t.type=r.readVarint():4===e&&(t._geometry=r.pos)}function Pc(e){let t=0;for(let r,n,i=0,a=e.length,o=a-1;i<a;o=i++)r=e[i],n=e[o],t+=(n.x-r.x)*(r.y+n.y);return t}Tc.types=["Unknown","Point","LineString","Polygon"];class Ec{constructor(e,t){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Cc,this,t),this.length=this._features.length}feature(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const t=this._pbf.readVarint()+this._pbf.pos;return new Tc(this._pbf,t,this.extent,this._keys,this._values)}}function Cc(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(e){let t=null;const r=e.readVarint()+e.pos;for(;e.pos<r;){const r=e.readVarint()>>3;t=1===r?e.readString():2===r?e.readFloat():3===r?e.readDouble():4===r?e.readVarint64():5===r?e.readVarint():6===r?e.readSVarint():7===r?e.readBoolean():null}if(null==t)throw new Error("unknown feature value");return t}(r))}class Mc{constructor(e,t){this.layers=e.readFields(kc,{},t)}}function kc(e,t,r){if(3===e){const e=new Ec(r,r.readVarint()+r.pos);e.length&&(t[e.name]=e)}}const Ic=Math.pow(2,13);function Ac(e,t,r,n,i,a,o,s){e.emplaceBack(t,r,2*Math.floor(n*Ic)+o,i*Ic*2,a*Ic*2,Math.round(s))}class zc{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new Vo,this.centroidVertexArray=new Bo,this.indexArray=new Yo,this.programConfigurations=new Is(e.layers,e.zoom),this.segments=new es,this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id)}populate(e,t,r){this.features=[],this.hasDependencies=zl("fill-extrusion",this.layers,t);for(const{feature:n,id:i,index:a,sourceLayerIndex:o}of e){const e=this.layers[0]._featureFilter.needGeometry,s=Fs(n,e);if(!this.layers[0]._featureFilter.filter(new Ma(this.zoom),s,r))continue;const l={id:i,sourceLayerIndex:o,index:a,geometry:e?s.geometry:Rs(n),properties:n.properties,type:n.type,patterns:{}};this.hasDependencies?this.features.push(Dl("fill-extrusion",this.layers,l,{zoom:this.zoom},t)):this.addFeature(l,l.geometry,a,r,{},t.subdivisionGranularity),t.featureIndex.insert(n,l.geometry,a,o,this.index,!0)}}addFeatures(e,t,r){for(const n of this.features){const{geometry:i}=n;this.addFeature(n,i,n.index,t,r,e.subdivisionGranularity)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,{imagePositions:r})}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,wc),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,xc.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,t,r,n,i,a){for(const r of Qr(t,500)){const t={x:0,y:0,sampleCount:0},i=this.layoutVertexArray.length;this.processPolygon(t,n,e,r,a);const o=this.layoutVertexArray.length-i,s=Math.floor(t.x/t.sampleCount),l=Math.floor(t.y/t.sampleCount);for(let e=0;e<o;e++)this.centroidVertexArray.emplaceBack(s,l)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{imagePositions:i,canonical:n})}processPolygon(e,t,r,n,i){if(n.length<1)return;if(Rc(n[0]))return;for(const t of n)0!==t.length&&Dc(e,t);const a={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},o=i.fill.getGranularityForZoomLevel(t.z),s="Polygon"===Tc.types[r.type];for(const e of n){if(0===e.length)continue;if(Rc(e))continue;const t=hc(e,o,s);this._generateSideFaces(t,a)}if(!s)return;const l=uc(n,t,o,!1),c=this.layoutVertexArray;pc((e,t)=>{Ac(c,e,t,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,l.verticesFlattened,l.indicesTriangles)}_generateSideFaces(e,t){let r=0;for(let n=1;n<e.length;n++){const i=e[n],a=e[n-1];if(Lc(i,a))continue;t.segment.vertexLength+4>es.MAX_VERTEX_ARRAY_LENGTH&&(t.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const o=i.sub(a)._perp()._unit(),s=a.dist(i);r+s>32768&&(r=0),Ac(this.layoutVertexArray,i.x,i.y,o.x,o.y,0,0,r),Ac(this.layoutVertexArray,i.x,i.y,o.x,o.y,0,1,r),r+=s,Ac(this.layoutVertexArray,a.x,a.y,o.x,o.y,0,0,r),Ac(this.layoutVertexArray,a.x,a.y,o.x,o.y,0,1,r);const l=t.segment.vertexLength;this.indexArray.emplaceBack(l,l+2,l+1),this.indexArray.emplaceBack(l+1,l+2,l+3),t.segment.vertexLength+=4,t.segment.primitiveLength+=2}}}function Dc(e,t){for(let r=0;r<t.length;r++){const n=t[r];r===t.length-1&&t[0].x===n.x&&t[0].y===n.y||(e.x+=n.x,e.y+=n.y,e.sampleCount++)}}function Lc(e,t){return e.x===t.x&&(e.x<0||e.x>k)||e.y===t.y&&(e.y<0||e.y>k)}function Rc(e){return e.every(e=>e.x<0)||e.every(e=>e.x>k)||e.every(e=>e.y<0)||e.every(e=>e.y>k)}let Fc;sa("FillExtrusionBucket",zc,{omit:["layers","features"]});var Bc={get paint(){return Fc=Fc||new qa({"fill-extrusion-opacity":new Na(ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Va(ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Na(ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Na(ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ja(ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Va(ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Va(ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Na(ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Oc extends $a{constructor(e,t){super(e,Bc,t)}createBucket(e){return new zc(e)}queryRadius(){return Qs(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:e,feature:t,featureState:n,geometry:i,transform:a,pixelsToTileUnits:o,pixelPosMatrix:s}){const l=Js(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-a.bearingInRadians,o),c=this.paint.get("fill-extrusion-height").evaluate(t,n),u=this.paint.get("fill-extrusion-base").evaluate(t,n),h=function(e,t){const n=[];for(const i of e){const e=[i.x,i.y,0,1];S(e,e,t),n.push(new r(e[0]/e[3],e[1]/e[3]))}return n}(l,s),d=function(e,t,n,i){const a=[],o=[],s=i[8]*t,l=i[9]*t,c=i[10]*t,u=i[11]*t,h=i[8]*n,d=i[9]*n,p=i[10]*n,f=i[11]*n;for(const t of e){const e=[],n=[];for(const a of t){const t=a.x,o=a.y,m=i[0]*t+i[4]*o+i[12],g=i[1]*t+i[5]*o+i[13],_=i[2]*t+i[6]*o+i[14],y=i[3]*t+i[7]*o+i[15],v=_+c,b=y+u,x=m+h,w=g+d,T=_+p,S=y+f,P=new r((m+s)/b,(g+l)/b);P.z=v/b,e.push(P);const E=new r(x/S,w/S);E.z=T/S,n.push(E)}a.push(e),o.push(n)}return[a,o]}(i,u,c,s);return function(e,t,r){let n=1/0;Us(r,t)&&(n=Vc(r,t[0]));for(let i=0;i<t.length;i++){const a=t[i],o=e[i];for(let e=0;e<a.length-1;e++){const t=a[e],i=[t,a[e+1],o[e+1],o[e],t];Vs(r,i)&&(n=Math.min(n,Vc(r,i)))}}return n!==1/0&&n}(d[0],d[1],h)}}function Nc(e,t){return e.x*t.x+e.y*t.y}function Vc(e,t){if(1===e.length){let r=0;const n=t[r++];let i;for(;!i||n.equals(i);)if(i=t[r++],!i)return 1/0;for(;r<t.length;r++){const a=t[r],o=e[0],s=i.sub(n),l=a.sub(n),c=o.sub(n),u=Nc(s,s),h=Nc(s,l),d=Nc(l,l),p=Nc(c,s),f=Nc(c,l),m=u*d-h*h,g=(d*p-h*f)/m,_=(u*f-h*p)/m,y=n.z*(1-g-_)+i.z*g+a.z*_;if(isFinite(y))return y}return 1/0}{let e=1/0;for(const r of t)e=Math.min(e,r.z);return e}}const jc=Qa([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Uc}=jc,Gc=Qa([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:qc}=Gc,$c=Math.cos(Math.PI/180*37.5),Zc=Math.pow(2,14)/.5;class Hc{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(e=>{this.gradients[e.id]={}}),this.layoutVertexArray=new jo,this.layoutVertexArray2=new Uo,this.indexArray=new Yo,this.programConfigurations=new Is(e.layers,e.zoom),this.segments=new es,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id)}populate(e,t,r){this.hasDependencies=zl("line",this.layers,t)||this.hasLineDasharray(this.layers);const n=this.layers[0].layout.get("line-sort-key"),i=!n.isConstant(),a=[];for(const{feature:t,id:o,index:s,sourceLayerIndex:l}of e){const e=this.layers[0]._featureFilter.needGeometry,c=Fs(t,e);if(!this.layers[0]._featureFilter.filter(new Ma(this.zoom),c,r))continue;const u=i?n.evaluate(c,{},r):void 0,h={id:o,properties:t.properties,type:t.type,sourceLayerIndex:l,index:s,geometry:e?c.geometry:Rs(t),patterns:{},dashes:{},sortKey:u};a.push(h)}i&&a.sort((e,t)=>e.sortKey-t.sortKey);for(const n of a){const{geometry:i,index:a,sourceLayerIndex:o}=n;this.hasDependencies?(zl("line",this.layers,t)?Dl("line",this.layers,n,{zoom:this.zoom},t):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,n,this.zoom,t),this.patternFeatures.push(n)):this.addFeature(n,i,a,r,{},{},t.subdivisionGranularity),t.featureIndex.insert(e[a].feature,i,a,o,this.index)}}update(e,t,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,{imagePositions:r,dashPositions:n})}addFeatures(e,t,r,n){for(const i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,t,r,n,e.subdivisionGranularity)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,qc)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Uc),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,t,r,n,i,a,o){const s=this.layers[0].layout,l=s.get("line-join").evaluate(e,{}),c=s.get("line-cap"),u=s.get("line-miter-limit"),h=s.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const r of t)this.addLine(r,e,l,c,u,h,n,o);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{imagePositions:i,dashPositions:a,canonical:n})}addLine(e,t,r,n,i,a,o,s){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e=hc(e,o?s.line.getGranularityForZoomLevel(o.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let t=0;t<e.length-1;t++)this.totalDistance+=e[t].dist(e[t+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const l="Polygon"===Tc.types[t.type];let c=e.length;for(;c>=2&&e[c-1].equals(e[c-2]);)c--;let u=0;for(;u<c-1&&e[u].equals(e[u+1]);)u++;if(c<(l?3:2))return;"bevel"===r&&(i=1.05);const h=this.overscaling<=16?122880/(512*this.overscaling):0,d=this.segments.prepareSegment(10*c,this.layoutVertexArray,this.indexArray);let p,f,m,g,_;this.e1=this.e2=-1,l&&(p=e[c-2],_=e[u].sub(p)._unit()._perp());for(let t=u;t<c;t++){if(m=t===c-1?l?e[u+1]:void 0:e[t+1],m&&e[t].equals(m))continue;_&&(g=_),p&&(f=p),p=e[t],_=m?m.sub(p)._unit()._perp():g,g=g||_;let o=g.add(_);0===o.x&&0===o.y||o._unit();const s=g.x*_.x+g.y*_.y,y=o.x*_.x+o.y*_.y,v=0!==y?1/y:1/0,b=2*Math.sqrt(2-2*y),x=y<$c&&f&&m,w=g.x*_.y-g.y*_.x>0;if(x&&t>u){const e=p.dist(f);if(e>2*h){const t=p.sub(p.sub(f)._mult(h/e)._round());this.updateDistance(f,t),this.addCurrentVertex(t,g,0,0,d),f=t}}const T=f&&m;let S=T?r:l?"butt":n;if(T&&"round"===S&&(v<a?S="miter":v<=2&&(S="fakeround")),"miter"===S&&v>i&&(S="bevel"),"bevel"===S&&(v>2&&(S="flipbevel"),v<i&&(S="miter")),f&&this.updateDistance(f,p),"miter"===S)o._mult(v),this.addCurrentVertex(p,o,0,0,d);else if("flipbevel"===S){if(v>100)o=_.mult(-1);else{const e=v*g.add(_).mag()/g.sub(_).mag();o._perp()._mult(e*(w?-1:1))}this.addCurrentVertex(p,o,0,0,d),this.addCurrentVertex(p,o.mult(-1),0,0,d)}else if("bevel"===S||"fakeround"===S){const e=-Math.sqrt(v*v-1),t=w?e:0,r=w?0:e;if(f&&this.addCurrentVertex(p,g,t,r,d),"fakeround"===S){const e=Math.round(180*b/Math.PI/20);for(let t=1;t<e;t++){let r=t/e;if(.5!==r){const e=r-.5;r+=r*e*(r-1)*((1.0904+s*(s*(3.55645-1.43519*s)-3.2452))*e*e+(.848013+s*(.215638*s-1.06021)))}const n=_.sub(g)._mult(r)._add(g)._unit()._mult(w?-1:1);this.addHalfVertex(p,n.x,n.y,!1,w,0,d)}}m&&this.addCurrentVertex(p,_,-t,-r,d)}else if("butt"===S)this.addCurrentVertex(p,o,0,0,d);else if("square"===S){const e=f?1:-1;this.addCurrentVertex(p,o,e,e,d)}else"round"===S&&(f&&(this.addCurrentVertex(p,g,0,0,d),this.addCurrentVertex(p,g,1,1,d,!0)),m&&(this.addCurrentVertex(p,_,-1,-1,d,!0),this.addCurrentVertex(p,_,0,0,d)));if(x&&t<c-1){const e=p.dist(m);if(e>2*h){const t=p.add(m.sub(p)._mult(h/e)._round());this.updateDistance(p,t),this.addCurrentVertex(t,_,0,0,d),p=t}}}}addCurrentVertex(e,t,r,n,i,a=!1){const o=t.y*n-t.x,s=-t.y-t.x*n;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,a,!1,r,i),this.addHalfVertex(e,o,s,a,!0,-n,i),this.distance>Zc/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,t,r,n,i,a))}addHalfVertex({x:e,y:t},r,n,i,a,o,s){const l=.5*(this.lineClips?this.scaledDistance*(Zc-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(i?1:0),(t<<1)+(a?1:0),Math.round(63*r)+128,Math.round(63*n)+128,1+(0===o?0:o<0?-1:1)|(63&l)<<2,l>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const c=s.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,c,this.e2),s.primitiveLength++),a?this.e2=c:this.e1=c}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}hasLineDasharray(e){for(const t of e){const e=t.paint.get("line-dasharray");if(e&&!e.isConstant())return!0}return!1}addLineDashDependencies(e,t,r,n){for(const i of e){const e=i.paint.get("line-dasharray");if(!e||"constant"===e.value.kind)continue;const a="round"===i.layout.get("line-cap"),o={dasharray:e.value.evaluate({zoom:r-1},t,{}),round:a},s={dasharray:e.value.evaluate({zoom:r},t,{}),round:a},l={dasharray:e.value.evaluate({zoom:r+1},t,{}),round:a},c=`${o.dasharray.join(",")},${o.round}`,u=`${s.dasharray.join(",")},${s.round}`,h=`${l.dasharray.join(",")},${l.round}`;n.dashDependencies[c]=o,n.dashDependencies[u]=s,n.dashDependencies[h]=l,t.dashes[i.id]={min:c,mid:u,max:h}}}}let Wc,Xc;sa("LineBucket",Hc,{omit:["layers","patternFeatures"]});var Yc={get paint(){return Xc=Xc||new qa({"line-opacity":new Va(ye.paint_line["line-opacity"]),"line-color":new Va(ye.paint_line["line-color"]),"line-translate":new Na(ye.paint_line["line-translate"]),"line-translate-anchor":new Na(ye.paint_line["line-translate-anchor"]),"line-width":new Va(ye.paint_line["line-width"]),"line-gap-width":new Va(ye.paint_line["line-gap-width"]),"line-offset":new Va(ye.paint_line["line-offset"]),"line-blur":new Va(ye.paint_line["line-blur"]),"line-dasharray":new ja(ye.paint_line["line-dasharray"]),"line-pattern":new ja(ye.paint_line["line-pattern"]),"line-gradient":new Ga(ye.paint_line["line-gradient"])})},get layout(){return Wc=Wc||new qa({"line-cap":new Na(ye.layout_line["line-cap"]),"line-join":new Va(ye.layout_line["line-join"]),"line-miter-limit":new Na(ye.layout_line["line-miter-limit"]),"line-round-limit":new Na(ye.layout_line["line-round-limit"]),"line-sort-key":new Va(ye.layout_line["line-sort-key"])})}};class Kc extends Va{possiblyEvaluate(e,t){return t=new Ma(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,r,n){return t=O({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,r,n)}}let Qc;class Jc extends $a{constructor(e,t){super(e,Yc,t),this.gradientVersion=0,Qc||(Qc=new Kc(Yc.paint.properties["line-width"].specification),Qc.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if("line-gradient"===e){const e=this.gradientExpression();this.stepInterpolant=!!function(e){return void 0!==e._styleExpression}(e)&&e._styleExpression.expression instanceof or,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=Qc.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Hc(e)}queryRadius(e){const t=e,r=eu(Ks("line-width",this,t),Ks("line-gap-width",this,t)),n=Ks("line-offset",this,t);return r/2+Math.abs(n)+Qs(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:e,feature:t,featureState:n,geometry:i,transform:a,pixelsToTileUnits:o}){const s=Js(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-a.bearingInRadians,o),l=o/2*eu(this.paint.get("line-width").evaluate(t,n),this.paint.get("line-gap-width").evaluate(t,n)),c=this.paint.get("line-offset").evaluate(t,n);return c&&(i=function(e,t){const n=[];for(let i=0;i<e.length;i++){const a=e[i],o=[];for(let e=0;e<a.length;e++){const n=a[e-1],i=a[e],s=a[e+1],l=0===e?new r(0,0):i.sub(n)._unit()._perp(),c=e===a.length-1?new r(0,0):s.sub(i)._unit()._perp(),u=l._add(c)._unit(),h=u.x*c.x+u.y*c.y;0!==h&&u._mult(1/h),o.push(u._mult(t)._add(i))}n.push(o)}return n}(i,c*o)),function(e,t,r){for(let n=0;n<t.length;n++){const i=t[n];if(e.length>=3)for(let t=0;t<i.length;t++)if(Xs(e,i[t]))return!0;if(Gs(e,i,r))return!0}return!1}(s,i,l)}isTileClipped(){return!0}}function eu(e,t){return t>0?t+2*e:e}const tu=Qa([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ru=Qa([{name:"a_projected_pos",components:3,type:"Float32"}],4);Qa([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const nu=Qa([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Qa([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const iu=Qa([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),au=Qa([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function ou(e,t,r){return e.sections.forEach(e=>{e.text=function(e,t,r){const n=t.layout.get("text-transform").evaluate(r,{});return"uppercase"===n?e=e.toLocaleUpperCase():"lowercase"===n&&(e=e.toLocaleLowerCase()),Ca.applyArabicShaping&&(e=Ca.applyArabicShaping(e)),e}(e.text,t,r)}),e}Qa([{name:"triangle",components:3,type:"Uint16"}]),Qa([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Qa([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Qa([{type:"Float32",name:"offsetX"}]),Qa([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Qa([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var su=24;const lu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},cu={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},uu={40:!0};function hu(e,t,r,n,i,a){if("fontStack"in t){const n=r[t.fontStack],a=n&&n[e];return a?a.metrics.advance*t.scale+i:0}{const e=n[t.imageName];return e?e.displaySize[0]*t.scale*su/a+i:0}}function du(e,t,r,n){const i=Math.pow(e-t,2);return n?e<t?i/2:2*i:i+Math.abs(r)*r}function pu(e,t,r){let n=0;return 10===e&&(n-=1e4),r&&(n+=150),40!==e&&65288!==e||(n+=50),41!==t&&65289!==t||(n+=50),n}function fu(e,t,r,n,i,a){let o=null,s=du(t,r,i,a);for(const e of n){const n=du(t-e.x,r,i,a)+e.badness;n<=s&&(o=e,s=n)}return{index:e,x:t,priorBreak:o,badness:s}}function mu(e){return e?mu(e.priorBreak).concat(e.index):[]}class gu{constructor(e="",t=[],r=[]){this.text=e,this.sections=t,this.sectionIndex=r,this.imageSectionID=null}static fromFeature(e,t){const r=new gu;for(let n=0;n<e.sections.length;n++){const i=e.sections[n];i.image?r.addImageSection(i):r.addTextSection(i,t)}return r}length(){return[...this.text].length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}verticalizePunctuation(){this.text=function(e){let t="",r={premature:!0,value:void 0};const n=e[Symbol.iterator]();let i=n.next();const a=e[Symbol.iterator]();a.next();let o=a.next();for(;!i.done;)t+=!o.done&&wa(o.value.codePointAt(0))&&!lu[o.value]||!r.premature&&wa(r.value.codePointAt(0))&&!lu[r.value]||!lu[i.value]?i.value:lu[i.value],r={value:i.value,premature:!1},i=n.next(),o=a.next();return t}(this.text)}hasZeroWidthSpaces(){return this.text.includes("")}trim(){const e=this.text.match(/^\s*/),t=e?e[0].length:0,r=this.text.match(/\S\s*$/),n=r?r[0].length-1:0;this.text=this.text.substring(t,this.text.length-n),this.sectionIndex=this.sectionIndex.slice(t,this.sectionIndex.length-n)}substring(e,t){const r=[...this.text].slice(e,t).join(""),n=this.sectionIndex.slice(e,t);return new gu(r,this.sections,n)}toCodeUnitIndex(e){return[...this.text].slice(0,e).join("").length}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,t)=>Math.max(e,this.sections[t].scale),0)}getMaxImageSize(e){let t=0,r=0;for(let n=0;n<this.length();n++){const i=this.getSection(n);if("imageName"in i){const n=e[i.imageName];if(!n)continue;const a=n.displaySize;t=Math.max(t,a[0]),r=Math.max(r,a[1])}}return{maxImageWidth:t,maxImageHeight:r}}addTextSection(e,t){this.text+=e.text,this.sections.push({scale:e.scale||1,verticalAlign:e.verticalAlign||"bottom",fontStack:e.fontStack||t});const r=this.sections.length-1;this.sectionIndex.push(...[...e.text].map(()=>r))}addImageSection(e){const t=e.image?e.image.name:"";if(0===t.length)return void q("Can't add FormattedSection with an empty image.");const r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push({scale:1,verticalAlign:e.verticalAlign||"bottom",imageName:t}),this.sectionIndex.push(this.sections.length-1)):q("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}determineLineBreaks(e,t,r,n,i){const a=[],o=this.determineAverageLineWidth(e,t,r,n,i),s=this.hasZeroWidthSpaces();let l=0,c=0;const u=this.text[Symbol.iterator]();let h=u.next();const d=this.text[Symbol.iterator]();d.next();let p=d.next();const f=this.text[Symbol.iterator]();f.next(),f.next();let m=f.next();for(;!h.done;){const t=this.getSection(c),g=h.value.codePointAt(0);if(ga(g)||(l+=hu(g,t,r,n,e,i)),!p.done){const e=fa(g),r=p.value.codePointAt(0);(cu[g]||e||"imageName"in t||!m.done&&uu[r])&&a.push(fu(c+1,l,o,a,pu(g,r,e&&s),!1))}c++,h=u.next(),p=d.next(),m=f.next()}return mu(fu(this.length(),l,o,a,0,!0))}determineAverageLineWidth(e,t,r,n,i){let a=0,o=0;for(const t of this.text){const s=this.getSection(o);a+=hu(t.codePointAt(0),s,r,n,e,i),o++}return a/Math.max(1,Math.ceil(a/t))}}const _u=4294967296,yu=1/_u,vu="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8");class bu{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,t,r=this.length){for(;this.pos<r;){const r=this.readVarint(),n=r>>3,i=this.pos;this.type=7&r,e(n,t,this),this.pos===i&&this.skip(r)}return t}readMessage(e,t){return this.readFields(e,t,this.readVarint()+this.pos)}readFixed32(){const e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){const e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*_u;return this.pos+=8,e}readSFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*_u;return this.pos+=8,e}readFloat(){const e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){const e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){const t=this.buf;let r,n;return n=t[this.pos++],r=127&n,n<128?r:(n=t[this.pos++],r|=(127&n)<<7,n<128?r:(n=t[this.pos++],r|=(127&n)<<14,n<128?r:(n=t[this.pos++],r|=(127&n)<<21,n<128?r:(n=t[this.pos],r|=(15&n)<<28,function(e,t,r){const n=r.buf;let i,a;if(a=n[r.pos++],i=(112&a)>>4,a<128)return xu(e,i,t);if(a=n[r.pos++],i|=(127&a)<<3,a<128)return xu(e,i,t);if(a=n[r.pos++],i|=(127&a)<<10,a<128)return xu(e,i,t);if(a=n[r.pos++],i|=(127&a)<<17,a<128)return xu(e,i,t);if(a=n[r.pos++],i|=(127&a)<<24,a<128)return xu(e,i,t);if(a=n[r.pos++],i|=(1&a)<<31,a<128)return xu(e,i,t);throw new Error("Expected varint not more than 10 bytes")}(r,e,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const e=this.readVarint();return e%2==1?(e+1)/-2:e/2}readBoolean(){return Boolean(this.readVarint())}readString(){const e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&vu?vu.decode(this.buf.subarray(t,e)):function(e,t,r){let n="",i=t;for(;i<r;){const t=e[i];let a,o,s,l=null,c=t>239?4:t>223?3:t>191?2:1;if(i+c>r)break;1===c?t<128&&(l=t):2===c?(a=e[i+1],128==(192&a)&&(l=(31&t)<<6|63&a,l<=127&&(l=null))):3===c?(a=e[i+1],o=e[i+2],128==(192&a)&&128==(192&o)&&(l=(15&t)<<12|(63&a)<<6|63&o,(l<=2047||l>=55296&&l<=57343)&&(l=null))):4===c&&(a=e[i+1],o=e[i+2],s=e[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(l=(15&t)<<18|(63&a)<<12|(63&o)<<6|63&s,(l<=65535||l>=1114112)&&(l=null))),null===l?(l=65533,c=1):l>65535&&(l-=65536,n+=String.fromCharCode(l>>>10&1023|55296),l=56320|1023&l),n+=String.fromCharCode(l),i+=c}return n}(this.buf,t,e)}readBytes(){const e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t}readPackedVarint(e=[],t){const r=this.readPackedEnd();for(;this.pos<r;)e.push(this.readVarint(t));return e}readPackedSVarint(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFloat());return e}readPackedDouble(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed64());return e}readPackedEnd(){return 2===this.type?this.readVarint()+this.pos:this.pos+1}skip(e){const t=7&e;if(0===t)for(;this.buf[this.pos++]>127;);else if(2===t)this.pos=this.readVarint()+this.pos;else if(5===t)this.pos+=4;else{if(1!==t)throw new Error(`Unimplemented type: ${t}`);this.pos+=8}}writeTag(e,t){this.writeVarint(e<<3|t)}realloc(e){let t=this.length||16;for(;t<this.pos+e;)t*=2;if(t!==this.length){const e=new Uint8Array(t);e.set(this.buf),this.buf=e,this.dataView=new DataView(e.buffer),this.length=t}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*yu),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*yu),!0),this.pos+=8}writeVarint(e){(e=+e||0)>268435455||e<0?function(e,t){let r,n;if(e>=0?(r=e%4294967296|0,n=e/4294967296|0):(r=~(-e%4294967296),n=~(-e/4294967296),4294967295^r?r=r+1|0:(r=0,n=n+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,r){r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,r.buf[r.pos]=127&(e>>>=7)}(r,0,t),function(e,t){const r=(7&e)<<4;t.buf[t.pos++]|=r|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(n,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))}writeSVarint(e){this.writeVarint(e<0?2*-e-1:2*e)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(4*e.length),this.pos++;const t=this.pos;this.pos=function(e,t,r){for(let n,i,a=0;a<t.length;a++){if(n=t.charCodeAt(a),n>55295&&n<57344){if(!i){n>56319||a+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):i=n;continue}if(n<56320){e[r++]=239,e[r++]=191,e[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(e[r++]=239,e[r++]=191,e[r++]=189,i=null);n<128?e[r++]=n:(n<2048?e[r++]=n>>6|192:(n<65536?e[r++]=n>>12|224:(e[r++]=n>>18|240,e[r++]=n>>12&63|128),e[r++]=n>>6&63|128),e[r++]=63&n|128)}return r}(this.buf,e,this.pos);const r=this.pos-t;r>=128&&wu(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){const t=e.length;this.writeVarint(t),this.realloc(t);for(let r=0;r<t;r++)this.buf[this.pos++]=e[r]}writeRawMessage(e,t){this.pos++;const r=this.pos;e(t,this);const n=this.pos-r;n>=128&&wu(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n}writeMessage(e,t,r){this.writeTag(e,2),this.writeRawMessage(t,r)}writePackedVarint(e,t){t.length&&this.writeMessage(e,Tu,t)}writePackedSVarint(e,t){t.length&&this.writeMessage(e,Su,t)}writePackedBoolean(e,t){t.length&&this.writeMessage(e,Cu,t)}writePackedFloat(e,t){t.length&&this.writeMessage(e,Pu,t)}writePackedDouble(e,t){t.length&&this.writeMessage(e,Eu,t)}writePackedFixed32(e,t){t.length&&this.writeMessage(e,Mu,t)}writePackedSFixed32(e,t){t.length&&this.writeMessage(e,ku,t)}writePackedFixed64(e,t){t.length&&this.writeMessage(e,Iu,t)}writePackedSFixed64(e,t){t.length&&this.writeMessage(e,Au,t)}writeBytesField(e,t){this.writeTag(e,2),this.writeBytes(t)}writeFixed32Field(e,t){this.writeTag(e,5),this.writeFixed32(t)}writeSFixed32Field(e,t){this.writeTag(e,5),this.writeSFixed32(t)}writeFixed64Field(e,t){this.writeTag(e,1),this.writeFixed64(t)}writeSFixed64Field(e,t){this.writeTag(e,1),this.writeSFixed64(t)}writeVarintField(e,t){this.writeTag(e,0),this.writeVarint(t)}writeSVarintField(e,t){this.writeTag(e,0),this.writeSVarint(t)}writeStringField(e,t){this.writeTag(e,2),this.writeString(t)}writeFloatField(e,t){this.writeTag(e,5),this.writeFloat(t)}writeDoubleField(e,t){this.writeTag(e,1),this.writeDouble(t)}writeBooleanField(e,t){this.writeVarintField(e,+t)}}function xu(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function wu(e,t,r){const n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(n);for(let t=r.pos-1;t>=e;t--)r.buf[t+n]=r.buf[t]}function Tu(e,t){for(let r=0;r<e.length;r++)t.writeVarint(e[r])}function Su(e,t){for(let r=0;r<e.length;r++)t.writeSVarint(e[r])}function Pu(e,t){for(let r=0;r<e.length;r++)t.writeFloat(e[r])}function Eu(e,t){for(let r=0;r<e.length;r++)t.writeDouble(e[r])}function Cu(e,t){for(let r=0;r<e.length;r++)t.writeBoolean(e[r])}function Mu(e,t){for(let r=0;r<e.length;r++)t.writeFixed32(e[r])}function ku(e,t){for(let r=0;r<e.length;r++)t.writeSFixed32(e[r])}function Iu(e,t){for(let r=0;r<e.length;r++)t.writeFixed64(e[r])}function Au(e,t){for(let r=0;r<e.length;r++)t.writeSFixed64(e[r])}function zu(e,t,r){1===e&&r.readMessage(Du,t)}function Du(e,t,r){if(3===e){const{id:e,bitmap:n,width:i,height:a,left:o,top:s,advance:l}=r.readMessage(Lu,{});t.push({id:e,bitmap:new gl({width:i+6,height:a+6},n),metrics:{width:i,height:a,left:o,top:s,advance:l}})}}function Lu(e,t,r){1===e?t.id=r.readVarint():2===e?t.bitmap=r.readBytes():3===e?t.width=r.readVarint():4===e?t.height=r.readVarint():5===e?t.left=r.readSVarint():6===e?t.top=r.readSVarint():7===e&&(t.advance=r.readVarint())}function Ru(e){let t=0,r=0;for(const n of e)t+=n.w*n.h,r=Math.max(r,n.w);e.sort((e,t)=>t.h-e.h);const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let i=0,a=0;for(const t of e)for(let e=n.length-1;e>=0;e--){const r=n[e];if(!(t.w>r.w||t.h>r.h)){if(t.x=r.x,t.y=r.y,a=Math.max(a,t.y+t.h),i=Math.max(i,t.x+t.w),t.w===r.w&&t.h===r.h){const t=n.pop();t&&e<n.length&&(n[e]=t)}else t.h===r.h?(r.x+=t.w,r.w-=t.w):t.w===r.w?(r.y+=t.h,r.h-=t.h):(n.push({x:r.x+t.w,y:r.y,w:r.w-t.w,h:t.h}),r.y+=t.h,r.h-=t.h);break}}return{w:i,h:a,fill:t/(i*a)||0}}class Fu{constructor(e,{pixelRatio:t,version:r,stretchX:n,stretchY:i,content:a,textFitWidth:o,textFitHeight:s}){this.paddedRect=e,this.pixelRatio=t,this.stretchX=n,this.stretchY=i,this.content=a,this.version=r,this.textFitWidth=o,this.textFitHeight=s}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Bu{constructor(e,t){const r={},n={};this.haveRenderCallbacks=[];const i=[];this.addImages(e,r,i),this.addImages(t,n,i);const{w:a,h:o}=Ru(i),s=new _l({width:a||1,height:o||1});for(const t in e){const n=e[t],i=r[t].paddedRect;_l.copy(n.data,s,{x:0,y:0},{x:i.x+1,y:i.y+1},n.data)}for(const e in t){const r=t[e],i=n[e].paddedRect,a=i.x+1,o=i.y+1,l=r.data.width,c=r.data.height;_l.copy(r.data,s,{x:0,y:0},{x:a,y:o},r.data),_l.copy(r.data,s,{x:0,y:c-1},{x:a,y:o-1},{width:l,height:1}),_l.copy(r.data,s,{x:0,y:0},{x:a,y:o+c},{width:l,height:1}),_l.copy(r.data,s,{x:l-1,y:0},{x:a-1,y:o},{width:1,height:c}),_l.copy(r.data,s,{x:0,y:0},{x:a+l,y:o},{width:1,height:c})}this.image=s,this.iconPositions=r,this.patternPositions=n}addImages(e,t,r){for(const n in e){const i=e[n],a={x:0,y:0,w:i.data.width+2,h:i.data.height+2};r.push(a),t[n]=new Fu(a,i),i.hasRenderCallback&&this.haveRenderCallbacks.push(n)}}patchUpdatedImages(e,t){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const r in e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)}patchUpdatedImage(e,t,r){if(!e||!t)return;if(e.version===t.version)return;e.version=t.version;const[n,i]=e.tl;r.update(t.data,void 0,{x:n,y:i})}}var Ou;function Nu(t,r,n,i,a,o,s,l,c,u,h,d,p,f,m){const g=gu.fromFeature(t,a);let _;d===e.ay.vertical&&g.verticalizePunctuation();let y=g.determineLineBreaks(u,o,r,i,f);const{processBidirectionalText:v,processStyledBidirectionalText:b}=Ca;if(v&&1===g.sections.length){_=[],y=y.map(e=>g.toCodeUnitIndex(e));const e=v(g.toString(),y);for(const t of e){const e=[...t].map(()=>0);_.push(new gu(t,g.sections,e))}}else if(b){_=[],y=y.map(e=>g.toCodeUnitIndex(e));let e=0;const t=[];for(const r of g.text)t.push(...Array(r.length).fill(g.sectionIndex[e])),e++;const r=b(g.text,t,y);for(const e of r){const t=[];let r="";for(const n of e[0])t.push(e[1][r.length]),r+=n;_.push(new gu(e[0],g.sections,t))}}else _=function(e,t){const r=[];let n=0;for(const i of t)r.push(e.substring(n,i)),n=i;return n<e.length()&&r.push(e.substring(n,e.length())),r}(g,y);const x=[],w={positionedLines:x,text:g.toString(),top:h[1],bottom:h[1],left:h[0],right:h[0],writingMode:d,iconsInText:!1,verticalizable:!1};return function(e,t,r,n,i,a,o,s,l,c,u,h){let d=0,p=0,f=0,m=0;const g="right"===s?1:"left"===s?0:.5,_=su/h;let y=0;for(const o of i){o.trim();const i=o.getMaxScale(),s={positionedGlyphs:[],lineOffset:0};e.positionedLines[y]=s;const h=s.positionedGlyphs;let v=0;if(!o.length()){p+=a,++y;continue}const b=ju(n,o,_);let x=0;for(const a of o.text){const s=o.getSection(x),f=a.codePointAt(0),m=Gu(l,u,f),g={glyph:f,imageName:null,x:d,y:p+-17,vertical:m,scale:1,fontStack:"",sectionIndex:o.getSectionIndex(x),metrics:null,rect:null};let y;if("fontStack"in s){if(y=qu(s,f,m,b,t,r),!y)continue;g.fontStack=s.fontStack}else{if(e.iconsInText=!0,s.scale*=_,y=$u(s,m,i,b,n),!y)continue;v=Math.max(v,y.imageOffset),g.imageName=s.imageName}const{rect:w,metrics:T,baselineOffset:S}=y;g.y+=S,g.scale=s.scale,g.metrics=T,g.rect=w,h.push(g),m?(e.verticalizable=!0,d+=("imageName"in s?T.advance:su)*s.scale+c):d+=T.advance*s.scale+c,x++}0!==h.length&&(f=Math.max(d-c,f),Zu(h,0,h.length-1,g)),d=0,s.lineOffset=Math.max(v,(i-1)*su);const w=a*i+v;p+=w,m=Math.max(w,m),++y}const{horizontalAlign:v,verticalAlign:b}=Vu(o);(function(e,t,r,n,i,a,o,s,l){const c=(t-r)*i;let u=0;u=a!==o?-s*n- -17:-n*l*o+.5*o;for(const t of e)for(const e of t.positionedGlyphs)e.x+=c,e.y+=u})(e.positionedLines,g,v,b,f,m,a,p,i.length),e.top+=-b*p,e.bottom=e.top+p,e.left+=-v*f,e.right=e.left+f}(w,r,n,i,_,s,l,c,d,u,p,m),!function(e){for(const t of e)if(0!==t.positionedGlyphs.length)return!1;return!0}(x)&&w}function Vu(e){let t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function ju(e,t,r){const n=t.getMaxScale()*su,{maxImageWidth:i,maxImageHeight:a}=t.getMaxImageSize(e),o=Math.max(n,a*r);return{verticalLineContentWidth:Math.max(n,i*r),horizontalLineContentHeight:o}}function Uu(e){switch(e){case"top":return 0;case"center":return.5;default:return 1}}function Gu(t,r,n){return!(t===e.ay.horizontal||!r&&!ma(n)||r&&(ga(n)||(i=n,/\p{sc=Arab}/u.test(String.fromCodePoint(i)))));var i}function qu(e,t,r,n,i,a){const o=a[e.fontStack],s=function(e,t,r,n){if(e&&e.rect)return e;const i=t[r.fontStack],a=i&&i[n];return a?{rect:null,metrics:a.metrics}:null}(o&&o[t],i,e,t);if(null===s)return null;let l;if(r)l=n.verticalLineContentWidth-e.scale*su;else{const t=Uu(e.verticalAlign);l=(n.horizontalLineContentHeight-e.scale*su)*t}return{rect:s.rect,metrics:s.metrics,baselineOffset:l}}function $u(e,t,r,n,i){const a=i[e.imageName];if(!a)return null;const o=a.paddedRect,s=a.displaySize,l={width:s[0],height:s[1],left:1,top:-3,advance:t?s[1]:s[0]};let c;if(t)c=n.verticalLineContentWidth-s[1]*e.scale;else{const t=Uu(e.verticalAlign);c=(n.horizontalLineContentHeight-s[1]*e.scale)*t}return{rect:o,metrics:l,baselineOffset:c,imageOffset:(t?s[0]:s[1])*e.scale-su*r}}function Zu(e,t,r,n){if(0===n)return;const i=e[r],a=(e[r].x+i.metrics.advance*i.scale)*n;for(let n=t;n<=r;n++)e[n].x-=a}function Hu(e,t,r){const{horizontalAlign:n,verticalAlign:i}=Vu(r),a=t[0]-e.displaySize[0]*n,o=t[1]-e.displaySize[1]*i;return{image:e,top:o,bottom:o+e.displaySize[1],left:a,right:a+e.displaySize[0]}}function Wu(e){var t,r;let n=e.left,i=e.top,a=e.right-n,o=e.bottom-i;const s=null!==(t=e.image.textFitWidth)&&void 0!==t?t:"stretchOrShrink",l=null!==(r=e.image.textFitHeight)&&void 0!==r?r:"stretchOrShrink",c=(e.image.content[2]-e.image.content[0])/(e.image.content[3]-e.image.content[1]);if("proportional"===l){if("stretchOnly"===s&&a/o<c||"proportional"===s){const e=Math.ceil(o*c);n*=e/a,a=e}}else if("proportional"===s&&"stretchOnly"===l&&0!==c&&a/o>c){const e=Math.ceil(a/c);i*=e/o,o=e}return{x1:n,y1:i,x2:n+a,y2:i+o}}function Xu(e,t,r,n,i,a){const o=e.image;let s;if(o.content){const e=o.content,t=o.pixelRatio||1;s=[e[0]/t,e[1]/t,o.displaySize[0]-e[2]/t,o.displaySize[1]-e[3]/t]}const l=t.left*a,c=t.right*a;let u,h,d,p;"width"===r||"both"===r?(p=i[0]+l-n[3],h=i[0]+c+n[1]):(p=i[0]+(l+c-o.displaySize[0])/2,h=p+o.displaySize[0]);const f=t.top*a,m=t.bottom*a;return"height"===r||"both"===r?(u=i[1]+f-n[0],d=i[1]+m+n[2]):(u=i[1]+(f+m-o.displaySize[1])/2,d=u+o.displaySize[1]),{image:o,top:u,right:h,bottom:d,left:p,collisionPadding:s}}sa("ImagePosition",Fu),sa("ImageAtlas",Bu),e.ay=void 0,(Ou=e.ay||(e.ay={}))[Ou.none=0]="none",Ou[Ou.horizontal=1]="horizontal",Ou[Ou.vertical=2]="vertical",Ou[Ou.horizontalOnly=3]="horizontalOnly";const Yu=128,Ku=32640;function Qu(e,t){const{expression:r}=t;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new Ma(e+1))};if("source"===r.kind)return{kind:"source"};{const{zoomStops:t,interpolationType:n}=r;let i=0;for(;i<t.length&&t[i]<=e;)i++;i=Math.max(0,i-1);let a=i;for(;a<t.length&&t[a]<e+1;)a++;a=Math.min(t.length-1,a);const o=t[i],s=t[a];return"composite"===r.kind?{kind:"composite",minZoom:o,maxZoom:s,interpolationType:n}:{kind:"camera",minZoom:o,maxZoom:s,minSize:r.evaluate(new Ma(o)),maxSize:r.evaluate(new Ma(s)),interpolationType:n}}}function Ju(e,t,r){let n="never";const i=e.get(t);return i?n=i:e.get(r)&&(n="always"),n}const eh=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function th(e,t,r,n,i,a,o,s,l,c,u,h,d){const p=s?Math.min(Ku,Math.round(s[0])):0,f=s?Math.min(Ku,Math.round(s[1])):0;e.emplaceBack(t,r,Math.round(32*n),Math.round(32*i),a,o,(p<<1)+(l?1:0),f,16*c,16*u,256*h,256*d)}function rh(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function nh(e){for(const t of e.sections)if(Ea(t.text))return!0;return!1}class ih{constructor(e){this.layoutVertexArray=new $o,this.indexArray=new Yo,this.programConfigurations=e,this.segments=new es,this.dynamicLayoutVertexArray=new Zo,this.opacityVertexArray=new Ho,this.hasVisibleVertices=!1,this.placedSymbolArray=new Mo}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,t,r,n){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,tu.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,ru.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,eh,!0),this.opacityVertexBuffer.itemSize=1),(r||n)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}sa("SymbolBuffers",ih);class ah{constructor(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new es,this.collisionVertexArray=new Xo}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,nu.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}sa("CollisionBuffers",ah);class oh{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(e=>e.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Qu(this.zoom,r["text-size"]),this.iconSizeData=Qu(this.zoom,r["icon-size"]);const n=this.layers[0].layout,i=n.get("symbol-sort-key"),a=n.get("symbol-z-order");this.canOverlap="never"!==Ju(n,"text-overlap","text-allow-overlap")||"never"!==Ju(n,"icon-overlap","icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==a&&!i.isConstant(),this.sortFeaturesByY=("viewport-y"===a||"auto"===a&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===n.get("symbol-placement")&&(this.writingModes=n.get("text-writing-mode").map(t=>e.ay[t])),this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id),this.sourceID=t.sourceID}createArrays(){this.text=new ih(new Is(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new ih(new Is(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Ao,this.lineVertexArray=new zo,this.symbolInstances=new Io,this.textAnchorOffsets=new Lo}calculateGlyphDependencies(e,t,r,n,i){for(const a of e)if(t[a.codePointAt(0)]=!0,(r||n)&&i){const e=lu[a];e&&(t[e.codePointAt(0)]=!0)}}populate(t,r,n){const i=this.layers[0],a=i.layout,o=a.get("text-font"),s=a.get("text-field"),l=a.get("icon-image"),c=("constant"!==s.value.kind||s.value.value instanceof It&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&("constant"!==o.value.kind||o.value.value.length>0),u="constant"!==l.value.kind||!!l.value.value||Object.keys(l.parameters).length>0,h=a.get("symbol-sort-key");if(this.features=[],!c&&!u)return;const d=r.iconDependencies,p=r.glyphDependencies,f=r.availableImages,m=new Ma(this.zoom);for(const{feature:r,id:s,index:l,sourceLayerIndex:g}of t){const t=i._featureFilter.needGeometry,_=Fs(r,t);if(!i._featureFilter.filter(m,_,n))continue;let y,v;if(t||(_.geometry=Rs(r)),c){const e=i.getValueAndResolveTokens("text-field",_,n,f),t=It.factory(e),r=this.hasRTLText=this.hasRTLText||nh(t);(!r||"unavailable"===Ca.getRTLTextPluginStatus()||r&&Ca.isParsed())&&(y=ou(t,i,_))}if(u){const e=i.getValueAndResolveTokens("icon-image",_,n,f);v=e instanceof Bt?e:Bt.fromString(e)}if(!y&&!v)continue;const b=this.sortFeaturesByKey?h.evaluate(_,{},n):void 0;if(this.features.push({id:s,text:y,icon:v,index:l,sourceLayerIndex:g,geometry:_.geometry,properties:r.properties,type:Tc.types[r.type],sortKey:b}),v&&(d[v.name]=!0),y){const t=o.evaluate(_,{},n).join(","),r="viewport"!==a.get("text-rotation-alignment")&&"point"!==a.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(e.ay.vertical)>=0;for(const e of y.sections)if(e.image)d[e.image.name]=!0;else{const n=_a(y.toString()),i=e.fontStack||t,a=p[i]=p[i]||{};this.calculateGlyphDependencies(e.text,a,r,this.allowVerticalPlacement,n)}}}"line"===a.get("symbol-placement")&&(this.features=function(e){const t={},r={},n=[];let i=0;function a(t){n.push(e[t]),i++}function o(e,t,i){const a=r[e];return delete r[e],r[t]=a,n[a].geometry[0].pop(),n[a].geometry[0]=n[a].geometry[0].concat(i[0]),a}function s(e,r,i){const a=t[r];return delete t[r],t[e]=a,n[a].geometry[0].shift(),n[a].geometry[0]=i[0].concat(n[a].geometry[0]),a}function l(e,t,r){const n=r?t[0][t[0].length-1]:t[0][0];return`${e}:${n.x}:${n.y}`}for(let c=0;c<e.length;c++){const u=e[c],h=u.geometry,d=u.text?u.text.toString():null;if(!d){a(c);continue}const p=l(d,h),f=l(d,h,!0);if(p in r&&f in t&&r[p]!==t[f]){const e=s(p,f,h),i=o(p,f,n[e].geometry);delete t[p],delete r[f],r[l(d,n[i].geometry,!0)]=i,n[e].geometry=null}else p in r?o(p,f,h):f in t?s(p,f,h):(a(c),t[p]=i-1,r[f]=i-1)}return n.filter(e=>e.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((e,t)=>e.sortKey-t.sortKey)}update(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,{imagePositions:r}),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,{imagePositions:r}))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){const r=this.lineVertexArray.length;if(void 0!==e.segment){let r=e.dist(t[e.segment+1]),n=e.dist(t[e.segment]);const i={};for(let n=e.segment+1;n<t.length;n++)i[n]={x:t[n].x,y:t[n].y,tileUnitDistanceFromAnchor:r},n<t.length-1&&(r+=t[n+1].dist(t[n]));for(let r=e.segment||0;r>=0;r--)i[r]={x:t[r].x,y:t[r].y,tileUnitDistanceFromAnchor:n},r>0&&(n+=t[r-1].dist(t[r]));for(let e=0;e<t.length;e++){const t=i[e];this.lineVertexArray.emplaceBack(t.x,t.y,t.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}}addSymbols(t,r,n,i,a,o,s,l,c,u,h,d){const p=t.indexArray,f=t.layoutVertexArray,m=t.segments.prepareSegment(4*r.length,f,p,this.canOverlap?o.sortKey:void 0),g=this.glyphOffsetArray.length,_=m.vertexLength,y=this.allowVerticalPlacement&&s===e.ay.vertical?Math.PI/2:0,v=o.text&&o.text.sections;for(let e=0;e<r.length;e++){const{tl:i,tr:a,bl:s,br:c,tex:u,pixelOffsetTL:h,pixelOffsetBR:g,minFontScaleX:_,minFontScaleY:b,glyphOffset:x,isSDF:w,sectionIndex:T}=r[e],S=m.vertexLength,P=x[1];th(f,l.x,l.y,i.x,P+i.y,u.x,u.y,n,w,h.x,h.y,_,b),th(f,l.x,l.y,a.x,P+a.y,u.x+u.w,u.y,n,w,g.x,h.y,_,b),th(f,l.x,l.y,s.x,P+s.y,u.x,u.y+u.h,n,w,h.x,g.y,_,b),th(f,l.x,l.y,c.x,P+c.y,u.x+u.w,u.y+u.h,n,w,g.x,g.y,_,b),rh(t.dynamicLayoutVertexArray,l,y),p.emplaceBack(S,S+2,S+1),p.emplaceBack(S+1,S+2,S+3),m.vertexLength+=4,m.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(x[0]),e!==r.length-1&&T===r[e+1].sectionIndex||t.programConfigurations.populatePaintArrays(f.length,o,o.index,{imagePositions:{},canonical:d,formattedSection:v&&v[T]})}t.placedSymbolArray.emplaceBack(l.x,l.y,g,this.glyphOffsetArray.length-g,_,c,u,l.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],s,0,!1,0,h)}_addCollisionDebugVertex(e,t,r,n,i,a){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,n,i,Math.round(a.x),Math.round(a.y))}addCollisionDebugVertices(e,t,n,i,a,o,s){const l=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),c=l.vertexLength,u=a.layoutVertexArray,h=a.collisionVertexArray,d=s.anchorX,p=s.anchorY;this._addCollisionDebugVertex(u,h,o,d,p,new r(e,t)),this._addCollisionDebugVertex(u,h,o,d,p,new r(n,t)),this._addCollisionDebugVertex(u,h,o,d,p,new r(n,i)),this._addCollisionDebugVertex(u,h,o,d,p,new r(e,i)),l.vertexLength+=4;const f=a.indexArray;f.emplaceBack(c,c+1),f.emplaceBack(c+1,c+2),f.emplaceBack(c+2,c+3),f.emplaceBack(c+3,c),l.primitiveLength+=4}addDebugCollisionBoxes(e,t,r,n){for(let i=e;i<t;i++){const e=this.collisionBoxArray.get(i);this.addCollisionDebugVertices(e.x1,e.y1,e.x2,e.y2,n?this.textCollisionBox:this.iconCollisionBox,e.anchorPoint,r)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ah(Wo,iu.members,Ko),this.iconCollisionBox=new ah(Wo,iu.members,Ko);for(let e=0;e<this.symbolInstances.length;e++){const t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}}_deserializeCollisionBoxesForSymbol(e,t,r,n,i,a,o,s,l){const c={};for(let n=t;n<r;n++){const t=e.get(n);c.textBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},c.textFeatureIndex=t.featureIndex;break}for(let t=n;t<i;t++){const r=e.get(t);c.verticalTextBox={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,anchorPointX:r.anchorPointX,anchorPointY:r.anchorPointY},c.verticalTextFeatureIndex=r.featureIndex;break}for(let t=a;t<o;t++){const r=e.get(t);c.iconBox={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,anchorPointX:r.anchorPointX,anchorPointY:r.anchorPointY},c.iconFeatureIndex=r.featureIndex;break}for(let t=s;t<l;t++){const r=e.get(t);c.verticalIconBox={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,anchorPointX:r.anchorPointX,anchorPointY:r.anchorPointY},c.verticalIconFeatureIndex=r.featureIndex;break}return c}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let t=0;t<this.symbolInstances.length;t++){const r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,t){const r=e.placedSymbolArray.get(t),n=r.vertexStartIndex+4*r.numGlyphs;for(let t=r.vertexStartIndex;t<n;t+=4)e.indexArray.emplaceBack(t,t+2,t+1),e.indexArray.emplaceBack(t+1,t+2,t+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const t=Math.sin(e),r=Math.cos(e),n=[],i=[],a=[];for(let e=0;e<this.symbolInstances.length;++e){a.push(e);const o=this.symbolInstances.get(e);n.push(0|Math.round(t*o.anchorX+r*o.anchorY)),i.push(o.featureIndex)}return a.sort((e,t)=>n[e]-n[t]||i[t]-i[e]),a}addToSortKeyRanges(e,t){const r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const e of this.symbolInstanceIndexes){const t=this.symbolInstances.get(e);this.featureSortOrder.push(t.featureIndex),[t.rightJustifiedTextSymbolIndex,t.centerJustifiedTextSymbolIndex,t.leftJustifiedTextSymbolIndex].forEach((e,t,r)=>{e>=0&&r.indexOf(e)===t&&this.addIndicesForPlacedSymbol(this.text,e)}),t.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,t.verticalPlacedTextSymbolIndex),t.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,t.placedIconSymbolIndex),t.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,t.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let sh,lh;sa("SymbolBucket",oh,{omit:["layers","collisionBoxArray","features","compareText"]}),oh.MAX_GLYPHS=65535,oh.addDynamicAttributes=rh;var ch={get paint(){return lh=lh||new qa({"icon-opacity":new Va(ye.paint_symbol["icon-opacity"]),"icon-color":new Va(ye.paint_symbol["icon-color"]),"icon-halo-color":new Va(ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new Va(ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Va(ye.paint_symbol["icon-halo-blur"]),"icon-translate":new Na(ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new Na(ye.paint_symbol["icon-translate-anchor"]),"text-opacity":new Va(ye.paint_symbol["text-opacity"]),"text-color":new Va(ye.paint_symbol["text-color"],{runtimeType:Oe,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new Va(ye.paint_symbol["text-halo-color"]),"text-halo-width":new Va(ye.paint_symbol["text-halo-width"]),"text-halo-blur":new Va(ye.paint_symbol["text-halo-blur"]),"text-translate":new Na(ye.paint_symbol["text-translate"]),"text-translate-anchor":new Na(ye.paint_symbol["text-translate-anchor"])})},get layout(){return sh=sh||new qa({"symbol-placement":new Na(ye.layout_symbol["symbol-placement"]),"symbol-spacing":new Na(ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Na(ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Va(ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Na(ye.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Na(ye.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Na(ye.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Na(ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new Na(ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Na(ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new Va(ye.layout_symbol["icon-size"]),"icon-text-fit":new Na(ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Na(ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new Va(ye.layout_symbol["icon-image"]),"icon-rotate":new Va(ye.layout_symbol["icon-rotate"]),"icon-padding":new Va(ye.layout_symbol["icon-padding"]),"icon-keep-upright":new Na(ye.layout_symbol["icon-keep-upright"]),"icon-offset":new Va(ye.layout_symbol["icon-offset"]),"icon-anchor":new Va(ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Na(ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Na(ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Na(ye.layout_symbol["text-rotation-alignment"]),"text-field":new Va(ye.layout_symbol["text-field"]),"text-font":new Va(ye.layout_symbol["text-font"]),"text-size":new Va(ye.layout_symbol["text-size"]),"text-max-width":new Va(ye.layout_symbol["text-max-width"]),"text-line-height":new Na(ye.layout_symbol["text-line-height"]),"text-letter-spacing":new Va(ye.layout_symbol["text-letter-spacing"]),"text-justify":new Va(ye.layout_symbol["text-justify"]),"text-radial-offset":new Va(ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Na(ye.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Va(ye.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Va(ye.layout_symbol["text-anchor"]),"text-max-angle":new Na(ye.layout_symbol["text-max-angle"]),"text-writing-mode":new Na(ye.layout_symbol["text-writing-mode"]),"text-rotate":new Va(ye.layout_symbol["text-rotate"]),"text-padding":new Na(ye.layout_symbol["text-padding"]),"text-keep-upright":new Na(ye.layout_symbol["text-keep-upright"]),"text-transform":new Va(ye.layout_symbol["text-transform"]),"text-offset":new Va(ye.layout_symbol["text-offset"]),"text-allow-overlap":new Na(ye.layout_symbol["text-allow-overlap"]),"text-overlap":new Na(ye.layout_symbol["text-overlap"]),"text-ignore-placement":new Na(ye.layout_symbol["text-ignore-placement"]),"text-optional":new Na(ye.layout_symbol["text-optional"])})}};class uh{constructor(e){if(void 0===e.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Le,this.defaultValue=e}evaluate(e){if(e.formattedSection){const t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}sa("FormatSectionOverride",uh,{omit:["defaultValue"]});class hh extends $a{constructor(e,t){super(e,ch,t)}recalculate(e,t){if(super.recalculate(e,t),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const e=this.layout.get("text-writing-mode");if(e){const t=[];for(const r of e)t.indexOf(r)<0&&t.push(r);this.layout._values["text-writing-mode"]=t}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,t,r,n){const i=this.layout.get(e).evaluate(t,{},r,n),a=this._unevaluatedLayout._values[e];return a.isDataDriven()||ei(a.value)||!i?i:function(e,t){return t.replace(/{([^{}]+)}/g,(t,r)=>e&&r in e?String(e[r]):"")}(t.properties,i)}createBucket(e){return new oh(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of ch.paint.overridableProperties){if(!hh.hasPaintOverride(this.layout,e))continue;const t=this.paint.get(e),r=new uh(t),n=new Jn(r,t.property.specification);let i=null;i="constant"===t.value.kind||"source"===t.value.kind?new ri("source",n):new ni("composite",n,t.value.zoomStops),this.paint._values[e]=new Ba(t.property,i,t.parameters)}}_handleOverridablePaintPropertyUpdate(e,t,r){return!(!this.layout||t.isDataDriven()||r.isDataDriven())&&hh.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,t){const r=e.get("text-field"),n=ch.paint.properties[t];let i=!1;const a=e=>{for(const t of e)if(n.overrides&&n.overrides.hasOverride(t))return void(i=!0)};if("constant"===r.value.kind&&r.value.value instanceof It)a(r.value.value.sections);else if("source"===r.value.kind||"composite"===r.value.kind){const e=t=>{i||(t instanceof Gt&&jt(t.value)===Ge?a(t.value.sections):t instanceof Er?a(t.sections):t.eachChild(e))},t=r.value;t._styleExpression&&e(t._styleExpression.expression)}return i}}let dh;var ph={get paint(){return dh=dh||new qa({"background-color":new Na(ye.paint_background["background-color"]),"background-pattern":new Ua(ye.paint_background["background-pattern"]),"background-opacity":new Na(ye.paint_background["background-opacity"])})}};class fh extends $a{constructor(e,t){super(e,ph,t)}}class mh extends $a{constructor(e,t){super(e,{},t),this.onAdd=e=>{this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)},this.onRemove=e=>{this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)},this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class gh{constructor(e){this._methodToThrottle=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const _h={once:!0},yh=6371008.8;class vh{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new vh(B(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const t=Math.PI/180,r=this.lat*t,n=e.lat*t,i=Math.sin(r)*Math.sin(n)+Math.cos(r)*Math.cos(n)*Math.cos((e.lng-this.lng)*t);return yh*Math.acos(Math.min(i,1))}static convert(e){if(e instanceof vh)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new vh(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new vh(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const bh=2*Math.PI*yh;function xh(e){return bh*Math.cos(e*Math.PI/180)}function wh(e){return(180+e)/360}function Th(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Sh(e,t){return e/xh(t)}function Ph(e){return 360*e-180}function Eh(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}function Ch(e,t){return e*xh(Eh(t))}class Mh{constructor(e,t,r=0){this.x=+e,this.y=+t,this.z=+r}static fromLngLat(e,t=0){const r=vh.convert(e);return new Mh(wh(r.lng),Th(r.lat),Sh(t,r.lat))}toLngLat(){return new vh(Ph(this.x),Eh(this.y))}toAltitude(){return Ch(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/bh*(e=Eh(this.y),1/Math.cos(e*Math.PI/180));var e}}function kh(e,t,r){var n=2*Math.PI*6378137/256/Math.pow(2,r);return[e*n-2*Math.PI*6378137/2,t*n-2*Math.PI*6378137/2]}class Ih{constructor(e,t,r){if(!function(e,t,r){return!(e<0||e>25||r<0||r>=Math.pow(2,e)||t<0||t>=Math.pow(2,e))}(e,t,r))throw new Error(`x=${t}, y=${r}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=t,this.y=r,this.key=Dh(0,e,e,t,r)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,t,r){const n=(a=this.y,o=this.z,s=kh(256*(i=this.x),256*(a=Math.pow(2,o)-a-1),o),l=kh(256*(i+1),256*(a+1),o),s[0]+","+s[1]+","+l[0]+","+l[1]);var i,a,o,s,l;const c=function(e,t,r){let n,i="";for(let a=e;a>0;a--)n=1<<a-1,i+=(t&n?1:0)+(r&n?2:0);return i}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===r?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,t>1?"@2x":"").replace(/{quadkey}/g,c).replace(/{bbox-epsg-3857}/g,n)}isChildOf(e){const t=this.z-e.z;return t>0&&e.x===this.x>>t&&e.y===this.y>>t}getTilePoint(e){const t=Math.pow(2,this.z);return new r((e.x*t-this.x)*k,(e.y*t-this.y)*k)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ah{constructor(e,t){this.wrap=e,this.canonical=t,this.key=Dh(e,t.z,t.z,t.x,t.y)}}class zh{constructor(e,t,r,n,i){if(this.terrainRttPosMatrix32f=null,e<r)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${r}`);this.overscaledZ=e,this.wrap=t,this.canonical=new Ih(r,+n,+i),this.key=Dh(t,e,r,n,i)}clone(){return new zh(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const t=this.canonical.z-e;return e>this.canonical.z?new zh(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new zh(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(e,t){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-e;return e>this.canonical.z?Dh(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):Dh(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)}isChildOf(e){if(e.wrap!==this.wrap)return!1;if(this.overscaledZ-e.overscaledZ<=0)return!1;if(0===e.overscaledZ)return this.overscaledZ>0;const t=this.canonical.z-e.canonical.z;return!(t<0)&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}children(e){if(this.overscaledZ>=e)return[new zh(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const t=this.canonical.z+1,r=2*this.canonical.x,n=2*this.canonical.y;return[new zh(t,this.wrap,t,r,n),new zh(t,this.wrap,t,r+1,n),new zh(t,this.wrap,t,r,n+1),new zh(t,this.wrap,t,r+1,n+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new zh(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new zh(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ah(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new Mh(e.x-this.wrap,e.y))}}function Dh(e,t,r,n,i){(e*=2)<0&&(e=-1*e-1);const a=1<<r;return(a*a*e+a*i+n).toString(36)+r.toString(36)+t.toString(36)}function Lh(e,t){return t?e.properties[t]:e.id}function Rh(e,t){const r={id:e.id};if(t.removeAllProperties&&(delete e.removeProperties,delete e.addOrUpdateProperties,delete t.removeProperties),t.removeProperties)for(const r of t.removeProperties){const t=e.addOrUpdateProperties.findIndex(e=>e.key===r);t>-1&&e.addOrUpdateProperties.splice(t,1)}return(e.removeAllProperties||t.removeAllProperties)&&(r.removeAllProperties=!0),(e.removeProperties||t.removeProperties)&&(r.removeProperties=[...e.removeProperties||[],...t.removeProperties||[]]),(e.addOrUpdateProperties||t.addOrUpdateProperties)&&(r.addOrUpdateProperties=[...e.addOrUpdateProperties||[],...t.addOrUpdateProperties||[]]),(e.newGeometry||t.newGeometry)&&(r.newGeometry=t.newGeometry||e.newGeometry),r}function Fh(e){var t,r;if(!e)return{};const n={};return n.removeAll=e.removeAll,n.remove=new Set(e.remove||[]),n.add=new Map(null===(t=e.add)||void 0===t?void 0:t.map(e=>[e.id,e])),n.update=new Map(null===(r=e.update)||void 0===r?void 0:r.map(e=>[e.id,e])),n}sa("CanonicalTileID",Ih),sa("OverscaledTileID",zh,{omit:["terrainRttPosMatrix32f"]});class Bh{constructor(e){this._stringToNumber={},this._numberToString=[];for(let t=0;t<e.length;t++){const r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class Oh{constructor(e,t,r,n,i){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=r,e._y=n,this.properties=e.properties,this.id=i}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const t in this)"_geometry"!==t&&"_vectorTileFeature"!==t&&(e[t]=this[t]);return e}}class Nh{_name;dataBuffer;nullabilityBuffer;_size;constructor(e,t,r){this._name=e,this.dataBuffer=t,"number"==typeof r?this._size=r:(this.nullabilityBuffer=r,this._size=r.size())}getValue(e){return this.nullabilityBuffer&&!this.nullabilityBuffer.get(e)?null:this.getValueFromBuffer(e)}has(e){return this.nullabilityBuffer&&this.nullabilityBuffer.get(e)||!this.nullabilityBuffer}get name(){return this._name}get size(){return this._size}}class Vh extends Nh{}class jh extends Vh{getValueFromBuffer(e){return this.dataBuffer[e]}}class Uh extends Vh{getValueFromBuffer(e){return this.dataBuffer[e]}}class Gh extends Nh{delta;constructor(e,t,r,n){super(e,t,n),this.delta=r}}class qh extends Gh{constructor(e,t,r,n){super(e,Int32Array.of(t),r,n)}getValueFromBuffer(e){return this.dataBuffer[0]+e*this.delta}}class $h extends Nh{constructor(e,t,r){super(e,Int32Array.of(t),r)}getValueFromBuffer(e){return this.dataBuffer[0]}}class Zh{_name;_geometryVector;_idVector;_propertyVectors;_extent;propertyVectorsMap;constructor(e,t,r,n,i=4096){this._name=e,this._geometryVector=t,this._idVector=r,this._propertyVectors=n,this._extent=i}get name(){return this._name}get idVector(){return this._idVector}get geometryVector(){return this._geometryVector}get propertyVectors(){return this._propertyVectors}getPropertyVector(e){return this.propertyVectorsMap||(this.propertyVectorsMap=new Map(this._propertyVectors.map(e=>[e.name,e]))),this.propertyVectorsMap.get(e)}*[Symbol.iterator](){const e=this.geometryVector[Symbol.iterator]();let t=0;for(;t<this.numFeatures;){let r;this.idVector&&(r=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(t)):this.idVector.getValue(t));const n=e?.next().value,i={};for(const e of this.propertyVectors){if(!e)continue;const r=e.name,n=e.getValue(t);null!==n&&(i[r]=n)}t++,yield{id:r,geometry:n,properties:i}}}get numFeatures(){return this.geometryVector.numGeometries}get extent(){return this._extent}getFeatures(){const e=[],t=this.geometryVector.getGeometries();for(let r=0;r<this.numFeatures;r++){let n;this.idVector&&(n=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(r)):this.idVector.getValue(r));const i={coordinates:t[r],type:this.geometryVector.geometryType(r)},a={};for(const e of this.propertyVectors){if(!e)continue;const t=e.name,n=e.getValue(r);null!==n&&(a[t]=n)}e.push({id:n,geometry:i,properties:a})}return e}containsMaxSaveIntegerValues(e){return e instanceof jh||e instanceof $h&&e instanceof qh||e instanceof Uh}}class Hh{value;constructor(e){this.value=e}get(){return this.value}set(e){this.value=e}increment(){return this.value++}add(e){this.value+=e}}var Wh,Xh,Yh,Kh,Qh,Jh,ed,td,rd,nd;!function(e){e.PRESENT="PRESENT",e.DATA="DATA",e.OFFSET="OFFSET",e.LENGTH="LENGTH"}(Wh||(Wh={}));class id{_dictionaryType;_offsetType;_lengthType;constructor(e,t,r){this._dictionaryType=e,this._offsetType=t,this._lengthType=r}get dictionaryType(){return this._dictionaryType}get offsetType(){return this._offsetType}get lengthType(){return this._lengthType}}function ad(e,t,r){const n=new Int32Array(r);let i=0,a=t.get();for(let t=0;t<n.length;t++){let t=e[a++],r=127&t;t<128||(t=e[a++],r|=(127&t)<<7,t<128||(t=e[a++],r|=(127&t)<<14,t<128||(t=e[a++],r|=(127&t)<<21,t<128||(t=e[a++],r|=(15&t)<<28)))),n[i++]=r}return t.set(a),n}function od(e,t,r){const n=new BigInt64Array(r);for(let r=0;r<n.length;r++)n[r]=hd(e,t);return n}function sd(e,t){let r,n;return n=e[t.get()],t.increment(),r=127&n,n<128?r:(n=e[t.get()],t.increment(),r|=(127&n)<<7,n<128?r:(n=e[t.get()],t.increment(),r|=(127&n)<<14,n<128?r:(n=e[t.get()],t.increment(),r|=(127&n)<<21,n<128?r:(n=e[t.get()],r|=(15&n)<<28,function(e,t,r){let n,i;if(i=t[r.get()],r.increment(),n=(112&i)>>4,i<128)return 4294967296*n+(e>>>0);if(i=t[r.get()],r.increment(),n|=(127&i)<<3,i<128)return 4294967296*n+(e>>>0);if(i=t[r.get()],r.increment(),n|=(127&i)<<10,i<128)return 4294967296*n+(e>>>0);if(i=t[r.get()],r.increment(),n|=(127&i)<<17,i<128)return 4294967296*n+(e>>>0);if(i=t[r.get()],r.increment(),n|=(127&i)<<24,i<128)return 4294967296*n+(e>>>0);if(i=t[r.get()],r.increment(),n|=(1&i)<<31,i<128)return 4294967296*n+(e>>>0);throw new Error("Expected varint not more than 10 bytes")}(r,e,t)))))}function ld(e,t,r,n){throw new Error("FastPFor is not implemented yet.")}function cd(e){return e>>>1^-(1&e)}function ud(e){return e>>1n^-(1n&e)}function hd(e,t){let r=0n,n=0,i=t.get();for(;i<e.length;){const t=e[i++];if(r|=BigInt(127&t)<<BigInt(n),!(128&t))break;if(n+=7,n>=64)throw new Error("Varint too long")}return t.set(i),r}function dd(e,t,r){const n=new Int32Array(r);let i=0;for(let r=0;r<t;r++){const a=e[r];n.fill(e[r+t],i,i+a),i+=a}return n}function pd(e,t,r){const n=new BigInt64Array(r);let i=0;for(let r=0;r<t;r++){const a=Number(e[r]);n.fill(e[r+t],i,i+a),i+=a}return n}function fd(e,t,r){const n=new Float64Array(r);let i=0;for(let r=0;r<t;r++){const a=e[r];n.fill(e[r+t],i,i+a),i+=a}return n}function md(e){const t=e.length/4*4;let r=1;if(t>=4)for(let n=e[0];r<t-4;r+=4)n=e[r]+=n,n=e[r+1]+=n,n=e[r+2]+=n,n=e[r+3]+=n;for(;r!=e.length;)e[r]+=e[r-1],++r}function gd(e){e[0]=e[0]>>>1^-(1&e[0]),e[1]=e[1]>>>1^-(1&e[1]);const t=e.length/4*4;let r=2;if(t>=4)for(;r<t-4;r+=4){const t=e[r],n=e[r+1],i=e[r+2],a=e[r+3];e[r]=(t>>>1^-(1&t))+e[r-2],e[r+1]=(n>>>1^-(1&n))+e[r-1],e[r+2]=(i>>>1^-(1&i))+e[r],e[r+3]=(a>>>1^-(1&a))+e[r+1]}for(;r!=e.length;r+=2)e[r]=(e[r]>>>1^-(1&e[r]))+e[r-2],e[r+1]=(e[r+1]>>>1^-(1&e[r+1]))+e[r-1]}function _d(e,t,r){return Math.min(r,Math.max(t,e))}!function(e){e.NONE="NONE",e.DELTA="DELTA",e.COMPONENTWISE_DELTA="COMPONENTWISE_DELTA",e.RLE="RLE",e.MORTON="MORTON",e.PDE="PDE"}(Xh||(Xh={})),function(e){e.NONE="NONE",e.FAST_PFOR="FAST_PFOR",e.VARINT="VARINT",e.ALP="ALP"}(Yh||(Yh={})),function(e){e.NONE="NONE",e.SINGLE="SINGLE",e.SHARED="SHARED",e.VERTEX="VERTEX",e.MORTON="MORTON",e.FSST="FSST"}(Kh||(Kh={})),function(e){e.VERTEX="VERTEX",e.INDEX="INDEX",e.STRING="STRING",e.KEY="KEY"}(Qh||(Qh={})),function(e){e.VAR_BINARY="VAR_BINARY",e.GEOMETRIES="GEOMETRIES",e.PARTS="PARTS",e.RINGS="RINGS",e.TRIANGLES="TRIANGLES",e.SYMBOL="SYMBOL",e.DICTIONARY="DICTIONARY"}(Jh||(Jh={}));class yd{_physicalStreamType;_logicalStreamType;_logicalLevelTechnique1;_logicalLevelTechnique2;_physicalLevelTechnique;_numValues;_byteLength;constructor(e,t,r,n,i,a,o){this._physicalStreamType=e,this._logicalStreamType=t,this._logicalLevelTechnique1=r,this._logicalLevelTechnique2=n,this._physicalLevelTechnique=i,this._numValues=a,this._byteLength=o}static decode(e,t){const r=e[t.get()],n=Object.values(Wh)[r>>4];let i=null;switch(n){case Wh.DATA:i=new id(Object.values(Kh)[15&r]);break;case Wh.OFFSET:i=new id(null,Object.values(Qh)[15&r]);break;case Wh.LENGTH:i=new id(null,null,Object.values(Jh)[15&r])}t.increment();const a=e[t.get()],o=Object.values(Xh)[a>>5],s=Object.values(Xh)[a>>2&7],l=Object.values(Yh)[3&a];t.increment();const c=ad(e,t,2);return new yd(n,i,o,s,l,c[0],c[1])}get physicalStreamType(){return this._physicalStreamType}get logicalStreamType(){return this._logicalStreamType}get logicalLevelTechnique1(){return this._logicalLevelTechnique1}get logicalLevelTechnique2(){return this._logicalLevelTechnique2}get physicalLevelTechnique(){return this._physicalLevelTechnique}get numValues(){return this._numValues}get byteLength(){return this._byteLength}getDecompressedCount(){return this._numValues}}class vd extends yd{num_bits;coordinate_shift;constructor(e,t,r,n,i,a,o,s,l){super(e,t,r,n,i,a,o),this.num_bits=s,this.coordinate_shift=l}static decode(e,t){const r=yd.decode(e,t),n=ad(e,t,2);return new vd(r.physicalStreamType,r.logicalStreamType,r.logicalLevelTechnique1,r.logicalLevelTechnique2,r.physicalLevelTechnique,r.numValues,r.byteLength,n[0],n[1])}static decodePartial(e,t,r){const n=ad(t,r,2);return new vd(e.physicalStreamType,e.logicalStreamType,e.logicalLevelTechnique1,e.logicalLevelTechnique2,e.physicalLevelTechnique,e.numValues,e.byteLength,n[0],n[1])}numBits(){return this.num_bits}coordinateShift(){return this.coordinate_shift}}class bd extends yd{_runs;_numRleValues;constructor(e,t,r,n,i,a,o,s,l){super(e,t,r,n,i,a,o),this._runs=s,this._numRleValues=l}static decode(e,t){const r=yd.decode(e,t),n=ad(e,t,2);return new bd(r.physicalStreamType,r.logicalStreamType,r.logicalLevelTechnique1,r.logicalLevelTechnique2,r.physicalLevelTechnique,r.numValues,r.byteLength,n[0],n[1])}static decodePartial(e,t,r){const n=ad(t,r,2);return new bd(e.physicalStreamType,e.logicalStreamType,e.logicalLevelTechnique1,e.logicalLevelTechnique2,e.physicalLevelTechnique,e.numValues,e.byteLength,n[0],n[1])}get runs(){return this._runs}get numRleValues(){return this._numRleValues}getDecompressedCount(){return this._numRleValues}}class xd{static decode(e,t){const r=yd.decode(e,t);return r.logicalLevelTechnique1===Xh.MORTON?vd.decodePartial(r,e,t):Xh.RLE!==r.logicalLevelTechnique1&&Xh.RLE!==r.logicalLevelTechnique2||Yh.NONE===r.physicalLevelTechnique?r:bd.decodePartial(r,e,t)}}!function(e){e[e.FLAT=0]="FLAT",e[e.CONST=1]="CONST",e[e.SEQUENCE=2]="SEQUENCE",e[e.DICTIONARY=3]="DICTIONARY",e[e.FSST_DICTIONARY=4]="FSST_DICTIONARY"}(ed||(ed={}));class wd{values;_size;constructor(e,t){this.values=e,this._size=t}get(e){const t=Math.floor(e/8);return 1==(this.values[t]>>e%8&1)}set(e,t){const r=Math.floor(e/8);this.values[r]=this.values[r]|(t?1:0)<<e%8}getInt(e){const t=Math.floor(e/8);return this.values[t]>>e%8&1}size(){return this._size}getBuffer(){return this.values}}class Td{constructor(){}static decodeIntStream(e,t,r,n,i){const a=Td.decodePhysicalLevelTechnique(e,t,r);return this.decodeIntBuffer(a,r,n,i)}static decodeLengthStreamToOffsetBuffer(e,t,r){const n=Td.decodePhysicalLevelTechnique(e,t,r);return this.decodeLengthToOffsetBuffer(n,r)}static decodePhysicalLevelTechnique(e,t,r){const n=r.physicalLevelTechnique;if(n===Yh.FAST_PFOR)return ld();if(n===Yh.VARINT)return ad(e,t,r.numValues);if(n===Yh.NONE){const n=t.get();t.add(r.byteLength);const i=e.subarray(n,t.get());return new Int32Array(i)}throw new Error("Specified physicalLevelTechnique is not supported (yet).")}static decodeConstIntStream(e,t,r,n){const i=Td.decodePhysicalLevelTechnique(e,t,r);if(1===i.length){const e=i[0];return n?cd(e):e}return n?function(e){return cd(e[1])}(i):function(e){return e[1]}(i)}static decodeSequenceIntStream(e,t,r){return function(e){if(2==e.length){const t=cd(e[1]);return[t,t]}return[cd(e[2]),cd(e[3])]}(Td.decodePhysicalLevelTechnique(e,t,r))}static decodeSequenceLongStream(e,t,r){return function(e){if(2==e.length){const t=ud(e[1]);return[t,t]}return[ud(e[2]),ud(e[3])]}(od(e,t,r.numValues))}static decodeLongStream(e,t,r,n){const i=od(e,t,r.numValues);return this.decodeLongBuffer(i,r,n)}static decodeLongFloat64Stream(e,t,r,n){const i=function(e,t,r){const n=new Float64Array(t);for(let i=0;i<t;i++)n[i]=sd(e,r);return n}(e,r.numValues,t);return this.decodeFloat64Buffer(i,r,n)}static decodeConstLongStream(e,t,r,n){const i=od(e,t,r.numValues);if(1===i.length){const e=i[0];return n?ud(e):e}return n?function(e){return ud(e[1])}(i):function(e){return e[1]}(i)}static decodeIntBuffer(e,t,r,n){switch(t.logicalLevelTechnique1){case Xh.DELTA:return t.logicalLevelTechnique2===Xh.RLE?function(e,t,r){const n=new Int32Array(r);let i=0,a=0;for(let r=0;r<t;r++){const o=e[r],s=cd(e[r+t]);for(let e=0;e<o;e++)a+=s,n[i++]=a}return n}(e,t.runs,t.numRleValues):(function(e){e[0]=e[0]>>>1^-(1&e[0]);const t=e.length/4*4;let r=1;if(t>=4)for(;r<t-4;r+=4){const t=e[r],n=e[r+1],i=e[r+2],a=e[r+3];e[r]=(t>>>1^-(1&t))+e[r-1],e[r+1]=(n>>>1^-(1&n))+e[r],e[r+2]=(i>>>1^-(1&i))+e[r+1],e[r+3]=(a>>>1^-(1&a))+e[r+2]}for(;r!=e.length;++r)e[r]=(e[r]>>>1^-(1&e[r]))+e[r-1]}(e),e);case Xh.RLE:return function(e,t,r){return r?function(e,t,r){const n=new Int32Array(r);let i=0;for(let r=0;r<t;r++){const a=e[r];let o=e[r+t];o=o>>>1^-(1&o),n.fill(o,i,i+a),i+=a}return n}(e,t.runs,t.numRleValues):dd(e,t.runs,t.numRleValues)}(e,t,r);case Xh.MORTON:return md(e),e;case Xh.COMPONENTWISE_DELTA:return n?(function(e,t,r,n){let i=e[0]>>>1^-(1&e[0]),a=e[1]>>>1^-(1&e[1]);e[0]=_d(Math.round(i*t),r,n),e[1]=_d(Math.round(a*t),r,n);const o=e.length/16;let s=2;if(o>=4)for(;s<o-4;s+=4){const o=e[s],l=e[s+1],c=(o>>>1^-(1&o))+i,u=(l>>>1^-(1&l))+a;e[s]=_d(Math.round(c*t),r,n),e[s+1]=_d(Math.round(u*t),r,n);const h=e[s+2],d=e[s+3];i=(h>>>1^-(1&h))+c,a=(d>>>1^-(1&d))+u,e[s+2]=_d(Math.round(i*t),r,n),e[s+3]=_d(Math.round(a*t),r,n)}for(;s!=e.length;s+=2)i+=e[s]>>>1^-(1&e[s]),a+=e[s+1]>>>1^-(1&e[s+1]),e[s]=_d(Math.round(i*t),r,n),e[s+1]=_d(Math.round(a*t),r,n)}(e,n.scale,n.min,n.max),e):(gd(e),e);case Xh.NONE:return r&&function(e){for(let t=0;t<e.length;t++){const r=e[t];e[t]=r>>>1^-(1&r)}}(e),e;default:throw new Error(`The specified Logical level technique is not supported: ${t.logicalLevelTechnique1}`)}}static decodeLongBuffer(e,t,r){switch(t.logicalLevelTechnique1){case Xh.DELTA:return t.logicalLevelTechnique2===Xh.RLE?function(e,t,r){const n=new BigInt64Array(r);let i=0,a=0n;for(let r=0;r<t;r++){const o=Number(e[r]),s=ud(e[r+t]);for(let e=0;e<o;e++)a+=s,n[i++]=a}return n}(e,t.runs,t.numRleValues):(function(e){e[0]=e[0]>>1n^-(1n&e[0]);const t=e.length/4*4;let r=1;if(t>=4)for(;r<t-4;r+=4){const t=e[r],n=e[r+1],i=e[r+2],a=e[r+3];e[r]=(t>>1n^-(1n&t))+e[r-1],e[r+1]=(n>>1n^-(1n&n))+e[r],e[r+2]=(i>>1n^-(1n&i))+e[r+1],e[r+3]=(a>>1n^-(1n&a))+e[r+2]}for(;r!=e.length;++r)e[r]=(e[r]>>1n^-(1n&e[r]))+e[r-1]}(e),e);case Xh.RLE:return function(e,t,r){return r?function(e,t,r){const n=new BigInt64Array(r);let i=0;for(let r=0;r<t;r++){const a=Number(e[r]);let o=e[r+t];o=o>>1n^-(1n&o),n.fill(o,i,i+a),i+=a}return n}(e,t.runs,t.numRleValues):pd(e,t.runs,t.numRleValues)}(e,t,r);case Xh.NONE:return r&&function(e){for(let t=0;t<e.length;t++){const r=e[t];e[t]=r>>1n^-(1n&r)}}(e),e;default:throw new Error(`The specified Logical level technique is not supported: ${t.logicalLevelTechnique1}`)}}static decodeFloat64Buffer(e,t,r){switch(t.logicalLevelTechnique1){case Xh.DELTA:return t.logicalLevelTechnique2===Xh.RLE&&(e=fd(e,t.runs,t.numRleValues)),function(e){e[0]=e[0]%2==1?(e[0]+1)/-2:e[0]/2;const t=e.length/4*4;let r=1;if(t>=4)for(;r<t-4;r+=4){const t=e[r],n=e[r+1],i=e[r+2],a=e[r+3];e[r]=(t%2==1?(t+1)/-2:t/2)+e[r-1],e[r+1]=(n%2==1?(n+1)/-2:n/2)+e[r],e[r+2]=(i%2==1?(i+1)/-2:i/2)+e[r+1],e[r+3]=(a%2==1?(a+1)/-2:a/2)+e[r+2]}for(;r!=e.length;++r)e[r]=(e[r]%2==1?(e[r]+1)/-2:e[r]/2)+e[r-1]}(e),e;case Xh.RLE:return function(e,t,r){return r?function(e,t,r){const n=new Float64Array(r);let i=0;for(let r=0;r<t;r++){const a=e[r];let o=e[r+t];o=o%2==1?(o+1)/-2:o/2,n.fill(o,i,i+a),i+=a}return n}(e,t.runs,t.numRleValues):fd(e,t.runs,t.numRleValues)}(e,t,r);case Xh.NONE:return r&&function(e){for(let t=0;t<e.length;t++){const r=e[t];e[t]=r%2==1?(r+1)/-2:r/2}}(e),e;default:throw new Error(`The specified Logical level technique is not supported: ${t.logicalLevelTechnique1}`)}}static decodeLengthToOffsetBuffer(e,t){if(t.logicalLevelTechnique1===Xh.DELTA&&t.logicalLevelTechnique2===Xh.NONE)return function(e){const t=new Int32Array(e.length+1);t[0]=0,t[1]=cd(e[0]);let r=t[1],n=2;for(;n!=t.length;++n){const i=e[n-1];r+=i>>>1^-(1&i),t[n]=t[n-1]+r}return t}(e);if(t.logicalLevelTechnique1===Xh.RLE&&t.logicalLevelTechnique2===Xh.NONE)return function(e,t,r){const n=new Int32Array(r+1);n[0]=0;let i=1,a=n[0];for(let r=0;r<t;r++){const o=e[r],s=e[r+t];for(let e=i;e<i+o;e++)n[e]=s+a,a=n[e];i+=o}return n}(e,t.runs,t.numRleValues);if(t.logicalLevelTechnique1===Xh.NONE&&t.logicalLevelTechnique2===Xh.NONE){!function(e){let t=0;for(let r=0;r<e.length;r++)e[r]+=t,t=e[r]}(e);const r=new Int32Array(t.numValues+1);return r[0]=0,r.set(e,1),r}if(t.logicalLevelTechnique1===Xh.DELTA&&t.logicalLevelTechnique2===Xh.RLE){const r=function(e,t,r){const n=new Int32Array(r+1);n[0]=0;let i=1,a=n[0];for(let r=0;r<t;r++){const o=e[r];let s=e[r+t];s=s>>>1^-(1&s);for(let e=i;e<i+o;e++)n[e]=s+a,a=n[e];i+=o}return n}(e,t.runs,t.numRleValues);return md(r),r}throw new Error("Only delta encoding is supported for transforming length to offset streams yet.")}static decodeNullableIntStream(e,t,r,n,i){const a=r.physicalLevelTechnique===Yh.FAST_PFOR?ld():ad(e,t,r.numValues);return this.decodeNullableIntBuffer(a,r,n,i)}static decodeNullableLongStream(e,t,r,n,i){const a=od(e,t,r.numValues);return this.decodeNullableLongBuffer(a,r,n,i)}static decodeNullableIntBuffer(e,t,r,n){switch(t.logicalLevelTechnique1){case Xh.DELTA:return t.logicalLevelTechnique2===Xh.RLE&&(e=dd(e,t.runs,t.numRleValues)),function(e,t){const r=new Int32Array(e.size());let n=0;e.get(0)?(r[0]=e.get(0)?t[0]>>>1^-(1&t[0]):0,n=1):r[0]=0;let i=1;for(;i!=r.length;++i)r[i]=e.get(i)?r[i-1]+(t[n]>>>1^-(1&t[n++])):r[i-1];return r}(n,e);case Xh.RLE:return function(e,t,r,n){const i=t;return r?function(e,t,r){const n=new Int32Array(e.size());let i=0;for(let a=0;a<r;a++){const o=t[a];let s=t[a+r];s=s>>>1^-(1&s);for(let t=i;t<i+o;t++)e.get(t)?n[t]=s:(n[t]=0,i++);i+=o}return n}(n,e,i.runs):function(e,t,r){const n=new Int32Array(e.size());let i=0;for(let a=0;a<r;a++){const o=t[a],s=t[a+r];for(let t=i;t<i+o;t++)e.get(t)?n[t]=s:(n[t]=0,i++);i+=o}return n}(n,e,i.runs)}(e,t,r,n);case Xh.MORTON:return md(e),e;case Xh.COMPONENTWISE_DELTA:return gd(e),e;case Xh.NONE:return e=r?function(e,t){const r=new Int32Array(e.size());let n=0,i=0;for(;i!=r.length;++i)if(e.get(i)){const e=t[n++];r[i]=e>>>1^-(1&e)}else r[i]=0;return r}(n,e):function(e,t){const r=new Int32Array(e.size());let n=0,i=0;for(;i!=r.length;++i)r[i]=e.get(i)?t[n++]:0;return r}(n,e),e;default:throw new Error("The specified Logical level technique is not supported")}}static decodeNullableLongBuffer(e,t,r,n){switch(t.logicalLevelTechnique1){case Xh.DELTA:return t.logicalLevelTechnique2===Xh.RLE&&(e=pd(e,t.runs,t.numRleValues)),function(e,t){const r=new BigInt64Array(e.size());let n=0;e.get(0)?(r[0]=e.get(0)?t[0]>>1n^-(1n&t[0]):0n,n=1):r[0]=0n;let i=1;for(;i!=r.length;++i)r[i]=e.get(i)?r[i-1]+(t[n]>>1n^-(1n&t[n++])):r[i-1];return r}(n,e);case Xh.RLE:return function(e,t,r,n){const i=t;return r?function(e,t,r){const n=new BigInt64Array(e.size());let i=0;for(let a=0;a<r;a++){const o=Number(t[a]);let s=t[a+r];s=s>>1n^-(1n&s);for(let t=i;t<i+o;t++)e.get(t)?n[t]=s:(n[t]=0n,i++);i+=o}return n}(n,e,i.runs):function(e,t,r){const n=new BigInt64Array(e.size());let i=0;for(let a=0;a<r;a++){const o=Number(t[a]),s=t[a+r];for(let t=i;t<i+o;t++)e.get(t)?n[t]=s:(n[t]=0n,i++);i+=o}return n}(n,e,i.runs)}(e,t,r,n);case Xh.NONE:return e=r?function(e,t){const r=new BigInt64Array(e.size());let n=0,i=0;for(;i!=r.length;++i)if(e.get(i)){const e=t[n++];r[i]=e>>1n^-(1n&e)}else r[i]=0n;return r}(n,e):function(e,t){const r=new BigInt64Array(e.size());let n=0,i=0;for(;i!=r.length;++i)r[i]=e.get(i)?t[n++]:0n;return r}(n,e),e;default:throw new Error("The specified Logical level technique is not supported")}}static getVectorType(e,t,r,n){const i=e.logicalLevelTechnique1;if(i===Xh.RLE)return 1===e.runs?ed.CONST:ed.FLAT;const a=t instanceof wd?t.size():t;if(i===Xh.DELTA&&e.logicalLevelTechnique2===Xh.RLE){const t=e.runs,i=2;if(e.numRleValues!==a)return ed.FLAT;if(1===t)return ed.SEQUENCE;if(2===t){const t=n.get();let a;if(e.physicalLevelTechnique===Yh.VARINT)a=ad(r,n,4);else{const e=n.get();a=new Int32Array(r.buffer,r.byteOffset+e,4)}if(n.set(t),a[2]===i&&a[3]===i)return ed.SEQUENCE}}return 1===e.numValues?ed.CONST:ed.FLAT}}class Sd extends Vh{getValueFromBuffer(e){return this.dataBuffer[e]}}class Pd extends Gh{constructor(e,t,r,n){super(e,BigInt64Array.of(t),r,n)}getValueFromBuffer(e){return this.dataBuffer[0]+BigInt(e)*this.delta}}class Ed{_geometryOffsets;_partOffsets;_ringOffsets;constructor(e,t,r){this._geometryOffsets=e,this._partOffsets=t,this._ringOffsets=r}get geometryOffsets(){return this._geometryOffsets}get partOffsets(){return this._partOffsets}get ringOffsets(){return this._ringOffsets}}class Cd{tileExtent;_numBits;_coordinateShift;minBound;maxBound;constructor(e,t){this._coordinateShift=e<0?Math.abs(e):0,this.tileExtent=t+this._coordinateShift,this._numBits=Math.ceil(Math.log2(this.tileExtent)),this.minBound=e,this.maxBound=t}validateCoordinates(e){if(e.x<this.minBound||e.y<this.minBound||e.x>this.maxBound||e.y>this.maxBound)throw new Error("The specified tile buffer size is currently not supported.")}numBits(){return this._numBits}coordinateShift(){return this._coordinateShift}}class Md extends Cd{encode(e){this.validateCoordinates(e);const t=e.x+this._coordinateShift,r=e.y+this._coordinateShift;let n=0;for(let e=0;e<this._numBits;e++)n|=(t&1<<e)<<e|(r&1<<e)<<e+1;return n}decode(e){return{x:this.decodeMorton(e)-this._coordinateShift,y:this.decodeMorton(e>>1)-this._coordinateShift}}decodeMorton(e){let t=0;for(let r=0;r<this._numBits;r++)t|=(e&1<<2*r)>>r;return t}static decode(e,t,r){return{x:Md.decodeMorton(e,t)-r,y:Md.decodeMorton(e>>1,t)-r}}static decodeMorton(e,t){let r=0;for(let n=0;n<t;n++)r|=(e&1<<2*n)>>n;return r}}!function(e){e[e.POINT=0]="POINT",e[e.LINESTRING=1]="LINESTRING",e[e.POLYGON=2]="POLYGON",e[e.MULTIPOINT=3]="MULTIPOINT",e[e.MULTILINESTRING=4]="MULTILINESTRING",e[e.MULTIPOLYGON=5]="MULTIPOLYGON"}(td||(td={})),function(e){e[e.POINT=0]="POINT",e[e.LINESTRING=1]="LINESTRING",e[e.POLYGON=2]="POLYGON"}(rd||(rd={})),function(e){e[e.MORTON=0]="MORTON",e[e.VEC_2=1]="VEC_2",e[e.VEC_3=2]="VEC_3"}(nd||(nd={}));class kd{createPoint(e){return[[e]]}createMultiPoint(e){return e.map(e=>[e])}createLineString(e){return[e]}createMultiLineString(e){return e}createPolygon(e,t){return[e,...t]}createMultiPolygon(e){return e.flat()}}function Id(e){const t=new Array(e.numGeometries);let n=1,i=1,a=1,o=0;const s=new kd;let l=0,c=0;const u=e.mortonSettings,h=e.topologyVector,d=h.geometryOffsets,p=h.partOffsets,f=h.ringOffsets,m=e.vertexOffsets,g=e.containsPolygonGeometry(),_=e.vertexBuffer;for(let h=0;h<e.numGeometries;h++){const y=e.geometryType(h);if(y===td.POINT){if(m&&0!==m.length)if(e.vertexBufferType===nd.VEC_2){const e=2*m[c++],n=new r(_[e],_[e+1]);t[o++]=s.createPoint(n)}else{const e=m[c++],n=Md.decode(_[e],u.numBits,u.coordinateShift),i=new r(n.x,n.y);t[o++]=s.createPoint(i)}else{const e=new r(_[l++],_[l++]);t[o++]=s.createPoint(e)}d&&a++,p&&n++,f&&i++}else if(y===td.MULTIPOINT){const e=d[a]-d[a-1];a++;const n=new Array(e);if(m&&0!==m.length){for(let t=0;t<e;t++){const e=2*m[c++];n[t]=new r(_[e],_[e+1])}t[o++]=s.createMultiPoint(n)}else{for(let t=0;t<e;t++){const e=_[l++],i=_[l++];n[t]=new r(e,i)}t[o++]=s.createMultiPoint(n)}}else if(y===td.LINESTRING){let r,h=0;g?(h=f[i]-f[i-1],i++):h=p[n]-p[n-1],n++,m&&0!==m.length?(r=e.vertexBufferType===nd.VEC_2?Rd(_,m,c,h,!1):Fd(_,m,c,h,!1,u),c+=h):(r=Ld(_,l,h,!1),l+=2*h),t[o++]=s.createLineString(r),d&&a++}else if(y===td.POLYGON){const r=p[n]-p[n-1];n++;const h=new Array(r-1);let g=f[i]-f[i-1];if(i++,m&&0!==m.length){const r=e.vertexBufferType===nd.VEC_2?zd(_,m,c,g):Dd(_,m,c,g,0,u);c+=g;for(let t=0;t<h.length;t++)g=f[i]-f[i-1],i++,h[t]=e.vertexBufferType===nd.VEC_2?zd(_,m,c,g):Dd(_,m,c,g,0,u),c+=g;t[o++]=s.createPolygon(r,h)}else{const e=Ad(_,l,g);l+=2*g;for(let e=0;e<h.length;e++)g=f[i]-f[i-1],i++,h[e]=Ad(_,l,g),l+=2*g;t[o++]=s.createPolygon(e,h)}d&&a++}else if(y===td.MULTILINESTRING){const r=d[a]-d[a-1];a++;const h=new Array(r);if(m&&0!==m.length){for(let t=0;t<r;t++){let r=0;g?(r=f[i]-f[i-1],i++):r=p[n]-p[n-1],n++;const a=e.vertexBufferType===nd.VEC_2?Rd(_,m,c,r,!1):Fd(_,m,c,r,!1,u);h[t]=a,c+=r}t[o++]=s.createMultiLineString(h)}else{for(let e=0;e<r;e++){let t=0;g?(t=f[i]-f[i-1],i++):t=p[n]-p[n-1],n++,h[e]=Ld(_,l,t,!1),l+=2*t}t[o++]=s.createMultiLineString(h)}}else{if(y!==td.MULTIPOLYGON)throw new Error("The specified geometry type is currently not supported.");{const r=d[a]-d[a-1];a++;const h=new Array(r);let g=0;if(m&&0!==m.length){for(let t=0;t<r;t++){const r=p[n]-p[n-1];n++;const a=new Array(r-1);g=f[i]-f[i-1],i++;const o=e.vertexBufferType===nd.VEC_2?zd(_,m,c,g):Dd(_,m,c,g,0,u);c+=g;for(let t=0;t<a.length;t++)g=f[i]-f[i-1],i++,a[t]=e.vertexBufferType===nd.VEC_2?zd(_,m,c,g):Dd(_,m,c,g,0,u),c+=g;h[t]=s.createPolygon(o,a)}t[o++]=s.createMultiPolygon(h)}else{for(let e=0;e<r;e++){const t=p[n]-p[n-1];n++;const r=new Array(t-1);g=f[i]-f[i-1],i++;const a=Ad(_,l,g);l+=2*g;for(let e=0;e<r.length;e++){const t=f[i]-f[i-1];i++,r[e]=Ad(_,l,t),l+=2*t}h[e]=s.createPolygon(a,r)}t[o++]=s.createMultiPolygon(h)}}}}return t}function Ad(e,t,r){return Ld(e,t,r,!0)}function zd(e,t,r,n){return Rd(e,t,r,n,!0)}function Dd(e,t,r,n,i,a){return Fd(e,t,r,n,!0,a)}function Ld(e,t,n,i){const a=new Array(i?n+1:n);for(let i=0;i<2*n;i+=2)a[i/2]=new r(e[t+i],e[t+i+1]);return i&&(a[a.length-1]=a[0]),a}function Rd(e,t,n,i,a){const o=new Array(a?i+1:i);for(let a=0;a<2*i;a+=2){const i=2*t[n+a/2];o[a/2]=new r(e[i],e[i+1])}return a&&(o[o.length-1]=o[0]),o}function Fd(e,t,n,i,a,o){const s=new Array(a?i+1:i);for(let a=0;a<i;a++){const i=Md.decode(e[t[n+a]],o.numBits,o.coordinateShift);s[a]=new r(i.x,i.y)}return a&&(s[s.length-1]=s[0]),s}class Bd{_vertexBufferType;_topologyVector;_vertexOffsets;_vertexBuffer;_mortonSettings;constructor(e,t,r,n,i){this._vertexBufferType=e,this._topologyVector=t,this._vertexOffsets=r,this._vertexBuffer=n,this._mortonSettings=i}get vertexBufferType(){return this._vertexBufferType}get topologyVector(){return this._topologyVector}get vertexOffsets(){return this._vertexOffsets}get vertexBuffer(){return this._vertexBuffer}*[Symbol.iterator](){const e=Id(this);let t=0;for(;t<this.numGeometries;)yield{coordinates:e[t],type:this.geometryType(t)},t++}getSimpleEncodedVertex(e){const t=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[t],this.vertexBuffer[t+1]]}getVertex(e){if(this.vertexOffsets&&this.mortonSettings){const t=Md.decode(this.vertexBuffer[this.vertexOffsets[e]],this.mortonSettings.numBits,this.mortonSettings.coordinateShift);return[t.x,t.y]}const t=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[t],this.vertexBuffer[t+1]]}getGeometries(){return Id(this)}get mortonSettings(){return this._mortonSettings}}class Od extends Bd{_numGeometries;_geometryType;constructor(e,t,r,n,i,a,o){super(r,n,i,a,o),this._numGeometries=e,this._geometryType=t}static createMortonEncoded(e,t,r,n,i,a){return new Od(e,t,nd.MORTON,r,n,i,a)}static create(e,t,r,n,i){return new Od(e,t,nd.VEC_2,r,n,i)}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsPolygonGeometry(){return this._geometryType===td.POLYGON||this._geometryType===td.MULTIPOLYGON}containsSingleGeometryType(){return!0}}class Nd extends Bd{_geometryTypes;constructor(e,t,r,n,i,a){super(e,r,n,i,a),this._geometryTypes=t}static createMortonEncoded(e,t,r,n,i){return new Nd(nd.MORTON,e,t,r,n,i)}static create(e,t,r,n){return new Nd(nd.VEC_2,e,t,r,n)}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsPolygonGeometry(){for(let e=0;e<this.numGeometries;e++)if(this.geometryType(e)===td.POLYGON||this.geometryType(e)===td.MULTIPOLYGON)return!0;return!1}containsSingleGeometryType(){return!1}}class Vd{_triangleOffsets;_indexBuffer;_vertexBuffer;_topologyVector;constructor(e,t,r,n){this._triangleOffsets=e,this._indexBuffer=t,this._vertexBuffer=r,this._topologyVector=n}get triangleOffsets(){return this._triangleOffsets}get indexBuffer(){return this._indexBuffer}get vertexBuffer(){return this._vertexBuffer}get topologyVector(){return this._topologyVector}getGeometries(){if(!this._topologyVector)throw new Error("Cannot convert GpuVector to coordinates without topology information");const e=new Array(this.numGeometries),t=this._topologyVector,n=t.partOffsets,i=t.ringOffsets,a=t.geometryOffsets;let o=0,s=1,l=1,c=1;for(let t=0;t<this.numGeometries;t++)switch(this.geometryType(t)){case td.POLYGON:{const u=n[s]-n[s-1];s++;const h=[];for(let e=0;e<u;e++){const e=i[l]-i[l-1];l++;const t=[];for(let n=0;n<e;n++){const e=this._vertexBuffer[o++],n=this._vertexBuffer[o++];t.push(new r(e,n))}t.length>0&&t.push(t[0]),h.push(t)}e[t]=h,a&&c++}break;case td.MULTIPOLYGON:{const u=a[c]-a[c-1];c++;const h=[];for(let e=0;e<u;e++){const e=n[s]-n[s-1];s++;for(let t=0;t<e;t++){const e=i[l]-i[l-1];l++;const t=[];for(let n=0;n<e;n++){const e=this._vertexBuffer[o++],n=this._vertexBuffer[o++];t.push(new r(e,n))}t.length>0&&t.push(t[0]),h.push(t)}}e[t]=h}}return e}[Symbol.iterator](){return null}}class jd extends Vd{_numGeometries;_geometryType;constructor(e,t,r,n,i,a){super(r,n,i,a),this._numGeometries=e,this._geometryType=t}static create(e,t,r,n,i,a){return new jd(e,t,r,n,i,a)}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsSingleGeometryType(){return!0}}class Ud extends Vd{_geometryTypes;constructor(e,t,r,n,i){super(t,r,n,i),this._geometryTypes=e}static create(e,t,r,n,i){return new Ud(e,t,r,n,i)}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsSingleGeometryType(){return!1}}function Gd(e,t,r,n,i){const a=xd.decode(e,r);let o=null,s=null,l=null,c=null,u=null,h=null,d=null,p=null;if(Td.getVectorType(a,n,e,r)===ed.CONST){const f=Td.decodeConstIntStream(e,r,a,!1);for(let n=0;n<t-1;n++){const t=xd.decode(e,r);switch(t.physicalStreamType){case Wh.LENGTH:switch(t.logicalStreamType.lengthType){case Jh.GEOMETRIES:o=Td.decodeLengthStreamToOffsetBuffer(e,r,t);break;case Jh.PARTS:s=Td.decodeLengthStreamToOffsetBuffer(e,r,t);break;case Jh.RINGS:l=Td.decodeLengthStreamToOffsetBuffer(e,r,t);break;case Jh.TRIANGLES:d=Td.decodeLengthStreamToOffsetBuffer(e,r,t)}break;case Wh.OFFSET:switch(t.logicalStreamType.offsetType){case Qh.VERTEX:c=Td.decodeIntStream(e,r,t,!1);break;case Qh.INDEX:p=Td.decodeIntStream(e,r,t,!1)}break;case Wh.DATA:if(Kh.VERTEX===t.logicalStreamType.dictionaryType)u=Td.decodeIntStream(e,r,t,!0,i);else{const n=t;h={numBits:n.numBits(),coordinateShift:n.coordinateShift()},u=Td.decodeIntStream(e,r,t,!1,i)}}}if(null!==p){if(null!=o||null!=s){const e=new Ed(o,s,l);return jd.create(n,f,d,p,u,e)}return jd.create(n,f,d,p,u)}return null===h?Od.create(n,f,new Ed(o,s,l),c,u):Od.createMortonEncoded(n,f,new Ed(o,s,l),c,u,h)}const f=Td.decodeIntStream(e,r,a,!1);for(let n=0;n<t-1;n++){const t=xd.decode(e,r);switch(t.physicalStreamType){case Wh.LENGTH:switch(t.logicalStreamType.lengthType){case Jh.GEOMETRIES:o=Td.decodeIntStream(e,r,t,!1);break;case Jh.PARTS:s=Td.decodeIntStream(e,r,t,!1);break;case Jh.RINGS:l=Td.decodeIntStream(e,r,t,!1);break;case Jh.TRIANGLES:d=Td.decodeLengthStreamToOffsetBuffer(e,r,t)}break;case Wh.OFFSET:switch(t.logicalStreamType.offsetType){case Qh.VERTEX:c=Td.decodeIntStream(e,r,t,!1);break;case Qh.INDEX:p=Td.decodeIntStream(e,r,t,!1)}break;case Wh.DATA:if(Kh.VERTEX===t.logicalStreamType.dictionaryType)u=Td.decodeIntStream(e,r,t,!0,i);else{const n=t;h={numBits:n.numBits(),coordinateShift:n.coordinateShift()},u=Td.decodeIntStream(e,r,t,!1,i)}}}return null!==p&&null===s?Ud.create(f,d,p,u):(null!==o?(o=qd(f,o,2),null!==s&&null!==l?(s=$d(f,o,s,!1),l=function(e,t,r,n){const i=new Int32Array(r[r.length-1]+1);let a=0;i[0]=a;let o=1,s=1,l=0;for(let c=0;c<e.length;c++){const u=e[c],h=t[c+1]-t[c];if(0!==u&&3!==u)for(let e=0;e<h;e++){const e=r[o]-r[o-1];o++;for(let t=0;t<e;t++)a=i[s++]=a+n[l++]}else for(let e=0;e<h;e++)i[s++]=++a,o++}return i}(f,o,s,l)):null!==s&&(s=function(e,t,r){const n=new Int32Array(t[t.length-1]+1);let i=0;n[0]=i;let a=1,o=0;for(let s=0;s<e.length;s++){const l=e[s],c=t[s+1]-t[s];if(4===l||1===l)for(let e=0;e<c;e++)i=n[a++]=i+r[o++];else for(let e=0;e<c;e++)n[a++]=++i}return n}(f,o,s))):null!==s&&null!==l?(s=qd(f,s,1),l=$d(f,s,l,!0)):null!==s&&(s=qd(f,s,0)),null!==p?Ud.create(f,d,p,u,new Ed(o,s,l)):null===h?Nd.create(f,new Ed(o,s,l),c,u):Nd.createMortonEncoded(f,new Ed(o,s,l),c,u,h))}function qd(e,t,r){const n=new Int32Array(e.length+1);let i=0;n[0]=i;let a=0;for(let o=0;o<e.length;o++)i=n[o+1]=i+(e[o]>r?t[a++]:1);return n}function $d(e,t,r,n){const i=new Int32Array(t[t.length-1]+1);let a=0;i[0]=a;let o=1,s=0;for(let l=0;l<e.length;l++){const c=e[l],u=t[l+1]-t[l];if(5===c||2===c||n&&(4===c||1===c))for(let e=0;e<u;e++)a=i[o++]=a+r[s++];else for(let e=0;e<u;e++)i[o++]=++a}return i}class Zd extends Nh{dataVector;constructor(e,t,r){super(e,t.getBuffer(),r),this.dataVector=t}getValueFromBuffer(e){return this.dataVector.get(e)}}class Hd extends Vh{getValueFromBuffer(e){return this.dataBuffer[e]}}class Wd extends Nh{constructor(e,t,r){super(e,BigInt64Array.of(t),r)}getValueFromBuffer(e){return this.dataBuffer[0]}}function Xd(e,t,r){for(let n=0;n<e;n++){const e=xd.decode(t,r);r.add(e.byteLength)}}function Yd(e,t,r){return Kd(e,Math.ceil(t/8),r)}function Kd(e,t,r){const n=new Uint8Array(t);let i=0;for(;i<t;){const t=e[r.increment()];if(t<=127){const a=t+3,o=e[r.increment()],s=i+a;n.fill(o,i,s),i=s}else{const a=256-t;for(let t=0;t<a;t++)n[i++]=e[r.increment()]}}return n}const Qd=new TextDecoder;function Jd(e,t,r){return r-t>=12?Qd.decode(e.subarray(t,r)):function(e,t,r){let n="",i=t;for(;i<r;){const t=e[i];let a,o,s,l=null,c=t>239?4:t>223?3:t>191?2:1;if(i+c>r)break;1===c?t<128&&(l=t):2===c?(a=e[i+1],128==(192&a)&&(l=(31&t)<<6|63&a,l<=127&&(l=null))):3===c?(a=e[i+1],o=e[i+2],128==(192&a)&&128==(192&o)&&(l=(15&t)<<12|(63&a)<<6|63&o,(l<=2047||l>=55296&&l<=57343)&&(l=null))):4===c&&(a=e[i+1],o=e[i+2],s=e[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(l=(15&t)<<18|(63&a)<<12|(63&o)<<6|63&s,(l<=65535||l>=1114112)&&(l=null))),null===l?(l=65533,c=1):l>65535&&(l-=65536,n+=String.fromCharCode(l>>>10&1023|55296),l=56320|1023&l),n+=String.fromCharCode(l),i+=c}return n}(e,t,r)}class ep extends Nh{offsetBuffer;constructor(e,t,r,n){super(e,r,n),this.offsetBuffer=t}}class tp extends ep{textEncoder;constructor(e,t,r,n){super(e,t,r,n??t.length-1),this.textEncoder=new TextEncoder}getValueFromBuffer(e){return Jd(this.dataBuffer,this.offsetBuffer[e],this.offsetBuffer[e+1])}}class rp extends ep{indexBuffer;textEncoder;constructor(e,t,r,n,i){super(e,r,n,i??t.length),this.indexBuffer=t,this.indexBuffer=t,this.textEncoder=new TextEncoder}getValueFromBuffer(e){const t=this.indexBuffer[e];return Jd(this.dataBuffer,this.offsetBuffer[t],this.offsetBuffer[t+1])}}class np extends ep{indexBuffer;symbolOffsetBuffer;symbolTableBuffer;textEncoder;symbolLengthBuffer;lengthBuffer;decodedDictionary;constructor(e,t,r,n,i,a,o){super(e,r,n,o),this.indexBuffer=t,this.symbolOffsetBuffer=i,this.symbolTableBuffer=a,this.textEncoder=new TextEncoder}getValueFromBuffer(e){null==this.decodedDictionary&&(null==this.symbolLengthBuffer&&(this.symbolLengthBuffer=this.offsetToLengthBuffer(this.symbolOffsetBuffer),this.lengthBuffer=this.offsetToLengthBuffer(this.offsetBuffer)),this.decodedDictionary=function(e,t,r){const n=[],i=new Array(t.length).fill(0);for(let e=1;e<t.length;e++)i[e]=i[e-1]+t[e-1];for(let a=0;a<r.length;a++)if(255===r[a])n.push(r[++a]);else{const o=t[r[a]],s=i[r[a]];for(let t=0;t<o;t++)n.push(e[s+t])}return new Uint8Array(n)}(this.symbolTableBuffer,this.symbolLengthBuffer,this.dataBuffer));const t=this.indexBuffer[e];return Jd(this.decodedDictionary,this.offsetBuffer[t],this.offsetBuffer[t+1])}offsetToLengthBuffer(e){const t=new Uint32Array(e.length-1);let r=e[0];for(let n=1;n<e.length;n++){const i=e[n];t[n-1]=i-r,r=i}return t}}class ip{static ROOT_COLUMN_NAME="default";static NESTED_COLUMN_SEPARATOR=":";constructor(){}static decode(e,t,r,n,i){let a=null,o=null,s=null,l=null,c=null,u=null,h=null,d=null;for(let e=0;e<n;e++){const e=xd.decode(t,r);if(0!==e.byteLength)switch(e.physicalStreamType){case Wh.PRESENT:{const n=Yd(t,e.numValues,r);u=new wd(n,e.numValues);break}case Wh.OFFSET:o=null!=i||null!=u?Td.decodeNullableIntStream(t,r,e,!1,i??u):Td.decodeIntStream(t,r,e,!1);break;case Wh.LENGTH:{const n=Td.decodeLengthStreamToOffsetBuffer(t,r,e);Jh.DICTIONARY===e.logicalStreamType.lengthType?a=n:Jh.SYMBOL===e.logicalStreamType.lengthType?l=n:h=n;break}case Wh.DATA:{const n=t.subarray(r.get(),r.get()+e.byteLength);r.add(e.byteLength);const i=e.logicalStreamType.dictionaryType;Kh.FSST===i?c=n:Kh.SINGLE===i||Kh.SHARED===i?s=n:Kh.NONE===i&&(d=n);break}}}return this.decodeFsstDictionaryVector(e,c,o,a,s,l,i??u)??this.decodeDictionaryVector(e,s,o,a,i??u)??this.decodePlainStringVector(e,h,d,o,i??u)}static decodeFsstDictionaryVector(e,t,r,n,i,a,o){return t?new np(e,r,n,i,a,t,o):null}static decodeDictionaryVector(e,t,r,n,i){return t?i?new rp(e,r,n,t,i):new rp(e,r,n,t):null}static decodePlainStringVector(e,t,r,n,i){if(!t||!r)return null;if(n)return i?new rp(e,n,t,r,i):new rp(e,n,t,r);if(i&&i.size()!==t.length-1){const n=new Int32Array(i.size());let a=0;for(let e=0;e<i.size();e++)n[e]=i.get(e)?a++:0;return new rp(e,n,t,r,i)}return i?new tp(e,t,r,i):new tp(e,t,r)}static decodeSharedDictionary(e,t,r,n,i){let a=null,o=null,s=null,l=null,c=!1;for(;!c;){const r=xd.decode(e,t);switch(r.physicalStreamType){case Wh.LENGTH:Jh.DICTIONARY===r.logicalStreamType.lengthType?a=Td.decodeLengthStreamToOffsetBuffer(e,t,r):s=Td.decodeLengthStreamToOffsetBuffer(e,t,r);break;case Wh.DATA:Kh.SINGLE===r.logicalStreamType.dictionaryType||Kh.SHARED===r.logicalStreamType.dictionaryType?(o=e.subarray(t.get(),t.get()+r.byteLength),c=!0):l=e.subarray(t.get(),t.get()+r.byteLength),t.add(r.byteLength)}}const u=r.complexType.children,h=[];let d=0;for(const c of u){const u=ad(e,t,1)[0];if(0==u)continue;const p=`${r.name}${c.name===ip.ROOT_COLUMN_NAME?"":ip.NESTED_COLUMN_SEPARATOR+c.name}`;if(i&&!i.has(p)){Xd(u,e,t);continue}if(2!==u||"scalarField"!==c.type||9!==c.scalarField.physicalType)throw new Error("Currently only optional string fields are implemented for a struct.");const f=xd.decode(e,t),m=Yd(e,f.numValues,t),g=xd.decode(e,t),_=(g instanceof bd?g.numRleValues:g.numValues)!==n?Td.decodeNullableIntStream(e,t,g,!1,new wd(m,f.numValues)):Td.decodeIntStream(e,t,g,!1);h[d++]=l?new np(p,_,a,o,s,l,new wd(m,f.numValues)):new rp(p,_,a,o,new wd(m,f.numValues))}return h}}function ap(e,t,r,n,i,a){return"scalarType"===r.type?function(e,t,r,n,i,a){let o=null,s=0;if(0===e)return null;if(a.nullable){const e=xd.decode(t,r);s=e.numValues;const n=r.get(),i=Yd(t,s,r);r.set(n+e.byteLength),o=new wd(i,e.numValues)}const l=o??n;switch(i.physicalType){case 4:case 3:return function(e,t,r,n,i){const a=xd.decode(e,t),o=Td.getVectorType(a,i,e,t),s=3===n.physicalType;if(o===ed.FLAT){const n=op(i)?Td.decodeNullableIntStream(e,t,a,s,i):Td.decodeIntStream(e,t,a,s);return new jh(r.name,n,i)}if(o===ed.SEQUENCE){const n=Td.decodeSequenceIntStream(e,t,a);return new qh(r.name,n[0],n[1],a.numRleValues)}{const n=Td.decodeConstIntStream(e,t,a,s);return new $h(r.name,n,i)}}(t,r,a,i,l);case 9:return ip.decode(a.name,t,r,a.nullable?e-1:e,o);case 0:return function(e,t,r,n,i){const a=xd.decode(e,t),o=a.numValues,s=t.get(),l=op(i)?function(e,t,r,n){const i=Kd(e,Math.ceil(t/8),r),a=new wd(i,t),o=n.size(),s=new wd(new Uint8Array(o),o);let l=0;for(let e=0;e<n.size();e++){const t=!!n.get(e)&&a.get(l++);s.set(e,t)}return s.getBuffer()}(e,o,t,i):Yd(e,o,t);t.set(s+a.byteLength);const c=new wd(l,o);return new Zd(r.name,c,i)}(t,r,a,0,l);case 6:case 5:return function(e,t,r,n,i){const a=xd.decode(e,t),o=Td.getVectorType(a,n,e,t),s=5===i.physicalType;if(o===ed.FLAT){const i=op(n)?Td.decodeNullableLongStream(e,t,a,s,n):Td.decodeLongStream(e,t,a,s);return new Sd(r.name,i,n)}if(o===ed.SEQUENCE){const n=Td.decodeSequenceLongStream(e,t,a);return new Pd(r.name,n[0],n[1],a.numRleValues)}{const i=Td.decodeConstLongStream(e,t,a,s);return new Wd(r.name,i,n)}}(t,r,a,l,i);case 7:return function(e,t,r,n){const i=xd.decode(e,t),a=op(n)?function(e,t,r,n){const i=t.get(),a=i+n*Float32Array.BYTES_PER_ELEMENT,o=new Uint8Array(e.subarray(i,a)).buffer,s=new Float32Array(o);t.set(a);const l=r.size(),c=new Float32Array(l);let u=0;for(let e=0;e<l;e++)c[e]=r.get(e)?s[u++]:0;return c}(e,t,n,i.numValues):function(e,t,r){const n=t.get(),i=n+r*Float32Array.BYTES_PER_ELEMENT,a=new Uint8Array(e.subarray(n,i)).buffer,o=new Float32Array(a);return t.set(i),o}(e,t,i.numValues);return new Hd(r.name,a,n)}(t,r,a,l);case 8:return function(e,t,r,n){const i=xd.decode(e,t),a=op(n)?function(e,t,r,n){const i=t.get(),a=i+n*Float64Array.BYTES_PER_ELEMENT,o=new Uint8Array(e.subarray(i,a)).buffer,s=new Float64Array(o);t.set(a);const l=r.size(),c=new Float64Array(l);let u=0;for(let e=0;e<l;e++)c[e]=r.get(e)?s[u++]:0;return c}(e,t,n,i.numValues):function(e,t,r){const n=t.get(),i=n+r*Float64Array.BYTES_PER_ELEMENT,a=new Uint8Array(e.subarray(n,i)).buffer,o=new Float64Array(a);return t.set(i),o}(e,t,i.numValues);return new Uh(r.name,a,n)}(t,r,a,l);default:throw new Error(`The specified data type for the field is currently not supported: ${i}`)}}(n,e,t,i,r.scalarType,r):1!=n?null:ip.decodeSharedDictionary(e,t,r,i,a)}function op(e){return e instanceof wd}class sp{static decodeColumnType(e){switch(e){case 0:case 1:case 2:case 3:{const t={};t.nullable=!!(1&e),t.columnScope=0;const r={};return r.physicalType=e>1?6:4,r.type="physicalType",t.scalarType=r,t.type="scalarType",t}case 4:{const e={nullable:!1,columnScope:0},t={type:"physicalType",physicalType:0};return e.type="complexType",e.complexType=t,e}case 30:{const e={nullable:!1,columnScope:0},t={type:"physicalType",physicalType:1};return e.type="complexType",e.complexType=t,e}default:return this.mapScalarType(e)}}static columnTypeHasName(e){return e>=10}static columnTypeHasChildren(e){return 30===e}static hasStreamCount(e){if("id"===e.name)return!1;if("scalarType"===e.type){const t=e.scalarType;if("physicalType"===t.type)switch(t.physicalType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:default:return!1;case 9:return!0}else if("logicalType"===t.type)return!1}else if("complexType"===e.type){const t=e.complexType;if("physicalType"===t.type)switch(t.physicalType){case 0:case 1:return!0;default:return!1}}return console.warn("Unexpected column type in hasStreamCount",e),!1}static mapScalarType(e){let t=null;switch(e){case 10:case 11:t=0;break;case 12:case 13:t=1;break;case 14:case 15:t=2;break;case 16:case 17:t=3;break;case 18:case 19:t=4;break;case 20:case 21:t=5;break;case 22:case 23:t=6;break;case 24:case 25:t=7;break;case 26:case 27:t=8;break;case 28:case 29:t=9;break;default:return null}const r={};r.nullable=!!(1&e),r.columnScope=0;const n={type:"physicalType"};return n.physicalType=t,r.type="scalarType",r.scalarType=n,r}}const lp=new TextDecoder;function cp(e,t){const r=ad(e,t,1)[0];if(0===r)return"";const n=t.get(),i=e.subarray(n,n+r);return t.add(r),lp.decode(i)}function up(e,t){const r=ad(e,t,1)[0]>>>0,n=!!(4&r),i=!!(2&r),a=ad(e,t,1)[0]>>>0,o={};if(1&r&&(o.nullable=!0),i){const i={};if(n?(i.type="logicalType",i.logicalType=a):(i.type="physicalType",i.physicalType=a),8&r){const r=ad(e,t,1)[0]>>>0;i.children=new Array(r);for(let n=0;n<r;n++)i.children[n]=up(e,t)}o.type="complexField",o.complexField=i}else{const e={};n?(e.type="logicalType",e.logicalType=a):(e.type="physicalType",e.physicalType=a),o.type="scalarField",o.scalarField=e}return o}function hp(e,t){const r=ad(e,t,1)[0]>>>0,n=sp.decodeColumnType(r);if(!n)throw new Error(`Unsupported column type code: ${r}`);if(sp.columnTypeHasName(r)?n.name=cp(e,t):r>=0&&r<=3?n.name="id":4===r&&(n.name="geometry"),sp.columnTypeHasChildren(r)){const r=ad(e,t,1)[0]>>>0,i=n.complexType;i.children=new Array(r);for(let n=0;n<r;n++)i.children[n]=up(e,t)}return n}function dp(e,t){const r={featureTables:[]},n={};n.name=cp(e,t);const i=ad(e,t,1)[0]>>>0,a=ad(e,t,1)[0]>>>0;n.columns=new Array(a);for(let r=0;r<a;r++)n.columns[r]=hp(e,t);return r.featureTables.push(n),[r,i]}function pp(e,t,r,n,i,a,o=!1){const s=t.scalarType.physicalType,l=Td.getVectorType(i,a,e,r);if(4===s)switch(l){case ed.FLAT:{const t=Td.decodeIntStream(e,r,i,!1);return new jh(n,t,a)}case ed.SEQUENCE:{const t=Td.decodeSequenceIntStream(e,r,i);return new qh(n,t[0],t[1],i.numRleValues)}case ed.CONST:{const t=Td.decodeConstIntStream(e,r,i,!1);return new $h(n,t,a)}}else switch(l){case ed.FLAT:{if(o){const t=Td.decodeLongFloat64Stream(e,r,i,!1);return new Uh(n,t,a)}const t=Td.decodeLongStream(e,r,i,!1);return new Sd(n,t,a)}case ed.SEQUENCE:{const t=Td.decodeSequenceLongStream(e,r,i);return new Pd(n,t[0],t[1],i.numRleValues)}case ed.CONST:{const t=Td.decodeConstLongStream(e,r,i,!1);return new Wd(n,t,a)}}throw new Error("Vector type not supported for id column.")}class fp{constructor(e,t){var r;switch(this._featureData=e,this.properties=this._featureData.properties||{},null===(r=this._featureData.geometry)||void 0===r?void 0:r.type){case td.POINT:case td.MULTIPOINT:this.type=1;break;case td.LINESTRING:case td.MULTILINESTRING:this.type=2;break;case td.POLYGON:case td.MULTIPOLYGON:this.type=3;break;default:this.type=0}this.extent=t,this.id=Number(this._featureData.id)}projectPoint(e,t,r,n){return[360*(e.x+t)/n-180,360/Math.PI*Math.atan(Math.exp((1-2*(e.y+r)/n)*Math.PI))-90]}projectLine(e,t,r,n){return e.map(e=>this.projectPoint(e,t,r,n))}toGeoJSON(e,t,r){const n=this.extent*Math.pow(2,r),i=this.extent*e,a=this.extent*t,o=this.loadGeometry();let s;switch(this.type){case 1:{const e=[];for(const t of o)e.push(t[0]);const t=this.projectLine(e,i,a,n);s=1===e.length?{type:"Point",coordinates:t[0]}:{type:"MultiPoint",coordinates:t};break}case 2:{const e=o.map(e=>this.projectLine(e,i,a,n));s=1===e.length?{type:"LineString",coordinates:e[0]}:{type:"MultiLineString",coordinates:e};break}case 3:{const e=Qr(o),t=[];for(const r of e)t.push(r.map(e=>this.projectLine(e,i,a,n)));s=1===t.length?{type:"Polygon",coordinates:t[0]}:{type:"MultiPolygon",coordinates:t};break}default:throw new Error(`unknown feature type: ${this.type}`)}const l={type:"Feature",geometry:s,properties:this.properties};return null!=this.id&&(l.id=this.id),l}loadGeometry(){const e=[];for(const t of this._featureData.geometry.coordinates){const n=[];for(const e of t)n.push(new r(e.x,e.y));e.push(n)}return e}bbox(){return[0,0,0,0]}}class mp{constructor(e){this.features=[],this.featureTable=e,this.name=e.name,this.extent=e.extent,this.version=2,this.features=e.getFeatures(),this.length=this.features.length}feature(e){return new fp(this.features[e],this.extent)}}class gp{constructor(e){this.layers={};const t=function(e,t,r=!0){const n=new Hh(0),i=[];for(;n.get()<e.length;){const a=ad(e,n,1)[0]>>>0,o=n.get()+a;if(o>e.length)throw new Error(`Block overruns tile: ${o} > ${e.length}`);if(1!=ad(e,n,1)[0]>>>0){n.set(o);continue}const s=dp(e,n),l=s[1],c=s[0].featureTables[0];let u=null,h=null;const d=[];let p=0;for(const i of c.columns){const a=i.name;if("id"===a){let t=null;if(i.nullable){const r=xd.decode(e,n),i=n.get(),a=Yd(e,r.numValues,n);n.set(i+r.byteLength),t=new wd(a,r.numValues)}const o=xd.decode(e,n);p=o.getDecompressedCount(),u=pp(e,i,n,a,o,t??p,r)}else if("geometry"===a){const r=ad(e,n,1)[0];if(0===p){const t=n.get();p=xd.decode(e,n).getDecompressedCount(),n.set(t)}h=Gd(e,r,n,p,t)}else{const t=sp.hasStreamCount(i)?ad(e,n,1)[0]:1;if(0===t&&"scalarType"===i.type)continue;const r=ap(e,n,i,t,p,void 0);r&&(Array.isArray(r)?d.push(...r):d.push(r))}}const f=new Zh(c.name,h,u,d,l);i.push(f),n.set(o)}return i}(new Uint8Array(e));this.layers=t.reduce((e,t)=>Object.assign(Object.assign({},e),{[t.name]:new mp(t)}),{})}}class _p{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(e){return this.minX=Math.min(this.minX,e.x),this.minY=Math.min(this.minY,e.y),this.maxX=Math.max(this.maxX,e.x),this.maxY=Math.max(this.maxY,e.y),this}expandBy(e){return this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(e){return this.expandBy(-e)}map(e){const t=new _p;return t.extend(e(new r(this.minX,this.minY))),t.extend(e(new r(this.maxX,this.minY))),t.extend(e(new r(this.minX,this.maxY))),t.extend(e(new r(this.maxX,this.maxY))),t}static fromPoints(e){const t=new _p;for(const r of e)t.extend(r);return t}contains(e){return e.x>=this.minX&&e.x<=this.maxX&&e.y>=this.minY&&e.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(e){return!this.empty()&&!e.empty()&&e.minX>=this.minX&&e.maxX<=this.maxX&&e.minY>=this.minY&&e.maxY<=this.maxY}intersects(e){return!this.empty()&&!e.empty()&&e.minX<=this.maxX&&e.maxX>=this.minX&&e.minY<=this.maxY&&e.maxY>=this.minY}}const yp="_geojsonTileLayer";class vp{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new aa(k,16,0),this.grid3D=new aa(k,16,0),this.featureIndexArray=new Fo,this.promoteId=t}insert(e,t,r,n,i,a){const o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,n,i);const s=a?this.grid3D:this.grid;for(let e=0;e<t.length;e++){const r=t[e],n=[1/0,1/0,-1/0,-1/0];for(let e=0;e<r.length;e++){const t=r[e];n[0]=Math.min(n[0],t.x),n[1]=Math.min(n[1],t.y),n[2]=Math.max(n[2],t.x),n[3]=Math.max(n[3],t.y)}n[0]<k&&n[1]<k&&n[2]>=0&&n[3]>=0&&s.insert(o,n[0],n[1],n[2],n[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers="mlt"!==this.encoding?new Mc(new bu(this.rawTileData)).layers:new gp(this.rawTileData).layers,this.sourceLayerCoder=new Bh(this.vtLayers?Object.keys(this.vtLayers).sort():[yp])),this.vtLayers}query(e,t,n,i){this.loadVTLayers();const a=e.params,o=k/e.tileSize/e.scale,s=hi(a.filter,a.globalState),l=e.queryGeometry,c=e.queryPadding*o,u=_p.fromPoints(l),h=this.grid.query(u.minX-c,u.minY-c,u.maxX+c,u.maxY+c),d=_p.fromPoints(e.cameraQueryGeometry).expandBy(c),p=this.grid3D.query(d.minX,d.minY,d.maxX,d.maxY,(t,n,i,a)=>function(e,t,n,i,a){for(const r of e)if(t<=r.x&&n<=r.y&&i>=r.x&&a>=r.y)return!0;const o=[new r(t,n),new r(t,a),new r(i,a),new r(i,n)];if(e.length>2)for(const t of o)if(Xs(e,t))return!0;for(let t=0;t<e.length-1;t++)if(Ys(e[t],e[t+1],o))return!0;return!1}(e.cameraQueryGeometry,t-c,n-c,i+c,a+c));for(const e of p)h.push(e);h.sort(xp);const f={};let m;for(let r=0;r<h.length;r++){const c=h[r];if(c===m)continue;m=c;const u=this.featureIndexArray.get(c);let d=null;this.loadMatchingFeature(f,u.bucketIndex,u.sourceLayerIndex,u.featureIndex,s,a.layers,a.availableImages,t,n,i,(t,r,n)=>(d||(d=Rs(t)),r.queryIntersectsFeature({queryGeometry:l,feature:t,featureState:n,geometry:d,zoom:this.z,transform:e.transform,pixelsToTileUnits:o,pixelPosMatrix:e.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:e.getElevation})))}return f}loadMatchingFeature(e,t,r,n,i,a,o,s,l,c,u){const h=this.bucketLayerIDs[t];if(a&&!h.some(e=>a.has(e)))return;const d=this.sourceLayerCoder.decode(r),p=this.vtLayers[d].feature(n);if(i.needGeometry){const e=Fs(p,!0);if(!i.filter(new Ma(this.tileID.overscaledZ),e,this.tileID.canonical))return}else if(!i.filter(new Ma(this.tileID.overscaledZ),p))return;const f=this.getId(p,d);for(let t=0;t<h.length;t++){const r=h[t];if(a&&!a.has(r))continue;const i=s[r];if(!i)continue;let d={};f&&c&&(d=c.getState(i.sourceLayer||yp,f));const m=O({},l[r]);m.paint=bp(m.paint,i.paint,p,d,o),m.layout=bp(m.layout,i.layout,p,d,o);const g=!u||u(p,i,d);if(!g)continue;const _=new Oh(p,this.z,this.x,this.y,f);_.layer=m;let y=e[r];void 0===y&&(y=e[r]=[]),y.push({featureIndex:n,feature:_,intersectionZ:g})}}lookupSymbolFeatures(e,t,r,n,i,a,o,s){const l={};this.loadVTLayers();const c=hi(i.filterSpec,i.globalState);for(const i of e)this.loadMatchingFeature(l,r,n,i,c,a,o,s,t);return l}hasLayer(e){for(const t of this.bucketLayerIDs)for(const r of t)if(e===r)return!0;return!1}getId(e,t){var r;let n=e.id;return this.promoteId&&(n=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[t]],"boolean"==typeof n&&(n=Number(n)),void 0===n&&(null===(r=e.properties)||void 0===r?void 0:r.cluster)&&this.promoteId&&(n=Number(e.properties.cluster_id))),n}}function bp(e,t,r,n,i){return V(e,(e,a)=>{const o=t instanceof Oa?t.get(a):null;return o&&o.evaluate?o.evaluate(r,n,i):o})}function xp(e,t){return t-e}function wp(e,t,n,i,a){const o=[];for(let s=0;s<e.length;s++){const l=e[s];let c;for(let e=0;e<l.length-1;e++){let s=l[e],u=l[e+1];s.x<t&&u.x<t||(s.x<t?s=new r(t,s.y+(t-s.x)/(u.x-s.x)*(u.y-s.y))._round():u.x<t&&(u=new r(t,s.y+(t-s.x)/(u.x-s.x)*(u.y-s.y))._round()),s.y<n&&u.y<n||(s.y<n?s=new r(s.x+(n-s.y)/(u.y-s.y)*(u.x-s.x),n)._round():u.y<n&&(u=new r(s.x+(n-s.y)/(u.y-s.y)*(u.x-s.x),n)._round()),s.x>=i&&u.x>=i||(s.x>=i?s=new r(i,s.y+(i-s.x)/(u.x-s.x)*(u.y-s.y))._round():u.x>=i&&(u=new r(i,s.y+(i-s.x)/(u.x-s.x)*(u.y-s.y))._round()),s.y>=a&&u.y>=a||(s.y>=a?s=new r(s.x+(a-s.y)/(u.y-s.y)*(u.x-s.x),a)._round():u.y>=a&&(u=new r(s.x+(a-s.y)/(u.y-s.y)*(u.x-s.x),a)._round()),c&&s.equals(c[c.length-1])||(c=[s],o.push(c)),c.push(u)))))}}return o}function Tp(e,t,r,n,i){switch(t){case 1:return function(e,t,r,n){const i=[];for(const a of e)for(const e of a){const a=0===n?e.x:e.y;a>=t&&a<=r&&i.push([e])}return i}(e,r,n,i);case 2:return Pp(e,r,n,i,!1);case 3:return Pp(e,r,n,i,!0)}return[]}function Sp(e,t,n,i,a){const o=0===i?Ep:Cp;let s=[];const l=[];for(let r=0;r<e.length-1;r++){const c=e[r],u=e[r+1],h=0===i?c.x:c.y,d=0===i?u.x:u.y;let p=!1;h<t?d>t&&s.push(o(c,u,t)):h>n?d<n&&s.push(o(c,u,n)):s.push(c),d<t&&h>=t&&(s.push(o(c,u,t)),p=!0),d>n&&h<=n&&(s.push(o(c,u,n)),p=!0),!a&&p&&(l.push(s),s=[])}const c=e.length-1,u=0===i?e[c].x:e[c].y;return u>=t&&u<=n&&s.push(e[c]),a&&s.length>0&&!s[0].equals(s[s.length-1])&&s.push(new r(s[0].x,s[0].y)),s.length>0&&l.push(s),l}function Pp(e,t,r,n,i){const a=[];for(const o of e){const e=Sp(o,t,r,n,i);e.length>0&&a.push(...e)}return a}function Ep(e,t,n){return new r(n,e.y+(n-e.x)/(t.x-e.x)*(t.y-e.y))}function Cp(e,t,n){return new r(e.x+(n-e.y)/(t.y-e.y)*(t.x-e.x),n)}sa("FeatureIndex",vp,{omit:["rawTileData","sourceLayerCoder"]});class Mp extends r{constructor(e,t,r,n){super(e,t),this.angle=r,void 0!==n&&(this.segment=n)}clone(){return new Mp(this.x,this.y,this.angle,this.segment)}}function kp(e,t,r,n,i){if(void 0===t.segment||0===r)return!0;let a=t,o=t.segment+1,s=0;for(;s>-r/2;){if(o--,o<0)return!1;s-=e[o].dist(a),a=e[o]}s+=e[o].dist(e[o+1]),o++;const l=[];let c=0;for(;s<r/2;){const t=e[o],r=e[o+1];if(!r)return!1;let a=e[o-1].angleTo(t)-t.angleTo(r);for(a=Math.abs((a+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:a}),c+=a;s-l[0].distance>n;)c-=l.shift().angleDelta;if(c>i)return!1;o++,s+=t.dist(r)}return!0}function Ip(e){let t=0;for(let r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Ap(e,t,r){return e?.6*t*r:0}function zp(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Dp(e,t,r,n,i,a){const o=Ap(r,i,a),s=zp(r,n)*a;let l=0;const c=Ip(e)/2;for(let r=0;r<e.length-1;r++){const n=e[r],i=e[r+1],a=n.dist(i);if(l+a>c){const u=(c-l)/a,h=pr.number(n.x,i.x,u),d=pr.number(n.y,i.y,u),p=new Mp(h,d,i.angleTo(n),r);return p._round(),!o||kp(e,p,s,o,t)?p:void 0}l+=a}}function Lp(e,t,r,n,i,a,o,s,l){const c=Ap(n,a,o),u=zp(n,i),h=u*o,d=0===e[0].x||e[0].x===l||0===e[0].y||e[0].y===l;return t-h<t/4&&(t=h+t/4),Rp(e,d?t/2*s%t:(u/2+2*a)*o*s%t,t,c,r,h,d,!1,l)}function Rp(e,t,r,n,i,a,o,s,l){const c=a/2,u=Ip(e);let h=0,d=t-r,p=[];for(let t=0;t<e.length-1;t++){const o=e[t],s=e[t+1],f=o.dist(s),m=s.angleTo(o);for(;d+r<h+f;){d+=r;const g=(d-h)/f,_=pr.number(o.x,s.x,g),y=pr.number(o.y,s.y,g);if(_>=0&&_<l&&y>=0&&y<l&&d-c>=0&&d+c<=u){const r=new Mp(_,y,m,t);r._round(),n&&!kp(e,r,a,n,i)||p.push(r)}}h+=f}return s||p.length||o||(p=Rp(e,h/2,r,n,i,a,o,!0,l)),p}function Fp(e,t,n,i){const a=[],o=e.image,s=o.pixelRatio,l=o.paddedRect.w-2,c=o.paddedRect.h-2;let u={x1:e.left,y1:e.top,x2:e.right,y2:e.bottom};const h=o.stretchX||[[0,l]],d=o.stretchY||[[0,c]],p=(e,t)=>e+t[1]-t[0],f=h.reduce(p,0),m=d.reduce(p,0),g=l-f,_=c-m;let y=0,v=f,b=0,x=m,w=0,T=g,S=0,P=_;if(o.content&&i){const t=o.content,r=t[2]-t[0],n=t[3]-t[1];(o.textFitWidth||o.textFitHeight)&&(u=Wu(e)),y=Bp(h,0,t[0]),b=Bp(d,0,t[1]),v=Bp(h,t[0],t[2]),x=Bp(d,t[1],t[3]),w=t[0]-y,S=t[1]-b,T=r-v,P=n-x}const E=u.x1,C=u.y1,M=u.x2-E,k=u.y2-C,I=(e,i,a,l)=>{const c=Np(e.stretch-y,v,M,E),u=Vp(e.fixed-w,T,e.stretch,f),h=Np(i.stretch-b,x,k,C),d=Vp(i.fixed-S,P,i.stretch,m),p=Np(a.stretch-y,v,M,E),g=Vp(a.fixed-w,T,a.stretch,f),_=Np(l.stretch-b,x,k,C),I=Vp(l.fixed-S,P,l.stretch,m),A=new r(c,h),z=new r(p,h),D=new r(p,_),L=new r(c,_),R=new r(u/s,d/s),F=new r(g/s,I/s),B=t*Math.PI/180;if(B){const e=Math.sin(B),t=Math.cos(B),r=[t,-e,e,t];A._matMult(r),z._matMult(r),L._matMult(r),D._matMult(r)}const O=e.stretch+e.fixed,N=i.stretch+i.fixed;return{tl:A,tr:z,bl:L,br:D,tex:{x:o.paddedRect.x+1+O,y:o.paddedRect.y+1+N,w:a.stretch+a.fixed-O,h:l.stretch+l.fixed-N},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:R,pixelOffsetBR:F,minFontScaleX:T/s/M,minFontScaleY:P/s/k,isSDF:n}};if(i&&(o.stretchX||o.stretchY)){const e=Op(h,g,f),t=Op(d,_,m);for(let r=0;r<e.length-1;r++){const n=e[r],i=e[r+1];for(let e=0;e<t.length-1;e++)a.push(I(n,t[e],i,t[e+1]))}}else a.push(I({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:c+1}));return a}function Bp(e,t,r){let n=0;for(const i of e)n+=Math.max(t,Math.min(r,i[1]))-Math.max(t,Math.min(r,i[0]));return n}function Op(e,t,r){const n=[{fixed:-1,stretch:0}];for(const[t,r]of e){const e=n[n.length-1];n.push({fixed:t-e.stretch,stretch:e.stretch}),n.push({fixed:t-e.stretch,stretch:e.stretch+(r-t)})}return n.push({fixed:t+1,stretch:r}),n}function Np(e,t,r,n){return e/t*r+n}function Vp(e,t,r,n){return e-t*r/n}sa("Anchor",Mp);class jp{constructor(e,t,n,i,a,o,s,l,c,u){var h;if(this.boxStartIndex=e.length,c){let e=o.top,t=o.bottom;const r=o.collisionPadding;r&&(e-=r[1],t+=r[3]);let n=t-e;n>0&&(n=Math.max(10,n),this.circleDiameter=n)}else{const c=(null===(h=o.image)||void 0===h?void 0:h.content)&&(o.image.textFitWidth||o.image.textFitHeight)?Wu(o):{x1:o.left,y1:o.top,x2:o.right,y2:o.bottom};c.y1=c.y1*s-l[0],c.y2=c.y2*s+l[2],c.x1=c.x1*s-l[3],c.x2=c.x2*s+l[1];const d=o.collisionPadding;if(d&&(c.x1-=d[0]*s,c.y1-=d[1]*s,c.x2+=d[2]*s,c.y2+=d[3]*s),u){const e=new r(c.x1,c.y1),t=new r(c.x2,c.y1),n=new r(c.x1,c.y2),i=new r(c.x2,c.y2),a=u*Math.PI/180;e._rotate(a),t._rotate(a),n._rotate(a),i._rotate(a),c.x1=Math.min(e.x,t.x,n.x,i.x),c.x2=Math.max(e.x,t.x,n.x,i.x),c.y1=Math.min(e.y,t.y,n.y,i.y),c.y2=Math.max(e.y,t.y,n.y,i.y)}e.emplaceBack(t.x,t.y,c.x1,c.y1,c.x2,c.y2,n,i,a)}this.boxEndIndex=e.length}}class Up{constructor(e=[],t=(e,t)=>e<t?-1:e>t?1:0){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let e=(this.length>>1)-1;e>=0;e--)this._down(e)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:r}=this,n=t[e];for(;e>0;){const i=e-1>>1,a=t[i];if(r(n,a)>=0)break;t[e]=a,e=i}t[e]=n}_down(e){const{data:t,compare:r}=this,n=this.length>>1,i=t[e];for(;e<n;){let n=1+(e<<1);const a=n+1;if(a<this.length&&r(t[a],t[n])<0&&(n=a),r(t[n],i)>=0)break;t[e]=t[n],e=n}t[e]=i}}function Gp(e,t=1,n=!1){const i=_p.fromPoints(e[0]),a=Math.min(i.width(),i.height());let o=a/2;const s=new Up([],qp),{minX:l,minY:c,maxX:u,maxY:h}=i;if(0===a)return new r(l,c);for(let t=l;t<u;t+=a)for(let r=c;r<h;r+=a)s.push(new $p(t+o,r+o,o,e));let d=function(e){let t=0,r=0,n=0;const i=e[0];for(let e=0,a=i.length,o=a-1;e<a;o=e++){const a=i[e],s=i[o],l=a.x*s.y-s.x*a.y;r+=(a.x+s.x)*l,n+=(a.y+s.y)*l,t+=3*l}return new $p(r/t,n/t,0,e)}(e),p=s.length;for(;s.length;){const r=s.pop();(r.d>d.d||!d.d)&&(d=r,n&&console.log("found best %d after %d probes",Math.round(1e4*r.d)/1e4,p)),r.max-d.d<=t||(o=r.h/2,s.push(new $p(r.p.x-o,r.p.y-o,o,e)),s.push(new $p(r.p.x+o,r.p.y-o,o,e)),s.push(new $p(r.p.x-o,r.p.y+o,o,e)),s.push(new $p(r.p.x+o,r.p.y+o,o,e)),p+=4)}return n&&(console.log(`num probes: ${p}`),console.log(`best distance: ${d.d}`)),d.p}function qp(e,t){return t.max-e.max}function $p(e,t,n,i){this.p=new r(e,t),this.h=n,this.d=function(e,t){let r=!1,n=1/0;for(let i=0;i<t.length;i++){const a=t[i];for(let t=0,i=a.length,o=i-1;t<i;o=t++){const i=a[t],s=a[o];i.y>e.y!=s.y>e.y&&e.x<(s.x-i.x)*(e.y-i.y)/(s.y-i.y)+i.x&&(r=!r),n=Math.min(n,Hs(e,i,s))}}return(r?1:-1)*Math.sqrt(n)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}var Zp;e.aO=void 0,(Zp=e.aO||(e.aO={}))[Zp.center=1]="center",Zp[Zp.left=2]="left",Zp[Zp.right=3]="right",Zp[Zp.top=4]="top",Zp[Zp.bottom=5]="bottom",Zp[Zp["top-left"]=6]="top-left",Zp[Zp["top-right"]=7]="top-right",Zp[Zp["bottom-left"]=8]="bottom-left",Zp[Zp["bottom-right"]=9]="bottom-right";const Hp=Number.POSITIVE_INFINITY;function Wp(e,t){return t[1]!==Hp?function(e,t,r){let n=0,i=0;switch(t=Math.abs(t),r=Math.abs(r),e){case"top-right":case"top-left":case"top":i=r-7;break;case"bottom-right":case"bottom-left":case"bottom":i=7-r}switch(e){case"top-right":case"bottom-right":case"right":n=-t;break;case"top-left":case"bottom-left":case"left":n=t}return[n,i]}(e,t[0],t[1]):function(e,t){let r=0,n=0;t<0&&(t=0);const i=t/Math.SQRT2;switch(e){case"top-right":case"top-left":n=i-7;break;case"bottom-right":case"bottom-left":n=7-i;break;case"bottom":n=7-t;break;case"top":n=t-7}switch(e){case"top-right":case"bottom-right":r=-i;break;case"top-left":case"bottom-left":r=i;break;case"left":r=t;break;case"right":r=-t}return[r,n]}(e,t[0])}function Xp(e,t,r){var n;const i=e.layout,a=null===(n=i.get("text-variable-anchor-offset"))||void 0===n?void 0:n.evaluate(t,{},r);if(a){const e=a.values,t=[];for(let r=0;r<e.length;r+=2){const n=t[r]=e[r],i=e[r+1].map(e=>e*su);n.startsWith("top")?i[1]-=7:n.startsWith("bottom")&&(i[1]+=7),t[r+1]=i}return new Ft(t)}const o=i.get("text-variable-anchor");if(o){let n;n=void 0!==e._unevaluatedLayout.getValue("text-radial-offset")?[i.get("text-radial-offset").evaluate(t,{},r)*su,Hp]:i.get("text-offset").evaluate(t,{},r).map(e=>e*su);const a=[];for(const e of o)a.push(e,Wp(e,n));return new Ft(a)}return null}function Yp(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Kp(t,r,n,i,a,o,s,l,c,u,h,d){let p=o.textMaxSize.evaluate(r,{});void 0===p&&(p=s);const f=t.layers[0].layout,m=f.get("icon-offset").evaluate(r,{},h),g=Jp(n.horizontal),_=s/24,y=t.tilePixelRatio*_,v=t.tilePixelRatio*p/24,b=t.tilePixelRatio*l,x=t.tilePixelRatio*f.get("symbol-spacing"),w=f.get("text-padding")*t.tilePixelRatio,T=function(e,t,r,n=1){const i=e.get("icon-padding").evaluate(t,{},r),a=i&&i.values;return[a[0]*n,a[1]*n,a[2]*n,a[3]*n]}(f,r,h,t.tilePixelRatio),S=f.get("text-max-angle")/180*Math.PI,P="viewport"!==f.get("text-rotation-alignment")&&"point"!==f.get("symbol-placement"),E="map"===f.get("icon-rotation-alignment")&&"point"!==f.get("symbol-placement"),C=f.get("symbol-placement"),M=x/2,I=f.get("icon-text-fit");let A;i&&"none"!==I&&(t.allowVerticalPlacement&&n.vertical&&(A=Xu(i,n.vertical,I,f.get("icon-text-fit-padding"),m,_)),g&&(i=Xu(i,g,I,f.get("icon-text-fit-padding"),m,_)));const z=h?d.line.getGranularityForZoomLevel(h.z):1,D=(l,d)=>{d.x<0||d.x>=k||d.y<0||d.y>=k||function(t,r,n,i,a,o,s,l,c,u,h,d,p,f,m,g,_,y,v,b,x,w,T,S,P){const E=t.addToLineVertexArray(r,n);let C,M,k,I,A=0,z=0,D=0,L=0,R=-1,F=-1;const B={};let O=hs("");if(t.allowVerticalPlacement&&i.vertical){const e=l.layout.get("text-rotate").evaluate(x,{},S)+90;k=new jp(c,r,u,h,d,i.vertical,p,f,m,e),s&&(I=new jp(c,r,u,h,d,s,_,y,m,e))}if(a){const n=l.layout.get("icon-rotate").evaluate(x,{}),i="none"!==l.layout.get("icon-text-fit"),o=Fp(a,n,T,i),p=s?Fp(s,n,T,i):void 0;M=new jp(c,r,u,h,d,a,_,y,!1,n),A=4*o.length;const f=t.iconSizeData;let m=null;"source"===f.kind?(m=[Yu*l.layout.get("icon-size").evaluate(x,{})],m[0]>Ku&&q(`${t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===f.kind&&(m=[Yu*w.compositeIconSizes[0].evaluate(x,{},S),Yu*w.compositeIconSizes[1].evaluate(x,{},S)],(m[0]>Ku||m[1]>Ku)&&q(`${t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),t.addSymbols(t.icon,o,m,b,v,x,e.ay.none,r,E.lineStartIndex,E.lineLength,-1,S),R=t.icon.placedSymbolArray.length-1,p&&(z=4*p.length,t.addSymbols(t.icon,p,m,b,v,x,e.ay.vertical,r,E.lineStartIndex,E.lineLength,-1,S),F=t.icon.placedSymbolArray.length-1)}const N=Object.keys(i.horizontal);for(const n of N){const a=i.horizontal[n];if(!C){O=hs(a.text);const e=l.layout.get("text-rotate").evaluate(x,{},S);C=new jp(c,r,u,h,d,a,p,f,m,e)}const s=1===a.positionedLines.length;if(D+=Qp(t,r,a,o,l,m,x,g,E,i.vertical?e.ay.horizontal:e.ay.horizontalOnly,s?N:[n],B,R,w,S),s)break}i.vertical&&(L+=Qp(t,r,i.vertical,o,l,m,x,g,E,e.ay.vertical,["vertical"],B,F,w,S));const V=C?C.boxStartIndex:t.collisionBoxArray.length,j=C?C.boxEndIndex:t.collisionBoxArray.length,U=k?k.boxStartIndex:t.collisionBoxArray.length,G=k?k.boxEndIndex:t.collisionBoxArray.length,$=M?M.boxStartIndex:t.collisionBoxArray.length,Z=M?M.boxEndIndex:t.collisionBoxArray.length,H=I?I.boxStartIndex:t.collisionBoxArray.length,W=I?I.boxEndIndex:t.collisionBoxArray.length;let X=-1;const Y=(e,t)=>e&&e.circleDiameter?Math.max(e.circleDiameter,t):t;X=Y(C,X),X=Y(k,X),X=Y(M,X),X=Y(I,X);const K=X>-1?1:0;K&&(X*=P/su),t.glyphOffsetArray.length>=oh.MAX_GLYPHS&&q("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==x.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,x.sortKey);const Q=Xp(l,x,S),[J,ee]=function(t,r){const n=t.length,i=null==r?void 0:r.values;if((null==i?void 0:i.length)>0)for(let r=0;r<i.length;r+=2){const n=i[r+1];t.emplaceBack(e.aO[i[r]],n[0],n[1])}return[n,t.length]}(t.textAnchorOffsets,Q);t.symbolInstances.emplaceBack(r.x,r.y,B.right>=0?B.right:-1,B.center>=0?B.center:-1,B.left>=0?B.left:-1,B.vertical||-1,R,F,O,V,j,U,G,$,Z,H,W,u,D,L,A,z,K,0,p,X,J,ee)}(t,d,l,n,i,a,A,t.layers[0],t.collisionBoxArray,r.index,r.sourceLayerIndex,t.index,y,[w,w,w,w],P,c,b,T,E,m,r,o,u,h,s)};if("line"===C)for(const e of wp(r.geometry,0,0,k,k)){const r=hc(e,z),a=Lp(r,x,S,n.vertical||g,i,24,v,t.overscaling,k);for(const e of a)g&&ef(t,g.text,M,e)||D(r,e)}else if("line-center"===C){for(const e of r.geometry)if(e.length>1){const t=hc(e,z),r=Dp(t,S,n.vertical||g,i,24,v);r&&D(t,r)}}else if("Polygon"===r.type)for(const e of Qr(r.geometry,0)){const t=Gp(e,16);D(hc(e[0],z,!0),new Mp(t.x,t.y,0))}else if("LineString"===r.type)for(const e of r.geometry){const t=hc(e,z);D(t,new Mp(t[0].x,t[0].y,0))}else if("Point"===r.type)for(const e of r.geometry)for(const t of e)D([t],new Mp(t.x,t.y,0))}function Qp(e,t,n,i,a,o,s,l,c,u,h,d,p,f,m){const g=function(e,t,n,i,a,o,s,l){const c=i.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,u=[];for(const e of t.positionedLines)for(const i of e.positionedGlyphs){if(!i.rect)continue;const o=i.rect||{};let h=4,d=!0,p=1,f=0;const m=(a||l)&&i.vertical,g=i.metrics.advance*i.scale/2;if(l&&t.verticalizable&&(f=e.lineOffset/2-(i.imageName?-(su-i.metrics.width*i.scale)/2:(i.scale-1)*su)),i.imageName){const e=s[i.imageName];d=e.sdf,p=e.pixelRatio,h=1/p}const _=a?[i.x+g,i.y]:[0,0];let y=a?[0,0]:[i.x+g+n[0],i.y+n[1]-f],v=[0,0];m&&(v=y,y=[0,0]);const b=i.metrics.isDoubleResolution?2:1,x=(i.metrics.left-h)*i.scale-g+y[0],w=(-i.metrics.top-h)*i.scale+y[1],T=x+o.w/b*i.scale/p,S=w+o.h/b*i.scale/p,P=new r(x,w),E=new r(T,w),C=new r(x,S),M=new r(T,S);if(m){const e=new r(-g,g- -17),t=-Math.PI/2,n=12-g,a=new r(22-n,-(i.imageName?n:0)),o=new r(...v);P._rotateAround(t,e)._add(a)._add(o),E._rotateAround(t,e)._add(a)._add(o),C._rotateAround(t,e)._add(a)._add(o),M._rotateAround(t,e)._add(a)._add(o)}if(c){const e=Math.sin(c),t=Math.cos(c),r=[t,-e,e,t];P._matMult(r),E._matMult(r),C._matMult(r),M._matMult(r)}const k=new r(0,0),I=new r(0,0);u.push({tl:P,tr:E,bl:C,br:M,tex:o,writingMode:t.writingMode,glyphOffset:_,sectionIndex:i.sectionIndex,isSDF:d,pixelOffsetTL:k,pixelOffsetBR:I,minFontScaleX:0,minFontScaleY:0})}return u}(0,n,l,a,o,s,i,e.allowVerticalPlacement),_=e.textSizeData;let y=null;"source"===_.kind?(y=[Yu*a.layout.get("text-size").evaluate(s,{})],y[0]>Ku&&q(`${e.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===_.kind&&(y=[Yu*f.compositeTextSizes[0].evaluate(s,{},m),Yu*f.compositeTextSizes[1].evaluate(s,{},m)],(y[0]>Ku||y[1]>Ku)&&q(`${e.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),e.addSymbols(e.text,g,y,l,o,s,u,t,c.lineStartIndex,c.lineLength,p,m);for(const t of h)d[t]=e.text.placedSymbolArray.length-1;return 4*g.length}function Jp(e){for(const t in e)return e[t];return null}function ef(e,t,r,n){const i=e.compareText;if(t in i){const e=i[t];for(let t=e.length-1;t>=0;t--)if(n.dist(e[t])<r)return!0}else i[t]=[];return i[t].push(n),!1}const tf=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class rf{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,r]=new Uint8Array(e,0,2);if(219!==t)throw new Error("Data does not appear to be in a KDBush format.");const n=r>>4;if(1!==n)throw new Error(`Got v${n} data when expected v1.`);const i=tf[15&r];if(!i)throw new Error("Unrecognized array type.");const[a]=new Uint16Array(e,2,1),[o]=new Uint32Array(e,4,1);return new rf(o,a,i,e)}constructor(e,t=64,r=Float64Array,n){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const i=tf.indexOf(this.ArrayType),a=2*e*this.ArrayType.BYTES_PER_ELEMENT,o=e*this.IndexArrayType.BYTES_PER_ELEMENT,s=(8-o%8)%8;if(i<0)throw new Error(`Unexpected typed array class: ${r}.`);n&&n instanceof ArrayBuffer?(this.data=n,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+o+s,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+a+o+s),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+o+s,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+i]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=t,r}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return nf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,r,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:a,nodeSize:o}=this,s=[0,i.length-1,0],l=[];for(;s.length;){const c=s.pop()||0,u=s.pop()||0,h=s.pop()||0;if(u-h<=o){for(let o=h;o<=u;o++){const s=a[2*o],c=a[2*o+1];s>=e&&s<=r&&c>=t&&c<=n&&l.push(i[o])}continue}const d=h+u>>1,p=a[2*d],f=a[2*d+1];p>=e&&p<=r&&f>=t&&f<=n&&l.push(i[d]),(0===c?e<=p:t<=f)&&(s.push(h),s.push(d-1),s.push(1-c)),(0===c?r>=p:n>=f)&&(s.push(d+1),s.push(u),s.push(1-c))}return l}within(e,t,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:n,coords:i,nodeSize:a}=this,o=[0,n.length-1,0],s=[],l=r*r;for(;o.length;){const c=o.pop()||0,u=o.pop()||0,h=o.pop()||0;if(u-h<=a){for(let r=h;r<=u;r++)lf(i[2*r],i[2*r+1],e,t)<=l&&s.push(n[r]);continue}const d=h+u>>1,p=i[2*d],f=i[2*d+1];lf(p,f,e,t)<=l&&s.push(n[d]),(0===c?e-r<=p:t-r<=f)&&(o.push(h),o.push(d-1),o.push(1-c)),(0===c?e+r>=p:t+r>=f)&&(o.push(d+1),o.push(u),o.push(1-c))}return s}}function nf(e,t,r,n,i,a){if(i-n<=r)return;const o=n+i>>1;af(e,t,o,n,i,a),nf(e,t,r,n,o-1,1-a),nf(e,t,r,o+1,i,1-a)}function af(e,t,r,n,i,a){for(;i>n;){if(i-n>600){const o=i-n+1,s=r-n+1,l=Math.log(o),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(o-c)/o)*(s-o/2<0?-1:1);af(e,t,r,Math.max(n,Math.floor(r-s*c/o+u)),Math.min(i,Math.floor(r+(o-s)*c/o+u)),a)}const o=t[2*r+a];let s=n,l=i;for(of(e,t,n,r),t[2*i+a]>o&&of(e,t,n,i);s<l;){for(of(e,t,s,l),s++,l--;t[2*s+a]<o;)s++;for(;t[2*l+a]>o;)l--}t[2*n+a]===o?of(e,t,n,l):(l++,of(e,t,l,i)),l<=r&&(n=l+1),r<=l&&(i=l-1)}}function of(e,t,r,n){sf(e,r,n),sf(t,2*r,2*n),sf(t,2*r+1,2*n+1)}function sf(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function lf(e,t,r,n){const i=e-r,a=t-n;return i*i+a*a}var cf;e.cG=void 0,(cf=e.cG||(e.cG={})).create="create",cf.load="load",cf.fullLoad="fullLoad";let uf=null,hf=[];const df=1e3/60,pf="loadTime",ff="fullLoadTime",mf={mark(e){performance.mark(e)},frame(e){const t=e;null!=uf&&hf.push(t-uf),uf=t},clearMetrics(){uf=null,hf=[],performance.clearMeasures(pf),performance.clearMeasures(ff);for(const t in e.cG)performance.clearMarks(e.cG[t])},getPerformanceMetrics(){performance.measure(pf,e.cG.create,e.cG.load),performance.measure(ff,e.cG.create,e.cG.fullLoad);const t=performance.getEntriesByName(pf)[0].duration,r=performance.getEntriesByName(ff)[0].duration,n=hf.length,i=1/(hf.reduce((e,t)=>e+t,0)/n/1e3),a=hf.filter(e=>e>df).reduce((e,t)=>e+(t-df)/df,0);return{loadTime:t,fullLoadTime:r,fps:i,percentDroppedFrames:a/(n+a)*100,totalFrames:n}}};e.$=h,e.A=p,e.B=ia,e.C=Ji,e.D=Na,e.E=_e,e.F=function([e,t,r]){return t+=90,t*=Math.PI/180,r*=Math.PI/180,{x:e*Math.cos(t)*Math.sin(r),y:e*Math.sin(t)*Math.sin(r),z:e*Math.cos(r)}},e.G=pr,e.H=Ma,e.I=Fu,e.J=ta,e.K=function(e){if(null==H){const t=e.navigator?e.navigator.userAgent:null;H=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return H},e.L=class{constructor(e,t){this.target=e,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new gh(()=>this.process()),this.subscription=J(this.target,"message",e=>this.receive(e),!1),this.globalScope=Z(self)?e:window}registerMessageHandler(e,t){this.messageHandlers[e]=t}unregisterMessageHandler(e){delete this.messageHandlers[e]}sendAsync(e,t){return new Promise((r,n)=>{const i=Math.round(1e18*Math.random()).toString(36).substring(0,10),a=t?J(t.signal,"abort",()=>{null==a||a.unsubscribe(),delete this.resolveRejects[i];const t={id:i,type:"<cancel>",origin:location.origin,targetMapId:e.targetMapId,sourceMapId:this.mapId};this.target.postMessage(t)},_h):null;this.resolveRejects[i]={resolve:e=>{null==a||a.unsubscribe(),r(e)},reject:e=>{null==a||a.unsubscribe(),n(e)}};const o=[],s=Object.assign(Object.assign({},e),{id:i,sourceMapId:this.mapId,origin:location.origin,data:ha(e.data,o)});this.target.postMessage(s,{transfer:o})})}receive(e){const t=e.data,r=t.id;if(!("file://"!==t.origin&&"file://"!==location.origin&&"resource://android"!==t.origin&&"resource://android"!==location.origin&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if("<cancel>"===t.type){delete this.tasks[r];const e=this.abortControllers[r];return delete this.abortControllers[r],void(e&&e.abort())}if(Z(self)||t.mustQueue)return this.tasks[r]=t,this.taskQueue.push(r),void this.invoker.trigger();this.processTask(r,t)}}process(){if(0===this.taskQueue.length)return;const e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(e,t)}processTask(e,r){return t(this,void 0,void 0,function*(){if("<response>"===r.type){const t=this.resolveRejects[e];if(delete this.resolveRejects[e],!t)return;return void(r.error?t.reject(da(r.error)):t.resolve(da(r.data)))}if(!this.messageHandlers[r.type])return void this.completeTask(e,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const t=da(r.data),n=new AbortController;this.abortControllers[e]=n;try{const i=yield this.messageHandlers[r.type](r.sourceMapId,t,n);this.completeTask(e,null,i)}catch(t){this.completeTask(e,t)}})}completeTask(e,t,r){const n=[];delete this.abortControllers[e];const i={id:e,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?ha(t):null,data:ha(r,n)};this.target.postMessage(i,{transfer:n})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},e.M=le,e.N=function(){var e=new p(16);return p!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e.O=function(e,t,r){var n,i,a,o,s,l,c,u,h,d,p,f,m=r[0],g=r[1],_=r[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*_+t[12],e[13]=t[1]*m+t[5]*g+t[9]*_+t[13],e[14]=t[2]*m+t[6]*g+t[10]*_+t[14],e[15]=t[3]*m+t[7]*g+t[11]*_+t[15]):(i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],f=t[11],e[0]=n=t[0],e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e[6]=c,e[7]=u,e[8]=h,e[9]=d,e[10]=p,e[11]=f,e[12]=n*m+s*g+h*_+t[12],e[13]=i*m+l*g+d*_+t[13],e[14]=a*m+c*g+p*_+t[14],e[15]=o*m+u*g+f*_+t[15]),e},e.P=r,e.Q=function(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.R=_l,e.S=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],f=t[11],m=t[12],g=t[13],_=t[14],y=t[15],v=r[0],b=r[1],x=r[2],w=r[3];return e[0]=v*n+b*s+x*h+w*m,e[1]=v*i+b*l+x*d+w*g,e[2]=v*a+b*c+x*p+w*_,e[3]=v*o+b*u+x*f+w*y,e[4]=(v=r[4])*n+(b=r[5])*s+(x=r[6])*h+(w=r[7])*m,e[5]=v*i+b*l+x*d+w*g,e[6]=v*a+b*c+x*p+w*_,e[7]=v*o+b*u+x*f+w*y,e[8]=(v=r[8])*n+(b=r[9])*s+(x=r[10])*h+(w=r[11])*m,e[9]=v*i+b*l+x*d+w*g,e[10]=v*a+b*c+x*p+w*_,e[11]=v*o+b*u+x*f+w*y,e[12]=(v=r[12])*n+(b=r[13])*s+(x=r[14])*h+(w=r[15])*m,e[13]=v*i+b*l+x*d+w*g,e[14]=v*a+b*c+x*p+w*_,e[15]=v*o+b*u+x*f+w*y,e},e.T=El,e.U=function(e,t){const r={};for(let n=0;n<t.length;n++){const i=t[n];i in e&&(r[i]=e[i])}return r},e.V=vh,e.W=B,e.X=Th,e.Y=wh,e.Z=u,e._=t,e.a=oe,e.a$=v,e.a0=Y,e.a1=zh,e.a2=Ph,e.a3=Eh,e.a4=k,e.a5=function(e,t,r){if(!e)return t||{};if(!t)return e||{};const n=Fh(e),i=Fh(t);!function(e,t){t.removeAll&&(e.add.clear(),e.update.clear(),e.remove.clear(),t.remove.clear());for(const r of t.remove)e.add.delete(r),e.update.delete(r);for(const[r,n]of t.update){const i=e.update.get(r);i&&(t.update.set(r,Rh(i,n)),e.update.delete(r))}}(n,i);const a={};if((n.removeAll||i.removeAll)&&(a.removeAll=!0),a.remove=new Set([...n.remove,...i.remove]),a.add=new Map([...n.add,...i.add]),a.update=new Map([...n.update,...i.update]),a.remove.size&&a.add.size)for(const e of a.add.keys())a.remove.delete(e);return function(e){const t={};return e.removeAll&&(t.removeAll=e.removeAll),e.remove&&(t.remove=Array.from(e.remove)),e.add&&(t.add=Array.from(e.add.values())),e.update&&(t.update=Array.from(e.update.values())),t}(a)},e.a6=function(e,t){if(null==e)return!0;if("Feature"===e.type)return null!=Lh(e,t);if("FeatureCollection"===e.type){const r=new Set;for(const n of e.features){const e=Lh(n,t);if(null==e)return!1;if(r.has(e))return!1;r.add(e)}return!0}return!1},e.a7=function(e,t){const r=new Map;if(null==e);else if("Feature"===e.type)r.set(Lh(e,t),e);else for(const n of e.features)r.set(Lh(n,t),n);return r},e.a8=function(e,t,r){var n,i;if(t.removeAll)e.clear();else if(t.remove)for(const r of t.remove)e.delete(r);if(t.add)for(const n of t.add){const t=Lh(n,r);null!=t&&e.set(t,n)}if(t.update)for(const r of t.update){let t=e.get(r.id);if(!t)continue;const a=!!r.newGeometry,o=r.removeAllProperties||(null===(n=r.removeProperties)||void 0===n?void 0:n.length)>0||(null===(i=r.addOrUpdateProperties)||void 0===i?void 0:i.length)>0;if((a||o)&&(t=Object.assign({},t),e.set(r.id,t),a&&(t.geometry=r.newGeometry),o)){if(t.properties=r.removeAllProperties?{}:Object.assign({},t.properties||{}),r.removeProperties)for(const e of r.removeProperties)delete t.properties[e];if(r.addOrUpdateProperties)for(const{key:e,value:n}of r.addOrUpdateProperties)t.properties[e]=n}}},e.a9=yp,e.aA=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],_=t[15],y=r*s-n*o,v=r*l-i*o,b=r*c-a*o,x=n*l-i*s,w=n*c-a*s,T=i*c-a*l,S=u*m-h*f,P=u*g-d*f,E=u*_-p*f,C=h*g-d*m,M=h*_-p*m,k=d*_-p*g,I=y*k-v*M+b*C+x*E-w*P+T*S;return I?(e[0]=(s*k-l*M+c*C)*(I=1/I),e[1]=(i*M-n*k-a*C)*I,e[2]=(m*T-g*w+_*x)*I,e[3]=(d*w-h*T-p*x)*I,e[4]=(l*E-o*k-c*P)*I,e[5]=(r*k-i*E+a*P)*I,e[6]=(g*b-f*T-_*v)*I,e[7]=(u*T-d*b+p*v)*I,e[8]=(o*M-s*E+c*S)*I,e[9]=(n*E-r*M-a*S)*I,e[10]=(f*w-m*b+_*y)*I,e[11]=(h*b-u*w-p*y)*I,e[12]=(s*P-o*C-l*S)*I,e[13]=(r*C-n*P+i*S)*I,e[14]=(m*v-f*x-g*y)*I,e[15]=(u*x-h*v+d*y)*I,e):null},e.aB=C,e.aC=function(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)},e.aD=function(e){return e[0]=0,e[1]=0,e},e.aE=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e},e.aF=rh,e.aG=S,e.aH=function(e,t,n,i){const a=t.y-e.y,o=t.x-e.x,s=i.y-n.y,l=i.x-n.x,c=s*o-l*a;if(0===c)return null;const u=(l*(e.y-n.y)-s*(e.x-n.x))/c;return new r(e.x+u*o,e.y+u*a)},e.aI=wp,e.aJ=Vs,e.aK=function(e){let t=1/0,r=1/0,n=-1/0,i=-1/0;for(const a of e)t=Math.min(t,a.x),r=Math.min(r,a.y),n=Math.max(n,a.x),i=Math.max(i,a.y);return[t,r,n,i]},e.aL=su,e.aM=I,e.aN=function(e,t,r,n,i=!1){if(!r[0]&&!r[1])return[0,0];const a=i?"map"===n?-e.bearingInRadians:0:"viewport"===n?e.bearingInRadians:0;if(a){const e=Math.sin(a),t=Math.cos(a);r=[r[0]*t-r[1]*e,r[0]*e+r[1]*t]}return[i?r[0]:I(t,r[0],e.zoom),i?r[1]:I(t,r[1],e.zoom)]},e.aP=Ju,e.aQ=Yp,e.aR=Vu,e.aS=rf,e.aT=Qa,e.aU=oc,e.aV=Bo,e.aW=es,e.aX=Yo,e.aY=te,e.aZ=Ch,e.a_=b,e.aa=Mh,e.ab=_p,e.ac=25,e.ad=Ih,e.ae=e=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(r=>{t.onloadstart=()=>{r(t)};for(const r of e){const e=window.document.createElement("source");de(r)||(t.crossOrigin="Anonymous"),e.src=r,t.appendChild(e)}})},e.af=Ie,e.ag=function(){return N++},e.ah=Eo,e.ai=oh,e.aj=hi,e.ak=Fs,e.al=Oh,e.am=function(e){const t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(e,r,n,i)=>{const a=n||i;return t[r]=!a||a.toLowerCase(),""}),t["max-age"]){const e=parseInt(t["max-age"],10);isNaN(e)?delete t["max-age"]:t["max-age"]=e}return t},e.an=F,e.ao=85.051129,e.ap=ee,e.aq=function(e){return Math.pow(2,e)},e.ar=m,e.as=Sh,e.at=function(e){return Math.log(e)/Math.LN2},e.au=function(e){var t=e[0],r=e[1];return t*t+r*r},e.av=class{constructor(e,t){this.max=e,this.onRemove=t,this.reset()}reset(){for(const e in this.data)for(const t of this.data[e])t.timeout&&clearTimeout(t.timeout),this.onRemove(t.value);return this.data={},this.order=[],this}add(e,t,r){const n=e.wrapped().key;void 0===this.data[n]&&(this.data[n]=[]);const i={value:t,timeout:void 0};if(void 0!==r&&(i.timeout=setTimeout(()=>{this.remove(e,i)},r)),this.data[n].push(i),this.order.push(n),this.order.length>this.max){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}getByKey(e){const t=this.data[e];return t?t[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,t){if(!this.has(e))return this;const r=e.wrapped().key,n=void 0===t?0:this.data[r].indexOf(t),i=this.data[r][n];return this.data[r].splice(n,1),i.timeout&&clearTimeout(i.timeout),0===this.data[r].length&&delete this.data[r],this.onRemove(i.value),this.order.splice(this.order.indexOf(r),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(e){const t=[];for(const r in this.data)for(const n of this.data[r])e(n.value)||t.push(n);for(const e of t)this.remove(e.value.tileID,e)}},e.aw=function(e){if(!e.length)return new Set;const t=Math.max(...e.map(e=>e.canonical.z));let r=1/0,n=-1/0,i=1/0,a=-1/0;const o=[];for(const s of e){const{x:e,y:l,z:c}=s.canonical,u=Math.pow(2,t-c),h=e*u,d=l*u;o.push({id:s,x:h,y:d}),h<r&&(r=h),h>n&&(n=h),d<i&&(i=d),d>a&&(a=d)}const s=new Set;for(const e of o)e.x!==r&&e.x!==n&&e.y!==i&&e.y!==a||s.add(e.id);return s},e.ax=function(e,t){let r=0,n=0;if("constant"===e.kind)n=e.layoutSize;else if("source"!==e.kind){const{interpolationType:i,minZoom:a,maxZoom:o}=e,s=i?F(hr.interpolationFactor(i,t,a,o),0,1):0;"camera"===e.kind?n=pr.number(e.minSize,e.maxSize,s):r=s}return{uSizeT:r,uSize:n}},e.az=function(e,{uSize:t,uSizeT:r},{lowerSize:n,upperSize:i}){return"source"===e.kind?n/Yu:"composite"===e.kind?pr.number(n/Yu,i/Yu,r):t},e.b=W,e.b$=class extends gs{constructor(e,t){super(e,t),this.current=bs}set(e){if(e[12]!==this.current[12]||e[0]!==this.current[0])return this.current=e,void this.gl.uniformMatrix4fv(this.location,!1,e);for(let t=1;t<16;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}}},e.b0=function(e){var t=new p(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.b1=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},e.b2=function(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e},e.b3=x,e.b4=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.b5=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e},e.b6=_,e.b7=function(e,t,r){const n=t[0]*r[0]+t[1]*r[1]+t[2]*r[2];return 0===n?null:(-(e[0]*r[0]+e[1]*r[1]+e[2]*r[2])-r[3])/n},e.b8=T,e.b9=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},e.bA=E,e.bB=function(e,t,r){var n=r[0],i=r[1],a=r[2],o=r[3],s=t[0],l=t[1],c=t[2],u=i*c-a*l,h=a*s-n*c,d=n*l-i*s;return e[0]=s+o*(u+=u)+i*(d+=d)-a*(h+=h),e[1]=l+o*h+a*u-n*d,e[2]=c+o*d+n*h-i*u,e},e.bC=function(e,t,r){const n=(i=[e[0],e[1],e[2],t[0],t[1],t[2],r[0],r[1],r[2]])[0]*((u=i[8])*(o=i[4])-(s=i[5])*(c=i[7]))+i[1]*(-u*(a=i[3])+s*(l=i[6]))+i[2]*(c*a-o*l);var i,a,o,s,l,c,u;if(0===n)return null;const h=x([],[t[0],t[1],t[2]],[r[0],r[1],r[2]]),d=x([],[r[0],r[1],r[2]],[e[0],e[1],e[2]]),p=x([],[e[0],e[1],e[2]],[t[0],t[1],t[2]]),f=b([],h,-e[3]);return v(f,f,b([],d,-t[3])),v(f,f,b([],p,-r[3])),b(f,f,1/n),f},e.bD=yh,e.bE=function(){return new Float64Array(4)},e.bF=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},e.bG=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},e.bH=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},e.bI=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],l=t[3],c=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-c*n,e[1]=o*i-u*n,e[2]=s*i-h*n,e[3]=l*i-d*n,e[8]=a*n+c*i,e[9]=o*n+u*i,e[10]=s*n+h*i,e[11]=l*n+d*i,e},e.bJ=function(e,t){const r=A(e,360),n=A(t,360),i=n-r,a=n>r?i-360:i+360;return Math.abs(i)<Math.abs(a)?i:a},e.bK=function(e){return e[0]=0,e[1]=0,e[2]=0,e},e.bL=function(e,t,r,n){const i=Math.sqrt(e*e+t*t),a=Math.sqrt(r*r+n*n);e/=i,t/=i,r/=a,n/=a;const o=Math.acos(e*r+t*n);return-t*r+e*n>0?o:-o},e.bM=function(e,t){const r=A(e,2*Math.PI),n=A(t,2*Math.PI);return Math.min(Math.abs(r-n),Math.abs(r-n+2*Math.PI),Math.abs(r-n-2*Math.PI))},e.bN=function(){const e={},t=ye.$version;for(const r in ye.$root){const n=ye.$root[r];if(n.required){let i=null;i="version"===r?t:"array"===n.type?[]:{},null!=i&&(e[r]=i)}}return e},e.bO=ue,e.bP=pa,e.bQ=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(let n=0;n<t.length;n++)if(!e(t[n],r[n]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==r){if("object"!=typeof r)return!1;if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(!e(t[n],r[n]))return!1;return!0}return t===r},e.bR=function(e){e=e.slice();const t=Object.create(null);for(let r=0;r<e.length;r++)t[e[r].id]=e[r];for(let r=0;r<e.length;r++)"ref"in e[r]&&(e[r]=be(e[r],t[e[r].ref]));return e},e.bS=function(e,t){if("custom"===e.type)return new mh(e,t);switch(e.type){case"background":return new fh(e,t);case"circle":return new cl(e,t);case"color-relief":return new kl(e,t);case"fill":return new vc(e,t);case"fill-extrusion":return new Oc(e,t);case"heatmap":return new bl(e,t);case"hillshade":return new Tl(e,t);case"line":return new Jc(e,t);case"raster":return new Wa(e,t);case"symbol":return new hh(e,t)}},e.bT=e=>"raster"===e.type,e.bU=U,e.bV=function(e,t){if(!e)return[{command:"setStyle",args:[t]}];let r=[];try{if(!xe(e.version,t.version))return[{command:"setStyle",args:[t]}];xe(e.center,t.center)||r.push({command:"setCenter",args:[t.center]}),xe(e.state,t.state)||r.push({command:"setGlobalState",args:[t.state]}),xe(e.centerAltitude,t.centerAltitude)||r.push({command:"setCenterAltitude",args:[t.centerAltitude]}),xe(e.zoom,t.zoom)||r.push({command:"setZoom",args:[t.zoom]}),xe(e.bearing,t.bearing)||r.push({command:"setBearing",args:[t.bearing]}),xe(e.pitch,t.pitch)||r.push({command:"setPitch",args:[t.pitch]}),xe(e.roll,t.roll)||r.push({command:"setRoll",args:[t.roll]}),xe(e.sprite,t.sprite)||r.push({command:"setSprite",args:[t.sprite]}),xe(e.glyphs,t.glyphs)||r.push({command:"setGlyphs",args:[t.glyphs]}),xe(e.transition,t.transition)||r.push({command:"setTransition",args:[t.transition]}),xe(e.light,t.light)||r.push({command:"setLight",args:[t.light]}),xe(e.terrain,t.terrain)||r.push({command:"setTerrain",args:[t.terrain]}),xe(e.sky,t.sky)||r.push({command:"setSky",args:[t.sky]}),xe(e.projection,t.projection)||r.push({command:"setProjection",args:[t.projection]});const n={},i=[];!function(e,t,r,n){let i;for(i in t=t||{},e=e||{})Object.prototype.hasOwnProperty.call(e,i)&&(Object.prototype.hasOwnProperty.call(t,i)||Se(i,r,n));for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(Object.prototype.hasOwnProperty.call(e,i)?xe(e[i],t[i])||("geojson"===e[i].type&&"geojson"===t[i].type&&Ee(e,t,i)?we(r,{command:"setGeoJSONSourceData",args:[i,t[i].data]}):Pe(i,t,r,n)):Te(i,t,r))}(e.sources,t.sources,i,n);const a=[];e.layers&&e.layers.forEach(e=>{"source"in e&&n[e.source]?r.push({command:"removeLayer",args:[e.id]}):a.push(e)}),r=r.concat(i),function(e,t,r){t=t||[];const n=(e=e||[]).map(Me),i=t.map(Me),a=e.reduce(ke,{}),o=t.reduce(ke,{}),s=n.slice(),l=Object.create(null);let c,u,h,d,p;for(let e=0,t=0;e<n.length;e++)c=n[e],Object.prototype.hasOwnProperty.call(o,c)?t++:(we(r,{command:"removeLayer",args:[c]}),s.splice(s.indexOf(c,t),1));for(let e=0,t=0;e<i.length;e++)c=i[i.length-1-e],s[s.length-1-e]!==c&&(Object.prototype.hasOwnProperty.call(a,c)?(we(r,{command:"removeLayer",args:[c]}),s.splice(s.lastIndexOf(c,s.length-t),1)):t++,d=s[s.length-e],we(r,{command:"addLayer",args:[o[c],d]}),s.splice(s.length-e,0,c),l[c]=!0);for(let e=0;e<i.length;e++)if(c=i[e],u=a[c],h=o[c],!l[c]&&!xe(u,h))if(xe(u.source,h.source)&&xe(u["source-layer"],h["source-layer"])&&xe(u.type,h.type)){for(p in Ce(u.layout,h.layout,r,c,null,"setLayoutProperty"),Ce(u.paint,h.paint,r,c,null,"setPaintProperty"),xe(u.filter,h.filter)||we(r,{command:"setFilter",args:[c,h.filter]}),xe(u.minzoom,h.minzoom)&&xe(u.maxzoom,h.maxzoom)||we(r,{command:"setLayerZoomRange",args:[c,h.minzoom,h.maxzoom]}),u)Object.prototype.hasOwnProperty.call(u,p)&&"layout"!==p&&"paint"!==p&&"filter"!==p&&"metadata"!==p&&"minzoom"!==p&&"maxzoom"!==p&&(0===p.indexOf("paint.")?Ce(u[p],h[p],r,c,p.slice(6),"setPaintProperty"):xe(u[p],h[p])||we(r,{command:"setLayerProperty",args:[c,p,h[p]]}));for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&!Object.prototype.hasOwnProperty.call(u,p)&&"layout"!==p&&"paint"!==p&&"filter"!==p&&"metadata"!==p&&"minzoom"!==p&&"maxzoom"!==p&&(0===p.indexOf("paint.")?Ce(u[p],h[p],r,c,p.slice(6),"setPaintProperty"):xe(u[p],h[p])||we(r,{command:"setLayerProperty",args:[c,p,h[p]]}))}else we(r,{command:"removeLayer",args:[c]}),d=s[s.lastIndexOf(c)+1],we(r,{command:"addLayer",args:[h,d]})}(a,t.layers,r)}catch(e){console.warn("Unable to compute style diff:",e),r=[{command:"setStyle",args:[t]}]}return r},e.bW=function(e){const t=[],r=e.id;return void 0===r&&t.push({message:`layers.${r}: missing required property "id"`}),void 0===e.render&&t.push({message:`layers.${r}: missing required method "render"`}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),t},e.bX=V,e.bY=j,e.bZ=class extends gs{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))}},e.b_=vs,e.ba=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]},e.bb=Ah,e.bc=Dh,e.bd=function(e,t,r,n,i){var a=1/Math.tan(t/2);if(e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0){var o=1/(n-i);e[10]=(i+n)*o,e[14]=2*i*n*o}else e[10]=-1,e[14]=-2*n;return e},e.be=function(e){var t=new p(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.bf=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],l=t[3],c=t[4],u=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+c*n,e[1]=o*i+u*n,e[2]=s*i+h*n,e[3]=l*i+d*n,e[4]=c*i-a*n,e[5]=u*i-o*n,e[6]=h*i-s*n,e[7]=d*i-l*n,e},e.bg=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],s=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+c*n,e[5]=o*i+u*n,e[6]=s*i+h*n,e[7]=l*i+d*n,e[8]=c*i-a*n,e[9]=u*i-o*n,e[10]=h*i-s*n,e[11]=d*i-l*n,e},e.bh=function(){const e=new Float32Array(16);return m(e),e},e.bi=function(){const e=new Float64Array(16);return m(e),e},e.bj=function(){return new Float64Array(16)},e.bk=function(e,t,r){const n=new Float64Array(4);return E(n,e,t-90,r),n},e.bl=function(e,t,r,n){var i,a,o,s,l,c=t[0],u=t[1],h=t[2],p=t[3],f=r[0],m=r[1],g=r[2],_=r[3];return(a=c*f+u*m+h*g+p*_)<0&&(a=-a,f=-f,m=-m,g=-g,_=-_),1-a>d?(i=Math.acos(a),o=Math.sin(i),s=Math.sin((1-n)*i)/o,l=Math.sin(n*i)/o):(s=1-n,l=n),e[0]=s*c+l*f,e[1]=s*u+l*m,e[2]=s*h+l*g,e[3]=s*p+l*_,e},e.bm=function(e){const t=new Float64Array(9);var r,n,i,a,o,s,l,c,u,h,d,p,f,m,g,_,y,v;h=(i=(n=e)[0])*(l=i+i),d=(a=n[1])*l,f=(o=n[2])*l,m=o*(c=a+a),_=(s=n[3])*l,y=s*c,v=s*(u=o+o),(r=t)[0]=1-(p=a*c)-(g=o*u),r[3]=d-v,r[6]=f+y,r[1]=d+v,r[4]=1-h-g,r[7]=m-_,r[2]=f-y,r[5]=m+_,r[8]=1-h-p;const b=te(-Math.asin(F(t[2],-1,1)));let x,w;return Math.hypot(t[5],t[8])<.001?(x=0,w=-te(Math.atan2(t[3],t[4]))):(x=te(0===t[5]&&0===t[8]?0:Math.atan2(t[5],t[8])),w=te(0===t[1]&&0===t[0]?0:Math.atan2(t[1],t[0]))),{roll:x,pitch:b+90,bearing:w}},e.bn=function(e,t){return e.roll==t.roll&&e.pitch==t.pitch&&e.bearing==t.bearing},e.bo=Et,e.bp=_s,e.bq=sc,e.br=lc,e.bs=ac,e.bt=z,e.bu=D,e.bv=Ot,e.bw=function(e,t,r,n,i){return z(n,i,F((e-t)/(r-t),0,1))},e.bx=A,e.by=function(){return new Float64Array(3)},e.bz=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e},e.c=ae,e.c$=class{constructor(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let e=performance.getEntriesByName(this._marks.measure);return 0===e.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),e=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),e}},e.c0=ys,e.c1=class extends gs{constructor(e,t){super(e,t),this.current=[0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]||(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))}},e.c2=class extends gs{constructor(e,t){super(e,t),this.current=[0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]||(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))}},e.c3=f,e.c4=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.c5=function(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e},e.c6=function(e,t,r,n,i,a,o){var s=1/(t-r),l=1/(n-i),c=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*l,e[14]=(o+a)*c,e[15]=1,e},e.c7=class extends gs{constructor(e,t){super(e,t),this.current=new Array}set(e){if(e!=this.current){this.current=e;const t=new Float32Array(4*e.length);for(let r=0;r<e.length;r++)t[4*r]=e[r].r,t[4*r+1]=e[r].g,t[4*r+2]=e[r].b,t[4*r+3]=e[r].a;this.gl.uniform4fv(this.location,t)}}},e.c8=class extends gs{constructor(e,t){super(e,t),this.current=new Array}set(e){if(e!=this.current){this.current=e;const t=new Float32Array(e);this.gl.uniform1fv(this.location,t)}}},e.c9=class extends fo{},e.cA=function(e){return re[e]||ne[e]},e.cB=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e},e.cC=function(e,t){const{x:r,y:n}=Mh.fromLngLat(t);return!(e<0||e>25||n<0||n>=1||r<0||r>=1)},e.cD=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.cE=class extends to{},e.cF=mf,e.cH=function(e){return e.message===ie},e.cI=ce,e.cJ=function(e,t){oe.REGISTERED_PROTOCOLS[e]=t},e.cK=function(e){delete oe.REGISTERED_PROTOCOLS[e]},e.cL=function(e,t){const r={};for(let n=0;n<e.length;n++){const i=t&&t[e[n].id]||bi(e[n]);t&&(t[e[n].id]=i);let a=r[i];a||(a=r[i]=[]),a.push(e[n])}const n=[];for(const e in r)n.push(r[e]);return n},e.cM=sa,e.cN=Bh,e.cO=vp,e.cP=Bu,e.cQ=function(t){t.bucket.createArrays(),t.bucket.tilePixelRatio=k/(512*t.bucket.overscaling),t.bucket.compareText={},t.bucket.iconsNeedLinear=!1;const r=t.bucket.layers[0],n=r.layout,i=r._unevaluatedLayout._values,a={layoutIconSize:i["icon-size"].possiblyEvaluate(new Ma(t.bucket.zoom+1),t.canonical),layoutTextSize:i["text-size"].possiblyEvaluate(new Ma(t.bucket.zoom+1),t.canonical),textMaxSize:i["text-size"].possiblyEvaluate(new Ma(18))};if("composite"===t.bucket.textSizeData.kind){const{minZoom:e,maxZoom:r}=t.bucket.textSizeData;a.compositeTextSizes=[i["text-size"].possiblyEvaluate(new Ma(e),t.canonical),i["text-size"].possiblyEvaluate(new Ma(r),t.canonical)]}if("composite"===t.bucket.iconSizeData.kind){const{minZoom:e,maxZoom:r}=t.bucket.iconSizeData;a.compositeIconSizes=[i["icon-size"].possiblyEvaluate(new Ma(e),t.canonical),i["icon-size"].possiblyEvaluate(new Ma(r),t.canonical)]}const o=n.get("text-line-height")*su,s="viewport"!==n.get("text-rotation-alignment")&&"point"!==n.get("symbol-placement"),l=n.get("text-keep-upright"),c=n.get("text-size");for(const i of t.bucket.features){const u=n.get("text-font").evaluate(i,{},t.canonical).join(","),h=c.evaluate(i,{},t.canonical),d=a.layoutTextSize.evaluate(i,{},t.canonical),p=a.layoutIconSize.evaluate(i,{},t.canonical),f={horizontal:{},vertical:void 0},m=i.text;let g,_=[0,0];if(m){const a=m.toString(),c=n.get("text-letter-spacing").evaluate(i,{},t.canonical)*su,p=ya(a)?c:0,g=n.get("text-anchor").evaluate(i,{},t.canonical),y=Xp(r,i,t.canonical);if(!y){const e=n.get("text-radial-offset").evaluate(i,{},t.canonical);_=e?Wp(g,[e*su,Hp]):n.get("text-offset").evaluate(i,{},t.canonical).map(e=>e*su)}let v=s?"center":n.get("text-justify").evaluate(i,{},t.canonical);const b="point"===n.get("symbol-placement")?n.get("text-max-width").evaluate(i,{},t.canonical)*su:1/0,x=()=>{t.bucket.allowVerticalPlacement&&_a(a)&&(f.vertical=Nu(m,t.glyphMap,t.glyphPositions,t.imagePositions,u,b,o,g,"left",p,_,e.ay.vertical,!0,d,h))};if(!s&&y){const r=new Set;if("auto"===v)for(let e=0;e<y.values.length;e+=2)r.add(Yp(y.values[e]));else r.add(v);let n=!1;for(const i of r)if(!f.horizontal[i])if(n)f.horizontal[i]=f.horizontal[0];else{const r=Nu(m,t.glyphMap,t.glyphPositions,t.imagePositions,u,b,o,"center",i,p,_,e.ay.horizontal,!1,d,h);r&&(f.horizontal[i]=r,n=1===r.positionedLines.length)}x()}else{"auto"===v&&(v=Yp(g));const r=Nu(m,t.glyphMap,t.glyphPositions,t.imagePositions,u,b,o,g,v,p,_,e.ay.horizontal,!1,d,h);r&&(f.horizontal[v]=r),x(),_a(a)&&s&&l&&(f.vertical=Nu(m,t.glyphMap,t.glyphPositions,t.imagePositions,u,b,o,g,v,p,_,e.ay.vertical,!1,d,h))}}let y=!1;if(i.icon&&i.icon.name){const e=t.imageMap[i.icon.name];e&&(g=Hu(t.imagePositions[i.icon.name],n.get("icon-offset").evaluate(i,{},t.canonical),n.get("icon-anchor").evaluate(i,{},t.canonical)),y=!!e.sdf,void 0===t.bucket.sdfIcons?t.bucket.sdfIcons=y:t.bucket.sdfIcons!==y&&q("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(e.pixelRatio!==t.bucket.pixelRatio||0!==n.get("icon-rotate").constantOr(1))&&(t.bucket.iconsNeedLinear=!0))}const v=Jp(f.horizontal)||f.vertical;t.bucket.iconsInText=!!v&&v.iconsInText,(v||g)&&Kp(t.bucket,i,f,g,t.imageMap,a,d,p,_,y,t.canonical,t.subdivisionGranularity)}t.showCollisionBoxes&&t.bucket.generateCollisionDebugBuffers()},e.cR=mc,e.cS=zc,e.cT=Hc,e.cU=Ec,e.cV=bu,e.cW=Tc,e.cX=function(e,t,r,n,i,a){let o=Tp(e,t,r,i,0);return o=Tp(o,t,n,a,1),o},e.cY=class{constructor(e){this.maxEntries=e,this.map=new Map}get(e){const t=this.map.get(e);return void 0!==t&&(this.map.delete(e),this.map.set(e,t)),t}set(e,t){if(this.map.has(e))this.map.delete(e);else if(this.map.size>=this.maxEntries){const e=this.map.keys().next().value;this.map.delete(e)}this.map.set(e,t)}clear(){this.map.clear()}},e.cZ=Mc,e.c_=gp,e.ca=au,e.cb=class extends go{},e.cc=vl,e.cd=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},e.ce=yl,e.cf=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/(o=o||1),e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,e},e.cg=class extends ro{},e.ch=class extends To{},e.ci=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},e.cj=function(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],p=e[10],f=e[11],m=e[12],g=e[13],_=e[14],y=e[15],v=t[0],b=t[1],x=t[2],w=t[3],T=t[4],S=t[5],P=t[6],E=t[7],C=t[8],M=t[9],k=t[10],I=t[11],A=t[12],z=t[13],D=t[14],L=t[15];return Math.abs(r-v)<=d*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(n-b)<=d*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(i-x)<=d*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(a-w)<=d*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(o-T)<=d*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(s-S)<=d*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(l-P)<=d*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(c-E)<=d*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(u-C)<=d*Math.max(1,Math.abs(u),Math.abs(C))&&Math.abs(h-M)<=d*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(p-k)<=d*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(f-I)<=d*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(m-A)<=d*Math.max(1,Math.abs(m),Math.abs(A))&&Math.abs(g-z)<=d*Math.max(1,Math.abs(g),Math.abs(z))&&Math.abs(_-D)<=d*Math.max(1,Math.abs(_),Math.abs(D))&&Math.abs(y-L)<=d*Math.max(1,Math.abs(y),Math.abs(L))},e.ck=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.cl=e=>"symbol"===e.type,e.cm=e=>"circle"===e.type,e.cn=e=>"heatmap"===e.type,e.co=e=>"line"===e.type,e.cp=e=>"fill"===e.type,e.cq=e=>"fill-extrusion"===e.type,e.cr=e=>"hillshade"===e.type,e.cs=e=>"color-relief"===e.type,e.ct=e=>"background"===e.type,e.cu=e=>"custom"===e.type,e.cv=L,e.cw=function(e,t,r){const n=M(t.x-r.x,t.y-r.y),i=M(e.x-r.x,e.y-r.y);var a,o;return te(Math.atan2(n[0]*i[1]-n[1]*i[0],(a=n)[0]*(o=i)[0]+a[1]*o[1]))},e.cx=R,e.cy=function(e,t){return ne[t]&&(e instanceof MouseEvent||e instanceof WheelEvent)},e.cz=function(e,t){return re[t]&&"touches"in e},e.d=de,e.d0=function(e,r,n,i,a){return t(this,void 0,void 0,function*(){if(h())try{return yield Y(e,r,n,i,a)}catch(e){}return function(e,t,r,n,i){const a=e.width,o=e.height;K&&Q||(K=new OffscreenCanvas(a,o),Q=K.getContext("2d",{willReadFrequently:!0})),K.width=a,K.height=o,Q.drawImage(e,0,0,a,o);const s=Q.getImageData(t,r,n,i);return Q.clearRect(0,0,a,o),s.data}(e,r,n,i,a)})},e.d1=Cl,e.d2=n,e.d3=ti,e.d4=Ca,e.e=O,e.f=e=>t(void 0,void 0,void 0,function*(){if(0===e.byteLength)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(e)],{type:"image/png"});try{return createImageBitmap(t)}catch(e){throw new Error(`Could not load image because of ${e.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),e.g=se,e.h=e=>new Promise((t,r)=>{const n=new Image;n.onload=()=>{t(n),URL.revokeObjectURL(n.src),n.onload=null,window.requestAnimationFrame(()=>{n.src=X})},n.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const i=new Blob([new Uint8Array(e)],{type:"image/png"});n.src=e.byteLength?URL.createObjectURL(i):X}),e.i=Z,e.j=(e,t)=>he(O(e,{type:"json"}),t),e.k=ge,e.l=me,e.m=he,e.n=(e,t)=>he(O(e,{type:"arrayBuffer"}),t),e.o=function(e){return new bu(e).readFields(zu,[])},e.p=Ru,e.q=function(e){return/[\u02EA\u02EB\u1100-\u11FF\u2E80-\u2FDF\u3000-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(e))},e.r=gl,e.s=J,e.t=qa,e.u=ye,e.v=Qi,e.w=q,e.x=Da,e.y=ea,e.z=Ia}),r("worker",0,function(e){class t{constructor(e,t){this.keyCache={},e&&this.replace(e,t)}replace(e,t){this._layerConfigs={},this._layers={},this.update(e,[],t)}update(t,r,n){for(const r of t){this._layerConfigs[r.id]=r;const t=this._layers[r.id]=e.bS(r,n);t._featureFilter=e.aj(t.filter,n),this.keyCache[r.id]&&delete this.keyCache[r.id]}for(const e of r)delete this.keyCache[e],delete this._layerConfigs[e],delete this._layers[e];this.familiesBySource={};const i=e.cL(Object.values(this._layerConfigs),this.keyCache);for(const t of i){const r=t.map(e=>this._layers[e.id]),n=r[0];if("none"===n.visibility)continue;const i=n.source||"";let a=this.familiesBySource[i];a||(a=this.familiesBySource[i]={});const o=n.sourceLayer||e.a9;let s=a[o];s||(s=a[o]=[]),s.push(r)}}}class r{constructor(t){const r={},n=[];for(const e in t){const i=t[e],a=r[e]={};for(const e in i){const t=i[+e];if(!t||0===t.bitmap.width||0===t.bitmap.height)continue;const r={x:0,y:0,w:t.bitmap.width+2,h:t.bitmap.height+2};n.push(r),a[e]={rect:r,metrics:t.metrics}}}const{w:i,h:a}=e.p(n),o=new e.r({width:i||1,height:a||1});for(const n in t){const i=t[n];for(const t in i){const a=i[+t];if(!a||0===a.bitmap.width||0===a.bitmap.height)continue;const s=r[n][t].rect;e.r.copy(a.bitmap,o,{x:0,y:0},{x:s.x+1,y:s.y+1},a.bitmap)}}this.image=o,this.positions=r}}e.cM("GlyphAtlas",r);class n{constructor(t){this.tileID=new e.a1(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.inFlightDependencies=[]}parse(t,n,a,o,s){return e._(this,void 0,void 0,function*(){this.status="parsing",this.data=t,this.collisionBoxArray=new e.ah;const l=new e.cN(Object.keys(t.layers).sort()),c=new e.cO(this.tileID,this.promoteId);c.bucketLayerIDs=[];const u={},h={featureIndex:c,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:a,subdivisionGranularity:s},d=n.familiesBySource[this.source];for(const r in d){const n=t.layers[r];if(!n)continue;1===n.version&&e.w(`Vector tile source "${this.source}" layer "${r}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const o=l.encode(r),s=[];for(let e=0;e<n.length;e++){const t=n.feature(e),i=c.getId(t,r);s.push({feature:t,id:i,index:e,sourceLayerIndex:o})}for(const t of d[r]){const r=t[0];r.source!==this.source&&e.w(`layer.source = ${r.source} does not equal this.source = ${this.source}`),r.isHidden(this.zoom,!0)||(i(t,this.zoom,a),(u[r.id]=r.createBucket({index:c.bucketLayerIDs.length,layers:t,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:o,sourceID:this.source})).populate(s,h,this.tileID.canonical),c.bucketLayerIDs.push(t.map(e=>e.id)))}}const p=e.bX(h.glyphDependencies,e=>Object.keys(e).map(Number));this.inFlightDependencies.forEach(e=>null==e?void 0:e.abort()),this.inFlightDependencies=[];let f=Promise.resolve({});if(Object.keys(p).length){const e=new AbortController;this.inFlightDependencies.push(e),f=o.sendAsync({type:"GG",data:{stacks:p,source:this.source,tileID:this.tileID,type:"glyphs"}},e)}const m=Object.keys(h.iconDependencies);let g=Promise.resolve({});if(m.length){const e=new AbortController;this.inFlightDependencies.push(e),g=o.sendAsync({type:"GI",data:{icons:m,source:this.source,tileID:this.tileID,type:"icons"}},e)}const _=Object.keys(h.patternDependencies);let y=Promise.resolve({});if(_.length){const e=new AbortController;this.inFlightDependencies.push(e),y=o.sendAsync({type:"GI",data:{icons:_,source:this.source,tileID:this.tileID,type:"patterns"}},e)}const v=h.dashDependencies;let b=Promise.resolve({});if(Object.keys(v).length){const e=new AbortController;this.inFlightDependencies.push(e),b=o.sendAsync({type:"GDA",data:{dashes:v}},e)}const[x,w,T,S]=yield Promise.all([f,g,y,b]),P=new r(x),E=new e.cP(w,T);for(const t in u){const r=u[t];r instanceof e.ai?(i(r.layers,this.zoom,a),e.cQ({bucket:r,glyphMap:x,glyphPositions:P.positions,imageMap:w,imagePositions:E.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:h.subdivisionGranularity})):r.hasDependencies&&(r instanceof e.cR||r instanceof e.cS||r instanceof e.cT)&&(i(r.layers,this.zoom,a),r.addFeatures(h,this.tileID.canonical,E.patternPositions,S))}return this.status="done",{buckets:Object.values(u).filter(e=>!e.isEmpty()),featureIndex:c,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:P.image,imageAtlas:E,dashPositions:S,glyphMap:this.returnDependencies?x:null,iconMap:this.returnDependencies?w:null,glyphPositions:this.returnDependencies?P.positions:null}})}}function i(t,r,n){const i=new e.H(r);for(const e of t)e.recalculate(i,n)}class a extends e.cW{constructor(t,r){super(new e.cV,0,r,[],[]),this.feature=t,this.type=t.type,this.properties=t.tags?t.tags:{},"id"in t&&("string"==typeof t.id?this.id=parseInt(t.id,10):"number"!=typeof t.id||isNaN(t.id)||(this.id=t.id))}loadGeometry(){const t=[],r=1===this.feature.type?[this.feature.geometry]:this.feature.geometry;for(const n of r){const r=[];for(const t of n)r.push(new e.P(t[0],t[1]));t.push(r)}return t}}class o extends e.cU{constructor(t,r){super(new e.cV),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=r?r.version:1,this.extent=r?r.extent:4096,this.length=t.length,this.features=t}feature(e){return new a(this.features[e],this.extent)}}function s(e,t){t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);const r={keys:[],values:[],keycache:{},valuecache:{}};for(let n=0;n<e.length;n++)r.feature=e.feature(n),t.writeMessage(2,l,r);const n=r.keys;for(const e of n)t.writeStringField(3,e);const i=r.values;for(const e of i)t.writeMessage(4,p,e)}function l(e,t){if(!e.feature)return;const r=e.feature;void 0!==r.id&&t.writeVarintField(1,r.id),t.writeMessage(2,c,e),t.writeVarintField(3,r.type),t.writeMessage(4,d,r)}function c(e,t){for(const r in e.feature?.properties){let n=e.feature.properties[r],i=e.keycache[r];if(null===n)continue;void 0===i&&(e.keys.push(r),i=e.keys.length-1,e.keycache[r]=i),t.writeVarint(i),"string"!=typeof n&&"boolean"!=typeof n&&"number"!=typeof n&&(n=JSON.stringify(n));const a=typeof n+":"+n;let o=e.valuecache[a];void 0===o&&(e.values.push(n),o=e.values.length-1,e.valuecache[a]=o),t.writeVarint(o)}}function u(e,t){return(t<<3)+(7&e)}function h(e){return e<<1^e>>31}function d(e,t){const r=e.loadGeometry(),n=e.type;let i=0,a=0;for(const o of r){let r=1;1===n&&(r=o.length),t.writeVarint(u(1,r));const s=3===n?o.length-1:o.length;for(let e=0;e<s;e++){1===e&&1!==n&&t.writeVarint(u(2,s-1));const r=o[e].x-i,l=o[e].y-a;t.writeVarint(h(r)),t.writeVarint(h(l)),i+=r,a+=l}3===e.type&&t.writeVarint(u(7,1))}}function p(e,t){const r=typeof e;"string"===r?t.writeStringField(1,e):"boolean"===r?t.writeBooleanField(7,e):"number"===r&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}class f extends e.cW{constructor(t,r,n,i,a){super(new e.cV,0,a,[],[]),this.type=t,this.properties=n||{},this.extent=a,this.pointsArray=r,this.id=i}loadGeometry(){return this.pointsArray.map(t=>t.map(t=>new e.P(t.x,t.y)))}}class m extends e.cU{constructor(t,r,n){super(new e.cV),this.version=2,this._myFeatures=t,this.name=r,this.length=t.length,this.extent=n}feature(e){return this._myFeatures[e]}}class g{constructor(){this.layers={}}addLayer(e){this.layers[e.name]=e}}function _(t){let r=function(t){const r=new e.cV;return function(e,t){for(const r in e.layers)t.writeMessage(3,s,e.layers[r])}(t,r),r.finish()}(t);return 0===r.byteOffset&&r.byteLength===r.buffer.byteLength||(r=new Uint8Array(r)),{vectorTile:t,rawData:r.buffer}}function y(t,r,n){const{extent:i}=t,a=Math.pow(2,n.z-r.z),o=(n.x-r.x*a)*i,s=(n.y-r.y*a)*i,l=[];for(let r=0;r<t.length;r++){const n=t.feature(r);let c=n.loadGeometry();for(const e of c)for(const t of e)t.x=t.x*a-o,t.y=t.y*a-s;const u=128;c=e.cX(c,n.type,-u,-u,i+u,i+u),0!==c.length&&l.push(new f(n.type,c,n.properties,n.id,i))}return new m(l,t.name,i)}class v{constructor(t,r,n){this.actor=t,this.layerIndex=r,this.availableImages=n,this.fetching={},this.loading={},this.loaded={},this.overzoomedTileResultCache=new e.cY(1e3)}loadVectorTile(t,r){return e._(this,void 0,void 0,function*(){const n=yield e.n(t.request,r);try{return{vectorTile:"mlt"!==t.encoding?new e.cZ(new e.cV(n.data)):new e.c_(n.data),rawData:n.data,cacheControl:n.cacheControl,expires:n.expires}}catch(e){const r=new Uint8Array(n.data);let i=`Unable to parse the tile at ${t.request.url}, `;throw i+=31===r[0]&&139===r[1]?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${e.message}`,new Error(i)}})}loadTile(t){return e._(this,void 0,void 0,function*(){const{uid:r,overzoomParameters:i}=t;i&&(t.request=i.overzoomRequest);const a=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.c$(t.request),o=new n(t);this.loading[r]=o;const s=new AbortController;o.abort=s;try{const n=yield this.loadVectorTile(t,s);if(delete this.loading[r],!n)return null;if(i){const e=this._getOverzoomTile(t,n.vectorTile);n.rawData=e.rawData,n.vectorTile=e.vectorTile}const l=n.rawData,c={};n.expires&&(c.expires=n.expires),n.cacheControl&&(c.cacheControl=n.cacheControl);const u={};if(a){const e=a.finish();e&&(u.resourceTiming=JSON.parse(JSON.stringify(e)))}o.vectorTile=n.vectorTile;const h=o.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor,t.subdivisionGranularity);this.loaded[r]=o,this.fetching[r]={rawTileData:l,cacheControl:c,resourceTiming:u};try{const r=yield h;return e.e({rawTileData:l.slice(0),encoding:t.encoding},r,c,u)}finally{delete this.fetching[r]}}catch(e){throw delete this.loading[r],o.status="done",this.loaded[r]=o,e}})}_getOverzoomTile(e,t){const{tileID:r,source:n,overzoomParameters:i}=e,{maxZoomTileID:a}=i,o=`${a.key}_${r.key}`,s=this.overzoomedTileResultCache.get(o);if(s)return s;const l=new g,c=this.layerIndex.familiesBySource[n];for(const e in c){const n=t.layers[e];if(!n)continue;const i=y(n,a,r.canonical);i.length>0&&l.addLayer(i)}const u=_(l);return this.overzoomedTileResultCache.set(o,u),u}reloadTile(t){return e._(this,void 0,void 0,function*(){const r=t.uid;if(!this.loaded||!this.loaded[r])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const n=this.loaded[r];if(n.showCollisionBoxes=t.showCollisionBoxes,"parsing"===n.status){const i=yield n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor,t.subdivisionGranularity);let a;if(this.fetching[r]){const{rawTileData:n,cacheControl:o,resourceTiming:s}=this.fetching[r];delete this.fetching[r],a=e.e({rawTileData:n.slice(0),encoding:t.encoding},i,o,s)}else a=i;return a}if("done"===n.status&&n.vectorTile)return n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor,t.subdivisionGranularity)})}abortTile(t){return e._(this,void 0,void 0,function*(){const e=this.loading,r=t.uid;e&&e[r]&&e[r].abort&&(e[r].abort.abort(),delete e[r])})}removeTile(t){return e._(this,void 0,void 0,function*(){this.loaded&&this.loaded[t.uid]&&delete this.loaded[t.uid]})}}class b{constructor(){this.loaded={}}loadTile(t){return e._(this,void 0,void 0,function*(){const{uid:r,encoding:n,rawImageData:i,redFactor:a,greenFactor:o,blueFactor:s,baseShift:l}=t,c=i.width+2,u=i.height+2,h=e.b(i)?new e.R({width:c,height:u},yield e.d0(i,-1,-1,c,u)):i,d=new e.d1(r,h,n,a,o,s,l);return this.loaded=this.loaded||{},this.loaded[r]=d,d})}removeTile(e){const t=this.loaded,r=e.uid;t&&t[r]&&delete t[r]}}var x,w,T=function(){if(w)return x;function e(e,r){if(0!==e.length){t(e[0],r);for(var n=1;n<e.length;n++)t(e[n],!r)}}function t(e,t){for(var r=0,n=0,i=0,a=e.length,o=a-1;i<a;o=i++){var s=(e[i][0]-e[o][0])*(e[o][1]+e[i][1]),l=r+s;n+=Math.abs(r)>=Math.abs(s)?r-l+s:s-l+r,r=l}r+n>=0!=!!t&&e.reverse()}return w=1,x=function t(r,n){var i,a=r&&r.type;if("FeatureCollection"===a)for(i=0;i<r.features.length;i++)t(r.features[i],n);else if("GeometryCollection"===a)for(i=0;i<r.geometries.length;i++)t(r.geometries[i],n);else if("Feature"===a)t(r.geometry,n);else if("Polygon"===a)e(r.coordinates,n);else if("MultiPolygon"===a)for(i=0;i<r.coordinates.length;i++)e(r.coordinates[i],n);return r}}(),S=e.d2(T);const P={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},E=Math.fround||(C=new Float32Array(1),e=>(C[0]=+e,C[0]));var C;class M{constructor(e){this.options=Object.assign(Object.create(P),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:t,minZoom:r,maxZoom:n}=this.options;t&&console.time("total time");const i=`prepare ${e.length} points`;t&&console.time(i),this.points=e;const a=[];for(let t=0;t<e.length;t++){const r=e[t];if(!r.geometry)continue;const[n,i]=r.geometry.coordinates,o=E(A(n)),s=E(z(i));a.push(o,s,1/0,t,-1,1),this.options.reduce&&a.push(0)}let o=this.trees[n+1]=this._createTree(a);t&&console.timeEnd(i);for(let e=n;e>=r;e--){const r=+Date.now();o=this.trees[e]=this._createTree(this._cluster(o,e)),t&&console.log("z%d: %d clusters in %dms",e,o.numItems,+Date.now()-r)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let r=((e[0]+180)%360+360)%360-180;const n=Math.max(-90,Math.min(90,e[1]));let i=180===e[2]?180:((e[2]+180)%360+360)%360-180;const a=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,i=180;else if(r>i){const e=this.getClusters([r,n,180,a],t),o=this.getClusters([-180,n,i,a],t);return e.concat(o)}const o=this.trees[this._limitZoom(t)],s=o.range(A(r),z(a),A(i),z(n)),l=o.data,c=[];for(const e of s){const t=this.stride*e;c.push(l[t+5]>1?k(l,t,this.clusterProps):this.points[l[t+3]])}return c}getChildren(e){const t=this._getOriginId(e),r=this._getOriginZoom(e),n="No cluster with the specified id.",i=this.trees[r];if(!i)throw new Error(n);const a=i.data;if(t*this.stride>=a.length)throw new Error(n);const o=this.options.radius/(this.options.extent*Math.pow(2,r-1)),s=i.within(a[t*this.stride],a[t*this.stride+1],o),l=[];for(const t of s){const r=t*this.stride;a[r+4]===e&&l.push(a[r+5]>1?k(a,r,this.clusterProps):this.points[a[r+3]])}if(0===l.length)throw new Error(n);return l}getLeaves(e,t,r){const n=[];return this._appendLeaves(n,e,t=t||10,r=r||0,0),n}getTile(e,t,r){const n=this.trees[this._limitZoom(e)],i=Math.pow(2,e),{extent:a,radius:o}=this.options,s=o/a,l=(r-s)/i,c=(r+1+s)/i,u={features:[]};return this._addTileFeatures(n.range((t-s)/i,l,(t+1+s)/i,c),n.data,t,r,i,u),0===t&&this._addTileFeatures(n.range(1-s/i,l,1,c),n.data,i,r,i,u),t===i-1&&this._addTileFeatures(n.range(0,l,s/i,c),n.data,-1,r,i,u),u.features.length?u:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const r=this.getChildren(e);if(t++,1!==r.length)break;e=r[0].properties.cluster_id}return t}_appendLeaves(e,t,r,n,i){const a=this.getChildren(t);for(const t of a){const a=t.properties;if(a&&a.cluster?i+a.point_count<=n?i+=a.point_count:i=this._appendLeaves(e,a.cluster_id,r,n,i):i<n?i++:e.push(t),e.length===r)break}return i}_createTree(t){const r=new e.aS(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let e=0;e<t.length;e+=this.stride)r.add(t[e],t[e+1]);return r.finish(),r.data=t,r}_addTileFeatures(e,t,r,n,i,a){for(const o of e){const e=o*this.stride,s=t[e+5]>1;let l,c,u;if(s)l=I(t,e,this.clusterProps),c=t[e],u=t[e+1];else{const r=this.points[t[e+3]];l=r.properties;const[n,i]=r.geometry.coordinates;c=A(n),u=z(i)}const h={type:1,geometry:[[Math.round(this.options.extent*(c*i-r)),Math.round(this.options.extent*(u*i-n))]],tags:l};let d;d=s||this.options.generateId?t[e+3]:this.points[t[e+3]].id,void 0!==d&&(h.id=d),a.features.push(h)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const{radius:r,extent:n,reduce:i,minPoints:a}=this.options,o=r/(n*Math.pow(2,t)),s=e.data,l=[],c=this.stride;for(let r=0;r<s.length;r+=c){if(s[r+2]<=t)continue;s[r+2]=t;const n=s[r],u=s[r+1],h=e.within(s[r],s[r+1],o),d=s[r+5];let p=d;for(const e of h){const r=e*c;s[r+2]>t&&(p+=s[r+5])}if(p>d&&p>=a){let e,a=n*d,o=u*d,f=-1;const m=(r/c<<5)+(t+1)+this.points.length;for(const n of h){const l=n*c;if(s[l+2]<=t)continue;s[l+2]=t;const u=s[l+5];a+=s[l]*u,o+=s[l+1]*u,s[l+4]=m,i&&(e||(e=this._map(s,r,!0),f=this.clusterProps.length,this.clusterProps.push(e)),i(e,this._map(s,l)))}s[r+4]=m,l.push(a/p,o/p,1/0,m,-1,p),i&&l.push(f)}else{for(let e=0;e<c;e++)l.push(s[r+e]);if(p>1)for(const e of h){const r=e*c;if(!(s[r+2]<=t)){s[r+2]=t;for(let e=0;e<c;e++)l.push(s[r+e])}}}}return l}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,r){if(e[t+5]>1){const n=this.clusterProps[e[t+6]];return r?Object.assign({},n):n}const n=this.points[e[t+3]].properties,i=this.options.map(n);return r&&i===n?Object.assign({},i):i}}function k(e,t,r){return{type:"Feature",id:e[t+3],properties:I(e,t,r),geometry:{type:"Point",coordinates:[(n=e[t],360*(n-.5)),D(e[t+1])]}};var n}function I(e,t,r){const n=e[t+5],i=n>=1e4?`${Math.round(n/1e3)}k`:n>=1e3?Math.round(n/100)/10+"k":n,a=e[t+6],o=-1===a?{}:Object.assign({},r[a]);return Object.assign(o,{cluster:!0,cluster_id:e[t+3],point_count:n,point_count_abbreviated:i})}function A(e){return e/360+.5}function z(e){const t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function D(e){const t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function L(e,t,r,n){let i=n;const a=t+(r-t>>1);let o,s=r-t;const l=e[t],c=e[t+1],u=e[r],h=e[r+1];for(let n=t+3;n<r;n+=3){const t=R(e[n],e[n+1],l,c,u,h);if(t>i)o=n,i=t;else if(t===i){const e=Math.abs(n-a);e<s&&(o=n,s=e)}}i>n&&(o-t>3&&L(e,t,o,n),e[o+2]=i,r-o>3&&L(e,o,r,n))}function R(e,t,r,n,i,a){let o=i-r,s=a-n;if(0!==o||0!==s){const l=((e-r)*o+(t-n)*s)/(o*o+s*s);l>1?(r=i,n=a):l>0&&(r+=o*l,n+=s*l)}return o=e-r,s=t-n,o*o+s*s}function F(e,t,r,n){const i={id:null==e?null:e,type:t,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if("Point"===t||"MultiPoint"===t||"LineString"===t)B(i,r);else if("Polygon"===t)B(i,r[0]);else if("MultiLineString"===t)for(const e of r)B(i,e);else if("MultiPolygon"===t)for(const e of r)B(i,e[0]);return i}function B(e,t){for(let r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function O(e,t,r,n){if(!t.geometry)return;const i=t.geometry.coordinates;if(i&&0===i.length)return;const a=t.geometry.type,o=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2);let s=[],l=t.id;if(r.promoteId?l=t.properties[r.promoteId]:r.generateId&&(l=n||0),"Point"===a)N(i,s);else if("MultiPoint"===a)for(const e of i)N(e,s);else if("LineString"===a)V(i,s,o,!1);else if("MultiLineString"===a){if(r.lineMetrics){for(const r of i)s=[],V(r,s,o,!1),e.push(F(l,"LineString",s,t.properties));return}j(i,s,o,!1)}else if("Polygon"===a)j(i,s,o,!0);else{if("MultiPolygon"!==a){if("GeometryCollection"===a){for(const i of t.geometry.geometries)O(e,{id:l,geometry:i,properties:t.properties},r,n);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const e of i){const t=[];j(e,t,o,!0),s.push(t)}}e.push(F(l,a,s,t.properties))}function N(e,t){t.push(U(e[0]),G(e[1]),0)}function V(e,t,r,n){let i,a,o=0;for(let r=0;r<e.length;r++){const s=U(e[r][0]),l=G(e[r][1]);t.push(s,l,0),r>0&&(o+=n?(i*l-s*a)/2:Math.sqrt(Math.pow(s-i,2)+Math.pow(l-a,2))),i=s,a=l}const s=t.length-3;t[2]=1,L(t,0,s,r),t[s+2]=1,t.size=Math.abs(o),t.start=0,t.end=t.size}function j(e,t,r,n){for(let i=0;i<e.length;i++){const a=[];V(e[i],a,r,n),t.push(a)}}function U(e){return e/360+.5}function G(e){const t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function q(e,t,r,n,i,a,o,s){if(n/=t,a>=(r/=t)&&o<n)return e;if(o<r||a>=n)return null;const l=[];for(const t of e){const e=t.geometry;let a=t.type;const o=0===i?t.minX:t.minY,c=0===i?t.maxX:t.maxY;if(o>=r&&c<n){l.push(t);continue}if(c<r||o>=n)continue;let u=[];if("Point"===a||"MultiPoint"===a)$(e,u,r,n,i);else if("LineString"===a)Z(e,u,r,n,i,!1,s.lineMetrics);else if("MultiLineString"===a)W(e,u,r,n,i,!1);else if("Polygon"===a)W(e,u,r,n,i,!0);else if("MultiPolygon"===a)for(const t of e){const e=[];W(t,e,r,n,i,!0),e.length&&u.push(e)}if(u.length){if(s.lineMetrics&&"LineString"===a){for(const e of u)l.push(F(t.id,a,e,t.tags));continue}"LineString"!==a&&"MultiLineString"!==a||(1===u.length?(a="LineString",u=u[0]):a="MultiLineString"),"Point"!==a&&"MultiPoint"!==a||(a=3===u.length?"Point":"MultiPoint"),l.push(F(t.id,a,u,t.tags))}}return l.length?l:null}function $(e,t,r,n,i){for(let a=0;a<e.length;a+=3){const o=e[a+i];o>=r&&o<=n&&X(t,e[a],e[a+1],e[a+2])}}function Z(e,t,r,n,i,a,o){let s=H(e);const l=0===i?Y:K;let c,u,h=e.start;for(let d=0;d<e.length-3;d+=3){const p=e[d],f=e[d+1],m=e[d+2],g=e[d+3],_=e[d+4],y=0===i?p:f,v=0===i?g:_;let b=!1;o&&(c=Math.sqrt(Math.pow(p-g,2)+Math.pow(f-_,2))),y<r?v>r&&(u=l(s,p,f,g,_,r),o&&(s.start=h+c*u)):y>n?v<n&&(u=l(s,p,f,g,_,n),o&&(s.start=h+c*u)):X(s,p,f,m),v<r&&y>=r&&(u=l(s,p,f,g,_,r),b=!0),v>n&&y<=n&&(u=l(s,p,f,g,_,n),b=!0),!a&&b&&(o&&(s.end=h+c*u),t.push(s),s=H(e)),o&&(h+=c)}let d=e.length-3;const p=e[d],f=e[d+1],m=0===i?p:f;m>=r&&m<=n&&X(s,p,f,e[d+2]),d=s.length-3,a&&d>=3&&(s[d]!==s[0]||s[d+1]!==s[1])&&X(s,s[0],s[1],s[2]),s.length&&t.push(s)}function H(e){const t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function W(e,t,r,n,i,a){for(const o of e)Z(o,t,r,n,i,a,!1)}function X(e,t,r,n){e.push(t,r,n)}function Y(e,t,r,n,i,a){const o=(a-t)/(n-t);return X(e,a,r+(i-r)*o,1),o}function K(e,t,r,n,i,a){const o=(a-r)/(i-r);return X(e,t+(n-t)*o,a,1),o}function Q(e,t){const r=[];for(let n=0;n<e.length;n++){const i=e[n],a=i.type;let o;if("Point"===a||"MultiPoint"===a||"LineString"===a)o=J(i.geometry,t);else if("MultiLineString"===a||"Polygon"===a){o=[];for(const e of i.geometry)o.push(J(e,t))}else if("MultiPolygon"===a){o=[];for(const e of i.geometry){const r=[];for(const n of e)r.push(J(n,t));o.push(r)}}r.push(F(i.id,a,o,i.tags))}return r}function J(e,t){const r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(let n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}function ee(e,t){if(e.transformed)return e;const r=1<<e.z,n=e.x,i=e.y;for(const a of e.features){const e=a.geometry,o=a.type;if(a.geometry=[],1===o)for(let o=0;o<e.length;o+=2)a.geometry.push(te(e[o],e[o+1],t,r,n,i));else for(let o=0;o<e.length;o++){const s=[];for(let a=0;a<e[o].length;a+=2)s.push(te(e[o][a],e[o][a+1],t,r,n,i));a.geometry.push(s)}}return e.transformed=!0,e}function te(e,t,r,n,i,a){return[Math.round(r*(e*n-i)),Math.round(r*(t*n-a))]}function re(e,t,r,n,i){const a=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:e.length,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const t of e)ne(o,t,a,i);return o}function ne(e,t,r,n){const i=t.geometry,a=t.type,o=[];if(e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),"Point"===a||"MultiPoint"===a)for(let t=0;t<i.length;t+=3)o.push(i[t],i[t+1]),e.numPoints++,e.numSimplified++;else if("LineString"===a)ie(o,i,e,r,!1,!1);else if("MultiLineString"===a||"Polygon"===a)for(let t=0;t<i.length;t++)ie(o,i[t],e,r,"Polygon"===a,0===t);else if("MultiPolygon"===a)for(let t=0;t<i.length;t++){const n=i[t];for(let t=0;t<n.length;t++)ie(o,n[t],e,r,!0,0===t)}if(o.length){let r=t.tags||null;if("LineString"===a&&n.lineMetrics){r={};for(const e in t.tags)r[e]=t.tags[e];r.mapbox_clip_start=i.start/i.size,r.mapbox_clip_end=i.end/i.size}const s={geometry:o,type:"Polygon"===a||"MultiPolygon"===a?3:"LineString"===a||"MultiLineString"===a?2:1,tags:r};null!==t.id&&(s.id=t.id),e.features.push(s)}}function ie(e,t,r,n,i,a){const o=n*n;if(n>0&&t.size<(i?o:n))return void(r.numPoints+=t.length/3);const s=[];for(let e=0;e<t.length;e+=3)(0===n||t[e+2]>o)&&(r.numSimplified++,s.push(t[e],t[e+1])),r.numPoints++;i&&function(e,t){let r=0;for(let t=0,n=e.length,i=n-2;t<n;i=t,t+=2)r+=(e[t]-e[i])*(e[t+1]+e[i+1]);if(r>0===t)for(let t=0,r=e.length;t<r/2;t+=2){const n=e[t],i=e[t+1];e[t]=e[r-2-t],e[t+1]=e[r-1-t],e[r-2-t]=n,e[r-1-t]=i}}(s,a),e.push(s)}const ae={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class oe{constructor(e,t){const r=(t=this.options=function(e,t){for(const r in t)e[r]=t[r];return e}(Object.create(ae),t)).debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");let n=function(e,t){const r=[];if("FeatureCollection"===e.type)for(let n=0;n<e.features.length;n++)O(r,e.features[n],t,n);else O(r,"Feature"===e.type?e:{geometry:e},t);return r}(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=function(e,t){const r=t.buffer/t.extent;let n=e;const i=q(e,1,-1-r,r,0,-1,2,t),a=q(e,1,1-r,2+r,0,-1,2,t);return(i||a)&&(n=q(e,1,-r,1+r,0,-1,2,t)||[],i&&(n=Q(i,1).concat(n)),a&&(n=n.concat(Q(a,-1)))),n}(n,t),n.length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(e,t,r,n,i,a,o){const s=[e,t,r,n],l=this.options,c=l.debug;for(;s.length;){n=s.pop(),r=s.pop(),t=s.pop(),e=s.pop();const u=1<<t,h=se(t,r,n);let d=this.tiles[h];if(!d&&(c>1&&console.time("creation"),d=this.tiles[h]=re(e,t,r,n,l),this.tileCoords.push({z:t,x:r,y:n}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,n,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));const e=`z${t}`;this.stats[e]=(this.stats[e]||0)+1,this.total++}if(d.source=e,null==i){if(t===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue}else{if(t===l.maxZoom||t===i)continue;if(null!=i){const e=i-t;if(r!==a>>e||n!==o>>e)continue}}if(d.source=null,0===e.length)continue;c>1&&console.time("clipping");const p=.5*l.buffer/l.extent,f=.5-p,m=.5+p,g=1+p;let _=null,y=null,v=null,b=null,x=q(e,u,r-p,r+m,0,d.minX,d.maxX,l),w=q(e,u,r+f,r+g,0,d.minX,d.maxX,l);e=null,x&&(_=q(x,u,n-p,n+m,1,d.minY,d.maxY,l),y=q(x,u,n+f,n+g,1,d.minY,d.maxY,l),x=null),w&&(v=q(w,u,n-p,n+m,1,d.minY,d.maxY,l),b=q(w,u,n+f,n+g,1,d.minY,d.maxY,l),w=null),c>1&&console.timeEnd("clipping"),s.push(_||[],t+1,2*r,2*n),s.push(y||[],t+1,2*r,2*n+1),s.push(v||[],t+1,2*r+1,2*n),s.push(b||[],t+1,2*r+1,2*n+1)}}getTile(e,t,r){e=+e,t=+t,r=+r;const n=this.options,{extent:i,debug:a}=n;if(e<0||e>24)return null;const o=1<<e,s=se(e,t=t+o&o-1,r);if(this.tiles[s])return ee(this.tiles[s],i);a>1&&console.log("drilling down to z%d-%d-%d",e,t,r);let l,c=e,u=t,h=r;for(;!l&&c>0;)c--,u>>=1,h>>=1,l=this.tiles[se(c,u,h)];return l&&l.source?(a>1&&(console.log("found parent tile z%d-%d-%d",c,u,h),console.time("drilling down")),this.splitTile(l.source,c,u,h,e,t,r),a>1&&console.timeEnd("drilling down"),this.tiles[s]?ee(this.tiles[s],i):null):null}}function se(e,t,r){return 32*((1<<e)*r+t)+e}class le extends v{constructor(e,t,r,n=ce){super(e,t,r),this._dataUpdateable=new Map,this._createGeoJSONIndex=n}loadVectorTile(t,r){return e._(this,void 0,void 0,function*(){const r=t.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const n=this._geoJSONIndex.getTile(r.z,r.x,r.y);return n?_(new o(n.features,{version:2,extent:e.a4})):null})}loadData(t){return e._(this,void 0,void 0,function*(){var r;null===(r=this._pendingRequest)||void 0===r||r.abort();const n=this._startPerformance(t);this._pendingRequest=new AbortController;try{(!this._pendingData||t.request||t.data||t.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(t,this._pendingRequest));const r=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(r,t),this.loaded={};const i=t.dataDiff&&e.a6(r)?{applyDiff:!0}:{data:r};return this._finishPerformance(n,t,i),i}catch(t){if(delete this._pendingRequest,e.cH(t))return{abandoned:!0};throw t}})}_startPerformance(t){var r;if(null===(r=null==t?void 0:t.request)||void 0===r?void 0:r.collectResourceTiming)return new e.c$(t.request)}_finishPerformance(e,t,r){if(!e)return;const n=e.finish();n&&(r.resourceTiming={},r.resourceTiming[t.source]=JSON.parse(JSON.stringify(n)))}getData(){return e._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(e){const t=this.loaded;return t&&t[e.uid]?super.reloadTile(e):this.loadTile(e)}loadAndProcessGeoJSON(t,r){return e._(this,void 0,void 0,function*(){let e;if(t.request?e=yield this.loadGeoJSONFromUrl(t.request,t.promoteId,r):t.data?e=this._loadGeoJSONFromObject(t.data,t.promoteId):t.dataDiff&&(e=this._loadGeoJSONFromDiff(t.dataDiff,t.promoteId,t.source)),delete this._pendingRequest,"object"!=typeof e)throw new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`);return S(e,!0),t.filter&&(e=this._filterGeoJSON(e,t.filter)),e})}loadGeoJSONFromUrl(t,r,n){return e._(this,void 0,void 0,function*(){const i=yield e.j(t,n);return this._dataUpdateable=e.a6(i.data,r)?e.a7(i.data,r):void 0,i.data})}_loadGeoJSONFromObject(t,r){return this._dataUpdateable=e.a6(t,r)?e.a7(t,r):void 0,t}_loadGeoJSONFromDiff(t,r,n){if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${n}`);e.a8(this._dataUpdateable,t,r);const i=Array.from(this._dataUpdateable.values());return this._toFeatureCollection(i)}_filterGeoJSON(t,r){const n=e.d3(r,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===n.result)throw new Error(n.value.map(e=>`${e.key}: ${e.message}`).join(", "));const i=t.features.filter(e=>n.value.evaluate({zoom:0},e));return this._toFeatureCollection(i)}_toFeatureCollection(e){return{type:"FeatureCollection",features:e}}removeSource(t){return e._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(e){return this._geoJSONIndex.getClusterExpansionZoom(e.clusterId)}getClusterChildren(e){return this._geoJSONIndex.getChildren(e.clusterId)}getClusterLeaves(e){return this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset)}}function ce(t,r){return r.cluster?new M(function({superclusterOptions:t,clusterProperties:r}){if(!r||!t)return t;const n={},i={},a={accumulated:null,zoom:0},o={properties:null},s=Object.keys(r);for(const t of s){const[a,o]=r[t],s=e.d3(o),l=e.d3("string"==typeof a?[a,["accumulated"],["get",t]]:a);n[t]=s.value,i[t]=l.value}return t.map=e=>{o.properties=e;const t={};for(const e of s)t[e]=n[e].evaluate(a,o);return t},t.reduce=(e,t)=>{o.properties=t;for(const t of s)a.accumulated=e[t],e[t]=i[t].evaluate(a,o)},t}(r)).load(t.features):function(e,t){return new oe(e,t)}(t,r.geojsonVtOptions)}class ue{constructor(t){this.self=t,this.actor=new e.L(t),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(e,t)=>{if(this.externalWorkerSourceTypes[e])throw new Error(`Worker source with name "${e}" already registered.`);this.externalWorkerSourceTypes[e]=t},this.self.addProtocol=e.cJ,this.self.removeProtocol=e.cK,this.self.registerRTLTextPlugin=t=>{e.d4.setMethods(t)},this.actor.registerMessageHandler("LDT",(e,t)=>this._getDEMWorkerSource(e,t.source).loadTile(t)),this.actor.registerMessageHandler("RDT",(t,r)=>e._(this,void 0,void 0,function*(){this._getDEMWorkerSource(t,r.source).removeTile(r)})),this.actor.registerMessageHandler("GCEZ",(t,r)=>e._(this,void 0,void 0,function*(){return this._getWorkerSource(t,r.type,r.source).getClusterExpansionZoom(r)})),this.actor.registerMessageHandler("GCC",(t,r)=>e._(this,void 0,void 0,function*(){return this._getWorkerSource(t,r.type,r.source).getClusterChildren(r)})),this.actor.registerMessageHandler("GCL",(t,r)=>e._(this,void 0,void 0,function*(){return this._getWorkerSource(t,r.type,r.source).getClusterLeaves(r)})),this.actor.registerMessageHandler("LD",(e,t)=>this._getWorkerSource(e,t.type,t.source).loadData(t)),this.actor.registerMessageHandler("GD",(e,t)=>this._getWorkerSource(e,t.type,t.source).getData()),this.actor.registerMessageHandler("LT",(e,t)=>this._getWorkerSource(e,t.type,t.source).loadTile(t)),this.actor.registerMessageHandler("RT",(e,t)=>this._getWorkerSource(e,t.type,t.source).reloadTile(t)),this.actor.registerMessageHandler("AT",(e,t)=>this._getWorkerSource(e,t.type,t.source).abortTile(t)),this.actor.registerMessageHandler("RMT",(e,t)=>this._getWorkerSource(e,t.type,t.source).removeTile(t)),this.actor.registerMessageHandler("RS",(t,r)=>e._(this,void 0,void 0,function*(){if(!this.workerSources[t]||!this.workerSources[t][r.type]||!this.workerSources[t][r.type][r.source])return;const e=this.workerSources[t][r.type][r.source];delete this.workerSources[t][r.type][r.source],void 0!==e.removeSource&&e.removeSource(r)})),this.actor.registerMessageHandler("RM",t=>e._(this,void 0,void 0,function*(){delete this.layerIndexes[t],delete this.availableImages[t],delete this.workerSources[t],delete this.demWorkerSources[t],this.globalStates.delete(t)})),this.actor.registerMessageHandler("SR",(t,r)=>e._(this,void 0,void 0,function*(){this.referrer=r})),this.actor.registerMessageHandler("SRPS",(e,t)=>this._syncRTLPluginState(e,t)),this.actor.registerMessageHandler("IS",(t,r)=>e._(this,void 0,void 0,function*(){this.self.importScripts(r)})),this.actor.registerMessageHandler("SI",(e,t)=>this._setImages(e,t)),this.actor.registerMessageHandler("UL",(t,r)=>e._(this,void 0,void 0,function*(){this._getLayerIndex(t).update(r.layers,r.removedIds,this._getGlobalState(t))})),this.actor.registerMessageHandler("UGS",(t,r)=>e._(this,void 0,void 0,function*(){const e=this._getGlobalState(t);for(const t in r)e[t]=r[t]})),this.actor.registerMessageHandler("SL",(t,r)=>e._(this,void 0,void 0,function*(){this._getLayerIndex(t).replace(r,this._getGlobalState(t))}))}_getGlobalState(e){let t=this.globalStates.get(e);return t||(t={},this.globalStates.set(e,t)),t}_setImages(t,r){return e._(this,void 0,void 0,function*(){this.availableImages[t]=r;for(const e in this.workerSources[t]){const n=this.workerSources[t][e];for(const e in n)n[e].availableImages=r}})}_syncRTLPluginState(t,r){return e._(this,void 0,void 0,function*(){return yield e.d4.syncState(r,this.self.importScripts)})}_getAvailableImages(e){let t=this.availableImages[e];return t||(t=[]),t}_getLayerIndex(e){let r=this.layerIndexes[e];return r||(r=this.layerIndexes[e]=new t),r}_getWorkerSource(e,t,r){if(this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),!this.workerSources[e][t][r]){const n={sendAsync:(t,r)=>(t.targetMapId=e,this.actor.sendAsync(t,r))};switch(t){case"vector":this.workerSources[e][t][r]=new v(n,this._getLayerIndex(e),this._getAvailableImages(e));break;case"geojson":this.workerSources[e][t][r]=new le(n,this._getLayerIndex(e),this._getAvailableImages(e));break;default:this.workerSources[e][t][r]=new this.externalWorkerSourceTypes[t](n,this._getLayerIndex(e),this._getAvailableImages(e))}}return this.workerSources[e][t][r]}_getDEMWorkerSource(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new b),this.demWorkerSources[e][t]}}return e.i(self)&&(self.worker=new ue(self)),ue}),r("index",0,function(e,t){var r="5.13.0";function n(){var e=new t.A(4);return t.A!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}let i,a,o;const s={frame(e,r,n){const i=requestAnimationFrame(e=>{a(),r(e)}),{unsubscribe:a}=t.s(e.signal,"abort",()=>{a(),cancelAnimationFrame(i),n(t.c())},!1)},frameAsync(e){return new Promise((t,r)=>{this.frame(e,t,r)})},getImageData(e,t=0){return this.getImageCanvasContext(e).getImageData(-t,-t,e.width+2*t,e.height+2*t)},getImageCanvasContext(e){const t=window.document.createElement("canvas"),r=t.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return t.width=e.width,t.height=e.height,r.drawImage(e,0,0,e.width,e.height),r},resolveURL:e=>(i||(i=document.createElement("a")),i.href=e,i.href),hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return void 0!==o?o:!!matchMedia&&(null==a&&(a=matchMedia("(prefers-reduced-motion: reduce)")),a.matches)},set prefersReducedMotion(e){o=e}},l=new class{constructor(){this._realTime="undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return null!==this._frozenAt?this._frozenAt:this._realTime()}setNow(e){this._frozenAt=e}restoreNow(){this._frozenAt=null}isFrozen(){return null!==this._frozenAt}};function c(){return l.getCurrentTime()}class u{static testProp(e){if(!u.docStyle)return e[0];for(let t=0;t<e.length;t++)if(e[t]in u.docStyle)return e[t];return e[0]}static create(e,t,r){const n=window.document.createElement(e);return void 0!==t&&(n.className=t),r&&r.appendChild(n),n}static createNS(e,t){return window.document.createElementNS(e,t)}static disableDrag(){u.docStyle&&u.selectProp&&(u.userSelect=u.docStyle[u.selectProp],u.docStyle[u.selectProp]="none")}static enableDrag(){u.docStyle&&u.selectProp&&(u.docStyle[u.selectProp]=u.userSelect)}static setTransform(e,t){e.style[u.transformProp]=t}static addEventListener(e,t,r,n={}){e.addEventListener(t,r,"passive"in n?n:n.capture)}static removeEventListener(e,t,r,n={}){e.removeEventListener(t,r,"passive"in n?n:n.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",u.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",u.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",u.suppressClickInternal,!0)},0)}static getScale(e){const t=e.getBoundingClientRect();return{x:t.width/e.offsetWidth||1,y:t.height/e.offsetHeight||1,boundingClientRect:t}}static getPoint(e,r,n){const i=r.boundingClientRect;return new t.P((n.clientX-i.left)/r.x-e.clientLeft,(n.clientY-i.top)/r.y-e.clientTop)}static mousePos(e,t){const r=u.getScale(e);return u.getPoint(e,r,t)}static touchPos(e,t){const r=[],n=u.getScale(e);for(let i=0;i<t.length;i++)r.push(u.getPoint(e,n,t[i]));return r}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const t=(new DOMParser).parseFromString(e,"text/html").body||document.createElement("body"),r=t.querySelectorAll("script");for(const e of r)e.remove();return u.clean(t),t.innerHTML}static isPossiblyDangerous(e,t){const r=t.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!r.includes("javascript:")&&!r.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const t=e.children;for(const e of t)u.removeAttributes(e),u.clean(e)}static removeAttributes(e){for(const{name:t,value:r}of e.attributes)u.isPossiblyDangerous(t,r)&&e.removeAttribute(t)}}u.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style,u.selectProp=u.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),u.transformProp=u.testProp(["transform","WebkitTransform"]);const h={supported:!1,testSupport:function(e){!f&&p&&(m?g(e):d=e)}};let d,p,f=!1,m=!1;function g(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,p),e.isContextLost())return;h.supported=!0}catch(e){}e.deleteTexture(t),f=!0}var _;"undefined"!=typeof document&&(p=document.createElement("img"),p.onload=()=>{d&&g(d),d=null,m=!0},p.onerror=()=>{f=!0,d=null},p.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(e){let r,n,i,a;e.resetRequestQueue=()=>{r=[],n=0,i=0,a={}},e.addThrottleControl=e=>{const t=i++;return a[t]=e,t},e.removeThrottleControl=e=>{delete a[e],s()},e.getImage=(e,n,i=!0)=>new Promise((a,o)=>{h.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),t.e(e,{type:"image"}),r.push({abortController:n,requestParameters:e,supportImageRefresh:i,state:"queued",onError:e=>{o(e)},onSuccess:e=>{a(e)}}),s()});const o=e=>t._(this,void 0,void 0,function*(){e.state="running";const{requestParameters:r,supportImageRefresh:i,onError:a,onSuccess:o,abortController:c}=e,u=!1===i&&!t.i(self)&&!t.g(r.url)&&(!r.headers||Object.keys(r.headers).reduce((e,t)=>e&&"accept"===t,!0));n++;const h=u?l(r,c):t.m(r,c);try{const r=yield h;delete e.abortController,e.state="completed",r.data instanceof HTMLImageElement||t.b(r.data)?o(r):r.data&&o({data:yield(d=r.data,"function"==typeof createImageBitmap?t.f(d):t.h(d)),cacheControl:r.cacheControl,expires:r.expires})}catch(t){delete e.abortController,a(t)}finally{n--,s()}var d}),s=()=>{const e=(()=>{for(const e of Object.keys(a))if(a[e]())return!0;return!1})()?t.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:t.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let t=n;t<e&&r.length>0;t++){const e=r.shift();e.abortController.signal.aborted?t--:o(e)}},l=(e,r)=>new Promise((n,i)=>{const a=new Image,o=e.url,s=e.credentials;s&&"include"===s?a.crossOrigin="use-credentials":(s&&"same-origin"===s||!t.d(o))&&(a.crossOrigin="anonymous"),r.signal.addEventListener("abort",()=>{a.src="",i(t.c())}),a.fetchPriority="high",a.onload=()=>{a.onerror=a.onload=null,n({data:a})},a.onerror=()=>{a.onerror=a.onload=null,r.signal.aborted||i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},a.src=o})}(_||(_={})),_.resetRequestQueue();class y{constructor(e){this._transformRequestFn=null!=e?e:null}transformRequest(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function v(e){const t=[];if("string"==typeof e)t.push({id:"default",url:e});else if(e&&e.length>0){const r=[];for(const{id:n,url:i}of e){const e=`${n}${i}`;-1===r.indexOf(e)&&(r.push(e),t.push({id:n,url:i}))}}return t}function b(e,t,r){try{const n=new URL(e);return n.pathname+=`${t}${r}`,n.toString()}catch(t){throw new Error(`Invalid sprite URL "${e}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function x(e){const{userImage:t}=e;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}class w extends t.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.R({width:1,height:1}),this.dirty=!0}destroy(){this.atlasTexture&&(this.atlasTexture.destroy(),this.atlasTexture=null);for(const e of Object.keys(this.images))this.removeImage(e);this.patterns={},this.atlasImage=new t.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:e,promiseResolve:t}of this.requestors)t(this._getImagesForIds(e));this.requestors=[]}}getImage(e){const r=this.images[e];if(r&&!r.data&&r.spriteData){const e=r.spriteData;r.data=new t.R({width:e.width,height:e.height},e.context.getImageData(e.x,e.y,e.width,e.height).data),r.spriteData=null}return r}addImage(e,t){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,t)&&(this.images[e]=t)}_validate(e,r){let n=!0;const i=r.data||r.spriteData;return this._validateStretch(r.stretchX,i&&i.width)||(this.fire(new t.k(new Error(`Image "${e}" has invalid "stretchX" value`))),n=!1),this._validateStretch(r.stretchY,i&&i.height)||(this.fire(new t.k(new Error(`Image "${e}" has invalid "stretchY" value`))),n=!1),this._validateContent(r.content,r)||(this.fire(new t.k(new Error(`Image "${e}" has invalid "content" value`))),n=!1),n}_validateStretch(e,t){if(!e)return!0;let r=0;for(const n of e){if(n[0]<r||n[1]<n[0]||t<n[1])return!1;r=n[1]}return!0}_validateContent(e,t){if(!e)return!0;if(4!==e.length)return!1;const r=t.spriteData,n=r&&r.width||t.data.width,i=r&&r.height||t.data.height;return!(e[0]<0||n<e[0]||e[1]<0||i<e[1]||e[2]<0||n<e[2]||e[3]<0||i<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,t,r=!0){const n=this.getImage(e);if(r&&(n.data.width!==t.data.width||n.data.height!==t.data.height))throw new Error(`size mismatch between old image (${n.data.width}x${n.data.height}) and new image (${t.data.width}x${t.data.height}).`);t.version=n.version+1,this.images[e]=t,this.updatedImages[e]=!0}removeImage(e){const t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((t,r)=>{let n=!0;if(!this.isLoaded())for(const t of e)this.images[t]||(n=!1);this.isLoaded()||n?t(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:t})})}_getImagesForIds(e){const r={};for(const n of e){let e=this.getImage(n);e||(this.fire(new t.l("styleimagemissing",{id:n})),e=this.getImage(n)),e?r[n]={data:e.data.clone(),pixelRatio:e.pixelRatio,sdf:e.sdf,version:e.version,stretchX:e.stretchX,stretchY:e.stretchY,content:e.content,textFitWidth:e.textFitWidth,textFitHeight:e.textFitHeight,hasRenderCallback:Boolean(e.userImage&&e.userImage.render)}:t.w(`Image "${n}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return r}getPixelSize(){const{width:e,height:t}=this.atlasImage;return{width:e,height:t}}getPattern(e){const r=this.patterns[e],n=this.getImage(e);if(!n)return null;if(r&&r.position.version===n.version)return r.position;if(r)r.position.version=n.version;else{const r={w:n.data.width+2,h:n.data.height+2,x:0,y:0},i=new t.I(r,n);this.patterns[e]={bin:r,position:i}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const r=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.T(e,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const t in this.patterns)e.push(this.patterns[t].bin);const{w:r,h:n}=t.p(e),i=this.atlasImage;i.resize({width:r||1,height:n||1});for(const e in this.patterns){const{bin:r}=this.patterns[e],n=r.x+1,a=r.y+1,o=this.getImage(e).data,s=o.width,l=o.height;t.R.copy(o,i,{x:0,y:0},{x:n,y:a},{width:s,height:l}),t.R.copy(o,i,{x:0,y:l-1},{x:n,y:a-1},{width:s,height:1}),t.R.copy(o,i,{x:0,y:0},{x:n,y:a+l},{width:s,height:1}),t.R.copy(o,i,{x:s-1,y:0},{x:n-1,y:a},{width:1,height:l}),t.R.copy(o,i,{x:0,y:0},{x:n+s,y:a},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const r of e){if(this.callbackDispatchedThisFrame[r])continue;this.callbackDispatchedThisFrame[r]=!0;const e=this.getImage(r);e||t.w(`Image with ID: "${r}" was not found`),x(e)&&this.updateImage(r,e)}}cloneImages(){const e={};for(const t in this.images){const r=this.images[t];e[t]=Object.assign(Object.assign({},r),{data:r.data?r.data.clone():null})}return e}}const T=1e20;function S(e,t,r,n,i,a,o,s,l){for(let c=t;c<t+n;c++)P(e,r*a+c,a,i,o,s,l);for(let c=r;c<r+i;c++)P(e,c*a+t,1,n,o,s,l)}function P(e,t,r,n,i,a,o){a[0]=0,o[0]=-T,o[1]=T,i[0]=e[t];for(let s=1,l=0,c=0;s<n;s++){i[s]=e[t+s*r];const n=s*s;do{const e=a[l];c=(i[s]-i[e]+n-e*e)/(s-e)/2}while(c<=o[l]&&--l>-1);l++,a[l]=s,o[l]=c,o[l+1]=T}for(let s=0,l=0;s<n;s++){for(;o[l+1]<s;)l++;const n=a[l],c=s-n;e[t+s*r]=i[n]+c*c}}const E=t.v.layout_symbol["text-font"].default.join(",");class C{constructor(e,t,r){this.requestManager=e,this.localIdeographFontFamily=t,this.entries={},this.lang=r}setURL(e){this.url=e}getGlyphs(e){return t._(this,void 0,void 0,function*(){const t=[];for(const r in e)for(const n of e[r])t.push(this._getAndCacheGlyphsPromise(r,n));const r=yield Promise.all(t),n={};for(const{stack:e,id:t,glyph:i}of r)n[e]||(n[e]={}),n[e][t]=i&&{id:i.id,bitmap:i.bitmap.clone(),metrics:i.metrics};return n})}_getAndCacheGlyphsPromise(e,r){return t._(this,void 0,void 0,function*(){let t=this.entries[e];t||(t=this.entries[e]={glyphs:{},requests:{},ranges:{}});let n=t.glyphs[r];return void 0!==n?{stack:e,id:r,glyph:n}:!this.url||this._charUsesLocalIdeographFontFamily(r)?(n=t.glyphs[r]=this._drawGlyph(t,e,r),{stack:e,id:r,glyph:n}):yield this._downloadAndCacheRangePromise(e,r)})}_downloadAndCacheRangePromise(e,r){return t._(this,void 0,void 0,function*(){const t=this.entries[e],n=Math.floor(r/256);if(t.ranges[n])return{stack:e,id:r,glyph:null};if(!t.requests[n]){const r=C.loadGlyphRange(e,n,this.url,this.requestManager);t.requests[n]=r}try{const i=yield t.requests[n];for(const e in i)t.glyphs[+e]=i[+e];return t.ranges[n]=!0,{stack:e,id:r,glyph:i[r]||null}}catch(i){const a=t.glyphs[r]=this._drawGlyph(t,e,r);return this._warnOnMissingGlyphRange(a,n,r,i),{stack:e,id:r,glyph:a}}})}_warnOnMissingGlyphRange(e,r,n,i){const a=256*r,o=a+255,s=n.toString(16).padStart(4,"0").toUpperCase();t.w(`Unable to load glyph range ${r}, ${a}-${o}. Rendering codepoint U+${s} locally instead. ${i}`)}_charUsesLocalIdeographFontFamily(e){return!!this.localIdeographFontFamily&&t.q(e)}_drawGlyph(e,r,n){const i=r===E&&""!==this.localIdeographFontFamily&&this._charUsesLocalIdeographFontFamily(n),a=i?"ideographTinySDF":"tinySDF";e[a]||(e[a]=this._createTinySDF(i?this.localIdeographFontFamily:r));const o=e[a].draw(String.fromCodePoint(n));return{id:n,bitmap:new t.r({width:o.width||60,height:o.height||60},o.data),metrics:{width:o.glyphWidth/2||24,height:o.glyphHeight/2||24,left:o.glyphLeft/2+.5||0,top:o.glyphTop/2-27.5||-8,advance:o.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(e){const t=e?e.split(","):[];t.push("sans-serif");const r=t.map(e=>/[-\w]+/.test(e)?e:`'${CSS.escape(e)}'`).join(",");return new C.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:r,fontWeight:this._fontWeight(t[0]),fontStyle:this._fontStyle(t[0]),lang:this.lang})}_fontStyle(e){return/italic/i.test(e)?"italic":/oblique/i.test(e)?"oblique":"normal"}_fontWeight(e){const t={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let r;for(const[n,i]of Object.entries(t))new RegExp(`\\b${n}\\b`,"i").test(e)&&(r=`${i}`);return r}destroy(){for(const e in this.entries){const t=this.entries[e];t.tinySDF&&(t.tinySDF=null),t.ideographTinySDF&&(t.ideographTinySDF=null),t.glyphs={},t.requests={},t.ranges={}}this.entries={}}}C.loadGlyphRange=function(e,r,n,i){return t._(this,void 0,void 0,function*(){const a=256*r,o=a+255,s=i.transformRequest(n.replace("{fontstack}",e).replace("{range}",`${a}-${o}`),"Glyphs"),l=yield t.n(s,new AbortController);if(!l||!l.data)throw new Error(`Could not load glyph range. range: ${r}, ${a}-${o}`);const c={};for(const e of t.o(l.data))c[e.id]=e;return c})},C.TinySDF=class{constructor({fontSize:e=24,buffer:t=3,radius:r=8,cutoff:n=.25,fontFamily:i="sans-serif",fontWeight:a="normal",fontStyle:o="normal",lang:s=null}={}){this.buffer=t,this.cutoff=n,this.radius=r,this.lang=s;const l=this.size=e+4*t,c=this._createCanvas(l),u=this.ctx=c.getContext("2d",{willReadFrequently:!0});u.font=`${o} ${a} ${e}px ${i}`,u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(l*l),this.gridInner=new Float64Array(l*l),this.f=new Float64Array(l),this.z=new Float64Array(l+1),this.v=new Uint16Array(l)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:r,actualBoundingBoxDescent:n,actualBoundingBoxLeft:i,actualBoundingBoxRight:a}=this.ctx.measureText(e),o=Math.ceil(r),s=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(a-i))),l=Math.min(this.size-this.buffer,o+Math.ceil(n)),c=s+2*this.buffer,u=l+2*this.buffer,h=Math.max(c*u,0),d=new Uint8ClampedArray(h),p={data:d,width:c,height:u,glyphWidth:s,glyphHeight:l,glyphTop:o,glyphLeft:0,glyphAdvance:t};if(0===s||0===l)return p;const{ctx:f,buffer:m,gridInner:g,gridOuter:_}=this;this.lang&&(f.lang=this.lang),f.clearRect(m,m,s,l),f.fillText(e,m,m+o);const y=f.getImageData(m,m,s,l);_.fill(T,0,h),g.fill(0,0,h);for(let e=0;e<l;e++)for(let t=0;t<s;t++){const r=y.data[4*(e*s+t)+3]/255;if(0===r)continue;const n=(e+m)*c+t+m;if(1===r)_[n]=0,g[n]=T;else{const e=.5-r;_[n]=e>0?e*e:0,g[n]=e<0?e*e:0}}S(_,0,0,c,u,c,this.f,this.v,this.z),S(g,m,m,s,l,c,this.f,this.v,this.z);for(let e=0;e<h;e++){const t=Math.sqrt(_[e])-Math.sqrt(g[e]);d[e]=Math.round(255-255*(t/this.radius+this.cutoff))}return p}};class M{constructor(){this.specification=t.u.light.position}possiblyEvaluate(e,r){return t.F(e.expression.evaluate(r))}interpolate(e,r,n){return{x:t.G.number(e.x,r.x,n),y:t.G.number(e.y,r.y,n),z:t.G.number(e.z,r.z,n)}}}let k;class I extends t.E{constructor(e){super(),k=k||new t.t({anchor:new t.D(t.u.light.anchor),position:new M,color:new t.D(t.u.light.color),intensity:new t.D(t.u.light.intensity)}),this._transitionable=new t.x(k,void 0),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,r={}){if(!this._validate(t.y,e,r))for(const r in e){const n=e[r];r.endsWith(t.z)?this._transitionable.setTransition(r.slice(0,-t.z.length),n):this._transitionable.setValue(r,n)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,n){return(!n||!1!==n.validate)&&t.B(this,e.call(t.C,{value:r,style:{glyphs:!0,sprite:!0},styleSpec:t.u}))}}const A=new t.t({"sky-color":new t.D(t.u.sky["sky-color"]),"horizon-color":new t.D(t.u.sky["horizon-color"]),"fog-color":new t.D(t.u.sky["fog-color"]),"fog-ground-blend":new t.D(t.u.sky["fog-ground-blend"]),"horizon-fog-blend":new t.D(t.u.sky["horizon-fog-blend"]),"sky-horizon-blend":new t.D(t.u.sky["sky-horizon-blend"]),"atmosphere-blend":new t.D(t.u.sky["atmosphere-blend"])});class z extends t.E{constructor(e){super(),this._transitionable=new t.x(A,void 0),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new t.H(0))}setSky(e,r={}){if(!this._validate(t.J,e,r)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const r in e){const n=e[r];r.endsWith(t.z)?this._transitionable.setTransition(r.slice(0,-t.z.length),n):this._transitionable.setValue(r,n)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,n={}){return!1!==(null==n?void 0:n.validate)&&t.B(this,e.call(t.C,t.e({value:r,style:{glyphs:!0,sprite:!0},styleSpec:t.u})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class D{constructor(e,t){this.width=e,this.height=t,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,t){const r=e.join(",")+String(t);return this.dashEntry[r]||(this.dashEntry[r]=this.addDash(e,t)),this.dashEntry[r]}getDashRanges(e,t,r){const n=[];let i=e.length%2==1?-e[e.length-1]*r:0,a=e[0]*r,o=!0;n.push({left:i,right:a,isDash:o,zeroLength:0===e[0]});let s=e[0];for(let t=1;t<e.length;t++){o=!o;const l=e[t];i=s*r,s+=l,a=s*r,n.push({left:i,right:a,isDash:o,zeroLength:0===l})}return n}addRoundDash(e,t,r){const n=t/2;for(let t=-r;t<=r;t++){const i=this.width*(this.nextRow+r+t);let a=0,o=e[a];for(let s=0;s<this.width;s++){s/o.right>1&&(o=e[++a]);const l=Math.abs(s-o.left),c=Math.abs(s-o.right),u=Math.min(l,c);let h;const d=t/r*(n+1);if(o.isDash){const e=n-Math.abs(d);h=Math.sqrt(u*u+e*e)}else h=n-Math.sqrt(u*u+d*d);this.data[i+s]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(e){for(let t=e.length-1;t>=0;--t){const r=e[t],n=e[t+1];r.zeroLength?e.splice(t,1):n&&n.isDash===r.isDash&&(n.left=r.left,e.splice(t,1))}const t=e[0],r=e[e.length-1];t.isDash===r.isDash&&(t.left=r.left-this.width,r.right=t.right+this.width);const n=this.width*this.nextRow;let i=0,a=e[i];for(let t=0;t<this.width;t++){t/a.right>1&&(a=e[++i]);const r=Math.abs(t-a.left),o=Math.abs(t-a.right),s=Math.min(r,o);this.data[n+t]=Math.max(0,Math.min(255,(a.isDash?s:-s)+128))}}addDash(e,r){const n=r?7:0,i=2*n+1;if(this.nextRow+i>this.height)return t.w("LineAtlas out of space"),null;let a=0;for(let t=0;t<e.length;t++)a+=e[t];if(0!==a){const t=this.width/a,i=this.getDashRanges(e,this.width,t);r?this.addRoundDash(i,t,n):this.addRegularDash(i)}const o={y:this.nextRow+n,height:2*n,width:a};return this.nextRow+=i,this.dirty=!0,o}bind(e){const t=e.gl;this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,this.data))}}const L="maplibre_preloaded_worker_pool";class R{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<R.workerCount;)this.workers.push(new Worker(t.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach(e=>{e.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[L]}numActive(){return Object.keys(this.active).length}}const F=Math.floor(s.hardwareConcurrency/2);let B,O;function N(){return B||(B=new R),B}R.workerCount=t.K(globalThis)?Math.max(Math.min(F,3),1):1;class V{constructor(e,r){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=r;const n=this.workerPool.acquire(r);for(let e=0;e<n.length;e++){const i=new t.L(n[e],r);i.name=`Worker ${e}`,this.actors.push(i)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,t){const r=[];for(const n of this.actors)r.push(n.sendAsync({type:e,data:t}));return Promise.all(r)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(e=>{e.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,t){for(const r of this.actors)r.registerMessageHandler(e,t)}unregisterMessageHandler(e){for(const t of this.actors)t.unregisterMessageHandler(e)}}function j(){return O||(O=new V(N(),t.M),O.registerMessageHandler("GR",(e,r,n)=>t.m(r,n))),O}function U(e,r){const n=t.N();return t.O(n,n,[1,1,0]),t.Q(n,n,[.5*e.width,.5*e.height,1]),e.calculatePosMatrix?t.S(n,n,e.calculatePosMatrix(r.toUnwrapped())):n}function G(e,t,r,n,i,a,o){var s;const l=function(e,t,r){if(e)for(const n of e){const e=t[n];if(e&&e.source===r&&"fill-extrusion"===e.type)return!0}else for(const e in t){const n=t[e];if(n.source===r&&"fill-extrusion"===n.type)return!0}return!1}(null!==(s=null==i?void 0:i.layers)&&void 0!==s?s:null,t,e.id),c=a.maxPitchScaleFactor(),u=e.tilesIn(n,c,l);u.sort(q);const h=[];for(const n of u)h.push({wrappedTileID:n.tileID.wrapped().key,queryResults:n.tile.queryRenderedFeatures(t,r,e.getState(),n.queryGeometry,n.cameraQueryGeometry,n.scale,i,a,c,U(a,n.tileID),o?(e,t)=>o(n.tileID,e,t):void 0)});return function(e,t){for(const r in e)for(const n of e[r])$(n,t);return e}(function(e){const t={},r={};for(const n of e){const e=n.queryResults,i=n.wrappedTileID,a=r[i]=r[i]||{};for(const r in e){const n=e[r],i=a[r]=a[r]||{},o=t[r]=t[r]||[];for(const e of n)i[e.featureIndex]||(i[e.featureIndex]=!0,o.push(e))}}return t}(h),e)}function q(e,t){const r=e.tileID,n=t.tileID;return r.overscaledZ-n.overscaledZ||r.canonical.y-n.canonical.y||r.wrap-n.wrap||r.canonical.x-n.canonical.x}function $(e,t){const r=e.feature,n=t.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=n}function Z(e,r,n){return t._(this,void 0,void 0,function*(){let i=e;if(e.url?i=(yield t.j(r.transformRequest(e.url,"Source"),n)).data:yield s.frameAsync(n),!i)return null;const a=t.U(t.e(i,e),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in i&&i.vector_layers&&(a.vectorLayerIds=i.vector_layers.map(e=>e.id)),a})}class H{constructor(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):Array.isArray(e)&&(4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof t.V?new t.V(e.lng,e.lat):t.V.convert(e),this}setSouthWest(e){return this._sw=e instanceof t.V?new t.V(e.lng,e.lat):t.V.convert(e),this}extend(e){const r=this._sw,n=this._ne;let i,a;if(e instanceof t.V)i=e,a=e;else{if(!(e instanceof H))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(H.convert(e)):this.extend(t.V.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(t.V.convert(e)):this;if(i=e._sw,a=e._ne,!i||!a)return this}return r||n?(r.lng=Math.min(i.lng,r.lng),r.lat=Math.min(i.lat,r.lat),n.lng=Math.max(a.lng,n.lng),n.lat=Math.max(a.lat,n.lat)):(this._sw=new t.V(i.lng,i.lat),this._ne=new t.V(a.lng,a.lat)),this}getCenter(){return new t.V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new t.V(this.getWest(),this.getNorth())}getSouthEast(){return new t.V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:n}=t.V.convert(e);let i=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(i=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&i}intersects(e){if((e=H.convert(e)).getNorth()<this.getSouth()||e.getSouth()>this.getNorth())return!1;const r=t.W(this.getWest(),-180,180),n=t.W(this.getEast(),-180,180),i=t.W(e.getWest(),-180,180),a=t.W(e.getEast(),-180,180),o=r>n,s=i>a;return!(!o||!s)||(o?a>=r||i<=n:s?n>=i||r<=a:!(i>n||a<r))}static convert(e){return e instanceof H?e:e?new H(e):e}static fromLngLat(e,r=0){const n=360*r/40075017,i=n/Math.cos(Math.PI/180*e.lat);return new H(new t.V(e.lng-i,e.lat-n),new t.V(e.lng+i,e.lat+n))}adjustAntiMeridian(){const e=new t.V(this._sw.lng,this._sw.lat),r=new t.V(this._ne.lng,this._ne.lat);return new H(e,e.lng>r.lng?new t.V(r.lng+360,r.lat):r)}}class W{constructor(e,t,r){this.bounds=H.convert(this.validateBounds(e)),this.minzoom=t||0,this.maxzoom=r||24}validateBounds(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const r=Math.pow(2,e.z),n=Math.floor(t.Y(this.bounds.getWest())*r),i=Math.floor(t.X(this.bounds.getNorth())*r),a=Math.ceil(t.Y(this.bounds.getEast())*r),o=Math.ceil(t.X(this.bounds.getSouth())*r);return e.x>=n&&e.x<a&&e.y>=i&&e.y<o}}class X extends t.E{constructor(e,r,n,i){if(super(),this.id=e,this.dispatcher=n,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.e(this,t.U(r,["url","scheme","tileSize","promoteId","encoding"])),this._options=t.e({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(i)}load(){return t._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new t.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield Z(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),e&&(t.e(this,e),e.bounds&&(this.tileBounds=new W(e.bounds,this.minzoom,this.maxzoom)),this.fire(new t.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this._loaded=!0,this.fire(new t.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return t.e({},this._options)}loadTile(e){return t._(this,void 0,void 0,function*(){const t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r={request:this.map._requestManager.transformRequest(t,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,encoding:this.encoding,overzoomParameters:this._getOverzoomParameters(e)};r.request.collectResourceTiming=this._collectResourceTiming;let n="RT";if(e.actor&&"expired"!==e.state){if("loading"===e.state)return new Promise((t,r)=>{e.reloadPromise={resolve:t,reject:r}})}else e.actor=this.dispatcher.getActor(),n="LT";e.abortController=new AbortController;try{const t=yield e.actor.sendAsync({type:n,data:r},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,t)}catch(t){if(delete e.abortController,e.aborted)return;if(t&&404!==t.status)throw t;this._afterTileLoadWorkerResponse(e,null)}})}_getOverzoomParameters(e){if(e.tileID.canonical.z<=this.maxzoom)return;if(void 0===this.map._zoomLevelsToOverscale)return;const t=e.tileID.scaledTo(this.maxzoom).canonical,r=t.url(this.tiles,this.map.getPixelRatio(),this.scheme);return{maxZoomTileID:t,overzoomRequest:this.map._requestManager.transformRequest(r,"Tile")}}_afterTileLoadWorkerResponse(e,t){if(t&&t.resourceTiming&&(e.resourceTiming=t.resourceTiming),t&&this.map._refreshExpiredTiles&&e.setExpiryData(t),e.loadVectorData(t,this.map.painter),e.reloadPromise){const t=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(t.resolve).catch(t.reject)}}abortTile(e){return t._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return t._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Y extends t.E{constructor(e,r,n,i){super(),this.id=e,this.dispatcher=n,this.setEventedParent(i),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.e({type:"raster"},r),t.e(this,t.U(r,["url","scheme","tileSize"]))}load(){return t._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new t.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield Z(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,r&&(t.e(this,r),r.bounds&&(this.tileBounds=new W(r.bounds,this.minzoom,this.maxzoom)),this.fire(new t.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(e){this._tileJSONRequest=null,this._loaded=!0,this.fire(new t.k(e))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return t.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return t._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const n=yield _.getImage(this.map._requestManager.transformRequest(r,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(n&&n.data){this.map._refreshExpiredTiles&&(n.cacheControl||n.expires)&&e.setExpiryData({cacheControl:n.cacheControl,expires:n.expires});const r=this.map.painter.context,i=r.gl,a=n.data;e.texture=this.map.painter.getTileTexture(a.width),e.texture?e.texture.update(a,{useMipmap:!0}):(e.texture=new t.T(r,a,i.RGBA,{useMipmap:!0}),e.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE,i.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(t){if(delete e.abortController,e.aborted)e.state="unloaded";else if(t)throw e.state="errored",t}})}abortTile(e){return t._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return t._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class K extends Y{constructor(e,r,n,i){super(e,r,n,i),this.type="raster-dem",this.maxzoom=22,this._options=t.e({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox",this.redFactor=r.redFactor,this.greenFactor=r.greenFactor,this.blueFactor=r.blueFactor,this.baseShift=r.baseShift}loadTile(e){return t._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),n=this.map._requestManager.transformRequest(r,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const r=yield _.getImage(n,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(r&&r.data){const n=r.data;this.map._refreshExpiredTiles&&(r.cacheControl||r.expires)&&e.setExpiryData({cacheControl:r.cacheControl,expires:r.expires});const i=t.b(n)&&t.Z()?n:yield this.readImageNow(n),a={type:this.type,uid:e.uid,source:this.id,rawImageData:i,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||"expired"===e.state){e.actor=this.dispatcher.getActor();const t=yield e.actor.sendAsync({type:"LDT",data:a});e.dem=t,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(t){if(delete e.abortController,e.aborted)e.state="unloaded";else if(t)throw e.state="errored",t}})}readImageNow(e){return t._(this,void 0,void 0,function*(){if("undefined"!=typeof VideoFrame&&t.$()){const r=e.width+2,n=e.height+2;try{return new t.R({width:r,height:n},yield t.a0(e,-1,-1,r,n))}catch(e){}}return s.getImageData(e,1)})}_getNeighboringTiles(e){const r=e.canonical,n=Math.pow(2,r.z),i=(r.x-1+n)%n,a=0===r.x?e.wrap-1:e.wrap,o=(r.x+1+n)%n,s=r.x+1===n?e.wrap+1:e.wrap,l={};return l[new t.a1(e.overscaledZ,a,r.z,i,r.y).key]={backfilled:!1},l[new t.a1(e.overscaledZ,s,r.z,o,r.y).key]={backfilled:!1},r.y>0&&(l[new t.a1(e.overscaledZ,a,r.z,i,r.y-1).key]={backfilled:!1},l[new t.a1(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},l[new t.a1(e.overscaledZ,s,r.z,o,r.y-1).key]={backfilled:!1}),r.y+1<n&&(l[new t.a1(e.overscaledZ,a,r.z,i,r.y+1).key]={backfilled:!1},l[new t.a1(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},l[new t.a1(e.overscaledZ,s,r.z,o,r.y+1).key]={backfilled:!1}),l}unloadTile(e){return t._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}function Q(e){return"GeometryCollection"===e.type?e.geometries.map(e=>e.coordinates).flat(1/0):e.coordinates.flat(1/0)}function J(e){const t=new H;let r;switch(e.type){case"FeatureCollection":r=e.features.map(e=>Q(e.geometry)).flat(1/0);break;case"Feature":r=Q(e.geometry);break;default:r=Q(e)}if(0==r.length)return t;for(let e=0;e<r.length-1;e+=2)t.extend([r[e],r[e+1]]);return t}class ee extends t.E{constructor(e,r,n,i){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:r.data},this.actor=n.getActor(),this.setEventedParent(i),this._data="string"==typeof r.data?{url:r.data}:{geojson:r.data},this._options=t.e({},r),this._collectResourceTiming=r.collectResourceTiming,void 0!==r.maxzoom&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId,void 0!==r.clusterMaxZoom&&this.maxzoom<=r.clusterMaxZoom&&t.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${r.clusterMaxZoom}".`),this.workerOptions=t.e({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(void 0!==r.buffer?r.buffer:128),tolerance:this._pixelsToTileUnits(void 0!==r.tolerance?r.tolerance:.375),extent:t.a4,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(r.clusterMaxZoom),minPoints:Math.max(2,r.clusterMinPoints||2),extent:t.a4,radius:this._pixelsToTileUnits(r.clusterRadius||50),log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return void 0!==this._pendingWorkerUpdate.data||void 0!==this._pendingWorkerUpdate.diff||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(e){return e*(t.a4/this.tileSize)}_getClusterMaxZoom(e){const r=e?Math.round(e):this.maxzoom-1;return Number.isInteger(e)||void 0===e||t.w(`Integer expected for option 'clusterMaxZoom': provided value "${e}" rounded to "${r}"`),r}load(){return t._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e,t){this._data="string"==typeof e?{url:e}:{geojson:e},this._pendingWorkerUpdate={data:e};const r=this._updateWorkerData();return t?r:this}updateData(e,r){this._pendingWorkerUpdate.diff=t.a5(this._pendingWorkerUpdate.diff,e);const n=this._updateWorkerData();return r?n:this}getData(){return t._(this,void 0,void 0,function*(){const e=t.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}getBounds(){return t._(this,void 0,void 0,function*(){return J(yield this.getData())})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,void 0!==e.clusterRadius&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),void 0!==e.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(e.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,t,r){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:t,offset:r}})}_updateWorkerData(){return t._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void t.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:e,diff:r}=this._pendingWorkerUpdate,n=t.e({type:this.type},this.workerOptions);e?("string"==typeof e?(n.request=this.map._requestManager.transformRequest(s.resolveURL(e),"Source"),n.request.collectResourceTiming=this._collectResourceTiming):n.data=e,this._pendingWorkerUpdate.data=void 0):r&&(n.dataDiff=r,this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,this._isUpdatingWorker=!0,this.fire(new t.l("dataloading",{dataType:"source"}));try{const e=yield this.actor.sendAsync({type:"LD",data:n});if(this._isUpdatingWorker=!1,this._removed||e.abandoned)return void this.fire(new t.l("dataabort",{dataType:"source"}));e.applyDiff?this._applyDiff(r):this._data={geojson:e.data};let i=null;e.resourceTiming&&e.resourceTiming[this.id]&&(i=e.resourceTiming[this.id].slice(0));const a={dataType:"source"};this._collectResourceTiming&&i&&i.length>0&&t.e(a,{resourceTiming:i}),this.fire(new t.l("data",Object.assign(Object.assign({},a),{sourceDataType:"metadata"}))),this.fire(new t.l("data",Object.assign(Object.assign({},a),{sourceDataType:"content",shouldReloadTileOptions:this._getShouldReloadTileOptions(r)})))}catch(e){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new t.l("dataabort",{dataType:"source"}));this.fire(new t.k(e))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}})}_applyDiff(e){const r="string"==typeof this.promoteId?this.promoteId:void 0;this._data.url||this._data.updateable||!t.a6(this._data.geojson,r)||(this._data={updateable:t.a7(this._data.geojson,r)}),e&&this._data.updateable?t.a8(this._data.updateable,e,r):t.w("Cannot apply GeoJSONSource#updateData due to internal error")}_getShouldReloadTileOptions(e){if(this._options.cluster||!e||e.removeAll)return;const{add:r=[],update:n=[],remove:i=[]}=e||{},a=new Set([...n.map(e=>e.id),...i]);for(const e of a.values())if("number"!=typeof e&&null==this.promoteId)return void t.w(`GeoJSONSource "${this.id}": updateData is slower when using string GeoJSON feature IDs (e.g. "${e}"). Consider using promoteId or numeric IDs for better performance.`);return{nextBounds:[...n.map(e=>e.newGeometry),...r.map(e=>e.geometry)].filter(Boolean).map(e=>J(e)),prevIds:a}}shouldReloadTile(e,{nextBounds:r,prevIds:n}){if(!e.latestFeatureIndex)return"unloaded"!==e.state;const i=e.latestFeatureIndex.loadVTLayers();for(let r=0;r<e.latestFeatureIndex.featureIndexArray.length;r++){const a=e.latestFeatureIndex.featureIndexArray.get(r),o=i[t.a9].feature(a.featureIndex),s=e.latestFeatureIndex.getId(o,t.a9);if(n.has(s))return!0}const{buffer:a,extent:o}=this.workerOptions.geojsonVtOptions,s=function({x:e,y:r,z:n},i=0){const a=t.a2((e-i)/Math.pow(2,n)),o=t.a3((r+1+i)/Math.pow(2,n)),s=t.a2((e+1+i)/Math.pow(2,n)),l=t.a3((r-i)/Math.pow(2,n));return new H([a,o],[s,l])}(e.tileID.canonical,a/o);for(const e of r)if(s.intersects(e))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(e){return t._(this,void 0,void 0,function*(){const t=e.actor?"RT":"LT";e.actor=this.actor;const r={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const n=yield this.actor.sendAsync({type:t,data:r},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(n,this.map.painter,"RT"===t)})}abortTile(e){return t._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return t._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return t.e({},this._options,{type:this.type,data:this._data.updateable?{type:"FeatureCollection",features:Array.from(this._data.updateable.values())}:this._data.url||this._data.geojson})}hasTransition(){return!1}}class te extends t.E{constructor(e,t,r,n){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=r,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(n),this.options=t}load(e){return t._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new t.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const t=yield _.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,t&&t.data&&(this.image=t.data,e&&(this.coordinates=e),this._finishLoading())}catch(e){this._request=null,this._loaded=!0,this.fire(new t.k(e))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const r=e.map(t.aa.fromLngLat);var n;return this.tileID=function(e){const r=t.ab.fromPoints(e),n=r.width(),i=r.height(),a=Math.max(n,i),o=Math.max(0,Math.floor(-Math.log(a)/Math.LN2)),s=Math.pow(2,o);return new t.ad(o,Math.floor((r.minX+r.maxX)/2*s),Math.floor((r.minY+r.maxY)/2*s))}(r),this.terrainTileRanges=this._getOverlappingTileRanges(r),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=r.map(e=>this.tileID.getTilePoint(e)._round()),this.flippedWindingOrder=((n=this.tileCoords)[1].x-n[0].x)*(n[2].y-n[0].y)-(n[1].y-n[0].y)*(n[2].x-n[0].x)<0,this.fire(new t.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const e=this.map.painter.context,r=e.gl;this.texture||(this.texture=new t.T(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let n=!1;for(const e in this.tiles){const t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture,n=!0)}n&&this.fire(new t.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return t._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){const{minX:r,minY:n,maxX:i,maxY:a}=t.ab.fromPoints(e),o={};for(let e=0;e<=t.ac;e++){const t=Math.pow(2,e),s=Math.floor(r*t),l=Math.floor(n*t),c=Math.floor(i*t),u=Math.floor(a*t);o[e]={minTileX:s,minTileY:l,maxTileX:c,maxTileY:u}}return o}}class re extends te{constructor(e,t,r,n){super(e,t,r,n),this.roundZoom=!0,this.type="video",this.options=t}load(){return t._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const t of e.urls)this.urls.push(this.map._requestManager.transformRequest(t,"Source").url);try{const e=yield t.ae(this.urls);if(this._loaded=!0,!e)return;this.video=e,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(e){this.fire(new t.k(e))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const r=this.video.seekable;e<r.start(0)||e>r.end(0)?this.fire(new t.k(new t.af(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const e=this.map.painter.context,r=e.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new t.T(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let n=!1;for(const e in this.tiles){const t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture,n=!0)}n&&this.fire(new t.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ne extends te{constructor(e,r,n,i){super(e,r,n,i),r.coordinates?Array.isArray(r.coordinates)&&4===r.coordinates.length&&!r.coordinates.some(e=>!Array.isArray(e)||2!==e.length||e.some(e=>"number"!=typeof e))||this.fire(new t.k(new t.af(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.k(new t.af(`sources.${e}`,null,'missing required property "coordinates"'))),r.animate&&"boolean"!=typeof r.animate&&this.fire(new t.k(new t.af(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),r.canvas?"string"==typeof r.canvas||r.canvas instanceof HTMLCanvasElement||this.fire(new t.k(new t.af(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.k(new t.af(`sources.${e}`,null,'missing required property "canvas"'))),this.options=r,this.animate=void 0===r.animate||r.animate}load(){return t._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const r=this.map.painter.context,n=r.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.T(r,this.canvas,n.RGBA,{premultiply:!0});let i=!1;for(const e in this.tiles){const t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture,i=!0)}i&&this.fire(new t.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",animate:this.animate,canvas:this.options.canvas,coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const ie={},ae=e=>{switch(e){case"geojson":return ee;case"image":return te;case"raster":return Y;case"raster-dem":return K;case"vector":return X;case"video":return re;case"canvas":return ne}return ie[e]},oe="RTLPluginLoaded";class se extends t.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=j()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(e=>{throw this.status="error",e})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return t._(this,arguments,void 0,function*(e,t=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=s.resolveURL(e),!this.url)throw new Error(`requested url ${e} is invalid`);if("unavailable"===this.status){if(!t)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if("requested"===this.status)return this._requestImport()})}_requestImport(){return t._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new t.l(oe))})}lazyLoad(){"unavailable"===this.status?this.status="requested":"deferred"===this.status&&this._requestImport()}}let le=null;function ce(){return le||(le=new se),le}var ue,he;!function(e){e[e.Base=0]="Base",e[e.Parent=1]="Parent"}(ue||(ue={})),function(e){e[e.Departing=0]="Departing",e[e.Incoming=1]="Incoming"}(he||(he={}));class de{constructor(e,r){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=e,this.uid=t.ag(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(e){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(e||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:e,fadingDirection:t,fadingParentID:r,fadeEndTime:n}){this.resetFadeLogic(),this.fadingRole=e,this.fadingDirection=t,this.fadingParentID=r,this.fadeEndTime=n}setSelfFadeLogic(e){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=e}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=c(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,r,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData,this.latestFeatureIndex.encoding=e.encoding):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData,this.latestFeatureIndex.encoding=this.latestEncoding)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(e,t){const r={};if(!t)return r;for(const n of e){const e=n.layerIds.map(e=>t.getLayer(e)).filter(Boolean);if(0!==e.length){n.layers=e,n.stateDependentLayerIds&&(n.stateDependentLayers=n.stateDependentLayerIds.map(t=>e.filter(e=>e.id===t)[0]));for(const t of e)r[t.id]=n}}return r}(e.buckets,null==r?void 0:r.style),this.hasSymbolBuckets=!1;for(const e in this.buckets){const r=this.buckets[e];if(r instanceof t.ai){if(this.hasSymbolBuckets=!0,!n)break;r.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const e in this.buckets){const r=this.buckets[e];if(r instanceof t.ai&&r.hasRTLText){this.hasRTLText=!0,ce().lazyLoad();break}}this.queryPadding=0;for(const e in this.buckets){const t=this.buckets[e];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(e).queryRadius(t))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),this.dashPositions=e.dashPositions}else this.collisionBoxArray=new t.ah}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const t in this.buckets){const r=this.buckets[t];r.uploadPending()&&r.upload(e)}const r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new t.T(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new t.T(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,t,r,n,i,a,o,s,l,c,u){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:n,cameraQueryGeometry:i,scale:a,tileSize:this.tileSize,pixelPosMatrix:c,transform:s,params:o,queryPadding:this.queryPadding*l,getElevation:u},e,t,r):{}}querySourceFeatures(e,r){const n=this.latestFeatureIndex;if(!n||!n.rawTileData)return;const i=n.loadVTLayers(),a=r&&r.sourceLayer?r.sourceLayer:"",o=i[t.a9]||i[a];if(!o)return;const s=t.aj(null==r?void 0:r.filter,null==r?void 0:r.globalState),{z:l,x:c,y:u}=this.tileID.canonical,h={z:l,x:c,y:u};for(let r=0;r<o.length;r++){const i=o.feature(r);if(s.needGeometry){const e=t.ak(i,!0);if(!s.filter(new t.H(this.tileID.overscaledZ),e,this.tileID.canonical))continue}else if(!s.filter(new t.H(this.tileID.overscaledZ),i))continue;const d=n.getId(i,a),p=new t.al(i,l,c,u,d);p.tile=h,e.push(p)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const r=this.expirationTime;if(e.cacheControl){const r=t.am(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const e=Date.now();let t=!1;if(this.expirationTime>e)t=!1;else if(r)if(this.expirationTime<r)t=!0;else{const n=this.expirationTime-r;n?this.expirationTime=e+Math.max(n,3e4):t=!0}else t=!0;t?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length)return;const n=this.latestFeatureIndex.loadVTLayers();for(const i in this.buckets){if(!r.style.hasLayer(i))continue;const a=this.buckets[i],o=a.layers[0].sourceLayer||t.a9,s=n[o],l=e[o];if(!s||!l||0===Object.keys(l).length)continue;a.update(l,s,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const c=r&&r.style&&r.style.getLayer(i);c&&(this.queryPadding=Math.max(this.queryPadding,c.queryRadius(a)))}}holdingForSymbolFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<c()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(e){this.symbolFadeHoldUntil=c()+e}setDependencies(e,t){const r={};for(const e of t)r[e]=!0;this.dependencies[e]=r}hasDependency(e,t){for(const r of e){const e=this.dependencies[r];if(e)for(const r of t)if(e[r])return!0}return!1}}class pe{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,n){const i=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][i]=this.stateChanges[e][i]||{},t.e(this.stateChanges[e][i],n),null===this.deletedStates[e]){this.deletedStates[e]={};for(const t in this.state[e])t!==i&&(this.deletedStates[e][t]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][i]){this.deletedStates[e][i]={};for(const t in this.state[e][i])n[t]||(this.deletedStates[e][i][t]=null)}else for(const t in n)this.deletedStates[e]&&this.deletedStates[e][i]&&null===this.deletedStates[e][i][t]&&delete this.deletedStates[e][i][t]}removeFeatureState(e,t,r){if(null===this.deletedStates[e])return;const n=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&void 0!==t)null!==this.deletedStates[e][n]&&(this.deletedStates[e][n]=this.deletedStates[e][n]||{},this.deletedStates[e][n][r]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][n])for(r in this.deletedStates[e][n]={},this.stateChanges[e][n])this.deletedStates[e][n][r]=null;else this.deletedStates[e][n]=null;else this.deletedStates[e]=null}getState(e,r){const n=String(r),i=t.e({},(this.state[e]||{})[n],(this.stateChanges[e]||{})[n]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const t=this.deletedStates[e][r];if(null===t)return{};for(const e in t)delete i[e]}return i}initializeTileState(e,t){e.setFeatureState(this.state,t)}coalesceChanges(e,r){const n={};for(const e in this.stateChanges){this.state[e]=this.state[e]||{};const r={};for(const n in this.stateChanges[e])this.state[e][n]||(this.state[e][n]={}),t.e(this.state[e][n],this.stateChanges[e][n]),r[n]=this.state[e][n];n[e]=r}for(const e in this.deletedStates){this.state[e]=this.state[e]||{};const r={};if(null===this.deletedStates[e])for(const t in this.state[e])r[t]={},this.state[e][t]={};else for(const t in this.deletedStates[e]){if(null===this.deletedStates[e][t])this.state[e][t]={};else for(const r of Object.keys(this.deletedStates[e][t]))delete this.state[e][t][r];r[t]=this.state[e][t]}n[e]=n[e]||{},t.e(n[e],r)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length)for(const t in e)e[t].setFeatureState(n,r)}}const fe=89.25;function me(e,r){const n=t.an(r.lat,-t.ao,t.ao);return new t.P(t.Y(r.lng)*e,t.X(n)*e)}function ge(e,r){return new t.aa(r.x/e,r.y/e).toLngLat()}function _e(e){return e.cameraToCenterDistance*Math.min(.85*Math.tan(t.ap(90-e.pitch)),Math.tan(t.ap(fe-e.pitch)))}function ye(e,r){const n=e.canonical,i=r/t.aq(n.z),a=n.x+Math.pow(2,n.z)*e.wrap,o=t.ar(new Float64Array(16));return t.O(o,o,[a*i,n.y*i,0]),t.Q(o,o,[i/t.a4,i/t.a4,1]),o}function ve(e,r,n,i,a){const o=t.aa.fromLngLat(e,r),s=a*t.as(1,e.lat),l=s*Math.cos(t.ap(n)),c=Math.sqrt(s*s-l*l),u=c*Math.sin(t.ap(-i)),h=c*Math.cos(t.ap(-i));return new t.aa(o.x+u,o.y+h,o.z+l)}function be(e,t,r){const n=t.intersectsFrustum(e);if(!r||0===n)return n;const i=t.intersectsPlane(r);return 0===i?0:2===n&&2===i?2:1}function xe(e,t,r){let n=0;const i=(r-t)/10;for(let a=0;a<10;a++)n+=i*Math.pow(Math.cos(t+(a+.5)/10*(r-t)),e);return n}function we(e,r){return function(n,i,a,o,s){const l=2*((e-1)/t.at(Math.cos(t.ap(fe-s))/Math.cos(t.ap(fe)))-1),c=Math.acos(a/o),u=2*xe(l-1,0,t.ap(s/2)),h=Math.min(t.ap(fe),c+t.ap(s/2)),d=xe(l-1,Math.min(h,c-t.ap(s/2)),h),p=Math.atan(i/a),f=Math.hypot(i,a);let m=n;return m+=t.at(o/f/Math.max(.5,Math.cos(t.ap(s/2)))),m+=l*t.at(Math.cos(p))/2,m-=t.at(Math.max(1,d/u/r))/2,m}}const Te=we(9.314,3);function Se(e,r){const n=(r.roundZoom?Math.round:Math.floor)(e.zoom+t.at(e.tileSize/r.tileSize));return Math.max(0,n)}function Pe(e,r){const n=e.getCameraFrustum(),i=e.getClippingPlane(),a=e.screenPointToMercatorCoordinate(e.getCameraPoint()),o=t.aa.fromLngLat(e.center,e.elevation);a.z=o.z+Math.cos(e.pitchInRadians)*e.cameraToCenterDistance/e.worldSize;const s=e.getCoveringTilesDetailsProvider(),l=s.allowVariableZoom(e,r),c=Se(e,r),u=r.minzoom||0,h=void 0!==r.maxzoom?r.maxzoom:e.maxZoom,d=Math.min(Math.max(0,c),h),p=Math.pow(2,d),f=[p*a.x,p*a.y,0],m=[p*o.x,p*o.y,0],g=Math.hypot(o.x-a.x,o.y-a.y),_=Math.abs(o.z-a.z),y=Math.hypot(g,_),v=e=>({zoom:0,x:0,y:0,wrap:e,fullyVisible:!1}),b=[],x=[];if(e.renderWorldCopies&&s.allowWorldCopies())for(let e=1;e<=3;e++)b.push(v(-e)),b.push(v(e));for(b.push(v(0));b.length>0;){const p=b.pop(),g=p.x,v=p.y;let w=p.fullyVisible;const T={x:g,y:v,z:p.zoom},S=s.getTileBoundingVolume(T,p.wrap,e.elevation,r);if(!w){const e=be(n,S,i);if(0===e)continue;w=2===e}const P=s.distanceToTile2d(a.x,a.y,T,S);let E=c;l&&(E=(r.calculateTileZoom||Te)(e.zoom+t.at(e.tileSize/r.tileSize),P,_,y,e.fov)),E=(r.roundZoom?Math.round:Math.floor)(E),E=Math.max(0,E);const C=Math.min(E,h);if(p.wrap=s.getWrap(o,T,p.wrap),p.zoom>=C){if(p.zoom<u)continue;const e=d-p.zoom,n=f[0]-.5-(g<<e),i=f[1]-.5-(v<<e),a=r.reparseOverscaled?Math.max(p.zoom,E):p.zoom;x.push({tileID:new t.a1(p.zoom===h?a:p.zoom,p.wrap,p.zoom,g,v),distanceSq:t.au([m[0]-.5-g,m[1]-.5-v]),tileDistanceToCamera:Math.sqrt(n*n+i*i)})}else for(let e=0;e<4;e++)b.push({zoom:p.zoom+1,x:(g<<1)+e%2,y:(v<<1)+(e>>1),wrap:p.wrap,fullyVisible:w})}return x.sort((e,t)=>e.distanceSq-t.distanceSq).map(e=>e.tileID)}const Ee=t.ab.fromPoints([new t.P(0,0),new t.P(t.a4,t.a4)]);class Ce extends t.E{constructor(e,r,n){super(),this.id=e,this.dispatcher=n,this.on("data",e=>this._dataHandler(e)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((e,t,r,n)=>{const i=new(ae(t.type))(e,t,r,n);if(i.id!==e)throw new Error(`Expected Source id to be ${e} instead of ${i.id}`);return i})(e,r,n,this),this._tiles={},this._cache=new t.av(0,e=>this._unloadTile(e)),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new pe,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,r,n){return t._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,r,n)}catch(r){e.state="errored",404!==r.status?this._source.fire(new t.k(r,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new t.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const t in this._tiles){const r=this._tiles[t];r.upload(e),r.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(Me).map(e=>e.key)}getRenderableIds(e){const r=[];for(const t in this._tiles)this._isIdRenderable(t,e)&&r.push(this._tiles[t]);return e?r.sort((e,r)=>{const n=e.tileID,i=r.tileID,a=new t.P(n.canonical.x,n.canonical.y)._rotate(-this.transform.bearingInRadians),o=new t.P(i.canonical.x,i.canonical.y)._rotate(-this.transform.bearingInRadians);return n.overscaledZ-i.overscaledZ||o.y-a.y||o.x-a.x}).map(e=>e.tileID.key):r.map(e=>e.tileID).sort(Me).map(e=>e.key)}hasRenderableParent(e){const t=e.overscaledZ-1;if(t>=this._source.minzoom){const r=this.getLoadedTile(e.scaledTo(t));if(r)return this._isIdRenderable(r.tileID.key)}return!1}_isIdRenderable(e,t=!1){var r;return null===(r=this._tiles[e])||void 0===r?void 0:r.isRenderable(t)}reload(e,t=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)t&&this._source.shouldReloadTile&&!this._source.shouldReloadTile(this._tiles[r],t)||(e?this._reloadTile(r,"expired"):"errored"!==this._tiles[r].state&&this._reloadTile(r,"reloading"))}}_reloadTile(e,r){return t._(this,void 0,void 0,function*(){const t=this._tiles[e];t&&("loading"!==t.state&&(t.state=r),yield this._loadTile(t,e,r))})}_tileLoaded(e,r,n){e.timeAdded=c(),e.selfFading&&(e.fadeEndTime=e.timeAdded+this._rasterFadeDuration),"expired"===n&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new t.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const t=this.getRenderableIds();for(let n=0;n<t.length;n++){const i=t[n];if(e.neighboringTiles&&e.neighboringTiles[i]){const t=this.getTileByID(i);r(e,t),r(t,e)}}function r(e,t){e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0;let r=t.tileID.canonical.x-e.tileID.canonical.x;const n=t.tileID.canonical.y-e.tileID.canonical.y,i=Math.pow(2,e.tileID.canonical.z),a=t.tileID.key;0===r&&0===n||Math.abs(n)>1||(Math.abs(r)>1&&(1===Math.abs(r+i)?r+=i:1===Math.abs(r-i)&&(r-=i)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,r,n),e.neighboringTiles&&e.neighboringTiles[a]&&(e.neighboringTiles[a].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,t){const r=this._getLoadedDescendents(t),n=new Set;for(const i of t){const t=r[i.key];if(!(null==t?void 0:t.length)){n.add(i);continue}const a=i.overscaledZ+Ce.maxOverzooming,o=t.filter(e=>e.tileID.overscaledZ<=a);if(!o.length){n.add(i);continue}const s=Math.min(...o.map(e=>e.tileID.overscaledZ)),l=o.filter(e=>e.tileID.overscaledZ===s).map(e=>e.tileID);for(const t of l)e[t.key]=t;this._areDescendentsComplete(l,s,i.overscaledZ)||n.add(i)}return n}_getLoadedDescendents(e){var t;const r={};for(const n in this._tiles){const i=this._tiles[n];if(i.hasData())for(const n of e)i.tileID.isChildOf(n)&&(r[t=n.key]||(r[t]=[])).push(i)}return r}_areDescendentsComplete(e,t,r){return 1===e.length&&e[0].isOverscaled()?e[0].overscaledZ===t:Math.pow(4,t-r)===e.length}getLoadedTile(e){const t=this._tiles[e.key];return(null==t?void 0:t.hasData())?t:null}updateCacheSize(e){const r=Math.ceil(e.width/this._source.tileSize)+1,n=Math.ceil(e.height/this._source.tileSize)+1,i=Math.floor(r*n*(null===this._maxTileCacheZoomLevels?t.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),a="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,i):i;this._cache.setMaxSize(a)}handleWrapJump(e){const t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){const e={};for(const r in this._tiles){const n=this._tiles[r];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+t),e[n.tileID.key]=n}this._tiles=e,this._resetTileReloadTimers()}}update(e,r){if(!this._sourceLoaded||this._paused)return;let n;this.transform=e,this.terrain=r,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?n=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(e=>new t.a1(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)):(n=Pe(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:"vector"===this._source.type&&void 0!==this.map._zoomLevelsToOverscale?e.maxZoom-this.map._zoomLevelsToOverscale:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:r,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(n=n.filter(e=>this._source.hasTile(e)))):n=[],this.usedForTerrain&&(n=this._addTerrainIdealTiles(n));const i=0===n.length&&!this._updated&&this._didEmitContent;this._updated=!0,i&&this.fire(new t.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const a=Se(e,this._source),o=this._updateRetainedTiles(n,a),s=ke(this._source.type);s&&this._rasterFadeDuration>0&&!r&&this._updateFadingTiles(n,o),s?this._cleanUpRasterTiles(o):this._cleanUpVectorTiles(o)}_cleanUpRasterTiles(e){for(const t in this._tiles)e[t]||this._removeTile(t)}_cleanUpVectorTiles(e){for(const t in this._tiles){const r=this._tiles[t];e[t]?r.clearSymbolFadeHold():r.hasSymbolBuckets?r.holdingForSymbolFade()?r.symbolFadeFinished()&&this._removeTile(t):r.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(t)}}_addTerrainIdealTiles(e){const t=[];for(const r of e)if(r.canonical.z>this._source.minzoom){const e=r.scaledTo(r.canonical.z-1);t.push(e);const n=r.scaledTo(Math.max(this._source.minzoom,Math.min(r.canonical.z,5)));t.push(n)}return e.concat(t)}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForSymbolFade()&&this._removeTile(e)}_updateRetainedTiles(e,t){var r;const n=new Set;for(const t of e)this._addTile(t).hasData()||n.add(t);const i=e.reduce((e,t)=>(e[t.key]=t,e),{}),a=this._retainLoadedChildren(i,n),o={},s=Math.max(t-Ce.maxUnderzooming,this._source.minzoom);for(const e of a){let t=this._tiles[e.key],n=null==t?void 0:t.wasRequested();for(let a=e.overscaledZ-1;a>=s;--a){const s=e.scaledTo(a);if(o[s.key])break;if(o[s.key]=!0,t=this.getTile(s),!t&&n&&(t=this._addTile(s)),t){const e=t.hasData();if((e||!(null===(r=this.map)||void 0===r?void 0:r.cancelPendingTileRequestsWhileZooming)||n)&&(i[s.key]=s),n=t.wasRequested(),e)break}}}return i}_updateFadingTiles(e,r){const n=c(),i=t.aw(e);for(const t of e){const e=this._tiles[t.key];e.fadingDirection!==he.Departing&&0!==e.fadeOpacity||e.resetFadeLogic(),this._updateFadingAncestor(e,r,n)||this._updateFadingDescendents(e,r,n)||this._updateFadingEdge(e,i,n)||e.resetFadeLogic()}}_updateFadingAncestor(e,t,r){if(!e.hasData())return!1;const{tileID:n,fadingRole:i,fadingDirection:a,fadingParentID:o}=e;if(i===ue.Base&&a===he.Incoming&&o)return t[o.key]=o,!0;const s=Math.max(n.overscaledZ-this._maxFadingAncestorLevels,this._source.minzoom);for(let i=n.overscaledZ-1;i>=s;i--){const a=n.scaledTo(i),o=this.getLoadedTile(a);if(o)return e.setCrossFadeLogic({fadingRole:ue.Base,fadingDirection:he.Incoming,fadingParentID:o.tileID,fadeEndTime:r+this._rasterFadeDuration}),o.setCrossFadeLogic({fadingRole:ue.Parent,fadingDirection:he.Departing,fadeEndTime:r+this._rasterFadeDuration}),t[a.key]=a,!0}return!1}_updateFadingDescendents(e,t,r){if(!e.hasData())return!1;const n=e.tileID.children(this._source.maxzoom);let i=this._updateFadingChildren(e,n,t,r);if(i)return!0;for(const a of n){const n=a.children(this._source.maxzoom);this._updateFadingChildren(e,n,t,r)&&(i=!0)}return i}_updateFadingChildren(e,t,r,n){if(t[0].overscaledZ>=this._source.maxzoom)return!1;let i=!1;for(const a of t){const t=this.getLoadedTile(a);if(!t)continue;const{fadingRole:o,fadingDirection:s,fadingParentID:l}=t;o===ue.Base&&s===he.Departing&&l||(t.setCrossFadeLogic({fadingRole:ue.Base,fadingDirection:he.Departing,fadingParentID:e.tileID,fadeEndTime:n+this._rasterFadeDuration}),e.setCrossFadeLogic({fadingRole:ue.Parent,fadingDirection:he.Incoming,fadeEndTime:n+this._rasterFadeDuration})),r[a.key]=a,i=!0}return i}_updateFadingEdge(e,t,r){const n=e.tileID;return!!e.selfFading||!e.hasData()&&!!t.has(n)&&(e.setSelfFadeLogic(r+this._rasterFadeDuration),!0)}_addTile(e){let r=this._tiles[e.key];if(r)return r;r=this._cache.getAndRemove(e),r&&(r.resetFadeLogic(),this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null));const n=r;return r||(r=new de(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,e.key,r.state)),r.uses++,this._tiles[e.key]=r,n||this._source.fire(new t.l("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r}_setTileReloadTimer(e,t){this._clearTileReloadTimer(e);const r=t.getExpiryTimeout();r&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},r))}_clearTileReloadTimer(e){const t=this._timers[e];t&&(clearTimeout(t),delete this._timers[e])}_resetTileReloadTimers(){for(const e in this._timers)clearTimeout(this._timers[e]),delete this._timers[e];for(const e in this._tiles)this._setTileReloadTimer(e,this._tiles[e])}refreshTiles(e){for(const t in this._tiles)(this._isIdRenderable(t)||"errored"==this._tiles[t].state)&&e.some(e=>e.equals(this._tiles[t].tileID.canonical))&&this._reloadTile(t,"expired")}_removeTile(e){const t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._clearTileReloadTimer(e),t.uses>0||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}_dataHandler(e){"source"===e.dataType&&("metadata"!==e.sourceDataType?"content"===e.sourceDataType&&this._sourceLoaded&&!this._paused&&(this.reload(e.sourceDataChanged,e.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,r,n){const i=[],a=this.transform;if(!a)return i;const o=a.getCoveringTilesDetailsProvider().allowWorldCopies(),s=n?a.getCameraQueryGeometry(e):e,l=e=>a.screenPointToMercatorCoordinate(e,this.terrain),c=this.transformBbox(e,l,!o),u=this.transformBbox(s,l,!o),h=this.getIds(),d=t.ab.fromPoints(u);for(let e=0;e<h.length;e++){const n=this._tiles[h[e]];if(n.holdingForSymbolFade())continue;const s=o?[n.tileID]:[n.tileID.unwrapTo(-1),n.tileID.unwrapTo(0)],l=Math.pow(2,a.zoom-n.tileID.overscaledZ),p=r*n.queryPadding*t.a4/n.tileSize/l;for(const e of s){const r=d.map(r=>e.getTilePoint(new t.aa(r.x,r.y)));if(r.expandBy(p),r.intersects(Ee)){const t=c.map(t=>e.getTilePoint(t)),r=u.map(t=>e.getTilePoint(t));i.push({tile:n,tileID:o?e:e.unwrapTo(0),queryGeometry:t,cameraQueryGeometry:r,scale:l})}}}return i}transformBbox(e,r,n){let i=e.map(r);if(n){const n=t.ab.fromPoints(e);n.shrinkBy(.001*Math.min(n.width(),n.height()));const a=n.map(r);t.ab.fromPoints(i).covers(a)||(i=i.map(e=>e.x>.5?new t.aa(e.x-1,e.y,e.z):e))}return i}getVisibleCoordinates(e){const t=this.getRenderableIds(e).map(e=>this._tiles[e].tileID);return this.transform&&this.transform.populateCache(t),t}hasTransition(){if(this._source.hasTransition())return!0;if(ke(this._source.type)&&this._rasterFadeDuration>0){const e=c();for(const t in this._tiles)if(this._tiles[t].fadeEndTime>=e)return!0}return!1}setRasterFadeDuration(e){this._rasterFadeDuration=e}setFeatureState(e,r,n){this._state.updateState(e=e||t.a9,r,n)}removeFeatureState(e,r,n){this._state.removeFeatureState(e=e||t.a9,r,n)}getFeatureState(e,r){return this._state.getState(e=e||t.a9,r)}setDependencies(e,t,r){const n=this._tiles[e];n&&n.setDependencies(t,r)}reloadTilesForDependencies(e,t){for(const r in this._tiles)this._tiles[r].hasDependency(e,t)&&this._reloadTile(r,"reloading");this._cache.filter(r=>!r.hasDependency(e,t))}}function Me(e,t){const r=Math.abs(2*e.wrap)-+(e.wrap<0),n=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||n-r||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function ke(e){return"raster"===e||"image"===e||"video"===e}Ce.maxUnderzooming=10,Ce.maxOverzooming=3;class Ie{constructor(e,t){this.reset(e,t)}reset(e,t){this.points=e||[],this._distances=[0];for(let e=1;e<this.points.length;e++)this._distances[e]=this._distances[e-1]+this.points[e].dist(this.points[e-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(1===this.points.length)return this.points[0];e=t.an(e,0,1);let r=1,n=this._distances[r];const i=e*this.paddedLength+this.padding;for(;n<i&&r<this._distances.length;)n=this._distances[++r];const a=r-1,o=this._distances[a],s=n-o,l=s>0?(i-o)/s:0;return this.points[a].mult(1-l).add(this.points[r].mult(l))}}function Ae(e,t){let r=!0;return"always"===e||"never"!==e&&"never"!==t||(r=!1),r}class ze{constructor(e,t,r){const n=this.boxCells=[],i=this.circleCells=[];this.xCellCount=Math.ceil(e/r),this.yCellCount=Math.ceil(t/r);for(let e=0;e<this.xCellCount*this.yCellCount;e++)n.push([]),i.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,t,r,n,i){this._forEachCell(t,r,n,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)}insertCircle(e,t,r,n){this._forEachCell(t-n,r-n,t+n,r+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(r),this.circles.push(n)}_insertBoxCell(e,t,r,n,i,a){this.boxCells[i].push(a)}_insertCircleCell(e,t,r,n,i,a){this.circleCells[i].push(a)}_query(e,t,r,n,i,a,o){if(r<0||e>this.width||n<0||t>this.height)return[];const s=[];if(e<=0&&t<=0&&this.width<=r&&this.height<=n){if(i)return[{key:null,x1:e,y1:t,x2:r,y2:n}];for(let e=0;e<this.boxKeys.length;e++)s.push({key:this.boxKeys[e],x1:this.bboxes[4*e],y1:this.bboxes[4*e+1],x2:this.bboxes[4*e+2],y2:this.bboxes[4*e+3]});for(let e=0;e<this.circleKeys.length;e++){const t=this.circles[3*e],r=this.circles[3*e+1],n=this.circles[3*e+2];s.push({key:this.circleKeys[e],x1:t-n,y1:r-n,x2:t+n,y2:r+n})}}else this._forEachCell(e,t,r,n,this._queryCell,s,{hitTest:i,overlapMode:a,seenUids:{box:{},circle:{}}},o);return s}query(e,t,r,n){return this._query(e,t,r,n,!1,null)}hitTest(e,t,r,n,i,a){return this._query(e,t,r,n,!0,i,a).length>0}hitTestCircle(e,t,r,n,i){const a=e-r,o=e+r,s=t-r,l=t+r;if(o<0||a>this.width||l<0||s>this.height)return!1;const c=[];return this._forEachCell(a,s,o,l,this._queryCellCircle,c,{hitTest:!0,overlapMode:n,circle:{x:e,y:t,radius:r},seenUids:{box:{},circle:{}}},i),c.length>0}_queryCell(e,t,r,n,i,a,o,s){const{seenUids:l,hitTest:c,overlapMode:u}=o,h=this.boxCells[i];if(null!==h){const i=this.bboxes;for(const o of h)if(!l.box[o]){l.box[o]=!0;const h=4*o,d=this.boxKeys[o];if(e<=i[h+2]&&t<=i[h+3]&&r>=i[h+0]&&n>=i[h+1]&&(!s||s(d))&&(!c||!Ae(u,d.overlapMode))&&(a.push({key:d,x1:i[h],y1:i[h+1],x2:i[h+2],y2:i[h+3]}),c))return!0}}const d=this.circleCells[i];if(null!==d){const i=this.circles;for(const o of d)if(!l.circle[o]){l.circle[o]=!0;const h=3*o,d=this.circleKeys[o];if(this._circleAndRectCollide(i[h],i[h+1],i[h+2],e,t,r,n)&&(!s||s(d))&&(!c||!Ae(u,d.overlapMode))){const e=i[h],t=i[h+1],r=i[h+2];if(a.push({key:d,x1:e-r,y1:t-r,x2:e+r,y2:t+r}),c)return!0}}}return!1}_queryCellCircle(e,t,r,n,i,a,o,s){const{circle:l,seenUids:c,overlapMode:u}=o,h=this.boxCells[i];if(null!==h){const e=this.bboxes;for(const t of h)if(!c.box[t]){c.box[t]=!0;const r=4*t,n=this.boxKeys[t];if(this._circleAndRectCollide(l.x,l.y,l.radius,e[r+0],e[r+1],e[r+2],e[r+3])&&(!s||s(n))&&!Ae(u,n.overlapMode))return a.push(!0),!0}}const d=this.circleCells[i];if(null!==d){const e=this.circles;for(const t of d)if(!c.circle[t]){c.circle[t]=!0;const r=3*t,n=this.circleKeys[t];if(this._circlesCollide(e[r],e[r+1],e[r+2],l.x,l.y,l.radius)&&(!s||s(n))&&!Ae(u,n.overlapMode))return a.push(!0),!0}}}_forEachCell(e,t,r,n,i,a,o,s){const l=this._convertToXCellCoord(e),c=this._convertToYCellCoord(t),u=this._convertToXCellCoord(r),h=this._convertToYCellCoord(n);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++)if(i.call(this,e,t,r,n,this.xCellCount*l+d,a,o,s))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,t,r,n,i,a){const o=n-e,s=i-t,l=r+a;return l*l>o*o+s*s}_circleAndRectCollide(e,t,r,n,i,a,o){const s=(a-n)/2,l=Math.abs(e-(n+s));if(l>s+r)return!1;const c=(o-i)/2,u=Math.abs(t-(i+c));if(u>c+r)return!1;if(l<=s||u<=c)return!0;const h=l-s,d=u-c;return h*h+d*d<=r*r}}function De(e,r,i){const a=t.N();if(!e){const{vecSouth:e,vecEast:t}=Re(r),i=n();i[0]=t[0],i[1]=t[1],i[2]=e[0],i[3]=e[1],o=i,(d=(l=(s=i)[0])*(h=s[3])-(u=s[2])*(c=s[1]))&&(o[0]=h*(d=1/d),o[1]=-c*d,o[2]=-u*d,o[3]=l*d),a[0]=i[0],a[1]=i[1],a[4]=i[2],a[5]=i[3]}var o,s,l,c,u,h,d;return t.Q(a,a,[1/i,1/i,1]),a}function Le(e,r,n,i){if(e){const e=t.N();if(!r){const{vecSouth:t,vecEast:r}=Re(n);e[0]=r[0],e[1]=r[1],e[4]=t[0],e[5]=t[1]}return t.Q(e,e,[i,i,1]),e}return n.pixelsToClipSpaceMatrix}function Re(e){const r=Math.cos(e.rollInRadians),n=Math.sin(e.rollInRadians),i=Math.cos(e.pitchInRadians),a=Math.cos(e.bearingInRadians),o=Math.sin(e.bearingInRadians),s=t.aB();s[0]=-a*i*n-o*r,s[1]=-o*i*n+a*r;const l=t.aC(s);l<1e-9?t.aD(s):t.aE(s,s,1/l);const c=t.aB();c[0]=a*i*r-o*n,c[1]=o*i*r+a*n;const u=t.aC(c);return u<1e-9?t.aD(c):t.aE(c,c,1/u),{vecEast:c,vecSouth:s}}function Fe(e,r,n,i){let a;i?(a=[e,r,i(e,r),1],t.aG(a,a,n)):(a=[e,r,0,1],Je(a,a,n));const o=a[3];return{point:new t.P(a[0]/o,a[1]/o),signedDistanceFromCamera:o,isOccluded:!1}}function Be(e,t){return.5+e/t*.5}function Oe(e,t){return e.x>=-t[0]&&e.x<=t[0]&&e.y>=-t[1]&&e.y<=t[1]}function Ne(e,r,n,i,a,o,s,l,c,u,h,d,p){const f=n?e.textSizeData:e.iconSizeData,m=t.ax(f,r.transform.zoom),g=[256/r.width*2+1,256/r.height*2+1],_=n?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;_.clear();const y=e.lineVertexArray,v=n?e.text.placedSymbolArray:e.icon.placedSymbolArray,b=r.transform.width/r.transform.height;let x=!1;for(let n=0;n<v.length;n++){const w=v.get(n);if(w.hidden||w.writingMode===t.ay.vertical&&!x){Qe(w.numGlyphs,_);continue}x=!1;const T=new t.P(w.anchorX,w.anchorY),S={getElevation:p,pitchedLabelPlaneMatrix:i,lineVertexArray:y,pitchWithMap:o,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:r.transform,tileAnchorPoint:T,unwrappedTileID:c,width:u,height:h,translation:d},P=He(w.anchorX,w.anchorY,S);if(!Oe(P.point,g)){Qe(w.numGlyphs,_);continue}const E=Be(r.transform.cameraToCenterDistance,P.signedDistanceFromCamera),C=t.az(f,m,w),M=o?C*r.transform.getPitchedTextCorrection(w.anchorX,w.anchorY,c)/E:C*E,k=Ue({projectionContext:S,pitchedLabelPlaneMatrixInverse:a,symbol:w,fontSize:M,flip:!1,keepUpright:s,glyphOffsetArray:e.glyphOffsetArray,dynamicLayoutVertexArray:_,aspectRatio:b,rotateToLine:l});x=k.useVertical,(k.notEnoughRoom||x||k.needsFlipping&&Ue({projectionContext:S,pitchedLabelPlaneMatrixInverse:a,symbol:w,fontSize:M,flip:!0,keepUpright:s,glyphOffsetArray:e.glyphOffsetArray,dynamicLayoutVertexArray:_,aspectRatio:b,rotateToLine:l}).notEnoughRoom)&&Qe(w.numGlyphs,_)}n?e.text.dynamicLayoutVertexBuffer.updateData(_):e.icon.dynamicLayoutVertexBuffer.updateData(_)}function Ve(e,t,r,n,i,a,o,s){const l=a.glyphStartIndex+a.numGlyphs,c=a.lineStartIndex,u=a.lineStartIndex+a.lineLength,h=t.getoffsetX(a.glyphStartIndex),d=t.getoffsetX(l-1),p=Ye(e*h,r,n,i,a.segment,c,u,s,o);if(!p)return null;const f=Ye(e*d,r,n,i,a.segment,c,u,s,o);return f?s.projectionCache.anyProjectionOccluded?null:{first:p,last:f}:null}function je(e,r,n,i){return e===t.ay.horizontal&&Math.abs(n.y-r.y)>Math.abs(n.x-r.x)*i?{useVertical:!0}:(e===t.ay.vertical?r.y<n.y:r.x>n.x)?{needsFlipping:!0}:null}function Ue(e){const{projectionContext:r,pitchedLabelPlaneMatrixInverse:n,symbol:i,fontSize:a,flip:o,keepUpright:s,glyphOffsetArray:l,dynamicLayoutVertexArray:c,aspectRatio:u,rotateToLine:h}=e,d=a/24,p=i.lineOffsetX*d,f=i.lineOffsetY*d;let m;if(i.numGlyphs>1){const e=i.glyphStartIndex+i.numGlyphs,t=i.lineStartIndex,a=i.lineStartIndex+i.lineLength,c=Ve(d,l,p,f,o,i,h,r);if(!c)return{notEnoughRoom:!0};const g=Ze(c.first.point.x,c.first.point.y,r,n),_=Ze(c.last.point.x,c.last.point.y,r,n);if(s&&!o){const e=je(i.writingMode,g,_,u);if(e)return e}m=[c.first];for(let n=i.glyphStartIndex+1;n<e-1;n++){const e=Ye(d*l.getoffsetX(n),p,f,o,i.segment,t,a,r,h);if(!e)return{notEnoughRoom:!0};m.push(e)}m.push(c.last)}else{if(s&&!o){const e=$e(r.tileAnchorPoint.x,r.tileAnchorPoint.y,r).point,a=i.lineStartIndex+i.segment+1,o=new t.P(r.lineVertexArray.getx(a),r.lineVertexArray.gety(a)),s=$e(o.x,o.y,r),l=s.signedDistanceFromCamera>0?s.point:Ge(r.tileAnchorPoint,o,e,1,r),c=Ze(e.x,e.y,r,n),h=Ze(l.x,l.y,r,n),d=je(i.writingMode,c,h,u);if(d)return d}const e=Ye(d*l.getoffsetX(i.glyphStartIndex),p,f,o,i.segment,i.lineStartIndex,i.lineStartIndex+i.lineLength,r,h);if(!e||r.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};m=[e]}for(const e of m)t.aF(c,e.point,e.angle);return{}}function Ge(e,t,r,n,i){const a=e.add(e.sub(t)._unit()),o=$e(a.x,a.y,i).point,s=r.sub(o);return r.add(s._mult(n/s.mag()))}function qe(e,r,n){const i=r.projectionCache;if(i.projections[e])return i.projections[e];const a=new t.P(r.lineVertexArray.getx(e),r.lineVertexArray.gety(e)),o=$e(a.x,a.y,r);if(o.signedDistanceFromCamera>0)return i.projections[e]=o.point,i.anyProjectionOccluded=i.anyProjectionOccluded||o.isOccluded,o.point;const s=e-n.direction;return Ge(0===n.distanceFromAnchor?r.tileAnchorPoint:new t.P(r.lineVertexArray.getx(s),r.lineVertexArray.gety(s)),a,n.previousVertex,n.absOffsetX-n.distanceFromAnchor+1,r)}function $e(e,t,r){const n=e+r.translation[0],i=t+r.translation[1];let a;return r.pitchWithMap?(a=Fe(n,i,r.pitchedLabelPlaneMatrix,r.getElevation),a.isOccluded=!1):(a=r.transform.projectTileCoordinates(n,i,r.unwrappedTileID,r.getElevation),a.point.x=(.5*a.point.x+.5)*r.width,a.point.y=(.5*-a.point.y+.5)*r.height),a}function Ze(e,r,n,i){if(n.pitchWithMap){const a=[e,r,0,1];return t.aG(a,a,i),n.transform.projectTileCoordinates(a[0]/a[3],a[1]/a[3],n.unwrappedTileID,n.getElevation).point}return{x:e/n.width*2-1,y:1-r/n.height*2}}function He(e,t,r){return r.transform.projectTileCoordinates(e,t,r.unwrappedTileID,r.getElevation)}function We(e,t,r){return e._unit()._perp()._mult(t*r)}function Xe(e,r,n,i,a,o,s,l,c){if(l.projectionCache.offsets[e])return l.projectionCache.offsets[e];const u=n.add(r);if(e+c.direction<i||e+c.direction>=a)return l.projectionCache.offsets[e]=u,u;const h=qe(e+c.direction,l,c),d=We(h.sub(n),s,c.direction),p=n.add(d),f=h.add(d);return l.projectionCache.offsets[e]=t.aH(o,u,p,f)||u,l.projectionCache.offsets[e]}function Ye(e,t,r,n,i,a,o,s,l){const c=n?e-t:e+t;let u=c>0?1:-1,h=0;n&&(u*=-1,h=Math.PI),u<0&&(h+=Math.PI);let d,p=u>0?a+i:a+i+1;s.projectionCache.cachedAnchorPoint?d=s.projectionCache.cachedAnchorPoint:(d=$e(s.tileAnchorPoint.x,s.tileAnchorPoint.y,s).point,s.projectionCache.cachedAnchorPoint=d);let f,m,g=d,_=d,y=0,v=0;const b=Math.abs(c),x=[];let w;for(;y+v<=b;){if(p+=u,p<a||p>=o)return null;y+=v,_=g,m=f;const e={absOffsetX:b,direction:u,distanceFromAnchor:y,previousVertex:_};if(g=qe(p,s,e),0===r)x.push(_),w=g.sub(_);else{let t;const n=g.sub(_);t=0===n.mag()?We(qe(p+u,s,e).sub(g),r,u):We(n,r,u),m||(m=_.add(t)),f=Xe(p,t,g,a,o,m,r,s,e),x.push(m),w=f.sub(m)}v=w.mag()}const T=w._mult((b-y)/v)._add(m||_),S=h+Math.atan2(g.y-_.y,g.x-_.x);return x.push(T),{point:T,angle:l?S:0,path:x}}const Ke=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Qe(e,t){for(let r=0;r<e;r++){const e=t.length;t.resize(e+4),t.float32.set(Ke,3*e)}}function Je(e,t,r){const n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e[3]=r[3]*n+r[7]*i+r[15],e}const et=100;class tt{constructor(e,t=new ze(e.width+200,e.height+200,25),r=new ze(e.width+200,e.height+200,25)){this.transform=e,this.grid=t,this.ignoredGrid=r,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+et,this.screenBottomBoundary=e.height+et,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,t,r,n,i,a,o,s,l,c,u,h){const d=this.projectAndGetPerspectiveRatio(e.anchorPointX+s[0],e.anchorPointY+s[1],i,c,h),p=r*d.perspectiveRatio;let f;if(a||o)f=this._projectCollisionBox(e,p,n,i,a,o,s,d,c,u,h);else{const t=d.x+(u?u.x*p:0),r=d.y+(u?u.y*p:0);f={allPointsOccluded:!1,box:[t+e.x1*p,r+e.y1*p,t+e.x2*p,r+e.y2*p]}}const[m,g,_,y]=f.box,v=a?f.allPointsOccluded:d.isOccluded;let b=v;return b||(b=d.perspectiveRatio<this.perspectiveRatioCutoff),b||(b=!this.isInsideGrid(m,g,_,y)),b||"always"!==t&&this.grid.hitTest(m,g,_,y,t,l)?{box:[m,g,_,y],placeable:!1,offscreen:!1,occluded:v}:{box:[m,g,_,y],placeable:!0,offscreen:this.isOffscreen(m,g,_,y),occluded:v}}placeCollisionCircles(e,r,n,i,a,o,s,l,c,u,h,d,p,f){const m=[],g=new t.P(r.anchorX,r.anchorY),_=this.getPerspectiveRatio(g.x,g.y,o,f),y=(c?a*this.transform.getPitchedTextCorrection(r.anchorX,r.anchorY,o)/_:a*_)/t.aL,v={getElevation:f,pitchedLabelPlaneMatrix:s,lineVertexArray:n,pitchWithMap:c,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:g,unwrappedTileID:o,width:this.transform.width,height:this.transform.height,translation:p},b=Ve(y,i,r.lineOffsetX*y,r.lineOffsetY*y,!1,r,!1,v);let x=!1,w=!1,T=!0;if(b){const r=.5*h*_+d,n=new t.P(-100,-100),i=new t.P(this.screenRightBoundary,this.screenBottomBoundary),a=new Ie,o=b.first,s=b.last;let p=[];for(let e=o.path.length-1;e>=1;e--)p.push(o.path[e]);for(let e=1;e<s.path.length;e++)p.push(s.path[e]);const f=2.5*r;if(c){const e=this.projectPathToScreenSpace(p,v);p=e.some(e=>e.signedDistanceFromCamera<=0)?[]:e.map(e=>e.point)}let g=[];if(p.length>0){const e=p[0].clone(),r=p[0].clone();for(let t=1;t<p.length;t++)e.x=Math.min(e.x,p[t].x),e.y=Math.min(e.y,p[t].y),r.x=Math.max(r.x,p[t].x),r.y=Math.max(r.y,p[t].y);g=e.x>=n.x&&r.x<=i.x&&e.y>=n.y&&r.y<=i.y?[p]:r.x<n.x||e.x>i.x||r.y<n.y||e.y>i.y?[]:t.aI([p],n.x,n.y,i.x,i.y)}for(const t of g){a.reset(t,.25*r);let n=0;n=a.length<=.5*r?1:Math.ceil(a.paddedLength/f)+1;for(let t=0;t<n;t++){const i=t/Math.max(n-1,1),o=a.lerp(i),s=o.x+et,c=o.y+et;m.push(s,c,r,0);const h=s-r,d=c-r,p=s+r,f=c+r;if(T=T&&this.isOffscreen(h,d,p,f),w=w||this.isInsideGrid(h,d,p,f),"always"!==e&&this.grid.hitTestCircle(s,c,r,e,u)&&(x=!0,!l))return{circles:[],offscreen:!1,collisionDetected:x}}}}return{circles:!l&&x||!w||_<this.perspectiveRatioCutoff?[]:m,offscreen:T,collisionDetected:x}}projectPathToScreenSpace(e,r){const n=function(e,r){const n=t.N();return t.aA(n,r.pitchedLabelPlaneMatrix),e.map(e=>{const t=Fe(e.x,e.y,n,r.getElevation),i=r.transform.projectTileCoordinates(t.point.x,t.point.y,r.unwrappedTileID,r.getElevation);return i.point.x=(.5*i.point.x+.5)*r.width,i.point.y=(.5*-i.point.y+.5)*r.height,i})}(e,r);return function(e){let t=0,r=0,n=0,i=0;for(let a=0;a<e.length;a++)e[a].isOccluded?(n=a+1,i=0):(i++,i>r&&(r=i,t=n));return e.slice(t,t+r)}(n)}queryRenderedSymbols(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const r=[],n=new t.ab;for(const i of e){const e=new t.P(i.x+et,i.y+et);n.extend(e),r.push(e)}const{minX:i,minY:a,maxX:o,maxY:s}=n,l=this.grid.query(i,a,o,s).concat(this.ignoredGrid.query(i,a,o,s)),c={},u={};for(const e of l){const n=e.key;if(void 0===c[n.bucketInstanceId]&&(c[n.bucketInstanceId]={}),c[n.bucketInstanceId][n.featureIndex])continue;const i=[new t.P(e.x1,e.y1),new t.P(e.x2,e.y1),new t.P(e.x2,e.y2),new t.P(e.x1,e.y2)];t.aJ(r,i)&&(c[n.bucketInstanceId][n.featureIndex]=!0,void 0===u[n.bucketInstanceId]&&(u[n.bucketInstanceId]=[]),u[n.bucketInstanceId].push(n.featureIndex))}return u}insertCollisionBox(e,t,r,n,i,a){(r?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:i,collisionGroupID:a,overlapMode:t},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,t,r,n,i,a){const o=r?this.ignoredGrid:this.grid,s={bucketInstanceId:n,featureIndex:i,collisionGroupID:a,overlapMode:t};for(let t=0;t<e.length;t+=4)o.insertCircle(s,e[t],e[t+1],e[t+2])}projectAndGetPerspectiveRatio(e,r,n,i,a){if(a){let n;i?(n=[e,r,i(e,r),1],t.aG(n,n,a)):(n=[e,r,0,1],Je(n,n,a));const o=n[3];return{x:(n[0]/o+1)/2*this.transform.width+et,y:(-n[1]/o+1)/2*this.transform.height+et,perspectiveRatio:.5+this.transform.cameraToCenterDistance/o*.5,isOccluded:!1,signedDistanceFromCamera:o}}{const t=this.transform.projectTileCoordinates(e,r,n,i);return{x:(t.point.x+1)/2*this.transform.width+et,y:(1-t.point.y)/2*this.transform.height+et,perspectiveRatio:.5+this.transform.cameraToCenterDistance/t.signedDistanceFromCamera*.5,isOccluded:t.isOccluded,signedDistanceFromCamera:t.signedDistanceFromCamera}}}getPerspectiveRatio(e,t,r,n){const i=this.transform.projectTileCoordinates(e,t,r,n);return.5+this.transform.cameraToCenterDistance/i.signedDistanceFromCamera*.5}isOffscreen(e,t,r,n){return r<et||e>=this.screenRightBoundary||n<et||t>this.screenBottomBoundary}isInsideGrid(e,t,r,n){return r>=0&&e<this.gridRightBoundary&&n>=0&&t<this.gridBottomBoundary}getViewportMatrix(){const e=t.ar([]);return t.O(e,e,[-100,-100,0]),e}_projectCollisionBox(e,r,n,i,a,o,s,l,c,u,h){let d=1,p=0,f=0,m=1;const g=e.anchorPointX+s[0],_=e.anchorPointY+s[1];if(o&&!a){const e=this.projectAndGetPerspectiveRatio(g+1,_,i,c,h),t=e.x-l.x,r=Math.atan((e.y-l.y)/t)+(t<0?Math.PI:0),n=Math.sin(r),a=Math.cos(r);d=a,p=n,f=-n,m=a}else if(!o&&a){const e=Re(this.transform);d=e.vecEast[0],p=e.vecEast[1],f=e.vecSouth[0],m=e.vecSouth[1]}let y=l.x,v=l.y,b=r;a&&(y=g,v=_,b=Math.pow(2,-(this.transform.zoom-n.overscaledZ)),b*=this.transform.getPitchedTextCorrection(g,_,i),u||(b*=t.an(.5+l.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),u&&(y+=d*u.x*b+f*u.y*b,v+=p*u.x*b+m*u.y*b);const x=e.x1*b,w=e.x2*b,T=(x+w)/2,S=e.y1*b,P=e.y2*b,E=(S+P)/2,C=[{offsetX:x,offsetY:S},{offsetX:T,offsetY:S},{offsetX:w,offsetY:S},{offsetX:w,offsetY:E},{offsetX:w,offsetY:P},{offsetX:T,offsetY:P},{offsetX:x,offsetY:P},{offsetX:x,offsetY:E}];let M=[];for(const{offsetX:e,offsetY:r}of C)M.push(new t.P(y+d*e+f*r,v+p*e+m*r));let k=!1;if(a){const e=M.map(e=>this.projectAndGetPerspectiveRatio(e.x,e.y,i,c,h));k=e.some(e=>!e.isOccluded),M=e.map(e=>new t.P(e.x,e.y))}else k=!0;return{box:t.aK(M),allPointsOccluded:!k}}}class rt{constructor(e,t,r,n){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):n&&r?1:0,this.placed=r}isHidden(){return 0===this.opacity&&!this.placed}}class nt{constructor(e,t,r,n,i){this.text=new rt(e?e.text:null,t,r,i),this.icon=new rt(e?e.icon:null,t,n,i)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class it{constructor(e,t,r){this.text=e,this.icon=t,this.skipFade=r}}class at{constructor(e,t,r,n,i){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=r,this.bucketIndex=n,this.tileID=i}}class ot{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:e=>e.collisionGroupID===t}}return this.collisionGroups[e]}}function st(e,r,n,i,a){const{horizontalAlign:o,verticalAlign:s}=t.aR(e);return new t.P(-(o-.5)*r+i[0]*a,-(s-.5)*n+i[1]*a)}class lt{constructor(e,t,r,n,i){this.transform=e.clone(),this.terrain=t,this.collisionIndex=new tt(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new ot(n),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=i,i&&(i.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const t=this.terrain;return t?(r,n)=>t.getElevation(e,r,n):null}getBucketParts(e,r,n,i){const a=n.getBucket(r),o=n.latestFeatureIndex;if(!a||!o||r.id!==a.layerIds[0])return;const s=n.collisionBoxArray,l=a.layers[0].layout,c=a.layers[0].paint,u=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),h=n.tileSize/t.a4,d=n.tileID.toUnwrapped(),p="map"===l.get("text-rotation-alignment"),f=t.aM(n,1,this.transform.zoom),m=t.aN(this.collisionIndex.transform,n,c.get("text-translate"),c.get("text-translate-anchor")),g=t.aN(this.collisionIndex.transform,n,c.get("icon-translate"),c.get("icon-translate-anchor")),_=De(p,this.transform,f);this.retainedQueryData[a.bucketInstanceId]=new at(a.bucketInstanceId,o,a.sourceLayerIndex,a.index,n.tileID);const y={bucket:a,layout:l,translationText:m,translationIcon:g,unwrappedTileID:d,pitchedLabelPlaneMatrix:_,scale:u,textPixelRatio:h,holdingForFade:n.holdingForSymbolFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:t.ax(a.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(i)for(const t of a.sortKeyRanges){const{sortKey:r,symbolInstanceStart:n,symbolInstanceEnd:i}=t;e.push({sortKey:r,symbolInstanceStart:n,symbolInstanceEnd:i,parameters:y})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:y})}attemptAnchorPlacement(e,r,n,i,a,o,s,l,c,u,h,d,p,f,m,g,_,y,v,b){const x=t.aO[e.textAnchor],w=[e.textOffset0,e.textOffset1],T=st(x,n,i,w,a),S=this.collisionIndex.placeCollisionBox(r,d,l,c,u,s,o,g,h.predicate,v,T,b);if((!y||this.collisionIndex.placeCollisionBox(y,d,l,c,u,s,o,_,h.predicate,v,T,b).placeable)&&S.placeable){let e;if(this.prevPlacement&&this.prevPlacement.variableOffsets[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID].text&&(e=this.prevPlacement.variableOffsets[p.crossTileID].anchor),0===p.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[p.crossTileID]={textOffset:w,width:n,height:i,anchor:x,textBoxScale:a,prevAnchor:e},this.markUsedJustification(f,x,p,m),f.allowVerticalPlacement&&(this.markUsedOrientation(f,m,p),this.placedOrientations[p.crossTileID]=m),{shift:T,placedGlyphBoxes:S}}}placeLayerBucketPart(e,r,n){const{bucket:i,layout:a,translationText:o,translationIcon:s,unwrappedTileID:l,pitchedLabelPlaneMatrix:c,textPixelRatio:u,holdingForFade:h,collisionBoxArray:d,partiallyEvaluatedTextSize:p,collisionGroup:f}=e.parameters,m=a.get("text-optional"),g=a.get("icon-optional"),_=t.aP(a,"text-overlap","text-allow-overlap"),y="always"===_,v=t.aP(a,"icon-overlap","icon-allow-overlap"),b="always"===v,x="map"===a.get("text-rotation-alignment"),w="map"===a.get("text-pitch-alignment"),T="none"!==a.get("icon-text-fit"),S="viewport-y"===a.get("symbol-z-order"),P=y&&(b||!i.hasIconData()||g),E=b&&(y||!i.hasTextData()||m);!i.collisionArrays&&d&&i.deserializeCollisionBoxes(d);const C=this.retainedQueryData[i.bucketInstanceId].tileID,M=this._getTerrainElevationFunc(C),k=this.transform.getFastPathSimpleProjectionMatrix(C),I=(e,d,b)=>{var S,I;if(r[e.crossTileID])return;if(h)return void(this.placements[e.crossTileID]=new it(!1,!1,!1));let A=!1,z=!1,D=!0,L=null,R={box:null,placeable:!1,offscreen:null,occluded:!1},F={placeable:!1},B=null,O=null,N=null,V=0,j=0,U=0;d.textFeatureIndex?V=d.textFeatureIndex:e.useRuntimeCollisionCircles&&(V=e.featureIndex),d.verticalTextFeatureIndex&&(j=d.verticalTextFeatureIndex);const G=d.textBox;if(G){const r=r=>{let n=t.ay.horizontal;if(i.allowVerticalPlacement&&!r&&this.prevPlacement){const t=this.prevPlacement.placedOrientations[e.crossTileID];t&&(this.placedOrientations[e.crossTileID]=t,n=t,this.markUsedOrientation(i,n,e))}return n},a=(r,n)=>{if(i.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&d.verticalTextBox){for(const e of i.writingModes)if(e===t.ay.vertical?(R=n(),F=R):R=r(),R&&R.placeable)break}else R=r()},c=e.textAnchorOffsetStartIndex,h=e.textAnchorOffsetEndIndex;if(h===c){const n=(t,r)=>{const n=this.collisionIndex.placeCollisionBox(t,_,u,C,l,w,x,o,f.predicate,M,void 0,k);return n&&n.placeable&&(this.markUsedOrientation(i,r,e),this.placedOrientations[e.crossTileID]=r),n};a(()=>n(G,t.ay.horizontal),()=>{const r=d.verticalTextBox;return i.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&r?n(r,t.ay.vertical):{box:null,offscreen:null}}),r(R&&R.placeable)}else{let p=t.aO[null===(I=null===(S=this.prevPlacement)||void 0===S?void 0:S.variableOffsets[e.crossTileID])||void 0===I?void 0:I.anchor];const m=(t,r,a)=>{const d=t.x2-t.x1,m=t.y2-t.y1,g=e.textBoxScale,y=T&&"never"===v?r:null;let b=null,S="never"===_?1:2,P="never";p&&S++;for(let r=0;r<S;r++){for(let r=c;r<h;r++){const n=i.textAnchorOffsets.get(r);if(p&&n.textAnchor!==p)continue;const c=this.attemptAnchorPlacement(n,t,d,m,g,x,w,u,C,l,f,P,e,i,a,o,s,y,M);if(c&&(b=c.placedGlyphBoxes,b&&b.placeable))return A=!0,L=c.shift,b}p?p=null:P=_}return n&&!b&&(b={box:this.collisionIndex.placeCollisionBox(G,"always",u,C,l,w,x,o,f.predicate,M,void 0,k).box,offscreen:!1,placeable:!1,occluded:!1}),b};a(()=>m(G,d.iconBox,t.ay.horizontal),()=>{const r=d.verticalTextBox;return i.allowVerticalPlacement&&(!R||!R.placeable)&&e.numVerticalGlyphVertices>0&&r?m(r,d.verticalIconBox,t.ay.vertical):{box:null,occluded:!0,offscreen:null}}),R&&(A=R.placeable,D=R.offscreen);const g=r(R&&R.placeable);if(!A&&this.prevPlacement){const t=this.prevPlacement.variableOffsets[e.crossTileID];t&&(this.variableOffsets[e.crossTileID]=t,this.markUsedJustification(i,t.anchor,e,g))}}}if(B=R,A=B&&B.placeable,D=B&&B.offscreen,e.useRuntimeCollisionCircles&&e.centerJustifiedTextSymbolIndex>=0){const r=i.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),s=t.az(i.textSizeData,p,r),u=a.get("text-padding");O=this.collisionIndex.placeCollisionCircles(_,r,i.lineVertexArray,i.glyphOffsetArray,s,l,c,n,w,f.predicate,e.collisionCircleDiameter,u,o,M),O.circles.length&&O.collisionDetected&&!n&&t.w("Collisions detected, but collision boxes are not shown"),A=y||O.circles.length>0&&!O.collisionDetected,D=D&&O.offscreen}if(d.iconFeatureIndex&&(U=d.iconFeatureIndex),d.iconBox){const e=e=>this.collisionIndex.placeCollisionBox(e,v,u,C,l,w,x,s,f.predicate,M,T&&L?L:void 0,k);F&&F.placeable&&d.verticalIconBox?(N=e(d.verticalIconBox),z=N.placeable):(N=e(d.iconBox),z=N.placeable),D=D&&N.offscreen}const q=m||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,$=g||0===e.numIconVertices;q||$?$?q||(z=z&&A):A=z&&A:z=A=z&&A;const Z=z&&N.placeable;if(A&&B.placeable&&this.collisionIndex.insertCollisionBox(B.box,_,a.get("text-ignore-placement"),i.bucketInstanceId,F&&F.placeable&&j?j:V,f.ID),Z&&this.collisionIndex.insertCollisionBox(N.box,v,a.get("icon-ignore-placement"),i.bucketInstanceId,U,f.ID),O&&A&&this.collisionIndex.insertCollisionCircles(O.circles,_,a.get("text-ignore-placement"),i.bucketInstanceId,V,f.ID),n&&this.storeCollisionData(i.bucketInstanceId,b,d,B,N,O),0===e.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===i.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[e.crossTileID]=new it((A||P)&&!(null==B?void 0:B.occluded),(z||E)&&!(null==N?void 0:N.occluded),D||i.justReloaded),r[e.crossTileID]=!0};if(S){if(0!==e.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const t=i.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let e=t.length-1;e>=0;--e){const r=t[e];I(i.symbolInstances.get(r),i.collisionArrays[r],r)}}else for(let t=e.symbolInstanceStart;t<e.symbolInstanceEnd;t++)I(i.symbolInstances.get(t),i.collisionArrays[t],t);i.justReloaded=!1}storeCollisionData(e,t,r,n,i,a){if(r.textBox||r.iconBox){let a,o;this.collisionBoxArrays.has(e)?a=this.collisionBoxArrays.get(e):(a=new Map,this.collisionBoxArrays.set(e,a)),a.has(t)?o=a.get(t):(o={text:null,icon:null},a.set(t,o)),r.textBox&&(o.text=n.box),r.iconBox&&(o.icon=i.box)}if(a){let t=this.collisionCircleArrays[e];void 0===t&&(t=this.collisionCircleArrays[e]=[]);for(let e=0;e<a.circles.length;e+=4)t.push(a.circles[e+0]-et),t.push(a.circles[e+1]-et),t.push(a.circles[e+2]),t.push(a.collisionDetected?1:0)}}markUsedJustification(e,r,n,i){let a;a=i===t.ay.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[t.aQ(r)];const o=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];for(const t of o)t>=0&&(e.text.placedSymbolArray.get(t).crossTileID=a>=0&&t!==a?0:n.crossTileID)}markUsedOrientation(e,r,n){const i=r===t.ay.horizontal||r===t.ay.horizontalOnly?r:0,a=r===t.ay.vertical?r:0,o=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];for(const t of o)e.text.placedSymbolArray.get(t).placedOrientation=i;n.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=a)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const t=this.prevPlacement;let r=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;const n=t?t.symbolFadeChange(e):1,i=t?t.opacities:{},a=t?t.variableOffsets:{},o=t?t.placedOrientations:{};for(const e in this.placements){const t=this.placements[e],a=i[e];a?(this.opacities[e]=new nt(a,n,t.text,t.icon),r=r||t.text!==a.text.placed||t.icon!==a.icon.placed):(this.opacities[e]=new nt(null,n,t.text,t.icon,t.skipFade),r=r||t.text||t.icon)}for(const e in i){const t=i[e];if(!this.opacities[e]){const i=new nt(t,n,!1,!1);i.isHidden()||(this.opacities[e]=i,r=r||t.text.placed||t.icon.placed)}}for(const e in a)this.variableOffsets[e]||!this.opacities[e]||this.opacities[e].isHidden()||(this.variableOffsets[e]=a[e]);for(const e in o)this.placedOrientations[e]||!this.opacities[e]||this.opacities[e].isHidden()||(this.placedOrientations[e]=o[e]);if(t&&void 0===t.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");r?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}updateLayerOpacities(e,t){const r={};for(const n of t){const t=n.getBucket(e);t&&n.latestFeatureIndex&&e.id===t.layerIds[0]&&this.updateBucketOpacities(t,n.tileID,r,n.collisionBoxArray)}}updateBucketOpacities(e,r,n,i){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const a=e.layers[0],o=a.layout,s=new nt(null,0,!1,!1,!0),l=o.get("text-allow-overlap"),c=o.get("icon-allow-overlap"),u=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),h="map"===o.get("text-rotation-alignment"),d="map"===o.get("text-pitch-alignment"),p="none"!==o.get("icon-text-fit"),f=new nt(null,0,l&&(c||!e.hasIconData()||o.get("icon-optional")),c&&(l||!e.hasTextData()||o.get("text-optional")),!0);!e.collisionArrays&&i&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(i);const m=(e,t,r)=>{for(let n=0;n<t/4;n++)e.opacityVertexArray.emplaceBack(r);e.hasVisibleVertices=e.hasVisibleVertices||r!==yt},g=this.collisionBoxArrays.get(e.bucketInstanceId);for(let r=0;r<e.symbolInstances.length;r++){const i=e.symbolInstances.get(r),{numHorizontalGlyphVertices:a,numVerticalGlyphVertices:o,crossTileID:l}=i;let c=this.opacities[l];n[l]?c=s:c||(c=f,this.opacities[l]=c),n[l]=!0;const _=i.numIconVertices>0,y=this.placedOrientations[i.crossTileID],v=y===t.ay.vertical,b=y===t.ay.horizontal||y===t.ay.horizontalOnly;if(a>0||o>0){const t=_t(c.text);m(e.text,a,v?yt:t),m(e.text,o,b?yt:t);const r=c.text.isHidden();[i.rightJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.leftJustifiedTextSymbolIndex].forEach(t=>{t>=0&&(e.text.placedSymbolArray.get(t).hidden=r||v?1:0)}),i.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).hidden=r||b?1:0);const n=this.variableOffsets[i.crossTileID];n&&this.markUsedJustification(e,n.anchor,i,y);const s=this.placedOrientations[i.crossTileID];s&&(this.markUsedJustification(e,"left",i,s),this.markUsedOrientation(e,s,i))}if(_){const t=_t(c.icon),r=!(p&&i.verticalPlacedIconSymbolIndex&&v);i.placedIconSymbolIndex>=0&&(m(e.icon,i.numIconVertices,r?t:yt),e.icon.placedSymbolArray.get(i.placedIconSymbolIndex).hidden=c.icon.isHidden()),i.verticalPlacedIconSymbolIndex>=0&&(m(e.icon,i.numVerticalIconVertices,r?yt:t),e.icon.placedSymbolArray.get(i.verticalPlacedIconSymbolIndex).hidden=c.icon.isHidden())}const x=g&&g.has(r)?g.get(r):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const n=e.collisionArrays[r];if(n){let r=new t.P(0,0);if(n.textBox||n.verticalTextBox){let t=!0;if(u){const e=this.variableOffsets[l];e?(r=st(e.anchor,e.width,e.height,e.textOffset,e.textBoxScale),h&&r._rotate(d?-this.transform.bearingInRadians:this.transform.bearingInRadians)):t=!1}if(n.textBox||n.verticalTextBox){let i;n.textBox&&(i=v),n.verticalTextBox&&(i=b),ct(e.textCollisionBox.collisionVertexArray,c.text.placed,!t||i,x.text,r.x,r.y)}}if(n.iconBox||n.verticalIconBox){const t=Boolean(!b&&n.verticalIconBox);let i;n.iconBox&&(i=t),n.verticalIconBox&&(i=!t),ct(e.iconCollisionBox.collisionVertexArray,c.icon.placed,i,x.icon,p?r.x:0,p?r.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,t){const r=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*r>e}setStale(){this.stale=!0}}function ct(e,t,r,n,i,a){n&&0!==n.length||(n=[0,0,0,0]);const o=n[0]-et,s=n[1]-et,l=n[2]-et,c=n[3]-et;e.emplaceBack(t?1:0,r?1:0,i||0,a||0,o,s),e.emplaceBack(t?1:0,r?1:0,i||0,a||0,l,s),e.emplaceBack(t?1:0,r?1:0,i||0,a||0,l,c),e.emplaceBack(t?1:0,r?1:0,i||0,a||0,o,c)}const ut=Math.pow(2,25),ht=Math.pow(2,24),dt=Math.pow(2,17),pt=Math.pow(2,16),ft=Math.pow(2,9),mt=Math.pow(2,8),gt=Math.pow(2,1);function _t(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;const t=e.placed?1:0,r=Math.floor(127*e.opacity);return r*ut+t*ht+r*dt+t*pt+r*ft+t*mt+r*gt+t}const yt=0;class vt{constructor(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,t,r,n,i){const a=this._bucketParts;for(;this._currentTileIndex<e.length;)if(t.getBucketParts(a,n,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,i())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,a.sort((e,t)=>e.sortKey-t.sortKey));this._currentPartIndex<a.length;)if(t.placeLayerBucketPart(a[this._currentPartIndex],this._seenCrossTileIDs,r),this._currentPartIndex++,i())return!0;return!1}}class bt{constructor(e,t,r,n,i,a,o,s){this.placement=new lt(e,t,a,o,s),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=i,this._done=!1}isDone(){return this._done}continuePlacement(e,t,r){const n=c(),i=()=>!this._forceFullPlacement&&c()-n>2;for(;this._currentPlacementIndex>=0;){const n=t[e[this._currentPlacementIndex]],a=this.placement.collisionIndex.transform.zoom;if("symbol"===n.type&&(!n.minzoom||n.minzoom<=a)&&(!n.maxzoom||n.maxzoom>a)){if(this._inProgressLayer||(this._inProgressLayer=new vt(n)),this._inProgressLayer.continuePlacement(r[n.source],this.placement,this._showCollisionBoxes,n,i))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const xt=512/t.a4/2;class wt{constructor(e,r,n){this.tileID=e,this.bucketInstanceId=n,this._symbolsByKey={};const i=new Map;for(let e=0;e<r.length;e++){const t=r.get(e),n=t.key,a=i.get(n);a?a.push(t):i.set(n,[t])}for(const[e,r]of i){const n={positions:r.map(e=>({x:Math.floor(e.anchorX*xt),y:Math.floor(e.anchorY*xt)})),crossTileIDs:r.map(e=>e.crossTileID)};if(n.positions.length>128){const e=new t.aS(n.positions.length,16,Uint16Array);for(const{x:t,y:r}of n.positions)e.add(t,r);e.finish(),delete n.positions,n.index=e}this._symbolsByKey[e]=n}}getScaledCoordinates(e,r){const{x:n,y:i,z:a}=this.tileID.canonical,{x:o,y:s,z:l}=r.canonical,c=xt/Math.pow(2,l-a),u=(s*t.a4+e.anchorY)*c,h=i*t.a4*xt;return{x:Math.floor((o*t.a4+e.anchorX)*c-n*t.a4*xt),y:Math.floor(u-h)}}findMatches(e,t,r){const n=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z);for(let i=0;i<e.length;i++){const a=e.get(i);if(a.crossTileID)continue;const o=this._symbolsByKey[a.key];if(!o)continue;const s=this.getScaledCoordinates(a,t);if(o.index){const e=o.index.range(s.x-n,s.y-n,s.x+n,s.y+n).sort();for(const t of e){const e=o.crossTileIDs[t];if(!r[e]){r[e]=!0,a.crossTileID=e;break}}}else if(o.positions)for(let e=0;e<o.positions.length;e++){const t=o.positions[e],i=o.crossTileIDs[e];if(Math.abs(t.x-s.x)<=n&&Math.abs(t.y-s.y)<=n&&!r[i]){r[i]=!0,a.crossTileID=i;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class Tt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class St{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const t=Math.round((e-this.lng)/360);if(0!==t)for(const e in this.indexes){const r=this.indexes[e],n={};for(const e in r){const i=r[e];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+t),n[i.tileID.key]=i}this.indexes[e]=n}this.lng=e}addBucket(e,t,r){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let e=0;e<t.symbolInstances.length;e++)t.symbolInstances.get(e).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const n=this.usedCrossTileIDs[e.overscaledZ];for(const r in this.indexes){const i=this.indexes[r];if(Number(r)>e.overscaledZ)for(const r in i){const a=i[r];a.tileID.isChildOf(e)&&a.findMatches(t.symbolInstances,e,n)}else{const a=i[e.scaledTo(Number(r)).key];a&&a.findMatches(t.symbolInstances,e,n)}}for(let e=0;e<t.symbolInstances.length;e++){const i=t.symbolInstances.get(e);i.crossTileID||(i.crossTileID=r.generate(),n[i.crossTileID]=!0)}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new wt(e,t.symbolInstances,t.bucketInstanceId),!0}removeBucketCrossTileIDs(e,t){for(const r of t.getCrossTileIDsLists())for(const t of r)delete this.usedCrossTileIDs[e][t]}removeStaleBuckets(e){let t=!1;for(const r in this.indexes){const n=this.indexes[r];for(const i in n)e[n[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,n[i]),delete n[i],t=!0)}return t}}class Pt{constructor(){this.layerIndexes={},this.crossTileIDs=new Tt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,t,r){let n=this.layerIndexes[e.id];void 0===n&&(n=this.layerIndexes[e.id]=new St);let i=!1;const a={};n.handleWrapJump(r);for(const r of t){const t=r.getBucket(e);t&&e.id===t.layerIds[0]&&(t.bucketInstanceId||(t.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(r.tileID,t,this.crossTileIDs)&&(i=!0),a[t.bucketInstanceId]=!0)}return n.removeStaleBuckets(a)&&(i=!0),i}pruneUnusedLayers(e){const t={};e.forEach(e=>{t[e]=!0});for(const e in this.layerIndexes)t[e]||delete this.layerIndexes[e]}}var Et="void main() {fragColor=vec4(1.0);}";const Ct={prelude:Mt("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nout highp vec4 fragColor;","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c\n);}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\n#ifdef GLOBE\nif ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}\n#endif\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;"),projectionMercator:Mt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Mt("","#define GLOBE_RADIUS 6371008.8\nuniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos\n);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); \nif (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len\n);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}"),background:Mt("uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Mt("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Mt("in vec3 v_data;in float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {\n#ifdef GLOBE\nvec3 center_vector=projectToSphere(circle_center);\n#endif\nfloat angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {\n#ifdef GLOBE\nvec4 projected_center=interpolateProjection(circle_center,center_vector,ele);\n#else\nvec4 projected_center=projectTileWithElevation(circle_center,ele);\n#endif\ncorner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}\n#ifdef GLOBE\nvec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);\n#else\ngl_Position=projectTileWithElevation(corner_position,ele);\n#endif\n} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:Mt(Et,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Mt("uniform highp float u_intensity;in vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);\n#ifdef GLOBE\nvec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);\n#else\ngl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));\n#endif\n}"),heatmapTexture:Mt("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Mt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Mt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Mt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else\n{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Mt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Mt(Et,"in vec2 a_pos;void main() {\n#ifdef GLOBE\ngl_Position=projectTileFor3D(a_pos,0.0);\n#else\ngl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);\n#endif\n}"),fill:Mt("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nfragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_fill_translate;in vec2 a_pos;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=projectTile(a_pos+u_fill_translate,a_pos);}"),fillOutline:Mt("in vec2 v_pos;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n}"),fillOutlinePattern:Mt("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n}"),fillPattern:Mt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:Mt("in vec4 v_color;void main() {fragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;\n#ifdef TERRAIN3D\nin vec2 a_centroid;\n#endif\nout vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;\n#ifdef GLOBE\nvec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);\n#else\ngl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);\n#endif\nfloat colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);\n#ifdef GLOBE\nmat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);\n#endif\ndirectional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:Mt("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;\n#ifdef TERRAIN3D\nin vec2 a_centroid;\n#endif\n#ifdef GLOBE\nout vec3 v_sphere_pos;\n#endif\nout vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;\n#ifdef GLOBE\nvec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);\n#else\ngl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);\n#endif\nvec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:Mt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Mt("uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];\n#define PI 3.141592653589793\n#define STANDARD 0\n#define COMBINED 1\n#define IGOR 2\n#define MULTIDIRECTIONAL 3\n#define BASIC 4\nfloat get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else\n{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else\n{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Mt("uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:Mt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:Mt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:Mt("uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define mediump vec4 dasharray_from\n#pragma mapbox: define mediump vec4 dasharray_to\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dasharray_from\n#pragma mapbox: initialize mediump vec4 dasharray_to\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define mediump vec4 dasharray_from\n#pragma mapbox: define mediump vec4 dasharray_to\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dasharray_from\n#pragma mapbox: initialize mediump vec4 dasharray_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nfloat u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}"),lineGradientSDF:Mt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define mediump vec4 dasharray_from\n#pragma mapbox: define mediump vec4 dasharray_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dasharray_from\n#pragma mapbox: initialize mediump vec4 dasharray_to\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nin vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define mediump vec4 dasharray_from\n#pragma mapbox: define mediump vec4 dasharray_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dasharray_from\n#pragma mapbox: initialize mediump vec4 dasharray_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nfloat u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}"),raster:Mt("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;\n#ifdef GLOBE\nif (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}\n#endif\nv_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Mt("uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;\n#ifdef GLOBE\nif(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:Mt("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;\n#ifdef GLOBE\nif(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:Mt("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;\n#ifdef GLOBE\nif(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:Mt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Mt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Mt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Mt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Mt("in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758\n);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}","in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Mt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Mt(e,t){const r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,n=t.match(/in ([\w]+) ([\w]+)/g),i=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=a?a.concat(i):i,s={};return{fragmentSource:e=e.replace(r,(e,t,r,n,i)=>(s[i]=!0,"define"===t?`\n#ifndef HAS_UNIFORM_u_${i}\nin ${r} ${n} ${i};\n#else\nuniform ${r} ${n} u_${i};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${i}\n    ${r} ${n} ${i} = u_${i};\n#endif\n`)),vertexSource:t=t.replace(r,(e,t,r,n,i)=>{const a="float"===n?"vec2":"vec4",o=i.match(/color/)?"color":a;return s[i]?"define"===t?`\n#ifndef HAS_UNIFORM_u_${i}\nuniform lowp float u_${i}_t;\nin ${r} ${a} a_${i};\nout ${r} ${n} ${i};\n#else\nuniform ${r} ${n} u_${i};\n#endif\n`:"vec4"===o?`\n#ifndef HAS_UNIFORM_u_${i}\n    ${i} = a_${i};\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${i}\n    ${i} = unpack_mix_${o}(a_${i}, u_${i}_t);\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`:"define"===t?`\n#ifndef HAS_UNIFORM_u_${i}\nuniform lowp float u_${i}_t;\nin ${r} ${a} a_${i};\n#else\nuniform ${r} ${n} u_${i};\n#endif\n`:"vec4"===o?`\n#ifndef HAS_UNIFORM_u_${i}\n    ${r} ${n} ${i} = a_${i};\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${i}\n    ${r} ${n} ${i} = unpack_mix_${o}(a_${i}, u_${i}_t);\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`}),staticAttributes:n,staticUniforms:o}}class kt{constructor(e,t,r){this.vertexBuffer=e,this.indexBuffer=t,this.segments=r}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var It=t.aT([{name:"a_pos",type:"Int16",components:2}]);const At="#define PROJECTION_MERCATOR",zt="mercator";class Dt{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return zt}get shaderDefine(){return At}get shaderPreludeCode(){return Ct.projectionMercator}get vertexShaderPreludeCode(){return Ct.projectionMercator.vertexSource}get subdivisionGranularity(){return t.aU.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,r,n,i,a){if(this._cachedMesh)return this._cachedMesh;const o=new t.aV;o.emplaceBack(0,0),o.emplaceBack(t.a4,0),o.emplaceBack(0,t.a4),o.emplaceBack(t.a4,t.a4);const s=e.createVertexBuffer(o,It.members),l=t.aW.simpleSegment(0,0,4,2),c=new t.aX;c.emplaceBack(1,0,2),c.emplaceBack(1,2,3);const u=e.createIndexBuffer(c);return this._cachedMesh=new kt(s,u,l),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class Lt{constructor(e=0,t=0,r=0,n=0){if(isNaN(e)||e<0||isNaN(t)||t<0||isNaN(r)||r<0||isNaN(n)||n<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=r,this.right=n}interpolate(e,r,n){return null!=r.top&&null!=e.top&&(this.top=t.G.number(e.top,r.top,n)),null!=r.bottom&&null!=e.bottom&&(this.bottom=t.G.number(e.bottom,r.bottom,n)),null!=r.left&&null!=e.left&&(this.left=t.G.number(e.left,r.left,n)),null!=r.right&&null!=e.right&&(this.right=t.G.number(e.right,r.right,n)),this}getCenter(e,r){const n=t.an((this.left+e-this.right)/2,0,e),i=t.an((this.top+r-this.bottom)/2,0,r);return new t.P(n,i)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Lt(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Rt(e,t){if(!e.renderWorldCopies||e.lngRange)return;const r=t.lng-e.center.lng;t.lng+=r>180?-360:r<-180?360:0}function Ft(e){return Math.max(0,Math.floor(e))}class Bt{constructor(e,r){var n;this.applyConstrain=(e,t)=>null!==this._constrainOverride?this._constrainOverride(e,t):this._callbacks.defaultConstrain(e,t),this._callbacks=e,this._tileSize=512,this._renderWorldCopies=void 0===(null==r?void 0:r.renderWorldCopies)||!!(null==r?void 0:r.renderWorldCopies),this._minZoom=(null==r?void 0:r.minZoom)||0,this._maxZoom=(null==r?void 0:r.maxZoom)||22,this._minPitch=null==(null==r?void 0:r.minPitch)?0:null==r?void 0:r.minPitch,this._maxPitch=null==(null==r?void 0:r.maxPitch)?60:null==r?void 0:r.maxPitch,this._constrainOverride=null!==(n=null==r?void 0:r.constrainOverride)&&void 0!==n?n:null,this.setMaxBounds(),this._width=0,this._height=0,this._center=new t.V(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Ft(this._zoom),this._scale=t.aq(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Lt,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,r,n){this._constrainOverride=e.constrainOverride,this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Ft(this._zoom),this._scale=t.aq(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new Lt(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!n&&e.autoCalculateNearFarZ,r&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e}get constrainOverride(){return this._constrainOverride}setConstrainOverride(e){void 0===e&&(e=null),this._constrainOverride!==e&&(this._constrainOverride=e,this.constrainInternal(),this._calcMatrices())}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const r=t.W(e,-180,180)*Math.PI/180;var i,a,o,s,l,c,u,h,d;this._bearingInRadians!==r&&(this._unmodified=!1,this._bearingInRadians=r,this._calcMatrices(),this._rotationMatrix=n(),i=this._rotationMatrix,o=-this._bearingInRadians,s=(a=this._rotationMatrix)[0],l=a[1],c=a[2],u=a[3],h=Math.sin(o),d=Math.cos(o),i[0]=s*d+c*h,i[1]=l*d+u*h,i[2]=s*-h+c*d,i[3]=l*-h+u*d)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const r=t.an(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==r&&(this._unmodified=!1,this._pitchInRadians=r,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const t=e/180*Math.PI;this._rollInRadians!==t&&(this._unmodified=!1,this._rollInRadians=t,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return t.aY(this._fovInRadians)}setFov(e){e=t.an(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=t.ap(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const r=this.applyConstrain(this._center,e).zoom;this._zoom!==r&&(this._unmodified=!1,this._zoom=r,this._tileZoom=Math.max(0,Math.floor(r)),this._scale=t.aq(r),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,t){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=t,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,t,r){this._unmodified=!1,this._edgeInsets.interpolate(e,t,r),this.constrainInternal(),this._calcMatrices()}resize(e,t,r=!0){this._width=e,this._height=t,r&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&2===this._latRange.length&&this._lngRange&&2===this._lngRange.length?new H([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-t.ao,t.ao])}getCameraQueryGeometry(e,r){if(1===r.length)return[r[0],e];{const{minX:n,minY:i,maxX:a,maxY:o}=t.ab.fromPoints(r).extend(e);return[new t.P(n,i),new t.P(a,i),new t.P(a,o),new t.P(n,o),new t.P(n,i)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:t,zoom:r}=this.applyConstrain(this.center,this.zoom);this.setCenter(t),this.setZoom(r),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=t.ar(new Float64Array(16));t.Q(e,e,[this._width/2,-this._height/2,1]),t.O(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=t.ar(new Float64Array(16)),t.Q(e,e,[1,-1,1]),t.O(e,e,[-1,-1,0]),t.Q(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,r,n,i){const a=void 0!==n?n:this.bearing,o=i=void 0!==i?i:this.pitch,s=t.aa.fromLngLat(e,r),l=-Math.cos(t.ap(o)),c=Math.sin(t.ap(o)),u=c*Math.sin(t.ap(a)),h=-c*Math.cos(t.ap(a));let d=this.elevation;const p=r-d;let f;l*p>=0||Math.abs(l)<.1?(f=1e4,d=r+f*l):f=-p/l;let m,g,_=t.aZ(1,s.y),y=0;do{if(y+=1,y>10)break;g=f/_,m=new t.aa(s.x+u*g,s.y+h*g),_=1/m.meterInMercatorCoordinateUnits()}while(Math.abs(f-g*_)>1e-12);return{center:m.toLngLat(),elevation:d,zoom:t.at(this.height/2/Math.tan(this.fovInRadians/2)/g/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const r=t.as(1,this.center.lat)*this.worldSize,n=this.cameraToCenterDistance/r,i=t.aa.fromLngLat(this.center,this.elevation),a=ve(this.center,this.elevation,this.pitch,this.bearing,n);this._elevation=e;const o=this.calculateCenterFromCameraLngLatAlt(a.toLngLat(),t.aZ(a.z,i.y),this.bearing,this.pitch);this._elevation=o.elevation,this._center=o.center,this.setZoom(o.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=t.as(1,this.center.lat)*this.worldSize;return ve(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const r=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/r,e.canonical.y/r,1/r/t.a4,1/r/t.a4]}}class Ot{constructor(e,r){this.min=e,this.max=r,this.center=t.a_([],t.a$([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],n=t.b0(this.min),i=t.b0(this.max);for(let e=0;e<r.length;e++)n[e]=r[e]?this.min[e]:this.center[e],i[e]=r[e]?this.center[e]:this.max[e];return i[2]=this.max[2],new Ot(n,i)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let t=!0;for(let r=0;r<e.planes.length;r++){const n=this.intersectsPlane(e.planes[r]);if(0===n)return 0;1===n&&(t=!1)}return t?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let t=e[3],r=e[3];for(let n=0;n<3;n++)e[n]>0?(t+=e[n]*this.min[n],r+=e[n]*this.max[n]):(r+=e[n]*this.min[n],t+=e[n]*this.max[n]);return t>=0?2:r<0?0:1}}class Nt{distanceToTile2d(e,t,r,n){const i=n.distanceX([e,t]),a=n.distanceY([e,t]);return Math.hypot(i,a)}getWrap(e,t,r){return r}getTileBoundingVolume(e,r,n,i){var a,o;let s=0,l=0;if(null==i?void 0:i.terrain){const c=new t.a1(e.z,r,e.z,e.x,e.y),u=i.terrain.getMinMaxElevation(c);s=null!==(a=u.minElevation)&&void 0!==a?a:Math.min(0,n),l=null!==(o=u.maxElevation)&&void 0!==o?o:Math.max(0,n)}const c=1<<e.z;return new Ot([r+e.x/c,e.y/c,s],[r+(e.x+1)/c,(e.y+1)/c,l])}allowVariableZoom(e,r){const n=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,i=t.an(78.5-n/2,0,60);return!!r.terrain||e.pitch>i}allowWorldCopies(){return!0}prepareNextFrame(){}}class Vt{constructor(e,t,r){this.points=e,this.planes=t,this.aabb=r}static fromInvProjectionMatrix(e,r=1,n=0,i,a){const o=a?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],s=Math.pow(2,n),l=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(n=>function(e,r,n,i){const a=t.aG([],e,r),o=1/a[3]/n*i;return t.b5(a,a,[o,o,1/a[3],o])}(n,e,r,s));i&&function(e,r,n,i){const a=i?4:0,o=i?0:4;let s=0;const l=[],c=[];for(let r=0;r<4;r++){const n=t.b1([],e[r+o],e[r+a]),i=t.b6(n);t.a_(n,n,1/i),l.push(i),c.push(n)}for(let r=0;r<4;r++){const i=t.b7(e[r+a],c[r],n);s=null!==i&&i>=0?Math.max(s,i):Math.max(s,l[r])}const u=function(e,r){const n=t.b1([],e[r[0]],e[r[1]]),i=t.b1([],e[r[2]],e[r[1]]),a=[0,0,0,0];return t.b2(a,t.b3([],n,i)),a[3]=-t.b4(a,e[r[0]]),a}(e,r),h=function(e,r){const n=t.b8(e),i=t.b9([],e,1/n),a=t.b1([],r,t.a_([],i,t.b4(r,i))),o=t.b8(a);if(o>0){const e=Math.sqrt(1-i[3]*i[3]),n=t.a_([],i,-i[3]),s=t.a$([],n,t.a_([],a,e/o));return t.ba(r,s)}return null}(n,u);if(null!==h){const e=h/t.b4(c[0],u);s=Math.min(s,e)}for(let t=0;t<4;t++){const r=Math.min(s,l[t]);e[t+o]=[e[t+a][0]+c[t][0]*r,e[t+a][1]+c[t][1]*r,e[t+a][2]+c[t][2]*r,1]}}(l,o[0],i,a);const c=o.map(e=>{const r=t.b1([],l[e[0]],l[e[1]]),n=t.b1([],l[e[2]],l[e[1]]),i=t.b2([],t.b3([],r,n)),a=-t.b4(i,l[e[1]]);return i.concat(a)}),u=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],h=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const e of l)for(let t=0;t<3;t++)u[t]=Math.min(u[t],e[t]),h[t]=Math.max(h[t],e[t]);return new Vt(l,c,new Ot(u,h))}}class jt{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,t,r){return this._helper.interpolatePadding(e,t,r)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,t,r=!0){this._helper.resize(e,t,r)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}setConstrainOverride(e){this._helper.setConstrainOverride(e)}overrideNearFarZ(e,t){this._helper.overrideNearFarZ(e,t)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,t){}constructor(e){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(e,r)=>{r=t.an(+r,this.minZoom,this.maxZoom);const n={center:new t.V(e.lng,e.lat),zoom:r};let i=this._helper._lngRange;if(!this._helper._renderWorldCopies&&null===i){const e=180-1e-10;i=[-e,e]}const a=this.tileSize*t.aq(n.zoom);let o=0,s=a,l=0,c=a,u=0,h=0;const{x:d,y:p}=this.size;if(this._helper._latRange){const e=this._helper._latRange;o=t.X(e[1])*a,s=t.X(e[0])*a,s-o<p&&(u=p/(s-o))}i&&(l=t.W(t.Y(i[0])*a,0,a),c=t.W(t.Y(i[1])*a,0,a),c<l&&(c+=a),c-l<d&&(h=d/(c-l)));const{x:f,y:m}=me(a,e);let g,_;const y=Math.max(h||0,u||0);if(y){const e=new t.P(h?(c+l)/2:f,u?(s+o)/2:m);return n.center=ge(a,e).wrap(),n.zoom+=t.at(y),n}if(this._helper._latRange){const e=p/2;m-e<o&&(_=o+e),m+e>s&&(_=s-e)}if(i){const e=(l+c)/2;let r=f;this._helper._renderWorldCopies&&(r=t.W(f,e-a/2,e+a/2));const n=d/2;r-n<l&&(g=l+n),r+n>c&&(g=c-n)}if(void 0!==g||void 0!==_){const e=new t.P(null!=g?g:f,null!=_?_:m);n.center=ge(a,e).wrap()}return n},this.applyConstrain=(e,t)=>this._helper.applyConstrain(e,t),this._helper=new Bt({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(e,t)=>this.defaultConstrain(e,t)},e),this._coveringTilesDetailsProvider=new Nt}clone(){const e=new jt;return e.apply(this),e}apply(e,t,r){this._helper.apply(e,t,r)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const r=[new t.bb(0,e)];if(this._helper._renderWorldCopies){const n=this.screenPointToMercatorCoordinate(new t.P(0,0)),i=this.screenPointToMercatorCoordinate(new t.P(this._helper._width,0)),a=this.screenPointToMercatorCoordinate(new t.P(this._helper._width,this._helper._height)),o=this.screenPointToMercatorCoordinate(new t.P(0,this._helper._height)),s=Math.floor(Math.min(n.x,i.x,a.x,o.x)),l=Math.floor(Math.max(n.x,i.x,a.x,o.x)),c=1;for(let n=s-c;n<=l+c;n++)0!==n&&r.push(new t.bb(n,e))}return r}getCameraFrustum(){return Vt.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const t=this.screenPointToLocation(this.centerPoint,e),r=e?e.getElevationForLngLatZoom(t,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(r)}setLocationAtPoint(e,r){const n=t.as(this.elevation,this.center.lat),i=this.screenPointToMercatorCoordinateAtZ(r,n),a=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,n),o=t.aa.fromLngLat(e),s=new t.aa(o.x-(i.x-a.x),o.y-(i.y-a.y));this.setCenter(null==s?void 0:s.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,r){return r?this.coordinatePoint(t.aa.fromLngLat(e),r.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(t.aa.fromLngLat(e))}screenPointToLocation(e,t){var r;return null===(r=this.screenPointToMercatorCoordinate(e,t))||void 0===r?void 0:r.toLngLat()}screenPointToMercatorCoordinate(e,t){if(t){const r=t.pointCoordinate(e);if(null!=r)return r}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,r){const n=r||0,i=[e.x,e.y,0,1],a=[e.x,e.y,1,1];t.aG(i,i,this._pixelMatrixInverse),t.aG(a,a,this._pixelMatrixInverse);const o=i[3],s=a[3],l=i[1]/o,c=a[1]/s,u=i[2]/o,h=a[2]/s,d=u===h?0:(n-u)/(h-u);return new t.aa(t.G.number(i[0]/o,a[0]/s,d)/this.worldSize,t.G.number(l,c,d)/this.worldSize,n)}coordinatePoint(e,r=0,n=this._pixelMatrix){const i=[e.x*this.worldSize,e.y*this.worldSize,r,1];return t.aG(i,i,n),new t.P(i[0]/i[3],i[1]/i[3])}getBounds(){const e=Math.max(0,this._helper._height/2-_e(this));return(new H).extend(this.screenPointToLocation(new t.P(0,e))).extend(this.screenPointToLocation(new t.P(this._helper._width,e))).extend(this.screenPointToLocation(new t.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new t.P(0,this._helper._height)))}isPointOnMapSurface(e,t){return t?null!=t.pointCoordinate(e):e.y>this.height/2-_e(this)}calculatePosMatrix(e,r=!1,n){var i;const a=null!==(i=e.key)&&void 0!==i?i:t.bc(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),o=r?this._alignedPosMatrixCache:this._posMatrixCache;if(o.has(a)){const e=o.get(a);return n?e.f32:e.f64}const s=ye(e,this.worldSize);t.S(s,r?this._alignedProjMatrix:this._viewProjMatrix,s);const l={f64:s,f32:new Float32Array(s)};return o.set(a,l),n?l.f32:l.f64}calculateFogMatrix(e){const r=e.key,n=this._fogMatrixCacheF32;if(n.has(r))return n.get(r);const i=ye(e,this.worldSize);return t.S(i,this._fogMatrix,i),n.set(r,new Float32Array(i)),n.get(r)}calculateCenterFromCameraLngLatAlt(e,t,r,n){return this._helper.calculateCenterFromCameraLngLatAlt(e,t,r,n)}_calculateNearFarZIfNeeded(e,r,n){if(!this._helper.autoCalculateNearFarZ)return;const i=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),a=e-i*this._helper._pixelPerMeter/Math.cos(r),o=i<0?a:e,s=Math.PI/2+this.pitchInRadians,l=t.ap(this.fov)*(Math.abs(Math.cos(t.ap(this.roll)))*this.height+Math.abs(Math.sin(t.ap(this.roll)))*this.width)/this.height*(.5+n.y/this.height),c=Math.sin(l)*o/Math.sin(t.an(Math.PI-s-l,.01,Math.PI-.01)),u=_e(this),h=Math.atan(u/this._helper.cameraToCenterDistance),d=t.ap(.75),p=h>d?2*h*(.5+n.y/(2*u)):d,f=Math.sin(p)*o/Math.sin(t.an(Math.PI-s-p,.01,Math.PI-.01)),m=Math.min(c,f);this._helper._farZ=1.01*(Math.cos(Math.PI/2-r)*m+o),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,r=me(this.worldSize,this.center),n=r.x,i=r.y;this._helper._pixelPerMeter=t.as(1,this.center.lat)*this.worldSize;const a=t.ap(Math.min(this.pitch,fe)),o=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(a));let s;this._calculateNearFarZIfNeeded(o,a,e),s=new Float64Array(16),t.bd(s,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),t.aA(this._invProjMatrix,s),s[8]=2*-e.x/this._helper._width,s[9]=2*e.y/this._helper._height,this._projectionMatrix=t.be(s),t.Q(s,s,[1,-1,1]),t.O(s,s,[0,0,-this._helper.cameraToCenterDistance]),t.bf(s,s,-this.rollInRadians),t.bg(s,s,this.pitchInRadians),t.bf(s,s,-this.bearingInRadians),t.O(s,s,[-n,-i,0]),this._mercatorMatrix=t.Q([],s,[this.worldSize,this.worldSize,this.worldSize]),t.Q(s,s,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=t.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,s),t.O(s,s,[0,0,-this.elevation]),this._viewProjMatrix=s,this._invViewProjMatrix=t.aA([],s);const l=[0,0,-1,1];t.aG(l,l,this._invViewProjMatrix),this._cameraPosition=[l[0]/l[3],l[1]/l[3],l[2]/l[3]],this._fogMatrix=new Float64Array(16),t.bd(this._fogMatrix,this.fovInRadians,this.width/this.height,o,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,t.Q(this._fogMatrix,this._fogMatrix,[1,-1,1]),t.O(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),t.bf(this._fogMatrix,this._fogMatrix,-this.rollInRadians),t.bg(this._fogMatrix,this._fogMatrix,this.pitchInRadians),t.bf(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),t.O(this._fogMatrix,this._fogMatrix,[-n,-i,0]),t.Q(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),t.O(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=t.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,s);const c=this._helper._width%2/2,u=this._helper._height%2/2,h=Math.cos(this.bearingInRadians),d=Math.sin(-this.bearingInRadians),p=n-Math.round(n)+h*c+d*u,f=i-Math.round(i)+h*u+d*c,m=new Float64Array(s);if(t.O(m,m,[p>.5?p-1:p,f>.5?f-1:f,0]),this._alignedProjMatrix=m,s=t.aA(new Float64Array(16),this._pixelMatrix),!s)throw new Error("failed to invert matrix");this._pixelMatrixInverse=s,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new t.P(0,0)),r=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.aG(r,r,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=t.as(1,this.center.lat)*this.worldSize;return ve(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,r){const n=t.aa.fromLngLat(e),i=[n.x*this.worldSize,n.y*this.worldSize,r,1];return t.aG(i,i,this._viewProjMatrix),i[2]/i[3]}getProjectionData(e){const{overscaledTileID:r,aligned:n,applyTerrainMatrix:i}=e,a=this._helper.getMercatorTileCoordinates(r),o=r?this.calculatePosMatrix(r,n,!0):null;let s;return s=r&&r.terrainRttPosMatrix32f&&i?r.terrainRttPosMatrix32f:o||t.bh(),{mainMatrix:s,tileMercatorCoords:a,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:s}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,t,r){return 1}transformLightDirection(e){return t.b0(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,r,n,i){const a=this.calculatePosMatrix(n);let o;i?(o=[e,r,i(e,r),1],t.aG(o,o,a)):(o=[e,r,0,1],Je(o,o,a));const s=o[3];return{point:new t.P(o[0]/s,o[1]/s),signedDistanceFromCamera:s,isOccluded:!1}}populateCache(e){for(const t of e)this.calculatePosMatrix(t)}getMatrixForModel(e,r){const n=t.aa.fromLngLat(e,r),i=n.meterInMercatorCoordinateUnits(),a=t.bi();return t.O(a,a,[n.x,n.y,n.z]),t.bf(a,a,Math.PI),t.bg(a,a,Math.PI/2),t.Q(a,a,[-i,i,i]),a}getProjectionDataForCustomLayer(e=!0){const r=new t.a1(0,0,0,0,0),n=this.getProjectionData({overscaledTileID:r,applyGlobeMatrix:e}),i=ye(r,this.worldSize);t.S(i,this._viewProjMatrix,i),n.tileMercatorCoords=[0,0,1,1];const a=[t.a4,t.a4,this.worldSize/this._helper.pixelsPerMeter],o=t.bj();return t.Q(o,i,a),n.fallbackMatrix=o,n.mainMatrix=o,n}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function Ut(){t.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Gt(e){if(e.useSlerp)if(e.k<1){const r=t.bk(e.startEulerAngles.roll,e.startEulerAngles.pitch,e.startEulerAngles.bearing),n=t.bk(e.endEulerAngles.roll,e.endEulerAngles.pitch,e.endEulerAngles.bearing),i=new Float64Array(4);t.bl(i,r,n,e.k);const a=t.bm(i);e.tr.setRoll(a.roll),e.tr.setPitch(a.pitch),e.tr.setBearing(a.bearing)}else e.tr.setRoll(e.endEulerAngles.roll),e.tr.setPitch(e.endEulerAngles.pitch),e.tr.setBearing(e.endEulerAngles.bearing);else e.tr.setRoll(t.G.number(e.startEulerAngles.roll,e.endEulerAngles.roll,e.k)),e.tr.setPitch(t.G.number(e.startEulerAngles.pitch,e.endEulerAngles.pitch,e.k)),e.tr.setBearing(t.G.number(e.startEulerAngles.bearing,e.endEulerAngles.bearing,e.k))}function qt(e,r,n,i,a){const o=a.padding,s=me(a.worldSize,n.getNorthWest()),l=me(a.worldSize,n.getNorthEast()),c=me(a.worldSize,n.getSouthEast()),u=me(a.worldSize,n.getSouthWest()),h=t.ap(-i),d=s.rotate(h),p=l.rotate(h),f=c.rotate(h),m=u.rotate(h),g=new t.P(Math.max(d.x,p.x,m.x,f.x),Math.max(d.y,p.y,m.y,f.y)),_=new t.P(Math.min(d.x,p.x,m.x,f.x),Math.min(d.y,p.y,m.y,f.y)),y=g.sub(_),v=(a.width-(o.left+o.right+r.left+r.right))/y.x,b=(a.height-(o.top+o.bottom+r.top+r.bottom))/y.y;if(b<0||v<0)return void Ut();const x=Math.min(t.at(a.scale*Math.min(v,b)),e.maxZoom),w=t.P.convert(e.offset),T=new t.P((r.left-r.right)/2,(r.top-r.bottom)/2).rotate(t.ap(i)),S=w.add(T).mult(a.scale/t.aq(x));return{center:ge(a.worldSize,s.add(c).div(2).sub(S)),zoom:x,bearing:i}}class $t{get useGlobeControls(){return!1}handlePanInertia(e,t){const r=e.mag(),n=Math.abs(_e(t));return{easingOffset:e.mult(Math.min(.75*n/r,1)),easingCenter:t.center}}handleMapControlsRollPitchBearingZoom(e,t){e.bearingDelta&&t.setBearing(t.bearing+e.bearingDelta),e.pitchDelta&&t.setPitch(t.pitch+e.pitchDelta),e.rollDelta&&t.setRoll(t.roll+e.rollDelta),e.zoomDelta&&t.setZoom(t.zoom+e.zoomDelta)}handleMapControlsPan(e,t,r){e.around.distSqr(t.centerPoint)<.01||t.setLocationAtPoint(r,e.around)}cameraForBoxAndBearing(e,t,r,n,i){return qt(e,t,r,n,i)}handleJumpToCenterZoom(e,r){e.zoom!==(void 0!==r.zoom?+r.zoom:e.zoom)&&e.setZoom(+r.zoom),void 0!==r.center&&e.setCenter(t.V.convert(r.center))}handleEaseTo(e,r){const n=e.zoom,i=e.padding,a={roll:e.roll,pitch:e.pitch,bearing:e.bearing},o={roll:void 0===r.roll?e.roll:r.roll,pitch:void 0===r.pitch?e.pitch:r.pitch,bearing:void 0===r.bearing?e.bearing:r.bearing},s=void 0!==r.zoom,l=!e.isPaddingEqual(r.padding);let c=!1;const u=s?+r.zoom:e.zoom;let h=e.centerPoint.add(r.offsetAsPoint);const d=e.screenPointToLocation(h),{center:p,zoom:f}=e.applyConstrain(t.V.convert(r.center||d),null!=u?u:n);Rt(e,p);const m=me(e.worldSize,d),g=me(e.worldSize,p).sub(m),_=t.aq(f-n);return c=f!==n,{easeFunc:s=>{if(c&&e.setZoom(t.G.number(n,f,s)),t.bn(a,o)||Gt({startEulerAngles:a,endEulerAngles:o,tr:e,k:s,useSlerp:a.roll!=o.roll}),l&&(e.interpolatePadding(i,r.padding,s),h=e.centerPoint.add(r.offsetAsPoint)),r.around)e.setLocationAtPoint(r.around,r.aroundPoint);else{const r=t.aq(e.zoom-n),i=f>n?Math.min(2,_):Math.max(.5,_),a=Math.pow(i,1-s),o=ge(e.worldSize,m.add(g.mult(s*a)).mult(r));e.setLocationAtPoint(e.renderWorldCopies?o.wrap():o,h)}},isZooming:c,elevationCenter:p}}handleFlyTo(e,r){const n=void 0!==r.zoom,i=e.zoom,a=e.applyConstrain(t.V.convert(r.center||r.locationAtOffset),n?+r.zoom:i),o=a.center,s=a.zoom;Rt(e,o);const l=me(e.worldSize,r.locationAtOffset),c=me(e.worldSize,o).sub(l),u=c.mag(),h=t.aq(s-i);let d;if(void 0!==r.minZoom){const n=Math.min(+r.minZoom,i,s),a=e.applyConstrain(o,n).zoom;d=t.aq(a-i)}return{easeFunc:(r,n,a,u)=>{e.setZoom(1===r?s:i+t.at(n));const h=1===r?o:ge(e.worldSize,l.add(c.mult(a)).mult(n));e.setLocationAtPoint(e.renderWorldCopies?h.wrap():h,u)},scaleOfZoom:h,targetCenter:o,scaleOfMinZoom:d,pixelPathLength:u}}}class Zt{constructor(e,t,r){this.blendFunction=e,this.blendColor=t,this.mask=r}}Zt.Replace=[1,0],Zt.disabled=new Zt(Zt.Replace,t.bo.transparent,[!1,!1,!1,!1]),Zt.unblended=new Zt(Zt.Replace,t.bo.transparent,[!0,!0,!0,!0]),Zt.alphaBlended=new Zt([1,771],t.bo.transparent,[!0,!0,!0,!0]);const Ht=2305;class Wt{constructor(e,t,r){this.enable=e,this.mode=t,this.frontFace=r}}Wt.disabled=new Wt(!1,1029,Ht),Wt.backCCW=new Wt(!0,1029,Ht),Wt.frontCCW=new Wt(!0,1028,Ht);class Xt{constructor(e,t,r){this.func=e,this.mask=t,this.range=r}}Xt.ReadOnly=!1,Xt.ReadWrite=!0,Xt.disabled=new Xt(519,Xt.ReadOnly,[0,1]);const Yt=7680;class Kt{constructor(e,t,r,n,i,a){this.test=e,this.ref=t,this.mask=r,this.fail=n,this.depthFail=i,this.pass=a}}Kt.disabled=new Kt({func:519,mask:0},0,0,Yt,Yt,Yt);const Qt=new WeakMap;function Jt(e){var t;if(Qt.has(e))return Qt.get(e);{const r=null===(t=e.getParameter(e.VERSION))||void 0===t?void 0:t.startsWith("WebGL 2.0");return Qt.set(e,r),r}}class er{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const r=e.context,n=r.gl;this._texFormat=n.RGBA,this._texType=n.UNSIGNED_BYTE;const i=new t.aV;i.emplaceBack(-1,-1),i.emplaceBack(2,-1),i.emplaceBack(-1,2);const a=new t.aX;a.emplaceBack(0,1,2),this._fullscreenTriangle=new kt(r.createVertexBuffer(i,It.members),r.createIndexBuffer(a),t.aW.simpleSegment(0,0,i.length,a.length)),this._resultBuffer=new Uint8Array(4),r.activeTexture.set(n.TEXTURE1);const o=n.createTexture();n.bindTexture(n.TEXTURE_2D,o),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texImage2D(n.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=r.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(o),Jt(n)&&(this._pbo=n.createBuffer(),n.bindBuffer(n.PIXEL_PACK_BUFFER,this._pbo),n.bufferData(n.PIXEL_PACK_BUFFER,4,n.STREAM_READ),n.bindBuffer(n.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,t){const r=this._updateCount;return this._readbackQueue?r>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():r>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,t),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,t=e.gl;e.activeTexture.set(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,r){const n=this._cachedRenderContext.context,i=n.gl;if(this._bindFramebuffer(),n.viewport.set([0,0,this._texWidth,this._texHeight]),n.clear({color:t.bo.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(n,i.TRIANGLES,Xt.disabled,Kt.disabled,Zt.unblended,Wt.disabled,((e,t)=>({u_input:e,u_output_expected:t}))(e,r),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Jt(i)){i.bindBuffer(i.PIXEL_PACK_BUFFER,this._pbo),i.readBuffer(i.COLOR_ATTACHMENT0),i.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),i.bindBuffer(i.PIXEL_PACK_BUFFER,null);const e=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);i.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:e}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Jt(e)){const r=e.clientWaitSync(this._readbackQueue.sync,0,0);if(r===e.WAIT_FAILED)return t.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(r===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=er._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let t=0;return t+=e[0]/256,t+=e[1]/65536,t+=e[2]/16777216,e[3]<127&&(t=-t),t/128}}const tr=t.a4/128;function rr(e,r){const n=void 0!==e.granularity?Math.max(e.granularity,1):1,i=n+(e.generateBorders?2:0),a=n+(e.extendToNorthPole||e.generateBorders?1:0)+(e.extendToSouthPole||e.generateBorders?1:0),o=i+1,s=a+1,l=e.generateBorders?-1:0,c=e.generateBorders||e.extendToNorthPole?-1:0,u=n+(e.generateBorders?1:0),h=n+(e.generateBorders||e.extendToSouthPole?1:0),d=o*s,p=i*a*6,f=o*s>65536;if(f&&"16bit"===r)throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const m=f||"32bit"===r,g=new Int16Array(2*d);let _=0;for(let r=c;r<=h;r++)for(let i=l;i<=u;i++){let a=i/n*t.a4;-1===i&&(a=-tr),i===n+1&&(a=t.a4+tr);let o=r/n*t.a4;-1===r&&(o=e.extendToNorthPole?t.bq:-tr),r===n+1&&(o=e.extendToSouthPole?t.br:t.a4+tr),g[_++]=a,g[_++]=o}const y=m?new Uint32Array(p):new Uint16Array(p);let v=0;for(let e=0;e<a;e++)for(let t=0;t<i;t++){const r=t+1+e*o,n=t+(e+1)*o,i=t+1+(e+1)*o;y[v++]=t+e*o,y[v++]=n,y[v++]=r,y[v++]=r,y[v++]=n,y[v++]=i}return{vertices:g.buffer.slice(0),indices:y.buffer.slice(0),uses32bitIndices:m}}const nr=new t.aU({fill:new t.bs(128,2),line:new t.bs(512,0),tile:new t.bs(128,32),stencil:new t.bs(128,1),circle:3});class ir{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Ct.projectionGlobe}get vertexShaderPreludeCode(){return Ct.projectionMercator.vertexSource}get subdivisionGranularity(){return nr}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new er(e));const r=t.X(this._errorQueryLatitudeDegrees),n=2*Math.atan(Math.exp(Math.PI-r*Math.PI*2))-.5*Math.PI,i=this._errorMeasurement.updateErrorLoop(r,n),a=c();i!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=i,this._errorMeasurementLastChangeTime=a);const o=Math.min(Math.max((a-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=t.bt(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,t.bu(o))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,t,r,n,i){const a=("stencil"===i?nr.stencil:nr.tile).getGranularityForZoomLevel(t.z);return this._getMesh(e,{granularity:a,generateBorders:r,extendToNorthPole:0===t.y&&n,extendToSouthPole:t.y===(1<<t.z)-1&&n})}_getMesh(e,r){const n=this._getMeshKey(r);if(n in this._tileMeshCache)return this._tileMeshCache[n];const i=function(e,r){const n=rr(r,"16bit"),i=t.aV.deserialize({arrayBuffer:n.vertices,length:n.vertices.byteLength/2/2}),a=t.aX.deserialize({arrayBuffer:n.indices,length:n.indices.byteLength/2/3});return new kt(e.createVertexBuffer(i,It.members),e.createIndexBuffer(a),t.aW.simpleSegment(0,0,i.length,a.length))}(e,r);return this._tileMeshCache[n]=i,i}recalculate(e){}hasTransition(){const e=c();let t=!1;return t=t||(e-this._errorMeasurementLastChangeTime)/1e3<.7,t=t||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,t}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const ar=new t.t({type:new t.D(t.u.projection.type)});class or extends t.E{constructor(e){super(),this._transitionable=new t.x(ar,void 0),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new t.H(0)),this._mercatorProjection=new Dt,this._verticalPerspectiveProjection=new ir}get transitionState(){const e=this.properties.get("type");if("string"==typeof e&&"mercator"===e)return 0;if("string"==typeof e&&"vertical-perspective"===e)return 1;if(e instanceof t.bv){if("vertical-perspective"===e.from&&"mercator"===e.to)return 1-e.transition;if("mercator"===e.from&&"vertical-perspective"===e.to)return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,t,r,n,i){return this.currentProjection.getMeshFromTileID(e,t,r,n,i)}setProjection(e){this._transitionable.setValue("type",(null==e?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function sr(e){const t=ur(e.worldSize,e.center.lat);return 2*Math.PI*t}function lr(e,r,n,i,a){const o=1/(1<<a),s=r/t.a4*o+i*o,l=t.bx((e/t.a4*o+n*o)*Math.PI*2+Math.PI,2*Math.PI),c=2*Math.atan(Math.exp(Math.PI-s*Math.PI*2))-.5*Math.PI,u=Math.cos(c),h=new Float64Array(3);return h[0]=Math.sin(l)*u,h[1]=Math.sin(c),h[2]=Math.cos(l)*u,h}function cr(e){return function(e,t){const r=Math.cos(t),n=new Float64Array(3);return n[0]=Math.sin(e)*r,n[1]=Math.sin(t),n[2]=Math.cos(e)*r,n}(e.lng*Math.PI/180,e.lat*Math.PI/180)}function ur(e,t){return e/(2*Math.PI)/Math.cos(t*Math.PI/180)}function hr(e){const r=Math.asin(e[1])/Math.PI*180,n=Math.sqrt(e[0]*e[0]+e[2]*e[2]);if(n>1e-6){const i=e[0]/n,a=Math.acos(e[2]/n),o=(i>0?a:-a)/Math.PI*180;return new t.V(t.W(o,-180,180),r)}return new t.V(0,r)}function dr(e){return Math.cos(e*Math.PI/180)}function pr(e,r){const n=dr(e),i=dr(r);return t.at(i/n)}function fr(e,r){const n=e.rotate(r.bearingInRadians),i=r.zoom+pr(r.center.lat,0),a=t.bt(1/dr(r.center.lat),1/dr(Math.min(Math.abs(r.center.lat),60)),t.bw(i,7,3,0,1)),o=360/sr({worldSize:r.worldSize,center:{lat:r.center.lat}});return new t.V(r.center.lng-n.x*o*a,t.an(r.center.lat+n.y*o,-t.ao,t.ao))}function mr(e){const t=.5*e,r=Math.sin(t),n=Math.cos(t);return Math.log(r+n)-Math.log(n-r)}function gr(e,r,n,i){const a=e.lat+n*i;if(Math.abs(n)>1){const o=(Math.sign(e.lat+n)!==Math.sign(e.lat)?-Math.abs(e.lat):Math.abs(e.lat))*Math.PI/180,s=Math.abs(e.lat+n)*Math.PI/180,l=mr(o+i*(s-o)),c=mr(o),u=mr(s);return new t.V(e.lng+r*((l-c)/(u-c)),a)}return new t.V(e.lng+r*i,a)}class _r{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=e}swapBuffers(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(e,t,r,n){const i=`${e.z}_${e.x}_${e.y}_${(null==n?void 0:n.terrain)?"t":""}`,a=this._cache.get(i);if(a)return a;const o=this._cachePrevious.get(i);if(o)return this._cache.set(i,o),o;const s=this._boundingVolumeFactory(e,t,r,n);return this._cache.set(i,s),this._hadAnyChanges=!0,s}}class yr{constructor(e,t,r,n){this.min=r,this.max=n,this.points=e,this.planes=t}static fromAabb(e,t){const r=[];for(let n=0;n<8;n++)r.push([1&~n?e[0]:t[0],1==(n>>1&1)?t[1]:e[1],1==(n>>2&1)?t[2]:e[2]]);return new yr(r,[[-1,0,0,t[0]],[1,0,0,-e[0]],[0,-1,0,t[1]],[0,1,0,-e[1]],[0,0,-1,t[2]],[0,0,1,-e[2]]],e,t)}static fromCenterSizeAngles(e,r,n){const i=t.bA([],n[0],n[1],n[2]),a=t.bB([],[r[0],0,0],i),o=t.bB([],[0,r[1],0],i),s=t.bB([],[0,0,r[2]],i),l=[...e],c=[...e];for(let t=0;t<8;t++)for(let r=0;r<3;r++){const n=e[r]+a[r]*(1&~t?-1:1)+o[r]*(1==(t>>1&1)?1:-1)+s[r]*(1==(t>>2&1)?1:-1);l[r]=Math.min(l[r],n),c[r]=Math.max(c[r],n)}const u=[];for(let r=0;r<8;r++){const n=[...e];t.a$(n,n,t.a_([],a,1&~r?-1:1)),t.a$(n,n,t.a_([],o,1==(r>>1&1)?1:-1)),t.a$(n,n,t.a_([],s,1==(r>>2&1)?1:-1)),u.push(n)}return new yr(u,[[...a,-t.b4(a,u[0])],[...o,-t.b4(o,u[0])],[...s,-t.b4(s,u[0])],[-a[0],-a[1],-a[2],-t.b4(a,u[7])],[-o[0],-o[1],-o[2],-t.b4(o,u[7])],[-s[0],-s[1],-s[2],-t.b4(s,u[7])]],l,c)}intersectsFrustum(e){let t=!0;const r=this.points.length,n=this.planes.length,i=e.planes.length,a=e.points.length;for(let n=0;n<i;n++){const i=e.planes[n];let a=0;for(let e=0;e<r;e++){const t=this.points[e];i[0]*t[0]+i[1]*t[1]+i[2]*t[2]+i[3]>=0&&a++}if(0===a)return 0;a<r&&(t=!1)}if(t)return 2;for(let t=0;t<n;t++){const r=this.planes[t];let n=0;for(let t=0;t<a;t++){const i=e.points[t];r[0]*i[0]+r[1]*i[1]+r[2]*i[2]+r[3]>=0&&n++}if(0===n)return 0}return 1}intersectsPlane(e){const t=this.points.length;let r=0;for(let n=0;n<t;n++){const t=this.points[n];e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]>=0&&r++}return r===t?2:0===r?0:1}}function vr(e,t,r){const n=e-t;return n<0?-n:Math.max(0,n-r)}function br(e,t,r,n,i){const a=e-r;let o;return o=a<0?Math.min(-a,1+a-i):a>1?Math.min(Math.max(a-i,0),1-a):0,Math.max(o,vr(t,n,i))}class xr{constructor(){this._boundingVolumeCache=new _r(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(e,t,r,n){const i=1<<r.z,a=1/i,o=r.x/i,s=r.y/i;let l=2;return l=Math.min(l,br(e,t,o,s,a)),l=Math.min(l,br(e,t,o+.5,-s-a,a)),l=Math.min(l,br(e,t,o+.5,2-s-a,a)),l}getWrap(e,t,r){const n=1<<t.z,i=1/n,a=t.x/n,o=vr(e.x,a,i),s=vr(e.x,a-1,i),l=vr(e.x,a+1,i),c=Math.min(o,s,l);return c===l?1:c===s?-1:0}allowVariableZoom(e,t){return Se(e,t)>4}allowWorldCopies(){return!1}getTileBoundingVolume(e,t,r,n){return this._boundingVolumeCache.getTileBoundingVolume(e,t,r,n)}_computeTileBoundingVolume(e,r,n,i){var a,o;let s=0,l=0;if(null==i?void 0:i.terrain){const c=new t.a1(e.z,r,e.z,e.x,e.y),u=i.terrain.getMinMaxElevation(c);s=null!==(a=u.minElevation)&&void 0!==a?a:Math.min(0,n),l=null!==(o=u.maxElevation)&&void 0!==o?o:Math.max(0,n)}if(s/=t.bD,l/=t.bD,s+=1,l+=1,e.z<=0)return yr.fromAabb([-l,-l,-l],[l,l,l]);if(1===e.z)return yr.fromAabb([0===e.x?-l:0,0===e.y?0:-l,-l],[0===e.x?0:l,0===e.y?l:0,l]);{const r=[lr(0,0,e.x,e.y,e.z),lr(t.a4,0,e.x,e.y,e.z),lr(t.a4,t.a4,e.x,e.y,e.z),lr(0,t.a4,e.x,e.y,e.z)],n=[];for(const e of r)n.push(t.a_([],e,l));if(l!==s)for(const e of r)n.push(t.a_([],e,s));0===e.y&&n.push([0,1,0]),e.y===(1<<e.z)-1&&n.push([0,-1,0]);const i=[1,1,1],a=[-1,-1,-1];for(const e of n)for(let t=0;t<3;t++)i[t]=Math.min(i[t],e[t]),a[t]=Math.max(a[t],e[t]);const o=lr(t.a4/2,t.a4/2,e.x,e.y,e.z),c=t.b3([],[0,1,0],o);t.b2(c,c);const u=t.b3([],o,c);t.b2(u,u);const h=t.b3([],r[2],r[1]);t.b2(h,h);const d=t.b3([],r[0],r[3]);t.b2(d,d),n.push(t.a_([],o,l)),e.y>=(1<<e.z)/2&&n.push(t.a_([],lr(t.a4/2,0,e.x,e.y,e.z),l)),e.y<(1<<e.z)/2&&n.push(t.a_([],lr(t.a4/2,t.a4,e.x,e.y,e.z),l));const p=wr(o,n),f=wr(u,n),m=[-o[0],-o[1],-o[2],p.max],g=[o[0],o[1],o[2],-p.min],_=[-u[0],-u[1],-u[2],f.max],y=[u[0],u[1],u[2],-f.min],v=[...h,0],b=[...d,0],x=[];return 0===e.y?x.push(t.bC(b,v,m),t.bC(b,v,g)):x.push(t.bC(_,v,m),t.bC(_,v,g),t.bC(_,b,m),t.bC(_,b,g)),e.y===(1<<e.z)-1?x.push(t.bC(b,v,m),t.bC(b,v,g)):x.push(t.bC(y,v,m),t.bC(y,v,g),t.bC(y,b,m),t.bC(y,b,g)),new yr(x,[m,g,_,y,v,b],i,a)}}}function wr(e,r){let n=1/0,i=-1/0;for(const a of r){const r=t.b4(e,a);n=Math.min(n,r),i=Math.max(i,r)}return{min:n,max:i}}class Tr{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,t,r){return this._helper.interpolatePadding(e,t,r)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,t){this._helper.resize(e,t)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}setConstrainOverride(e){this._helper.setConstrainOverride(e)}overrideNearFarZ(e,t){this._helper.overrideNearFarZ(e,t)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(e){this._cachedClippingPlane=t.bE(),this._projectionMatrix=t.bi(),this._globeViewProjMatrix32f=t.bh(),this._globeViewProjMatrixNoCorrection=t.bi(),this._globeViewProjMatrixNoCorrectionInverted=t.bi(),this._globeProjMatrixInverted=t.bi(),this._cameraPosition=t.by(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(e,r)=>{const n=t.an(e.lat,-t.ao,t.ao),i=t.an(+r,this.minZoom+pr(0,n),this.maxZoom);return{center:new t.V(e.lng,n),zoom:i}},this.applyConstrain=(e,t)=>this._helper.applyConstrain(e,t),this._helper=new Bt({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(e,t)=>this.defaultConstrain(e,t)},e),this._coveringTilesDetailsProvider=new xr}clone(){const e=new Tr;return e.apply(this),e}apply(e,t){this._globeLatitudeErrorCorrectionRadians=t||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=t.by();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:t,applyGlobeMatrix:r}=e,n=this._helper.getMercatorTileCoordinates(t);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:n,clippingPlane:this._cachedClippingPlane,projectionTransition:r?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const r=this.pitchInRadians,n=this.cameraToCenterDistance/e,i=Math.sin(r)*n,a=Math.cos(r)*n+1,o=1/Math.sqrt(i*i+a*a)*1;let s=-i,l=a;const c=Math.sqrt(s*s+l*l);s/=c,l/=c;const u=[0,s,l];t.bF(u,u,[0,0,0],-this.bearingInRadians),t.bG(u,u,[0,0,0],-1*this.center.lat*Math.PI/180),t.bH(u,u,[0,0,0],this.center.lng*Math.PI/180);const h=1/t.b6(u);return t.a_(u,u,h),[...u,-o*h]}isLocationOccluded(e){return!this.isSurfacePointVisible(cr(e))}transformLightDirection(e){const r=this._helper._center.lng*Math.PI/180,n=this._helper._center.lat*Math.PI/180,i=Math.cos(n),a=[Math.sin(r)*i,Math.sin(n),Math.cos(r)*i],o=[a[2],0,-a[0]],s=[0,0,0];t.b3(s,o,a),t.b2(o,o),t.b2(s,s);const l=[0,0,0];return t.b2(l,[o[0]*e[0]+s[0]*e[1]+a[0]*e[2],o[1]*e[0]+s[1]*e[1]+a[1]*e[2],o[2]*e[0]+s[2]*e[1]+a[2]*e[2]]),l}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,r,n){const i=function(e,r,n){const i=1/(1<<n.z);return new t.aa(e/t.a4*i+n.x*i,r/t.a4*i+n.y*i)}(e,r,n.canonical),a=(o=i.y,[t.bx(i.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-o*Math.PI*2))-.5*Math.PI]);var o;return this.getCircleRadiusCorrection()/Math.cos(a[1])}projectTileCoordinates(e,r,n,i){const a=n.canonical,o=lr(e,r,a.x,a.y,a.z),s=1+(i?i(e,r):0)/t.bD,l=[o[0]*s,o[1]*s,o[2]*s,1];t.aG(l,l,this._globeViewProjMatrixNoCorrection);const c=this._cachedClippingPlane,u=c[0]*o[0]+c[1]*o[1]+c[2]*o[2]+c[3]<0;return{point:new t.P(l[0]/l[3],l[1]/l[3]),signedDistanceFromCamera:l[3],isOccluded:u}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=ur(this.worldSize,this.center.lat),r=t.bj(),n=t.bj();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),t.bd(r,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const i=this.centerOffset;r[8]=2*-i.x/this._helper._width,r[9]=2*i.y/this._helper._height,this._projectionMatrix=t.be(r),this._globeProjMatrixInverted=t.bj(),t.aA(this._globeProjMatrixInverted,r),t.O(r,r,[0,0,-this.cameraToCenterDistance]),t.bf(r,r,this.rollInRadians),t.bg(r,r,-this.pitchInRadians),t.bf(r,r,this.bearingInRadians),t.O(r,r,[0,0,-e]);const a=t.by();a[0]=e,a[1]=e,a[2]=e,t.bg(n,r,this.center.lat*Math.PI/180),t.bI(n,n,-this.center.lng*Math.PI/180),t.Q(n,n,a),this._globeViewProjMatrixNoCorrection=n,t.bg(r,r,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),t.bI(r,r,-this.center.lng*Math.PI/180),t.Q(r,r,a),this._globeViewProjMatrix32f=new Float32Array(r),this._globeViewProjMatrixNoCorrectionInverted=t.bj(),t.aA(this._globeViewProjMatrixNoCorrectionInverted,n);const o=t.by();this._cameraPosition=t.by(),this._cameraPosition[2]=this.cameraToCenterDistance/e,t.bF(this._cameraPosition,this._cameraPosition,o,-this.rollInRadians),t.bG(this._cameraPosition,this._cameraPosition,o,this.pitchInRadians),t.bF(this._cameraPosition,this._cameraPosition,o,-this.bearingInRadians),t.a$(this._cameraPosition,this._cameraPosition,[0,0,1]),t.bG(this._cameraPosition,this._cameraPosition,o,-this.center.lat*Math.PI/180),t.bH(this._cameraPosition,this._cameraPosition,o,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const s=t.be(this._globeViewProjMatrixNoCorrectionInverted);t.Q(s,s,[1,1,-1]),this._cachedFrustum=Vt.fromInvProjectionMatrix(s,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(e){t.w("calculateFogMatrix is not supported on globe projection.");const r=t.bj();return t.ar(r),r}getVisibleUnwrappedCoordinates(e){return[new t.bb(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&t.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){if(!this._globeViewProjMatrixNoCorrection)return 1;const n=cr(e);t.a_(n,n,1+r/t.bD);const i=t.bE();return t.aG(i,[n[0],n[1],n[2],1],this._globeViewProjMatrixNoCorrection),i[2]/i[3]}populateCache(e){}getBounds(){const e=.5*this.width,r=.5*this.height,n=[new t.P(0,0),new t.P(e,0),new t.P(this.width,0),new t.P(this.width,r),new t.P(this.width,this.height),new t.P(e,this.height),new t.P(0,this.height),new t.P(0,r)],i=[];for(const e of n)i.push(this.unprojectScreenPoint(e));let a=0,o=0,s=0,l=0;const c=this.center;for(const e of i){const r=t.bJ(c.lng,e.lng),n=t.bJ(c.lat,e.lat);r<o&&(o=r),r>a&&(a=r),n<l&&(l=n),n>s&&(s=n)}const u=[c.lng+o,c.lat+l,c.lng+a,c.lat+s];return this.isSurfacePointOnScreen([0,1,0])&&(u[3]=90,u[0]=-180,u[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(u[1]=-90,u[0]=-180,u[2]=180),new H(u)}calculateCenterFromCameraLngLatAlt(e,t,r,n){return this._helper.calculateCenterFromCameraLngLatAlt(e,t,r,n)}setLocationAtPoint(e,r){const n=cr(this.unprojectScreenPoint(r)),i=cr(e),a=t.by();t.bK(a);const o=t.by();t.bH(o,n,a,-this.center.lng*Math.PI/180),t.bG(o,o,a,this.center.lat*Math.PI/180);const s=i[0]*i[0]+i[2]*i[2],l=o[0]*o[0];if(s<l)return;const c=Math.sqrt(s-l),u=-c,h=t.bL(i[0],i[2],o[0],c),d=t.bL(i[0],i[2],o[0],u),p=t.by();t.bH(p,i,a,-h);const f=t.bL(p[1],p[2],o[1],o[2]),m=t.by();t.bH(m,i,a,-d);const g=t.bL(m[1],m[2],o[1],o[2]),_=.5*Math.PI,y=f>=-_&&f<=_,v=g>=-_&&g<=_;let b,x;if(y&&v){const e=this.center.lng*Math.PI/180,r=this.center.lat*Math.PI/180;t.bM(h,e)+t.bM(f,r)<t.bM(d,e)+t.bM(g,r)?(b=h,x=f):(b=d,x=g)}else if(y)b=h,x=f;else{if(!v)return;b=d,x=g}const w=b/Math.PI*180,T=x/Math.PI*180,S=this.center.lat;this.setCenter(new t.V(w,t.an(T,-90,90))),this.setZoom(this.zoom+pr(S,this.center.lat))}locationToScreenPoint(e,r){const n=cr(e);if(r){const i=r.getElevationForLngLatZoom(e,this._helper._tileZoom);t.a_(n,n,1+i/t.bD)}return this._projectSurfacePointToScreen(n)}_projectSurfacePointToScreen(e){const r=t.bE();return t.aG(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],new t.P((.5*r[0]+.5)*this.width,(.5*-r[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,r){if(r){const t=r.pointCoordinate(e);if(t)return t}return t.aa.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,t){var r;return null===(r=this.screenPointToMercatorCoordinate(e,t))||void 0===r?void 0:r.toLngLat()}isPointOnMapSurface(e,t){const r=this._cameraPosition,n=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(r,n)}getRayDirectionFromPixel(e){const r=t.bE();r[0]=e.x/this.width*2-1,r[1]=-1*(e.y/this.height*2-1),r[2]=1,r[3]=1,t.aG(r,r,this._globeViewProjMatrixNoCorrectionInverted),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3];const n=t.by();n[0]=r[0]-this._cameraPosition[0],n[1]=r[1]-this._cameraPosition[1],n[2]=r[2]-this._cameraPosition[2];const i=t.by();return t.b2(i,n),i}isSurfacePointVisible(e){const t=this._cachedClippingPlane;return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const r=t.bE();return t.aG(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3],r[0]>-1&&r[0]<1&&r[1]>-1&&r[1]<1&&r[2]>-1&&r[2]<1}rayPlanetIntersection(e,r){const n=t.b4(e,r),i=t.by(),a=t.by();t.a_(a,r,n),t.b1(i,e,a);const o=1-t.b4(i,i);if(o<0)return null;const s=t.b4(e,e)-1,l=-n+(n<0?1:-1)*Math.sqrt(o),c=s/l,u=l;return{tMin:Math.min(c,u),tMax:Math.max(c,u)}}unprojectScreenPoint(e){const r=this._cameraPosition,n=this.getRayDirectionFromPixel(e),i=this.rayPlanetIntersection(r,n);if(i){const e=t.by();t.a$(e,r,[n[0]*i.tMin,n[1]*i.tMin,n[2]*i.tMin]);const a=t.by();return t.b2(a,e),hr(a)}const a=this._cachedClippingPlane,o=a[0]*n[0]+a[1]*n[1]+a[2]*n[2],s=-t.ba(a,r)/o,l=t.by();if(s>0)t.a$(l,r,[n[0]*s,n[1]*s,n[2]*s]);else{const e=t.by();t.a$(e,r,[2*n[0],2*n[1],2*n[2]]);const i=t.ba(this._cachedClippingPlane,e);t.b1(l,e,[this._cachedClippingPlane[0]*i,this._cachedClippingPlane[1]*i,this._cachedClippingPlane[2]*i])}const c=function(e){const r=t.by();return r[0]=e[0]*-e[3],r[1]=e[1]*-e[3],r[2]=e[2]*-e[3],{center:r,radius:Math.sqrt(1-e[3]*e[3])}}(a);return hr(function(e,r,n){const i=t.by();t.b1(i,n,e);const a=t.by();return t.bz(a,e,i,r/t.b8(i)),a}(c.center,c.radius,l))}getMatrixForModel(e,r){const n=t.V.convert(e),i=1/t.bD,a=t.bi();return t.bI(a,a,n.lng/180*Math.PI),t.bg(a,a,-n.lat/180*Math.PI),t.O(a,a,[0,0,1+r/t.bD]),t.bg(a,a,.5*Math.PI),t.Q(a,a,[i,i,i]),a}getProjectionDataForCustomLayer(e=!0){const r=this.getProjectionData({overscaledTileID:new t.a1(0,0,0,0,0),applyGlobeMatrix:e});return r.tileMercatorCoords=[0,0,1,1],r}getFastPathSimpleProjectionMatrix(e){}}class Sr{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,t,r){return this._helper.interpolatePadding(e,t,r)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,t,r=!0){this._helper.resize(e,t,r)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}setConstrainOverride(e){this._helper.setConstrainOverride(e)}overrideNearFarZ(e,t){this._helper.overrideNearFarZ(e,t)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,t){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=t,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(e){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(e,t)=>this.currentTransform.defaultConstrain(e,t),this.applyConstrain=(e,t)=>this._helper.applyConstrain(e,t),this._helper=new Bt({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(e,t)=>this.defaultConstrain(e,t)},e),this._globeness=1,this._mercatorTransform=new jt,this._verticalPerspectiveTransform=new Tr}clone(){const e=new Sr;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const t=this._mercatorTransform.getProjectionData(e),r=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?r.mainMatrix:t.mainMatrix,clippingPlane:r.clippingPlane,tileMercatorCoords:r.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:t.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return t.bt(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return t.bt(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,r,n){const i=this._mercatorTransform.getPitchedTextCorrection(e,r,n),a=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,r,n);return t.bt(i,a,this._globeness)}projectTileCoordinates(e,t,r,n){return this.currentTransform.projectTileCoordinates(e,t,r,n)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,t){return this.currentTransform.lngLatToCameraDepth(e,t)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(e,t,r,n){return this._helper.calculateCenterFromCameraLngLatAlt(e,t,r,n)}setLocationAtPoint(e,t){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,t),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,t),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,t){return this.currentTransform.locationToScreenPoint(e,t)}screenPointToMercatorCoordinate(e,t){return this.currentTransform.screenPointToMercatorCoordinate(e,t)}screenPointToLocation(e,t){return this.currentTransform.screenPointToLocation(e,t)}isPointOnMapSurface(e,t){return this.currentTransform.isPointOnMapSurface(e,t)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,t){return this.currentTransform.getMatrixForModel(e,t)}getProjectionDataForCustomLayer(e=!0){const t=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return t;const r=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return r.fallbackMatrix=t.mainMatrix,r}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class Pr{get useGlobeControls(){return!0}handlePanInertia(e,r){const n=fr(e,r);return Math.abs(n.lng-r.center.lng)>180&&(n.lng=r.center.lng+179.5*Math.sign(n.lng-r.center.lng)),{easingCenter:n,easingOffset:new t.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,r){const n=e.around,i=r.screenPointToLocation(n);e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta);const a=r.zoom;e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta);const o=r.zoom-a;if(0===o)return;const s=t.bJ(r.center.lng,i.lng),l=s/(Math.abs(s/180)+1),c=t.bJ(r.center.lat,i.lat),u=r.getRayDirectionFromPixel(n),h=r.cameraPosition,d=-1*t.b4(h,u),p=t.by();t.a$(p,h,[u[0]*d,u[1]*d,u[2]*d]);const f=t.b6(p)-1,m=Math.exp(.5*-Math.max(f-.3,0)),g=ur(r.worldSize,r.center.lat)/Math.min(r.width,r.height),_=t.bw(g,.9,.5,1,.25),y=(1-t.aq(-o))*Math.min(m,_),v=r.center.lat,b=r.zoom,x=new t.V(r.center.lng+l*y,t.an(r.center.lat+c*y,-t.ao,t.ao));r.setLocationAtPoint(i,n);const w=r.center,T=t.bw(Math.abs(s),45,85,0,1),S=t.bw(g,.75,.35,0,1),P=Math.pow(Math.max(T,S),.25),E=t.bJ(w.lng,x.lng),C=t.bJ(w.lat,x.lat);r.setCenter(new t.V(w.lng+E*P,w.lat+C*P).wrap()),r.setZoom(b+pr(v,r.center.lat))}handleMapControlsPan(e,t,r){if(!e.panDelta)return;const n=t.center.lat,i=t.zoom;t.setCenter(fr(e.panDelta,t).wrap()),t.setZoom(i+pr(n,t.center.lat))}cameraForBoxAndBearing(e,r,n,i,a){const o=qt(e,r,n,i,a),s=r.left/a.width*2-1,l=(a.width-r.right)/a.width*2-1,c=r.top/a.height*-2+1,u=(a.height-r.bottom)/a.height*-2+1,h=t.bJ(n.getWest(),n.getEast())<0,d=h?n.getEast():n.getWest(),p=h?n.getWest():n.getEast(),f=Math.max(n.getNorth(),n.getSouth()),m=Math.min(n.getNorth(),n.getSouth()),g=d+.5*t.bJ(d,p),_=f+.5*t.bJ(f,m),y=a.clone();y.setCenter(o.center),y.setBearing(o.bearing),y.setPitch(0),y.setRoll(0),y.setZoom(o.zoom);const v=y.modelViewProjectionMatrix,b=[cr(n.getNorthWest()),cr(n.getNorthEast()),cr(n.getSouthWest()),cr(n.getSouthEast()),cr(new t.V(p,_)),cr(new t.V(d,_)),cr(new t.V(g,f)),cr(new t.V(g,m))],x=cr(o.center);let w=Number.POSITIVE_INFINITY;for(const e of b)s<0&&(w=Pr.getLesserNonNegativeNonNull(w,Pr.solveVectorScale(e,x,v,"x",s))),l>0&&(w=Pr.getLesserNonNegativeNonNull(w,Pr.solveVectorScale(e,x,v,"x",l))),c>0&&(w=Pr.getLesserNonNegativeNonNull(w,Pr.solveVectorScale(e,x,v,"y",c))),u<0&&(w=Pr.getLesserNonNegativeNonNull(w,Pr.solveVectorScale(e,x,v,"y",u)));if(Number.isFinite(w)&&0!==w)return o.zoom=y.zoom+t.at(w),o;Ut()}handleJumpToCenterZoom(e,r){const n=e.center.lat,i=e.applyConstrain(r.center?t.V.convert(r.center):e.center,e.zoom).center;e.setCenter(i.wrap());const a=void 0!==r.zoom?+r.zoom:e.zoom+pr(n,i.lat);e.zoom!==a&&e.setZoom(a)}handleEaseTo(e,r){const n=e.zoom,i=e.center,a=e.padding,o={roll:e.roll,pitch:e.pitch,bearing:e.bearing},s={roll:void 0===r.roll?e.roll:r.roll,pitch:void 0===r.pitch?e.pitch:r.pitch,bearing:void 0===r.bearing?e.bearing:r.bearing},l=void 0!==r.zoom,c=!e.isPaddingEqual(r.padding);let u=!1;const h=r.center?t.V.convert(r.center):i,d=e.applyConstrain(h,n).center;Rt(e,d);const p=e.clone();p.setCenter(d),p.setZoom(l?+r.zoom:n+pr(i.lat,h.lat)),p.setBearing(r.bearing);const f=new t.P(t.an(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),t.an(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));p.setLocationAtPoint(d,f);const m=(r.offset&&r.offsetAsPoint.mag())>0?p.center:d,g=l?+r.zoom:n+pr(i.lat,m.lat),_=n+pr(i.lat,0),y=g+pr(m.lat,0),v=t.bJ(i.lng,m.lng),b=t.bJ(i.lat,m.lat),x=t.aq(y-_);return u=g!==n,{easeFunc:n=>{if(t.bn(o,s)||Gt({startEulerAngles:o,endEulerAngles:s,tr:e,k:n,useSlerp:o.roll!=s.roll}),c&&e.interpolatePadding(a,r.padding,n),r.around)t.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(r.around,r.aroundPoint);else{const t=y>_?Math.min(2,x):Math.max(.5,x),r=Math.pow(t,1-n),a=gr(i,v,b,n*r);e.setCenter(a.wrap())}if(u){const r=t.G.number(_,y,n)+pr(0,e.center.lat);e.setZoom(r)}},isZooming:u,elevationCenter:m}}handleFlyTo(e,r){const n=void 0!==r.zoom,i=e.center,a=e.zoom,o=e.padding,s=!e.isPaddingEqual(r.padding),l=e.applyConstrain(t.V.convert(r.center||r.locationAtOffset),a).center,c=n?+r.zoom:e.zoom+pr(e.center.lat,l.lat),u=e.clone();u.setCenter(l),u.setZoom(c),u.setBearing(r.bearing);const h=new t.P(t.an(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),t.an(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));u.setLocationAtPoint(l,h);const d=u.center;Rt(e,d);const p=function(e,r,n){const i=cr(r),a=cr(n),o=t.b4(i,a),s=Math.acos(o),l=sr(e);return s/(2*Math.PI)*l}(e,i,d),f=a+pr(i.lat,0),m=c+pr(d.lat,0),g=t.aq(m-f);let _;if("number"==typeof r.minZoom){const n=+r.minZoom+pr(d.lat,0),i=Math.min(n,f,m)+pr(0,d.lat),a=e.applyConstrain(d,i).zoom+pr(d.lat,0);_=t.aq(a-f)}const y=t.bJ(i.lng,d.lng),v=t.bJ(i.lat,d.lat);return{easeFunc:(n,a,l,u)=>{const h=gr(i,y,v,l);s&&e.interpolatePadding(o,r.padding,n);const p=1===n?d:h;e.setCenter(p.wrap());const m=f+t.at(a);e.setZoom(1===n?c:m+pr(0,p.lat))},scaleOfZoom:g,targetCenter:d,scaleOfMinZoom:_,pixelPathLength:p}}static solveVectorScale(e,t,r,n,i){const a="x"===n?[r[0],r[4],r[8],r[12]]:[r[1],r[5],r[9],r[13]],o=[r[3],r[7],r[11],r[15]],s=e[0]*a[0]+e[1]*a[1]+e[2]*a[2],l=e[0]*o[0]+e[1]*o[1]+e[2]*o[2],c=t[0]*a[0]+t[1]*a[1]+t[2]*a[2],u=t[0]*o[0]+t[1]*o[1]+t[2]*o[2];return c+i*l===s+i*u||o[3]*(s-c)+a[3]*(u-l)+s*u==c*l?null:(c+a[3]-i*u-i*o[3])/(c-s-i*u+i*l)}static getLesserNonNegativeNonNull(e,t){return null!==t&&t>=0&&t<e?t:e}}class Er{constructor(e){this._globe=e,this._mercatorCameraHelper=new $t,this._verticalPerspectiveCameraHelper=new Pr}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,t){return this.currentHelper.handlePanInertia(e,t)}handleMapControlsRollPitchBearingZoom(e,t){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,t)}handleMapControlsPan(e,t,r){this.currentHelper.handleMapControlsPan(e,t,r)}cameraForBoxAndBearing(e,t,r,n,i){return this.currentHelper.cameraForBoxAndBearing(e,t,r,n,i)}handleJumpToCenterZoom(e,t){this.currentHelper.handleJumpToCenterZoom(e,t)}handleEaseTo(e,t){return this.currentHelper.handleEaseTo(e,t)}handleFlyTo(e,t){return this.currentHelper.handleFlyTo(e,t)}}const Cr=(e,r)=>t.B(e,r&&r.filter(e=>"source.canvas"!==e.identifier)),Mr=t.bN();class kr extends t.E{constructor(e,r={}){var n,i;super(),this._rtlPluginLoaded=()=>{for(const e in this.tileManagers){const t=this.tileManagers[e].getSource().type;"vector"!==t&&"geojson"!==t||this.tileManagers[e].reload()}},this.map=e,this.dispatcher=new V(N(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(e,t)=>this.getGlyphs(e,t)),this.dispatcher.registerMessageHandler("GI",(e,t)=>this.getImages(e,t)),this.dispatcher.registerMessageHandler("GDA",(e,t)=>this.getDashes(e,t)),this.imageManager=new w,this.imageManager.setEventedParent(this);const a=(null===(n=e._container)||void 0===n?void 0:n.lang)||"undefined"!=typeof document&&(null===(i=document.documentElement)||void 0===i?void 0:i.lang)||void 0;this.glyphManager=new C(e._requestManager,r.localIdeographFontFamily,a),this.lineAtlas=new D(256,512),this.crossTileSymbolIndex=new Pt,this._setInitialValues(),this._resetUpdates(),this.dispatcher.broadcast("SR",t.bO()),ce().on(oe,this._rtlPluginLoaded),this.on("data",e=>{if("source"!==e.dataType||"metadata"!==e.sourceDataType)return;const t=this.tileManagers[e.sourceId];if(!t)return;const r=t.getSource();if(r&&r.vectorLayerIds)for(const e in this._layers){const t=this._layers[e];t.source===r.id&&this._validateLayer(t)}})}_setInitialValues(){var e;this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new t.bP,this._availableImages=[],this._globalState={},this._serializedLayers={},this.stylesheet=null,this.light=null,this.sky=null,this.projection&&(this.projection.destroy(),delete this.projection),this._loaded=!1,this._changed=!1,this._updatedLayers={},this._updatedSources={},this._changedImages={},this._glyphsDidChange=!1,this._updatedPaintProps={},this._layerOrderChanged=!1,this.crossTileSymbolIndex=new((null===(e=this.crossTileSymbolIndex)||void 0===e?void 0:e.constructor)||Object),this.pauseablePlacement=void 0,this.placement=void 0,this.z=0}setGlobalStateProperty(e,r){var n,i,a;this._checkLoaded();const o=null===r?null!==(a=null===(i=null===(n=this.stylesheet.state)||void 0===n?void 0:n[e])||void 0===i?void 0:i.default)&&void 0!==a?a:null:r;if(t.bQ(o,this._globalState[e]))return this;this._globalState[e]=o,this._applyGlobalStateChanges([e])}getGlobalState(){return this._globalState}setGlobalState(e){this._checkLoaded();const r=[];for(const n in e)!t.bQ(this._globalState[n],e[n].default)&&(r.push(n),this._globalState[n]=e[n].default);this._applyGlobalStateChanges(r)}_applyGlobalStateChanges(e){if(0===e.length)return;const t=new Set,r={};for(const n of e){r[n]=this._globalState[n];for(const e in this._layers){const r=this._layers[e],i=r.getLayoutAffectingGlobalStateRefs(),a=r.getPaintAffectingGlobalStateRefs();if(i.has(n)&&t.add(r.source),a.has(n))for(const{name:e,value:t}of a.get(n))this._updatePaintProperty(r,e,t)}}this.dispatcher.broadcast("UGS",r);for(const e in this.tileManagers)t.has(e)&&(this._reloadSource(e),this._changed=!0)}loadURL(e,r={},n){this.fire(new t.l("dataloading",{dataType:"style"})),r.validate="boolean"!=typeof r.validate||r.validate;const i=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const a=this._loadStyleRequest;t.j(i,this._loadStyleRequest).then(e=>{this._loadStyleRequest=null,this._load(e.data,r,n)}).catch(e=>{this._loadStyleRequest=null,e&&!a.signal.aborted&&this.fire(new t.k(e))})}loadJSON(e,r={},n){this.fire(new t.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,s.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,r.validate=!1!==r.validate,this._load(e,r,n)}).catch(()=>{})}loadEmpty(){this.fire(new t.l("dataloading",{dataType:"style"})),this._load(Mr,{validate:!1})}_load(e,r,n){var i,a;let o=r.transformStyle?r.transformStyle(n,e):e;if(!r.validate||!Cr(this,t.C(o))){o=Object.assign({},o),this._loaded=!0,this.stylesheet=o;for(const e in o.sources)this.addSource(e,o.sources[e],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs),this._createLayers(),this.light=new I(this.stylesheet.light),this._setProjectionInternal((null===(i=this.stylesheet.projection)||void 0===i?void 0:i.type)||"mercator"),this.sky=new z(this.stylesheet.sky),this.map.setTerrain(null!==(a=this.stylesheet.terrain)&&void 0!==a?a:null),this.fire(new t.l("data",{dataType:"style"})),this.fire(new t.l("style.load"))}}_createLayers(){var e,r,n;const i=t.bR(this.stylesheet.layers);this.setGlobalState(null!==(e=this.stylesheet.state)&&void 0!==e?e:null),this.dispatcher.broadcast("SL",i),this._order=i.map(e=>e.id),this._layers={},this._serializedLayers=null;for(const e of i){const i=t.bS(e,this._globalState);if(i.setEventedParent(this,{layer:{id:e.id}}),this._layers[e.id]=i,t.bT(i)&&this.tileManagers[i.source]){const t=null!==(n=null===(r=e.paint)||void 0===r?void 0:r["raster-fade-duration"])&&void 0!==n?n:i.paint.get("raster-fade-duration");this.tileManagers[i.source].setRasterFadeDuration(t)}}}_loadSprite(e,r=!1,n=void 0){let i;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(e,r,n,i){return t._(this,void 0,void 0,function*(){const a=v(e),o=n>1?"@2x":"",l={},c={};for(const{id:e,url:n}of a){const a=r.transformRequest(b(n,o,".json"),"SpriteJSON");l[e]=t.j(a,i);const s=r.transformRequest(b(n,o,".png"),"SpriteImage");c[e]=_.getImage(s,i)}return yield Promise.all([...Object.values(l),...Object.values(c)]),function(e,r){return t._(this,void 0,void 0,function*(){const t={};for(const n in e){t[n]={};const i=s.getImageCanvasContext((yield r[n]).data),a=(yield e[n]).data;for(const e in a){const{width:r,height:o,x:s,y:l,sdf:c,pixelRatio:u,stretchX:h,stretchY:d,content:p,textFitWidth:f,textFitHeight:m}=a[e];t[n][e]={data:null,pixelRatio:u,sdf:c,stretchX:h,stretchY:d,content:p,textFitWidth:f,textFitHeight:m,spriteData:{width:r,height:o,x:s,y:l,context:i}}}}return t})}(l,c)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(e=>{if(this._spriteRequest=null,e)for(const t in e){this._spritesImagesIds[t]=[];const n=this._spritesImagesIds[t]?this._spritesImagesIds[t].filter(t=>!(t in e)):[];for(const e of n)this.imageManager.removeImage(e),this._changedImages[e]=!0;for(const n in e[t]){const i="default"===t?n:`${t}:${n}`;this._spritesImagesIds[t].push(i),i in this.imageManager.images?this.imageManager.updateImage(i,e[t][n],!1):this.imageManager.addImage(i,e[t][n]),r&&(this._changedImages[i]=!0)}}}).catch(e=>{this._spriteRequest=null,i=e,this.fire(new t.k(i))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),r&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.l("data",{dataType:"style"})),n&&n(i)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.l("data",{dataType:"style"}))}_validateLayer(e){const r=this.tileManagers[e.source];if(!r)return;const n=e.sourceLayer;if(!n)return;const i=r.getSource();("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(n))&&this.fire(new t.k(new Error(`Source layer "${n}" does not exist on source "${i.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const e in this.tileManagers)if(!this.tileManagers[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,r=!1){const n=this._serializedAllLayers();if(!e||0===e.length)return Object.values(r?t.bU(n):n);const i=[];for(const a of e)if(n[a]){const e=r?t.bU(n[a]):n[a];i.push(e)}return i}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const t=Object.keys(this._layers);for(const r of t){const t=this._layers[r];"custom"!==t.type&&(e[r]=t.serialize())}return e}hasTransitions(){var e,t,r;if(null===(e=this.light)||void 0===e?void 0:e.hasTransition())return!0;if(null===(t=this.sky)||void 0===t?void 0:t.hasTransition())return!0;if(null===(r=this.projection)||void 0===r?void 0:r.hasTransition())return!0;for(const e in this.tileManagers)if(this.tileManagers[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const r=this._changed;if(r){const t=Object.keys(this._updatedLayers),r=Object.keys(this._removedLayers);(t.length||r.length)&&this._updateWorkerLayers(t,r);for(const e in this._updatedSources){const t=this._updatedSources[e];if("reload"===t)this._reloadSource(e);else{if("clear"!==t)throw new Error(`Invalid action ${t}`);this._clearSource(e)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const t in this._updatedPaintProps)this._layers[t].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const n={};for(const e in this.tileManagers){const t=this.tileManagers[e];n[e]=t.used,t.used=!1}for(const t of this._order){const r=this._layers[t];r.recalculate(e,this._availableImages),!r.isHidden(e.zoom)&&r.source&&(this.tileManagers[r.source].used=!0)}for(const e in n){const r=this.tileManagers[e];!!n[e]!=!!r.used&&r.fire(new t.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:e}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,r&&this.fire(new t.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const t in this.tileManagers)this.tileManagers[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.tileManagers)this.tileManagers[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,t){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:t})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,r={}){var n;this._checkLoaded();const i=this.serialize();if(e=r.transformStyle?r.transformStyle(i,e):e,(null===(n=r.validate)||void 0===n||n)&&Cr(this,t.C(e)))return!1;(e=t.bU(e)).layers=t.bR(e.layers);const a=t.bV(i,e),o=this._getOperationsToPerform(a);if(o.unimplemented.length>0)throw new Error(`Unimplemented: ${o.unimplemented.join(", ")}.`);if(0===o.operations.length)return!1;for(const e of o.operations)e();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const t=[],r=[];for(const n of e)switch(n.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":t.push(()=>this.addLayer.apply(this,n.args));break;case"removeLayer":t.push(()=>this.removeLayer.apply(this,n.args));break;case"setPaintProperty":t.push(()=>this.setPaintProperty.apply(this,n.args));break;case"setLayoutProperty":t.push(()=>this.setLayoutProperty.apply(this,n.args));break;case"setFilter":t.push(()=>this.setFilter.apply(this,n.args));break;case"addSource":t.push(()=>this.addSource.apply(this,n.args));break;case"removeSource":t.push(()=>this.removeSource.apply(this,n.args));break;case"setLayerZoomRange":t.push(()=>this.setLayerZoomRange.apply(this,n.args));break;case"setLight":t.push(()=>this.setLight.apply(this,n.args));break;case"setGeoJSONSourceData":t.push(()=>this.setGeoJSONSourceData.apply(this,n.args));break;case"setGlyphs":t.push(()=>this.setGlyphs.apply(this,n.args));break;case"setSprite":t.push(()=>this.setSprite.apply(this,n.args));break;case"setTerrain":t.push(()=>this.map.setTerrain.apply(this,n.args));break;case"setSky":t.push(()=>this.setSky.apply(this,n.args));break;case"setProjection":this.setProjection.apply(this,n.args);break;case"setGlobalState":t.push(()=>this.setGlobalState.apply(this,n.args));break;case"setTransition":t.push(()=>{});break;default:r.push(n.command)}return{operations:t,unimplemented:r}}addImage(e,r){if(this.getImage(e))return this.fire(new t.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,r),this._afterImageUpdated(e)}updateImage(e,t){this.imageManager.updateImage(e,t)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new t.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,r,n={}){if(this._checkLoaded(),void 0!==this.tileManagers[e])throw new Error(`Source "${e}" already exists.`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(t.C.source,`sources.${e}`,r,null,n))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const i=this.tileManagers[e]=new Ce(e,r,this.dispatcher);i.style=this,i.setEventedParent(this,()=>({isSourceLoaded:i.loaded(),source:i.serialize(),sourceId:e})),i.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),void 0===this.tileManagers[e])throw new Error("There is no source with this ID");for(const r in this._layers)if(this._layers[r].source===e)return this.fire(new t.k(new Error(`Source "${e}" cannot be removed while layer "${r}" is using it.`)));const r=this.tileManagers[e];delete this.tileManagers[e],delete this._updatedSources[e],r.fire(new t.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,t){if(this._checkLoaded(),void 0===this.tileManagers[e])throw new Error(`There is no source with this ID=${e}`);const r=this.tileManagers[e].getSource();if("geojson"!==r.type)throw new Error(`geojsonSource.type is ${r.type}, which is !== 'geojson`);r.setData(t),this._changed=!0}getSource(e){return this.tileManagers[e]&&this.tileManagers[e].getSource()}addLayer(e,r,n={}){this._checkLoaded();const i=e.id;if(this.getLayer(i))return void this.fire(new t.k(new Error(`Layer "${i}" already exists on this map.`)));let a;if("custom"===e.type){if(Cr(this,t.bW(e)))return;a=t.bS(e,this._globalState)}else{if("source"in e&&"object"==typeof e.source&&(this.addSource(i,e.source),e=t.bU(e),e=t.e(e,{source:i})),this._validate(t.C.layer,`layers.${i}`,e,{arrayIndex:-1},n))return;a=t.bS(e,this._globalState),this._validateLayer(a),a.setEventedParent(this,{layer:{id:i}})}const o=r?this._order.indexOf(r):this._order.length;if(r&&-1===o)this.fire(new t.k(new Error(`Cannot add layer "${i}" before non-existing layer "${r}".`)));else{if(this._order.splice(o,0,i),this._layerOrderChanged=!0,this._layers[i]=a,this._removedLayers[i]&&a.source&&"custom"!==a.type){const e=this._removedLayers[i];delete this._removedLayers[i],e.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.tileManagers[a.source].pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map)}}moveLayer(e,r){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new t.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===r)return;const n=this._order.indexOf(e);this._order.splice(n,1);const i=r?this._order.indexOf(r):this._order.length;r&&-1===i?this.fire(new t.k(new Error(`Cannot move layer "${e}" before non-existing layer "${r}".`))):(this._order.splice(i,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const r=this._layers[e];if(!r)return void this.fire(new t.k(new Error(`Cannot remove non-existing layer "${e}".`)));r.setEventedParent(null);const n=this._order.indexOf(e);this._order.splice(n,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],r.onRemove&&r.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,r,n){this._checkLoaded();const i=this.getLayer(e);i?i.minzoom===r&&i.maxzoom===n||(null!=r&&(i.minzoom=r),null!=n&&(i.maxzoom=n),this._updateLayer(i)):this.fire(new t.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,r,n={}){this._checkLoaded();const i=this.getLayer(e);if(i){if(!t.bQ(i.filter,r))return null==r?(i.setFilter(void 0),void this._updateLayer(i)):void(this._validate(t.C.filter,`layers.${i.id}.filter`,r,null,n)||(i.setFilter(t.bU(r)),this._updateLayer(i)))}else this.fire(new t.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return t.bU(this.getLayer(e).filter)}setLayoutProperty(e,r,n,i={}){this._checkLoaded();const a=this.getLayer(e);a?t.bQ(a.getLayoutProperty(r),n)||(a.setLayoutProperty(r,n,i),this._updateLayer(a)):this.fire(new t.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,r){const n=this.getLayer(e);if(n)return n.getLayoutProperty(r);this.fire(new t.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,r,n,i={}){this._checkLoaded();const a=this.getLayer(e);a?t.bQ(a.getPaintProperty(r),n)||this._updatePaintProperty(a,r,n,i):this.fire(new t.k(new Error(`Cannot style non-existing layer "${e}".`)))}_updatePaintProperty(e,r,n,i={}){e.setPaintProperty(r,n,i)&&this._updateLayer(e),t.bT(e)&&"raster-fade-duration"===r&&this.tileManagers[e.source].setRasterFadeDuration(n),this._changed=!0,this._updatedPaintProps[e.id]=!0,this._serializedLayers=null}getPaintProperty(e,t){return this.getLayer(e).getPaintProperty(t)}setFeatureState(e,r){this._checkLoaded();const n=e.source,i=e.sourceLayer,a=this.tileManagers[n];if(void 0===a)return void this.fire(new t.k(new Error(`The source '${n}' does not exist in the map's style.`)));const o=a.getSource().type;"geojson"===o&&i?this.fire(new t.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==o||i?(void 0===e.id&&this.fire(new t.k(new Error("The feature id parameter must be provided."))),a.setFeatureState(i,e.id,r)):this.fire(new t.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,r){this._checkLoaded();const n=e.source,i=this.tileManagers[n];if(void 0===i)return void this.fire(new t.k(new Error(`The source '${n}' does not exist in the map's style.`)));const a=i.getSource().type,o="vector"===a?e.sourceLayer:void 0;"vector"!==a||o?r&&"string"!=typeof e.id&&"number"!=typeof e.id?this.fire(new t.k(new Error("A feature id is required to remove its specific state property."))):i.removeFeatureState(o,e.id,r):this.fire(new t.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const r=e.source,n=e.sourceLayer,i=this.tileManagers[r];if(void 0!==i)return"vector"!==i.getSource().type||n?(void 0===e.id&&this.fire(new t.k(new Error("The feature id parameter must be provided."))),i.getFeatureState(n,e.id)):void this.fire(new t.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new t.k(new Error(`The source '${r}' does not exist in the map's style.`)))}getTransition(){return t.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=t.bX(this.tileManagers,e=>e.serialize()),r=this._serializeByIds(this._order,!0),n=this.map.getTerrain()||void 0,i=this.stylesheet;return t.bY({version:i.version,name:i.name,metadata:i.metadata,light:i.light,sky:i.sky,center:i.center,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch,sprite:i.sprite,glyphs:i.glyphs,transition:i.transition,projection:i.projection,sources:e,layers:r,terrain:n},e=>void 0!==e)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&"raster"!==this.tileManagers[e.source].getSource().type&&(this._updatedSources[e.source]="reload",this.tileManagers[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const t=e=>"fill-extrusion"===this._layers[e].type,r={},n=[];for(let i=this._order.length-1;i>=0;i--){const a=this._order[i];if(t(a)){r[a]=i;for(const t of e){const e=t[a];if(e)for(const t of e)n.push(t)}}}n.sort((e,t)=>t.intersectionZ-e.intersectionZ);const i=[];for(let a=this._order.length-1;a>=0;a--){const o=this._order[a];if(t(o))for(let e=n.length-1;e>=0;e--){const t=n[e].feature;if(r[t.layer.id]<a)break;i.push(t),n.pop()}else for(const t of e){const e=t[o];if(e)for(const t of e)i.push(t.feature)}}return i}queryRenderedFeatures(e,r,n){r&&r.filter&&this._validate(t.C.filter,"queryRenderedFeatures.filter",r.filter,null,r);const i={};if(r&&r.layers){if(!(Array.isArray(r.layers)||r.layers instanceof Set))return this.fire(new t.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const e of r.layers){const r=this._layers[e];if(!r)return this.fire(new t.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be queried for features.`))),[];i[r.source]=!0}}const a=[];r.availableImages=this._availableImages;const o=this._serializedAllLayers(),s=r.layers instanceof Set?r.layers:Array.isArray(r.layers)?new Set(r.layers):null,l=Object.assign(Object.assign({},r),{layers:s,globalState:this._globalState});for(const t in this.tileManagers)r.layers&&!i[t]||a.push(G(this.tileManagers[t],this._layers,o,e,l,n,this.map.terrain?(e,t,r)=>this.map.terrain.getElevation(e,t,r):void 0));return this.placement&&a.push(function(e,t,r,n,i,a,o){const s={},l=a.queryRenderedSymbols(n),c=[];for(const e of Object.keys(l).map(Number))c.push(o[e]);c.sort(q);for(const r of c){const n=r.featureIndex.lookupSymbolFeatures(l[r.bucketInstanceId],t,r.bucketIndex,r.sourceLayerIndex,{filterSpec:i.filter,globalState:i.globalState},i.layers,i.availableImages,e);for(const e in n){const t=s[e]=s[e]||[],i=n[e];i.sort((e,t)=>{const n=r.featureSortOrder;if(n){const r=n.indexOf(e.featureIndex);return n.indexOf(t.featureIndex)-r}return t.featureIndex-e.featureIndex});for(const e of i)t.push(e)}}return function(e,t,r){for(const n in e)for(const i of e[n])$(i,r[t[n].source]);return e}(s,e,r)}(this._layers,o,this.tileManagers,e,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(a)}querySourceFeatures(e,r){(null==r?void 0:r.filter)&&this._validate(t.C.filter,"querySourceFeatures.filter",r.filter,null,r);const n=this.tileManagers[e];return n?function(e,t){const r=e.getRenderableIds().map(t=>e.getTileByID(t)),n=[],i={};for(let e=0;e<r.length;e++){const a=r[e],o=a.tileID.canonical.key;i[o]||(i[o]=!0,a.querySourceFeatures(n,t))}return n}(n,r?Object.assign(Object.assign({},r),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(e,r={}){this._checkLoaded();const n=this.light.getLight();let i=!1;for(const r in e)if(!t.bQ(e[r],n[r])){i=!0;break}if(!i)return;const a={now:c(),transition:t.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,r),this.light.updateTransitions(a)}getProjection(){var e;return null===(e=this.stylesheet)||void 0===e?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return null===(e=this.stylesheet)||void 0===e?void 0:e.sky}setSky(e,r={}){this._checkLoaded();const n=this.getSky();let i=!1;if(!e&&!n)return;if(e&&!n)i=!0;else if(!e&&n)i=!0;else for(const r in e)if(!t.bQ(e[r],n[r])){i=!0;break}if(!i)return;const a={now:c(),transition:t.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,r),this.sky.updateTransitions(a)}_setProjectionInternal(e){const r=function(e,r){const n={constrainOverride:r};if(Array.isArray(e)){const t=new or({type:e});return{projection:t,transform:new Sr(n),cameraHelper:new Er(t)}}switch(e){case"mercator":return{projection:new Dt,transform:new jt(n),cameraHelper:new $t};case"globe":{const e=new or({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:e,transform:new Sr(n),cameraHelper:new Er(e)}}case"vertical-perspective":return{projection:new ir,transform:new Tr(n),cameraHelper:new Pr};default:return t.w(`Unknown projection name: ${e}. Falling back to mercator projection.`),{projection:new Dt,transform:new jt(n),cameraHelper:new $t}}}(e,this.map.transformConstrain);this.projection=r.projection,this.map.migrateProjection(r.transform,r.cameraHelper);for(const e in this.tileManagers)this.tileManagers[e].reload()}_validate(e,r,n,i,a={}){return(!a||!1!==a.validate)&&Cr(this,e.call(t.C,t.e({key:r,style:this.serialize(),value:n,styleSpec:t.u},i)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ce().off(oe,this._rtlPluginLoaded);for(const e in this._layers)this._layers[e].setEventedParent(null);for(const e in this.tileManagers){const t=this.tileManagers[e];t.setEventedParent(null),t.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.tileManagers[e].clearTiles()}_reloadSource(e){this.tileManagers[e].resume(),this.tileManagers[e].reload()}_updateSources(e){for(const t in this.tileManagers)this.tileManagers[t].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.tileManagers)this._reloadSource(e)}_updatePlacement(e,t,r,n,i=!1){let a=!1,o=!1;const s={};for(const t of this._order){const r=this._layers[t];if("symbol"!==r.type)continue;if(!s[r.source]){const e=this.tileManagers[r.source];s[r.source]=e.getRenderableIds(!0).map(t=>e.getTileByID(t)).sort((e,t)=>t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1))}const n=this.crossTileSymbolIndex.addLayer(r,s[r.source],e.center.lng);a=a||n}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((i=i||this._layerOrderChanged||0===r)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(c(),e.zoom))&&(this.pauseablePlacement=new bt(e,this.map.terrain,this._order,i,t,r,n,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,s),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(c()),o=!0),a&&this.pauseablePlacement.placement.setStale()),o||a)for(const e of this._order){const t=this._layers[e];"symbol"===t.type&&this.placement.updateLayerOpacities(t,s[t.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(c())}_releaseSymbolFadeTiles(){for(const e in this.tileManagers)this.tileManagers[e].releaseSymbolFadeTiles()}getImages(e,r){return t._(this,void 0,void 0,function*(){const e=yield this.imageManager.getImages(r.icons);this._updateTilesForChangedImages();const t=this.tileManagers[r.source];return t&&t.setDependencies(r.tileID.key,r.type,r.icons),e})}getGlyphs(e,r){return t._(this,void 0,void 0,function*(){const e=yield this.glyphManager.getGlyphs(r.stacks),t=this.tileManagers[r.source];return t&&t.setDependencies(r.tileID.key,r.type,[""]),e})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,r={}){this._checkLoaded(),e&&this._validate(t.C.glyphs,"glyphs",e,null,r)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}getDashes(e,r){return t._(this,void 0,void 0,function*(){const e={};for(const[t,n]of Object.entries(r.dashes))e[t]=this.lineAtlas.getDash(n.dasharray,n.round);return e})}addSprite(e,r,n={},i){this._checkLoaded();const a=[{id:e,url:r}],o=[...v(this.stylesheet.sprite),...a];this._validate(t.C.sprite,"sprite",o,null,n)||(this.stylesheet.sprite=o,this._loadSprite(a,!0,i))}removeSprite(e){this._checkLoaded();const r=v(this.stylesheet.sprite);if(r.find(t=>t.id===e)){if(this._spritesImagesIds[e])for(const t of this._spritesImagesIds[e])this.imageManager.removeImage(t),this._changedImages[t]=!0;r.splice(r.findIndex(t=>t.id===e),1),this.stylesheet.sprite=r.length>0?r:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.l("data",{dataType:"style"}))}else this.fire(new t.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return v(this.stylesheet.sprite)}setSprite(e,r={},n){this._checkLoaded(),e&&this._validate(t.C.sprite,"sprite",e,null,r)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,n):(this._unloadSprite(),n&&n(null)))}destroy(){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);for(const e in this.tileManagers){const t=this.tileManagers[e];if(t.setEventedParent(null),t._tiles){for(const e in t._tiles)t._tiles[e].unloadVectorData();t._tiles={}}t._cache.reset(),t.onRemove(this.map)}this.tileManagers={},this.imageManager&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this._availableImages=[],this._spritesImagesIds={}),this.glyphManager&&this.glyphManager.destroy();for(const e in this._layers){const t=this._layers[e];t.setEventedParent(null),t.onRemove&&t.onRemove(this.map)}this._setInitialValues(),this.setEventedParent(null),this.dispatcher.unregisterMessageHandler("GG"),this.dispatcher.unregisterMessageHandler("GI"),this.dispatcher.unregisterMessageHandler("GDA"),this.dispatcher.remove(!0),this._listeners={},this._oneTimeListeners={}}}var Ir=t.aT([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Ar{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,t,r,n,i,a,o,s,l){this.context=e;let c=this.boundPaintVertexBuffers.length!==n.length;for(let e=0;!c&&e<n.length;e++)this.boundPaintVertexBuffers[e]!==n[e]&&(c=!0);!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==r||c||this.boundIndexBuffer!==i||this.boundVertexOffset!==a||this.boundDynamicVertexBuffer!==o||this.boundDynamicVertexBuffer2!==s||this.boundDynamicVertexBuffer3!==l?this.freshBind(t,r,n,i,a,o,s,l):(e.bindVertexArray.set(this.vao),o&&o.bind(),i&&i.dynamicDraw&&i.bind(),s&&s.bind(),l&&l.bind())}freshBind(e,t,r,n,i,a,o,s){const l=e.numAttributes,c=this.context,u=c.gl;this.vao&&this.destroy(),this.vao=c.createVertexArray(),c.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=n,this.boundVertexOffset=i,this.boundDynamicVertexBuffer=a,this.boundDynamicVertexBuffer2=o,this.boundDynamicVertexBuffer3=s,t.enableAttributes(u,e);for(const t of r)t.enableAttributes(u,e);a&&a.enableAttributes(u,e),o&&o.enableAttributes(u,e),s&&s.enableAttributes(u,e),t.bind(),t.setVertexAttribPointers(u,e,i);for(const t of r)t.bind(),t.setVertexAttribPointers(u,e,i);a&&(a.bind(),a.setVertexAttribPointers(u,e,i)),n&&n.bind(),o&&(o.bind(),o.setVertexAttribPointers(u,e,i)),s&&(s.bind(),s.setVertexAttribPointers(u,e,i)),c.currentNumAttributes=l}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const zr=(e,r,n,i,a)=>({u_texture:0,u_ele_delta:e,u_fog_matrix:r,u_fog_color:n?n.properties.get("fog-color"):t.bo.white,u_fog_ground_blend:n?n.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:a?0:n?n.calculateFogBlendOpacity(i):0,u_horizon_color:n?n.properties.get("horizon-color"):t.bo.white,u_horizon_fog_blend:n?n.properties.get("horizon-fog-blend"):1,u_is_globe_mode:a?1:0}),Dr={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Lr(e){const t=[];for(let r=0;r<e.length;r++){if(null===e[r])continue;const n=e[r].split(" ");t.push(n.pop())}return t}class Rr{constructor(e,r,n,i,a,o,s,l,c=[]){const u=e.gl;this.program=u.createProgram();const h=Lr(r.staticAttributes),d=n?n.getBinderAttributes():[],p=h.concat(d),f=Ct.prelude.staticUniforms?Lr(Ct.prelude.staticUniforms):[],m=s.staticUniforms?Lr(s.staticUniforms):[],g=r.staticUniforms?Lr(r.staticUniforms):[],_=n?n.getBinderUniforms():[],y=f.concat(m).concat(g).concat(_),v=[];for(const e of y)v.indexOf(e)<0&&v.push(e);const b=n?n.defines():[];Jt(u)&&b.unshift("#version 300 es"),a&&b.push("#define OVERDRAW_INSPECTOR;"),o&&b.push("#define TERRAIN3D;"),l&&b.push(l),c&&b.push(...c);let x=b.concat(Ct.prelude.fragmentSource,s.fragmentSource,r.fragmentSource).join("\n"),w=b.concat(Ct.prelude.vertexSource,s.vertexSource,r.vertexSource).join("\n");Jt(u)||(x=function(e){return e.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(x),w=function(e){return e.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(w));const T=u.createShader(u.FRAGMENT_SHADER);if(u.isContextLost())return void(this.failedToCreate=!0);if(u.shaderSource(T,x),u.compileShader(T),!u.getShaderParameter(T,u.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${u.getShaderInfoLog(T)}`);u.attachShader(this.program,T);const S=u.createShader(u.VERTEX_SHADER);if(u.isContextLost())return void(this.failedToCreate=!0);if(u.shaderSource(S,w),u.compileShader(S),!u.getShaderParameter(S,u.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${u.getShaderInfoLog(S)}`);u.attachShader(this.program,S),this.attributes={};const P={};this.numAttributes=p.length;for(let e=0;e<this.numAttributes;e++)p[e]&&(u.bindAttribLocation(this.program,e,p[e]),this.attributes[p[e]]=e);if(u.linkProgram(this.program),!u.getProgramParameter(this.program,u.LINK_STATUS))throw new Error(`Program failed to link: ${u.getProgramInfoLog(this.program)}`);u.deleteShader(S),u.deleteShader(T);for(let e=0;e<v.length;e++){const t=v[e];if(t&&!P[t]){const e=u.getUniformLocation(this.program,t);e&&(P[t]=e)}}this.fixedUniforms=i(e,P),this.terrainUniforms=((e,r)=>({u_depth:new t.bZ(e,r.u_depth),u_terrain:new t.bZ(e,r.u_terrain),u_terrain_dim:new t.bp(e,r.u_terrain_dim),u_terrain_matrix:new t.b$(e,r.u_terrain_matrix),u_terrain_unpack:new t.c0(e,r.u_terrain_unpack),u_terrain_exaggeration:new t.bp(e,r.u_terrain_exaggeration)}))(e,P),this.projectionUniforms=((e,r)=>({u_projection_matrix:new t.b$(e,r.u_projection_matrix),u_projection_tile_mercator_coords:new t.c0(e,r.u_projection_tile_mercator_coords),u_projection_clipping_plane:new t.c0(e,r.u_projection_clipping_plane),u_projection_transition:new t.bp(e,r.u_projection_transition),u_projection_fallback_matrix:new t.b$(e,r.u_projection_fallback_matrix)}))(e,P),this.binderUniforms=n?n.getUniforms(e,P):[]}draw(e,t,r,n,i,a,o,s,l,c,u,h,d,p,f,m,g,_,y){const v=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(r),e.setStencilMode(n),e.setColorMode(i),e.setCullFace(a),s){e.activeTexture.set(v.TEXTURE2),v.bindTexture(v.TEXTURE_2D,s.depthTexture),e.activeTexture.set(v.TEXTURE3),v.bindTexture(v.TEXTURE_2D,s.texture);for(const e in this.terrainUniforms)this.terrainUniforms[e].set(s[e])}if(l)for(const e in l)this.projectionUniforms[Dr[e]].set(l[e]);if(o)for(const e in this.fixedUniforms)this.fixedUniforms[e].set(o[e]);m&&m.setUniforms(e,this.binderUniforms,p,{zoom:f});let b=0;switch(t){case v.LINES:b=2;break;case v.TRIANGLES:b=3;break;case v.LINE_STRIP:b=1}for(const r of d.get()){const n=r.vaos||(r.vaos={});(n[c]||(n[c]=new Ar)).bind(e,this,u,m?m.getPaintVertexBuffers():[],h,r.vertexOffset,g,_,y),v.drawElements(t,r.primitiveLength*b,v.UNSIGNED_SHORT,r.primitiveOffset*b*2)}}}function Fr(e,r,n){const i=1/t.aM(n,1,r.transform.tileZoom),a=Math.pow(2,n.tileID.overscaledZ),o=n.tileSize*Math.pow(2,r.transform.tileZoom)/a,s=o*(n.tileID.canonical.x+n.tileID.wrap*a),l=o*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[i,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[s>>16,l>>16],u_pixel_coord_lower:[65535&s,65535&l]}}const Br=(e,r,n,i)=>{const a=e.style.light,o=a.properties.get("position"),s=[o.x,o.y,o.z],l=t.c3();"viewport"===a.properties.get("anchor")&&t.c4(l,e.transform.bearingInRadians),t.c5(s,s,l);const c=e.transform.transformLightDirection(s),u=a.properties.get("color");return{u_lightpos:s,u_lightpos_globe:c,u_lightintensity:a.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+r,u_opacity:n,u_fill_translate:i}},Or=(e,r,n,i,a,o,s)=>t.e(Br(e,r,n,i),Fr(o,e,s),{u_height_factor:-Math.pow(2,a.overscaledZ)/s.tileSize/8}),Nr=(e,r,n,i)=>t.e(Fr(r,e,n),{u_fill_translate:i}),Vr=(e,t)=>({u_world:e,u_fill_translate:t}),jr=(e,r,n,i,a)=>t.e(Nr(e,r,n,a),{u_world:i}),Ur=(e,r,n,i,a)=>{const o=e.transform;let s,l,c=0;if("map"===n.paint.get("circle-pitch-alignment")){const e=t.aM(r,1,o.zoom);s=!0,l=[e,e],c=e/(t.a4*Math.pow(2,r.tileID.overscaledZ))*2*Math.PI*a}else s=!1,l=o.pixelsToGLUnits;return{u_camera_to_center_distance:o.cameraToCenterDistance,u_scale_with_map:+("map"===n.paint.get("circle-pitch-scale")),u_pitch_with_map:+s,u_device_pixel_ratio:e.pixelRatio,u_extrude_scale:l,u_globe_extrude_scale:c,u_translate:i}},Gr=e=>({u_pixel_extrude_scale:[1/e.width,1/e.height]}),qr=e=>({u_viewport_size:[e.width,e.height]}),$r=(e,t=1)=>({u_color:e,u_overlay:0,u_overlay_scale:t}),Zr=(e,r,n,i)=>{const a=t.aM(e,1,r)/(t.a4*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*i;return{u_extrude_scale:t.aM(e,1,r),u_intensity:n,u_globe_extrude_scale:a}},Hr=(e,r,n,i)=>{const a=t.N();t.c6(a,0,e.width,e.height,0,0,1);const o=e.context.gl;return{u_matrix:a,u_world:[o.drawingBufferWidth,o.drawingBufferHeight],u_image:n,u_color_ramp:i,u_opacity:r.paint.get("heatmap-opacity")}},Wr=(e,t,r)=>{const n=r.paint.get("hillshade-accent-color");let i;switch(r.paint.get("hillshade-method")){case"basic":i=4;break;case"combined":i=1;break;case"igor":i=2;break;case"multidirectional":i=3;break;default:i=0}const a=r.getIlluminationProperties();for(let t=0;t<a.directionRadians.length;t++)"viewport"===r.paint.get("hillshade-illumination-anchor")&&(a.directionRadians[t]+=e.transform.bearingInRadians);return{u_image:0,u_latrange:Yr(0,t.tileID),u_exaggeration:r.paint.get("hillshade-exaggeration"),u_altitudes:a.altitudeRadians,u_azimuths:a.directionRadians,u_accent:n,u_method:i,u_highlights:a.highlightColor,u_shadows:a.shadowColor}},Xr=(e,r)=>{const n=r.stride,i=t.N();return t.c6(i,0,t.a4,-t.a4,0,0,1),t.O(i,i,[0,-t.a4,0]),{u_matrix:i,u_image:1,u_dimension:[n,n],u_zoom:e.overscaledZ,u_unpack:r.getUnpackVector()}};function Yr(e,r){const n=Math.pow(2,r.canonical.z),i=r.canonical.y;return[new t.aa(0,i/n).toLngLat().lat,new t.aa(0,(i+1)/n).toLngLat().lat]}const Kr=(e,t,r=0)=>({u_image:0,u_unpack:t.getUnpackVector(),u_dimension:[t.stride,t.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:r,u_opacity:e.paint.get("color-relief-opacity")}),Qr=(e,r,n,i)=>{const a=e.transform;return{u_translation:an(e,r,n),u_ratio:i/t.aM(r,1,a.zoom),u_device_pixel_ratio:e.pixelRatio,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},Jr=(e,r,n,i,a)=>t.e(Qr(e,r,n,i),{u_image:0,u_image_height:a}),en=(e,r,n,i,a)=>{const o=e.transform,s=nn(r,o);return{u_translation:an(e,r,n),u_texsize:r.imageAtlasTexture.size,u_ratio:i/t.aM(r,1,o.zoom),u_device_pixel_ratio:e.pixelRatio,u_image:0,u_scale:[s,a.fromScale,a.toScale],u_fade:a.t,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},tn=(e,r,n,i,a)=>{const o=nn(r,e.transform);return t.e(Qr(e,r,n,i),{u_tileratio:o,u_crossfade_from:a.fromScale,u_crossfade_to:a.toScale,u_image:0,u_mix:a.t,u_lineatlas_width:e.lineAtlas.width,u_lineatlas_height:e.lineAtlas.height})},rn=(e,r,n,i,a,o)=>{const s=nn(r,e.transform);return t.e(Qr(e,r,n,i),{u_image:0,u_image_height:o,u_tileratio:s,u_crossfade_from:a.fromScale,u_crossfade_to:a.toScale,u_image_dash:1,u_mix:a.t,u_lineatlas_width:e.lineAtlas.width,u_lineatlas_height:e.lineAtlas.height})};function nn(e,r){return 1/t.aM(e,1,r.tileZoom)}function an(e,r,n){return t.aN(e.transform,r,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const on=(e,t,r,n,i)=>{return{u_tl_parent:e,u_scale_parent:t,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*n.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:n.paint.get("raster-brightness-min"),u_brightness_high:n.paint.get("raster-brightness-max"),u_saturation_factor:(o=n.paint.get("raster-saturation"),o>0?1-1/(1.001-o):-o),u_contrast_factor:(a=n.paint.get("raster-contrast"),a>0?1/(1-a):1+a),u_spin_weights:sn(n.paint.get("raster-hue-rotate")),u_coords_top:[i[0].x,i[0].y,i[1].x,i[1].y],u_coords_bottom:[i[3].x,i[3].y,i[2].x,i[2].y]};var a,o};function sn(e){e*=Math.PI/180;const t=Math.sin(e),r=Math.cos(e);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}const ln=(e,t,r,n,i,a,o,s,l,c,u,h,d)=>{const p=o.transform;return{u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:p.cameraToCenterDistance,u_pitch:p.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:p.width/p.height,u_fade_change:o.options.fadeDuration?o.symbolFadeChange:1,u_label_plane_matrix:s,u_coord_matrix:l,u_is_text:+u,u_pitch_with_map:+n,u_is_along_line:i,u_is_variable_anchor:a,u_texsize:h,u_texture:0,u_translation:c,u_pitched_scale:d}},cn=(e,r,n,i,a,o,s,l,c,u,h,d,p,f)=>{const m=s.transform;return t.e(ln(e,r,n,i,a,o,s,l,c,u,h,d,f),{u_gamma_scale:i?Math.cos(m.pitch*Math.PI/180)*m.cameraToCenterDistance:1,u_device_pixel_ratio:s.pixelRatio,u_is_halo:1})},un=(e,r,n,i,a,o,s,l,c,u,h,d,p)=>t.e(cn(e,r,n,i,a,o,s,l,c,u,!0,h,0,p),{u_texsize_icon:d,u_texture_icon:1}),hn=(e,t)=>({u_opacity:e,u_color:t}),dn=(e,r,n,i,a)=>t.e(function(e,r,n,i){const a=n.imageManager.getPattern(e.from.toString()),o=n.imageManager.getPattern(e.to.toString()),{width:s,height:l}=n.imageManager.getPixelSize(),c=Math.pow(2,i.tileID.overscaledZ),u=i.tileSize*Math.pow(2,n.transform.tileZoom)/c,h=u*(i.tileID.canonical.x+i.tileID.wrap*c),d=u*i.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:a.tl,u_pattern_br_a:a.br,u_pattern_tl_b:o.tl,u_pattern_br_b:o.br,u_texsize:[s,l],u_mix:r.t,u_pattern_size_a:a.displaySize,u_pattern_size_b:o.displaySize,u_scale_a:r.fromScale,u_scale_b:r.toScale,u_tile_units_to_pixels:1/t.aM(i,1,n.transform.tileZoom),u_pixel_coord_upper:[h>>16,d>>16],u_pixel_coord_lower:[65535&h,65535&d]}}(n,a,r,i),{u_opacity:e}),pn=(e,t)=>{},fn={fillExtrusion:(e,r)=>({u_lightpos:new t.c1(e,r.u_lightpos),u_lightpos_globe:new t.c1(e,r.u_lightpos_globe),u_lightintensity:new t.bp(e,r.u_lightintensity),u_lightcolor:new t.c1(e,r.u_lightcolor),u_vertical_gradient:new t.bp(e,r.u_vertical_gradient),u_opacity:new t.bp(e,r.u_opacity),u_fill_translate:new t.c2(e,r.u_fill_translate)}),fillExtrusionPattern:(e,r)=>({u_lightpos:new t.c1(e,r.u_lightpos),u_lightpos_globe:new t.c1(e,r.u_lightpos_globe),u_lightintensity:new t.bp(e,r.u_lightintensity),u_lightcolor:new t.c1(e,r.u_lightcolor),u_vertical_gradient:new t.bp(e,r.u_vertical_gradient),u_height_factor:new t.bp(e,r.u_height_factor),u_opacity:new t.bp(e,r.u_opacity),u_fill_translate:new t.c2(e,r.u_fill_translate),u_image:new t.bZ(e,r.u_image),u_texsize:new t.c2(e,r.u_texsize),u_pixel_coord_upper:new t.c2(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.c2(e,r.u_pixel_coord_lower),u_scale:new t.c1(e,r.u_scale),u_fade:new t.bp(e,r.u_fade)}),fill:(e,r)=>({u_fill_translate:new t.c2(e,r.u_fill_translate)}),fillPattern:(e,r)=>({u_image:new t.bZ(e,r.u_image),u_texsize:new t.c2(e,r.u_texsize),u_pixel_coord_upper:new t.c2(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.c2(e,r.u_pixel_coord_lower),u_scale:new t.c1(e,r.u_scale),u_fade:new t.bp(e,r.u_fade),u_fill_translate:new t.c2(e,r.u_fill_translate)}),fillOutline:(e,r)=>({u_world:new t.c2(e,r.u_world),u_fill_translate:new t.c2(e,r.u_fill_translate)}),fillOutlinePattern:(e,r)=>({u_world:new t.c2(e,r.u_world),u_image:new t.bZ(e,r.u_image),u_texsize:new t.c2(e,r.u_texsize),u_pixel_coord_upper:new t.c2(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.c2(e,r.u_pixel_coord_lower),u_scale:new t.c1(e,r.u_scale),u_fade:new t.bp(e,r.u_fade),u_fill_translate:new t.c2(e,r.u_fill_translate)}),circle:(e,r)=>({u_camera_to_center_distance:new t.bp(e,r.u_camera_to_center_distance),u_scale_with_map:new t.bZ(e,r.u_scale_with_map),u_pitch_with_map:new t.bZ(e,r.u_pitch_with_map),u_extrude_scale:new t.c2(e,r.u_extrude_scale),u_device_pixel_ratio:new t.bp(e,r.u_device_pixel_ratio),u_globe_extrude_scale:new t.bp(e,r.u_globe_extrude_scale),u_translate:new t.c2(e,r.u_translate)}),collisionBox:(e,r)=>({u_pixel_extrude_scale:new t.c2(e,r.u_pixel_extrude_scale)}),collisionCircle:(e,r)=>({u_viewport_size:new t.c2(e,r.u_viewport_size)}),debug:(e,r)=>({u_color:new t.b_(e,r.u_color),u_overlay:new t.bZ(e,r.u_overlay),u_overlay_scale:new t.bp(e,r.u_overlay_scale)}),depth:pn,clippingMask:pn,heatmap:(e,r)=>({u_extrude_scale:new t.bp(e,r.u_extrude_scale),u_intensity:new t.bp(e,r.u_intensity),u_globe_extrude_scale:new t.bp(e,r.u_globe_extrude_scale)}),heatmapTexture:(e,r)=>({u_matrix:new t.b$(e,r.u_matrix),u_world:new t.c2(e,r.u_world),u_image:new t.bZ(e,r.u_image),u_color_ramp:new t.bZ(e,r.u_color_ramp),u_opacity:new t.bp(e,r.u_opacity)}),hillshade:(e,r)=>({u_image:new t.bZ(e,r.u_image),u_latrange:new t.c2(e,r.u_latrange),u_exaggeration:new t.bp(e,r.u_exaggeration),u_altitudes:new t.c8(e,r.u_altitudes),u_azimuths:new t.c8(e,r.u_azimuths),u_accent:new t.b_(e,r.u_accent),u_method:new t.bZ(e,r.u_method),u_shadows:new t.c7(e,r.u_shadows),u_highlights:new t.c7(e,r.u_highlights)}),hillshadePrepare:(e,r)=>({u_matrix:new t.b$(e,r.u_matrix),u_image:new t.bZ(e,r.u_image),u_dimension:new t.c2(e,r.u_dimension),u_zoom:new t.bp(e,r.u_zoom),u_unpack:new t.c0(e,r.u_unpack)}),colorRelief:(e,r)=>({u_image:new t.bZ(e,r.u_image),u_unpack:new t.c0(e,r.u_unpack),u_dimension:new t.c2(e,r.u_dimension),u_elevation_stops:new t.bZ(e,r.u_elevation_stops),u_color_stops:new t.bZ(e,r.u_color_stops),u_color_ramp_size:new t.bZ(e,r.u_color_ramp_size),u_opacity:new t.bp(e,r.u_opacity)}),line:(e,r)=>({u_translation:new t.c2(e,r.u_translation),u_ratio:new t.bp(e,r.u_ratio),u_device_pixel_ratio:new t.bp(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.c2(e,r.u_units_to_pixels)}),lineGradient:(e,r)=>({u_translation:new t.c2(e,r.u_translation),u_ratio:new t.bp(e,r.u_ratio),u_device_pixel_ratio:new t.bp(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.c2(e,r.u_units_to_pixels),u_image:new t.bZ(e,r.u_image),u_image_height:new t.bp(e,r.u_image_height)}),linePattern:(e,r)=>({u_translation:new t.c2(e,r.u_translation),u_texsize:new t.c2(e,r.u_texsize),u_ratio:new t.bp(e,r.u_ratio),u_device_pixel_ratio:new t.bp(e,r.u_device_pixel_ratio),u_image:new t.bZ(e,r.u_image),u_units_to_pixels:new t.c2(e,r.u_units_to_pixels),u_scale:new t.c1(e,r.u_scale),u_fade:new t.bp(e,r.u_fade)}),lineSDF:(e,r)=>({u_translation:new t.c2(e,r.u_translation),u_ratio:new t.bp(e,r.u_ratio),u_device_pixel_ratio:new t.bp(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.c2(e,r.u_units_to_pixels),u_image:new t.bZ(e,r.u_image),u_mix:new t.bp(e,r.u_mix),u_tileratio:new t.bp(e,r.u_tileratio),u_crossfade_from:new t.bp(e,r.u_crossfade_from),u_crossfade_to:new t.bp(e,r.u_crossfade_to),u_lineatlas_width:new t.bp(e,r.u_lineatlas_width),u_lineatlas_height:new t.bp(e,r.u_lineatlas_height)}),lineGradientSDF:(e,r)=>({u_translation:new t.c2(e,r.u_translation),u_ratio:new t.bp(e,r.u_ratio),u_device_pixel_ratio:new t.bp(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.c2(e,r.u_units_to_pixels),u_image:new t.bZ(e,r.u_image),u_image_height:new t.bp(e,r.u_image_height),u_tileratio:new t.bp(e,r.u_tileratio),u_crossfade_from:new t.bp(e,r.u_crossfade_from),u_crossfade_to:new t.bp(e,r.u_crossfade_to),u_image_dash:new t.bZ(e,r.u_image_dash),u_mix:new t.bp(e,r.u_mix),u_lineatlas_width:new t.bp(e,r.u_lineatlas_width),u_lineatlas_height:new t.bp(e,r.u_lineatlas_height)}),raster:(e,r)=>({u_tl_parent:new t.c2(e,r.u_tl_parent),u_scale_parent:new t.bp(e,r.u_scale_parent),u_buffer_scale:new t.bp(e,r.u_buffer_scale),u_fade_t:new t.bp(e,r.u_fade_t),u_opacity:new t.bp(e,r.u_opacity),u_image0:new t.bZ(e,r.u_image0),u_image1:new t.bZ(e,r.u_image1),u_brightness_low:new t.bp(e,r.u_brightness_low),u_brightness_high:new t.bp(e,r.u_brightness_high),u_saturation_factor:new t.bp(e,r.u_saturation_factor),u_contrast_factor:new t.bp(e,r.u_contrast_factor),u_spin_weights:new t.c1(e,r.u_spin_weights),u_coords_top:new t.c0(e,r.u_coords_top),u_coords_bottom:new t.c0(e,r.u_coords_bottom)}),symbolIcon:(e,r)=>({u_is_size_zoom_constant:new t.bZ(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.bZ(e,r.u_is_size_feature_constant),u_size_t:new t.bp(e,r.u_size_t),u_size:new t.bp(e,r.u_size),u_camera_to_center_distance:new t.bp(e,r.u_camera_to_center_distance),u_pitch:new t.bp(e,r.u_pitch),u_rotate_symbol:new t.bZ(e,r.u_rotate_symbol),u_aspect_ratio:new t.bp(e,r.u_aspect_ratio),u_fade_change:new t.bp(e,r.u_fade_change),u_label_plane_matrix:new t.b$(e,r.u_label_plane_matrix),u_coord_matrix:new t.b$(e,r.u_coord_matrix),u_is_text:new t.bZ(e,r.u_is_text),u_pitch_with_map:new t.bZ(e,r.u_pitch_with_map),u_is_along_line:new t.bZ(e,r.u_is_along_line),u_is_variable_anchor:new t.bZ(e,r.u_is_variable_anchor),u_texsize:new t.c2(e,r.u_texsize),u_texture:new t.bZ(e,r.u_texture),u_translation:new t.c2(e,r.u_translation),u_pitched_scale:new t.bp(e,r.u_pitched_scale)}),symbolSDF:(e,r)=>({u_is_size_zoom_constant:new t.bZ(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.bZ(e,r.u_is_size_feature_constant),u_size_t:new t.bp(e,r.u_size_t),u_size:new t.bp(e,r.u_size),u_camera_to_center_distance:new t.bp(e,r.u_camera_to_center_distance),u_pitch:new t.bp(e,r.u_pitch),u_rotate_symbol:new t.bZ(e,r.u_rotate_symbol),u_aspect_ratio:new t.bp(e,r.u_aspect_ratio),u_fade_change:new t.bp(e,r.u_fade_change),u_label_plane_matrix:new t.b$(e,r.u_label_plane_matrix),u_coord_matrix:new t.b$(e,r.u_coord_matrix),u_is_text:new t.bZ(e,r.u_is_text),u_pitch_with_map:new t.bZ(e,r.u_pitch_with_map),u_is_along_line:new t.bZ(e,r.u_is_along_line),u_is_variable_anchor:new t.bZ(e,r.u_is_variable_anchor),u_texsize:new t.c2(e,r.u_texsize),u_texture:new t.bZ(e,r.u_texture),u_gamma_scale:new t.bp(e,r.u_gamma_scale),u_device_pixel_ratio:new t.bp(e,r.u_device_pixel_ratio),u_is_halo:new t.bZ(e,r.u_is_halo),u_translation:new t.c2(e,r.u_translation),u_pitched_scale:new t.bp(e,r.u_pitched_scale)}),symbolTextAndIcon:(e,r)=>({u_is_size_zoom_constant:new t.bZ(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.bZ(e,r.u_is_size_feature_constant),u_size_t:new t.bp(e,r.u_size_t),u_size:new t.bp(e,r.u_size),u_camera_to_center_distance:new t.bp(e,r.u_camera_to_center_distance),u_pitch:new t.bp(e,r.u_pitch),u_rotate_symbol:new t.bZ(e,r.u_rotate_symbol),u_aspect_ratio:new t.bp(e,r.u_aspect_ratio),u_fade_change:new t.bp(e,r.u_fade_change),u_label_plane_matrix:new t.b$(e,r.u_label_plane_matrix),u_coord_matrix:new t.b$(e,r.u_coord_matrix),u_is_text:new t.bZ(e,r.u_is_text),u_pitch_with_map:new t.bZ(e,r.u_pitch_with_map),u_is_along_line:new t.bZ(e,r.u_is_along_line),u_is_variable_anchor:new t.bZ(e,r.u_is_variable_anchor),u_texsize:new t.c2(e,r.u_texsize),u_texsize_icon:new t.c2(e,r.u_texsize_icon),u_texture:new t.bZ(e,r.u_texture),u_texture_icon:new t.bZ(e,r.u_texture_icon),u_gamma_scale:new t.bp(e,r.u_gamma_scale),u_device_pixel_ratio:new t.bp(e,r.u_device_pixel_ratio),u_is_halo:new t.bZ(e,r.u_is_halo),u_translation:new t.c2(e,r.u_translation),u_pitched_scale:new t.bp(e,r.u_pitched_scale)}),background:(e,r)=>({u_opacity:new t.bp(e,r.u_opacity),u_color:new t.b_(e,r.u_color)}),backgroundPattern:(e,r)=>({u_opacity:new t.bp(e,r.u_opacity),u_image:new t.bZ(e,r.u_image),u_pattern_tl_a:new t.c2(e,r.u_pattern_tl_a),u_pattern_br_a:new t.c2(e,r.u_pattern_br_a),u_pattern_tl_b:new t.c2(e,r.u_pattern_tl_b),u_pattern_br_b:new t.c2(e,r.u_pattern_br_b),u_texsize:new t.c2(e,r.u_texsize),u_mix:new t.bp(e,r.u_mix),u_pattern_size_a:new t.c2(e,r.u_pattern_size_a),u_pattern_size_b:new t.c2(e,r.u_pattern_size_b),u_scale_a:new t.bp(e,r.u_scale_a),u_scale_b:new t.bp(e,r.u_scale_b),u_pixel_coord_upper:new t.c2(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.c2(e,r.u_pixel_coord_lower),u_tile_units_to_pixels:new t.bp(e,r.u_tile_units_to_pixels)}),terrain:(e,r)=>({u_texture:new t.bZ(e,r.u_texture),u_ele_delta:new t.bp(e,r.u_ele_delta),u_fog_matrix:new t.b$(e,r.u_fog_matrix),u_fog_color:new t.b_(e,r.u_fog_color),u_fog_ground_blend:new t.bp(e,r.u_fog_ground_blend),u_fog_ground_blend_opacity:new t.bp(e,r.u_fog_ground_blend_opacity),u_horizon_color:new t.b_(e,r.u_horizon_color),u_horizon_fog_blend:new t.bp(e,r.u_horizon_fog_blend),u_is_globe_mode:new t.bp(e,r.u_is_globe_mode)}),terrainDepth:(e,r)=>({u_ele_delta:new t.bp(e,r.u_ele_delta)}),terrainCoords:(e,r)=>({u_texture:new t.bZ(e,r.u_texture),u_terrain_coords_id:new t.bp(e,r.u_terrain_coords_id),u_ele_delta:new t.bp(e,r.u_ele_delta)}),projectionErrorMeasurement:(e,r)=>({u_input:new t.bp(e,r.u_input),u_output_expected:new t.bp(e,r.u_output_expected)}),atmosphere:(e,r)=>({u_sun_pos:new t.c1(e,r.u_sun_pos),u_atmosphere_blend:new t.bp(e,r.u_atmosphere_blend),u_globe_position:new t.c1(e,r.u_globe_position),u_globe_radius:new t.bp(e,r.u_globe_radius),u_inv_proj_matrix:new t.b$(e,r.u_inv_proj_matrix)}),sky:(e,r)=>({u_sky_color:new t.b_(e,r.u_sky_color),u_horizon_color:new t.b_(e,r.u_horizon_color),u_horizon:new t.c2(e,r.u_horizon),u_horizon_normal:new t.c2(e,r.u_horizon_normal),u_sky_horizon_blend:new t.bp(e,r.u_sky_horizon_blend),u_sky_blend:new t.bp(e,r.u_sky_blend)})};class mn{constructor(e,t,r){this.context=e;const n=e.gl;this.buffer=n.createBuffer(),this.dynamicDraw=Boolean(r),this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const t=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const gn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class _n{constructor(e,t,r,n){this.length=t.length,this.attributes=r,this.itemSize=t.bytesPerElement,this.dynamicDraw=n,this.context=e;const i=e.gl;this.buffer=i.createBuffer(),e.bindVertexBuffer.set(this.buffer),i.bufferData(i.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,t){for(let r=0;r<this.attributes.length;r++){const n=t.attributes[this.attributes[r].name];void 0!==n&&e.enableVertexAttribArray(n)}}setVertexAttribPointers(e,t,r){for(let n=0;n<this.attributes.length;n++){const i=this.attributes[n],a=t.attributes[i.name];void 0!==a&&e.vertexAttribPointer(a,i.components,e[gn[i.type]],!1,this.itemSize,i.offset+this.itemSize*(r||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class yn{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class vn extends yn{getDefault(){return t.bo.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class bn extends yn{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class xn extends yn{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class wn extends yn{getDefault(){return[!0,!0,!0,!0]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Tn extends yn{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Sn extends yn{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Pn extends yn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class En extends yn{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Cn extends yn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}}class Mn extends yn{getDefault(){return[0,1]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class kn extends yn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}}class In extends yn{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class An extends yn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}}class zn extends yn{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Dn extends yn{getDefault(){return t.bo.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Ln extends yn{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class Rn extends yn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}}class Fn extends yn{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Bn extends yn{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class On extends yn{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Nn extends yn{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Vn extends yn{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class jn extends yn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class Un extends yn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Gn extends yn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class qn extends yn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class $n extends yn{getDefault(){return null}set(e){const t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Zn extends yn{getDefault(){return null}set(e){var t;if(e===this.current&&!this.dirty)return;const r=this.gl;Jt(r)?r.bindVertexArray(e):null===(t=r.getExtension("OES_vertex_array_object"))||void 0===t||t.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Hn extends yn{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class Wn extends yn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Xn extends yn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Yn extends yn{constructor(e,t){super(e),this.context=e,this.parent=t}getDefault(){return null}}class Kn extends Yn{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Qn extends Yn{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Jn extends Yn{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const ei="Framebuffer is not complete";class ti{constructor(e,t,r,n,i){this.context=e,this.width=t,this.height=r;const a=e.gl,o=this.framebuffer=a.createFramebuffer();if(this.colorAttachment=new Kn(e,o),n)this.depthAttachment=i?new Jn(e,o):new Qn(e,o);else if(i)throw new Error("Stencil cannot be set without depth");if(a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE)throw new Error(ei)}destroy(){const e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){const t=this.depthAttachment.get();t&&e.deleteRenderbuffer(t)}e.deleteFramebuffer(this.framebuffer)}}class ri{constructor(e){var t,r;if(this.gl=e,this.clearColor=new vn(this),this.clearDepth=new bn(this),this.clearStencil=new xn(this),this.colorMask=new wn(this),this.depthMask=new Tn(this),this.stencilMask=new Sn(this),this.stencilFunc=new Pn(this),this.stencilOp=new En(this),this.stencilTest=new Cn(this),this.depthRange=new Mn(this),this.depthTest=new kn(this),this.depthFunc=new In(this),this.blend=new An(this),this.blendFunc=new zn(this),this.blendColor=new Dn(this),this.blendEquation=new Ln(this),this.cullFace=new Rn(this),this.cullFaceSide=new Fn(this),this.frontFace=new Bn(this),this.program=new On(this),this.activeTexture=new Nn(this),this.viewport=new Vn(this),this.bindFramebuffer=new jn(this),this.bindRenderbuffer=new Un(this),this.bindTexture=new Gn(this),this.bindVertexBuffer=new qn(this),this.bindElementBuffer=new $n(this),this.bindVertexArray=new Zn(this),this.pixelStoreUnpack=new Hn(this),this.pixelStoreUnpackPremultiplyAlpha=new Wn(this),this.pixelStoreUnpackFlipY=new Xn(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Jt(e)){this.HALF_FLOAT=e.HALF_FLOAT;const n=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(t=e.RGBA16F)&&void 0!==t?t:null==n?void 0:n.RGBA16F_EXT,this.RGB16F=null!==(r=e.RGB16F)&&void 0!==r?r:null==n?void 0:n.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const t=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=null==t?void 0:t.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,t){return new mn(this,e,t)}createVertexBuffer(e,t,r){return new _n(this,e,t,r)}createRenderbuffer(e,t,r){const n=this.gl,i=n.createRenderbuffer();return this.bindRenderbuffer.set(i),n.renderbufferStorage(n.RENDERBUFFER,e,t,r),this.bindRenderbuffer.set(null),i}createFramebuffer(e,t,r,n){return new ti(this,e,t,r,n)}clear({color:e,depth:t,stencil:r}){const n=this.gl;let i=0;e&&(i|=n.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==t&&(i|=n.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(t),this.depthMask.set(!0)),void 0!==r&&(i|=n.STENCIL_BUFFER_BIT,this.clearStencil.set(r),this.stencilMask.set(255)),n.clear(i)}setCullFace(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){t.bQ(e.blendFunction,Zt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Jt(this.gl)?this.gl.createVertexArray():null===(e=this.gl.getExtension("OES_vertex_array_object"))||void 0===e?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var t;return Jt(this.gl)?this.gl.deleteVertexArray(e):null===(t=this.gl.getExtension("OES_vertex_array_object"))||void 0===t?void 0:t.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let ni;function ii(e,r,n,i,a){const o=e.context,s=e.transform,l=o.gl,c=e.useProgram("collisionBox"),u=[];let h=0,d=0;for(let t=0;t<i.length;t++){const p=i[t],f=r.getTile(p).getBucket(n);if(!f)continue;const m=a?f.textCollisionBox:f.iconCollisionBox,g=f.collisionCircleArray;g.length>0&&(u.push({circleArray:g,circleOffset:d,coord:p}),h+=g.length/4,d=h),m&&c.draw(o,l.LINES,Xt.disabled,Kt.disabled,e.colorModeForRenderPass(),Wt.disabled,Gr(e.transform),e.style.map.terrain&&e.style.map.terrain.getTerrainData(p),s.getProjectionData({overscaledTileID:p,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),n.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,null,e.transform.zoom,null,null,m.collisionVertexBuffer)}if(!a||!u.length)return;const p=e.useProgram("collisionCircle"),f=new t.c9;f.resize(4*h),f._trim();let m=0;for(const e of u)for(let t=0;t<e.circleArray.length/4;t++){const r=4*t,n=e.circleArray[r+0],i=e.circleArray[r+1],a=e.circleArray[r+2],o=e.circleArray[r+3];f.emplace(m++,n,i,a,o,0),f.emplace(m++,n,i,a,o,1),f.emplace(m++,n,i,a,o,2),f.emplace(m++,n,i,a,o,3)}(!ni||ni.length<2*h)&&(ni=function(e){const r=2*e,n=new t.cb;n.resize(r),n._trim();for(let e=0;e<r;e++){const t=6*e;n.uint16[t+0]=4*e+0,n.uint16[t+1]=4*e+1,n.uint16[t+2]=4*e+2,n.uint16[t+3]=4*e+2,n.uint16[t+4]=4*e+3,n.uint16[t+5]=4*e+0}return n}(h));const g=o.createIndexBuffer(ni,!0),_=o.createVertexBuffer(f,t.ca.members,!0);for(const r of u){const i=qr(e.transform);p.draw(o,l.TRIANGLES,Xt.disabled,Kt.disabled,e.colorModeForRenderPass(),Wt.disabled,i,e.style.map.terrain&&e.style.map.terrain.getTerrainData(r.coord),null,n.id,_,g,t.aW.simpleSegment(0,2*r.circleOffset,r.circleArray.length,r.circleArray.length/2),null,e.transform.zoom,null,null,null)}_.destroy(),g.destroy()}const ai=t.ar(new Float32Array(16));function oi(e,r,n,i,a,o){const{horizontalAlign:s,verticalAlign:l}=t.aR(e);return new t.P((-(s-.5)*r/a+i[0])*o,(-(l-.5)*n/a+i[1])*o)}function si(e,r,n,i,a,o){const s=r.tileAnchorPoint.add(new t.P(r.translation[0],r.translation[1]));if(r.pitchWithMap){let e=i.mult(o);n||(e=e.rotate(-a));const t=s.add(e);return Fe(t.x,t.y,r.pitchedLabelPlaneMatrix,r.getElevation).point}if(n){const t=$e(r.tileAnchorPoint.x+1,r.tileAnchorPoint.y,r).point.sub(e),n=Math.atan(t.y/t.x)+(t.x<0?Math.PI:0);return e.add(i.rotate(n))}return e.add(i)}function li(e,r,n,i,a,o,s,l,c,u,h,d){const p=e.text.placedSymbolArray,f=e.text.dynamicLayoutVertexArray,m=e.icon.dynamicLayoutVertexArray,g={};f.clear();for(let m=0;m<p.length;m++){const _=p.get(m),y=_.hidden||!_.crossTileID||e.allowVerticalPlacement&&!_.placedOrientation?null:i[_.crossTileID];if(y){const i=new t.P(_.anchorX,_.anchorY),p={getElevation:d,width:a.width,height:a.height,pitchedLabelPlaneMatrix:o,pitchWithMap:n,transform:a,tileAnchorPoint:i,translation:u,unwrappedTileID:h},m=n?He(i.x,i.y,p):$e(i.x,i.y,p),v=Be(a.cameraToCenterDistance,m.signedDistanceFromCamera);let b=t.az(e.textSizeData,l,_)*v/t.aL;n&&(b*=e.tilePixelRatio/s);const{width:x,height:w,anchor:T,textOffset:S,textBoxScale:P}=y,E=oi(T,x,w,S,P,b),C=a.getPitchedTextCorrection(i.x+u[0],i.y+u[1],h),M=si(m.point,p,r,E,-a.bearingInRadians,C),k=e.allowVerticalPlacement&&_.placedOrientation===t.ay.vertical?Math.PI/2:0;for(let e=0;e<_.numGlyphs;e++)t.aF(f,M,k);c&&_.associatedIconIndex>=0&&(g[_.associatedIconIndex]={shiftedAnchor:M,angle:k})}else Qe(_.numGlyphs,f)}if(c){m.clear();const r=e.icon.placedSymbolArray;for(let e=0;e<r.length;e++){const n=r.get(e);if(n.hidden)Qe(n.numGlyphs,m);else{const r=g[e];if(r)for(let e=0;e<n.numGlyphs;e++)t.aF(m,r.shiftedAnchor,r.angle);else Qe(n.numGlyphs,m)}}e.icon.dynamicLayoutVertexBuffer.updateData(m)}e.text.dynamicLayoutVertexBuffer.updateData(f)}function ci(e,t,r){return r.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function ui(e,r,n,i,a,o,s,l,c,u,h,d,p){const f=e.context,m=f.gl,g=e.transform,_="map"===l,y="map"===c,v="viewport"!==l&&"point"!==n.layout.get("symbol-placement"),b=_&&!y&&!v,x=!n.layout.get("symbol-sort-key").isConstant();let w=!1;const T=e.getDepthModeForSublayer(0,Xt.ReadOnly),S=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),P=[],E=g.getCircleRadiusCorrection();for(const l of i){const i=r.getTile(l),c=i.getBucket(n);if(!c)continue;const h=a?c.text:c.icon;if(!h||!h.segments.get().length||!h.hasVisibleVertices)continue;const d=h.programConfigurations.get(n.id),f=a||c.sdfIcons,T=a?c.textSizeData:c.iconSizeData,C=y||0!==g.pitch,M=e.useProgram(ci(f,a,c),d),k=t.ax(T,g.zoom),I=e.style.map.terrain&&e.style.map.terrain.getTerrainData(l);let A,z,D,L,R=[0,0],F=null;if(a)z=i.glyphAtlasTexture,D=m.LINEAR,A=i.glyphAtlasTexture.size,c.iconsInText&&(R=i.imageAtlasTexture.size,F=i.imageAtlasTexture,L=C||e.options.rotating||e.options.zooming||"composite"===T.kind||"camera"===T.kind?m.LINEAR:m.NEAREST);else{const t=1!==n.layout.get("icon-size").constantOr(0)||c.iconsNeedLinear;z=i.imageAtlasTexture,D=f||e.options.rotating||e.options.zooming||t||C?m.LINEAR:m.NEAREST,A=i.imageAtlasTexture.size}const B=t.aM(i,1,e.transform.zoom),O=De(_,e.transform,B),N=t.N();t.aA(N,O);const V=Le(y,_,e.transform,B),j=t.aN(g,i,o,s),U=g.getProjectionData({overscaledTileID:l,applyGlobeMatrix:!p,applyTerrainMatrix:!0}),G=S&&c.hasTextData(),q="none"!==n.layout.get("icon-text-fit")&&G&&c.hasIconData();if(v){const t=e.style.map.terrain?(t,r)=>e.style.map.terrain.getElevation(l,t,r):null,r="map"===n.layout.get("text-rotation-alignment");Ne(c,e,a,O,N,y,u,r,l.toUnwrapped(),g.width,g.height,j,t)}const $=a&&S||q,Z=v||$?ai:y?O:e.transform.clipSpaceToPixelsMatrix,H=f&&0!==n.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1);let W;W=f?c.iconsInText?un(T.kind,k,b,y,v,$,e,Z,V,j,A,R,E):cn(T.kind,k,b,y,v,$,e,Z,V,j,a,A,0,E):ln(T.kind,k,b,y,v,$,e,Z,V,j,a,A,E);const X={program:M,buffers:h,uniformValues:W,projectionData:U,atlasTexture:z,atlasTextureIcon:F,atlasInterpolation:D,atlasInterpolationIcon:L,isSDF:f,hasHalo:H};if(x&&c.canOverlap){w=!0;const e=h.segments.get();for(const r of e)P.push({segments:new t.aW([r]),sortKey:r.sortKey,state:X,terrainData:I})}else P.push({segments:h.segments,sortKey:0,state:X,terrainData:I})}w&&P.sort((e,t)=>e.sortKey-t.sortKey);for(const t of P){const r=t.state;if(f.activeTexture.set(m.TEXTURE0),r.atlasTexture.bind(r.atlasInterpolation,m.CLAMP_TO_EDGE),r.atlasTextureIcon&&(f.activeTexture.set(m.TEXTURE1),r.atlasTextureIcon&&r.atlasTextureIcon.bind(r.atlasInterpolationIcon,m.CLAMP_TO_EDGE)),r.isSDF){const i=r.uniformValues;r.hasHalo&&(i.u_is_halo=1,hi(r.buffers,t.segments,n,e,r.program,T,h,d,i,r.projectionData,t.terrainData)),i.u_is_halo=0}hi(r.buffers,t.segments,n,e,r.program,T,h,d,r.uniformValues,r.projectionData,t.terrainData)}}function hi(e,t,r,n,i,a,o,s,l,c,u){const h=n.context;i.draw(h,h.gl.TRIANGLES,a,o,s,Wt.backCCW,l,u,c,r.id,e.layoutVertexBuffer,e.indexBuffer,t,r.paint,n.transform.zoom,e.programConfigurations.get(r.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function di(e,r,n,i,a){const o=e.context,s=o.gl,l=Kt.disabled,c=new Zt([s.ONE,s.ONE],t.bo.transparent,[!0,!0,!0,!0]),u=r.getBucket(n);if(!u)return;const h=i.key;let d=n.heatmapFbos.get(h);d||(d=fi(o,r.tileSize,r.tileSize),n.heatmapFbos.set(h,d)),o.bindFramebuffer.set(d.framebuffer),o.viewport.set([0,0,r.tileSize,r.tileSize]),o.clear({color:t.bo.transparent});const p=u.programConfigurations.get(n.id),f=e.useProgram("heatmap",p,!a),m=e.transform.getProjectionData({overscaledTileID:r.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),g=e.style.map.terrain.getTerrainData(i);f.draw(o,s.TRIANGLES,Xt.disabled,l,c,Wt.disabled,Zr(r,e.transform.zoom,n.paint.get("heatmap-intensity"),1),g,m,n.id,u.layoutVertexBuffer,u.indexBuffer,u.segments,n.paint,e.transform.zoom,p)}function pi(e,t,r,n,i){const a=e.context,o=a.gl,s=e.transform;a.setColorMode(e.colorModeForRenderPass());const l=mi(a,t),c=r.key,u=t.heatmapFbos.get(c);if(!u)return;a.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,u.colorAttachment.get()),a.activeTexture.set(o.TEXTURE1),l.bind(o.LINEAR,o.CLAMP_TO_EDGE);const h=s.getProjectionData({overscaledTileID:r,applyTerrainMatrix:i,applyGlobeMatrix:!n});e.useProgram("heatmapTexture").draw(a,o.TRIANGLES,Xt.disabled,Kt.disabled,e.colorModeForRenderPass(),Wt.disabled,Hr(e,t,0,1),null,h,t.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments,t.paint,s.zoom),u.destroy(),t.heatmapFbos.delete(c)}function fi(e,t,r){var n,i;const a=e.gl,o=a.createTexture();a.bindTexture(a.TEXTURE_2D,o),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);const s=null!==(n=e.HALF_FLOAT)&&void 0!==n?n:a.UNSIGNED_BYTE,l=null!==(i=e.RGBA16F)&&void 0!==i?i:a.RGBA;a.texImage2D(a.TEXTURE_2D,0,l,t,r,0,a.RGBA,s,null);const c=e.createFramebuffer(t,r,!1,!1);return c.colorAttachment.set(o),c}function mi(e,r){return r.colorRampTexture||(r.colorRampTexture=new t.T(e,r.colorRamp,e.gl.RGBA)),r.colorRampTexture}function gi(e,r,n,i,a,o,s,l){let c=256;if(a.stepInterpolant){const i=r.getSource().maxzoom,a=s.canonical.z===i?Math.ceil(1<<e.transform.maxZoom-s.canonical.z):1;c=t.an(t.cd(o.maxLineLength/t.a4*1024*a),256,n.maxTextureSize)}return l.gradient=t.ce({expression:a.gradientExpression(),evaluationKey:"lineProgress",resolution:c,image:l.gradient||void 0,clips:o.lineClipsArray}),l.texture?l.texture.update(l.gradient):l.texture=new t.T(n,l.gradient,i.RGBA),l.version=a.gradientVersion,l.texture}function _i(e,t,r,n,i){e.activeTexture.set(t.TEXTURE0),r.imageAtlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE),n.updatePaintBuffers(i)}function yi(e,t,r,n,i,a){(i||e.lineAtlas.dirty)&&(t.activeTexture.set(r.TEXTURE0),e.lineAtlas.bind(t)),n.updatePaintBuffers(a)}function vi(e,t,r,n,i,a,o){const s=a.gradients[i.id];let l=s.texture;i.gradientVersion!==s.version&&(l=gi(e,t,r,n,i,a,o,s)),r.activeTexture.set(n.TEXTURE0),l.bind(i.stepInterpolant?n.NEAREST:n.LINEAR,n.CLAMP_TO_EDGE)}function bi(e,t,r,n,i,a,o,s,l){const c=a.gradients[i.id];let u=c.texture;i.gradientVersion!==c.version&&(u=gi(e,t,r,n,i,a,o,c)),r.activeTexture.set(n.TEXTURE0),u.bind(i.stepInterpolant?n.NEAREST:n.LINEAR,n.CLAMP_TO_EDGE),r.activeTexture.set(n.TEXTURE1),e.lineAtlas.bind(r),s.updatePaintBuffers(l)}function xi(e,t,r,n,i){if(!r||!n||!n.imageAtlas)return;const a=n.imageAtlas.patternPositions;let o=a[r.to.toString()],s=a[r.from.toString()];if(!o&&s&&(o=s),!s&&o&&(s=o),!o||!s){const e=i.getPaintProperty(t);o=a[e],s=a[e]}o&&s&&e.setConstantPatternPositions(o,s)}function wi(e,r,n,i,a,o,s,l){const c=e.context.gl,u="fill-pattern",h=n.paint.get(u),d=h&&h.constantOr(1),p=n.getCrossfadeParameters();let f,m,g,_,y;const v=e.transform,b=n.paint.get("fill-translate"),x=n.paint.get("fill-translate-anchor");s?(m=d&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",f=c.LINES):(m=d?"fillPattern":"fill",f=c.TRIANGLES);const w=h.constantOr(null);for(const h of i){const i=r.getTile(h);if(d&&!i.patternsLoaded())continue;const T=i.getBucket(n);if(!T)continue;const S=T.programConfigurations.get(n.id),P=e.useProgram(m,S),E=e.style.map.terrain&&e.style.map.terrain.getTerrainData(h);d&&(e.context.activeTexture.set(c.TEXTURE0),i.imageAtlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE),S.updatePaintBuffers(p)),xi(S,u,w,i,n);const C=v.getProjectionData({overscaledTileID:h,applyGlobeMatrix:!l,applyTerrainMatrix:!0}),M=t.aN(v,i,b,x);if(s){_=T.indexBuffer2,y=T.segments2;const t=[c.drawingBufferWidth,c.drawingBufferHeight];g="fillOutlinePattern"===m&&d?jr(e,p,i,t,M):Vr(t,M)}else _=T.indexBuffer,y=T.segments,g=d?Nr(e,p,i,M):{u_fill_translate:M};const k=e.stencilModeForClipping(h);P.draw(e.context,f,a,k,o,Wt.backCCW,g,E,C,n.id,T.layoutVertexBuffer,_,y,n.paint,e.transform.zoom,S)}}function Ti(e,r,n,i,a,o,s,l){const c=e.context,u=c.gl,h="fill-extrusion-pattern",d=n.paint.get(h),p=d.constantOr(1),f=n.getCrossfadeParameters(),m=n.paint.get("fill-extrusion-opacity"),g=d.constantOr(null),_=e.transform;for(const d of i){const i=r.getTile(d),y=i.getBucket(n);if(!y)continue;const v=e.style.map.terrain&&e.style.map.terrain.getTerrainData(d),b=y.programConfigurations.get(n.id),x=e.useProgram(p?"fillExtrusionPattern":"fillExtrusion",b);p&&(e.context.activeTexture.set(u.TEXTURE0),i.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),b.updatePaintBuffers(f));const w=_.getProjectionData({overscaledTileID:d,applyGlobeMatrix:!l,applyTerrainMatrix:!0});xi(b,h,g,i,n);const T=t.aN(_,i,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),S=n.paint.get("fill-extrusion-vertical-gradient"),P=p?Or(e,S,m,T,d,f,i):Br(e,S,m,T);x.draw(c,c.gl.TRIANGLES,a,o,s,Wt.backCCW,P,v,w,n.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,n.paint,e.transform.zoom,b,e.style.map.terrain&&y.centroidVertexBuffer)}}function Si(e,t,r,n,i,a,o,s,l){var c;const u=e.style.projection,h=e.context,d=e.transform,p=h.gl,f=[`#define NUM_ILLUMINATION_SOURCES ${r.paint.get("hillshade-highlight-color").values.length}`],m=e.useProgram("hillshade",null,!1,f),g=!e.options.moving;for(const f of n){const n=t.getTile(f),_=n.fbo;if(!_)continue;const y=u.getMeshFromTileID(h,f.canonical,s,!0,"raster"),v=null===(c=e.style.map.terrain)||void 0===c?void 0:c.getTerrainData(f);h.activeTexture.set(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,_.colorAttachment.get());const b=d.getProjectionData({overscaledTileID:f,aligned:g,applyGlobeMatrix:!l,applyTerrainMatrix:!0});m.draw(h,p.TRIANGLES,a,i[f.overscaledZ],o,Wt.backCCW,Wr(e,n,r),v,b,r.id,y.vertexBuffer,y.indexBuffer,y.segments)}}function Pi(e,r,n,i,a,o,s,l,c){var u;const h=e.style.projection,d=e.context,p=e.transform,f=d.gl,m=e.useProgram("colorRelief"),g=!e.options.moving;let _=!0,y=0;for(const v of i){const i=r.getTile(v),b=i.dem;if(_){const e=f.getParameter(f.MAX_TEXTURE_SIZE),{elevationTexture:t,colorTexture:r}=n.getColorRampTextures(d,e,b.getUnpackVector());d.activeTexture.set(f.TEXTURE1),t.bind(f.NEAREST,f.CLAMP_TO_EDGE),d.activeTexture.set(f.TEXTURE4),r.bind(f.LINEAR,f.CLAMP_TO_EDGE),_=!1,y=t.size[0]}if(!b||!b.data)continue;const x=b.stride,w=b.getPixels();if(d.activeTexture.set(f.TEXTURE0),d.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||e.getTileTexture(x),i.demTexture){const e=i.demTexture;e.update(w,{premultiply:!1}),e.bind(f.LINEAR,f.CLAMP_TO_EDGE)}else i.demTexture=new t.T(d,w,f.RGBA,{premultiply:!1}),i.demTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE);const T=h.getMeshFromTileID(d,v.canonical,l,!0,"raster"),S=null===(u=e.style.map.terrain)||void 0===u?void 0:u.getTerrainData(v),P=p.getProjectionData({overscaledTileID:v,aligned:g,applyGlobeMatrix:!c,applyTerrainMatrix:!0});m.draw(d,f.TRIANGLES,o,a[v.overscaledZ],s,Wt.backCCW,Kr(n,i.dem,y),S,P,n.id,T.vertexBuffer,T.indexBuffer,T.segments)}}const Ei=[new t.P(0,0),new t.P(t.a4,0),new t.P(t.a4,t.a4),new t.P(0,t.a4)];function Ci(e,t,r,n,i,a,o,s,l=!1,c=!1){const u=n[n.length-1].overscaledZ,h=e.context,d=h.gl,p=e.useProgram("raster"),f=e.transform,m=e.style.projection,g=e.colorModeForRenderPass(),_=!e.options.moving,y=r.paint.get("raster-opacity"),v=r.paint.get("raster-resampling"),b=r.paint.get("raster-fade-duration"),x=!!e.style.map.terrain;for(const w of n){const n=e.getDepthModeForSublayer(w.overscaledZ-u,1===y?Xt.ReadWrite:Xt.ReadOnly,d.LESS),T=t.getTile(w),S="nearest"===v?d.NEAREST:d.LINEAR;h.activeTexture.set(d.TEXTURE0),T.texture.bind(S,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),h.activeTexture.set(d.TEXTURE1);const{parentTile:P,parentScaleBy:E,parentTopLeft:C,fadeValues:M}=Mi(T,t,b,x);T.fadeOpacity=M.tileOpacity,P?(P.fadeOpacity=M.parentTileOpacity,P.texture.bind(S,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST)):T.texture.bind(S,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),T.texture.useMipmap&&h.extTextureFilterAnisotropic&&e.transform.pitch>20&&d.texParameterf(d.TEXTURE_2D,h.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h.extTextureFilterAnisotropicMax);const k=e.style.map.terrain&&e.style.map.terrain.getTerrainData(w),I=f.getProjectionData({overscaledTileID:w,aligned:_,applyGlobeMatrix:!c,applyTerrainMatrix:!0}),A=on(C,E,M.fadeMix,r,s),z=m.getMeshFromTileID(h,w.canonical,a,o,"raster");p.draw(h,d.TRIANGLES,n,i?i[w.overscaledZ]:Kt.disabled,g,l?Wt.frontCCW:Wt.backCCW,A,k,I,r.id,z.vertexBuffer,z.indexBuffer,z.segments)}}function Mi(e,r,n,i){const a={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(0===n||i)return a;if(e.fadingParentID){const i=r.getLoadedTile(e.fadingParentID);if(!i)return a;const o=Math.pow(2,i.tileID.overscaledZ-e.tileID.overscaledZ),s=[e.tileID.canonical.x*o%1,e.tileID.canonical.y*o%1],l=function(e,r,n){const i=c(),a=(i-r.timeAdded)/n,o=e.fadingDirection===he.Incoming,s=t.an((i-e.timeAdded)/n,0,1),l=t.an(1-a,0,1),u=o?s:l;return{tileOpacity:u,parentTileOpacity:o?l:s,fadeMix:{opacity:1,mix:1-u}}}(e,i,n);return{parentTile:i,parentScaleBy:o,parentTopLeft:s,fadeValues:l}}if(e.selfFading){const r=function(e,r){const n=(c()-e.timeAdded)/r,i=t.an(n,0,1);return{tileOpacity:i,fadeMix:{opacity:i,mix:0}}}(e,n);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:r}}return a}const ki=new t.bo(1,0,0,1),Ii=new t.bo(0,1,0,1),Ai=new t.bo(0,0,1,1),zi=new t.bo(1,0,1,1),Di=new t.bo(0,1,1,1);function Li(e,t,r,n){Fi(e,0,t+r/2,e.transform.width,r,n)}function Ri(e,t,r,n){Fi(e,t-r/2,0,r,e.transform.height,n)}function Fi(e,t,r,n,i,a){const o=e.context,s=o.gl;s.enable(s.SCISSOR_TEST),s.scissor(t*e.pixelRatio,r*e.pixelRatio,n*e.pixelRatio,i*e.pixelRatio),o.clear({color:a}),s.disable(s.SCISSOR_TEST)}function Bi(e,r,n){const i=e.context,a=i.gl,o=e.useProgram("debug"),s=Xt.disabled,l=Kt.disabled,c=e.colorModeForRenderPass(),u="$debug",h=e.style.map.terrain&&e.style.map.terrain.getTerrainData(n);i.activeTexture.set(a.TEXTURE0);const d=r.getTileByID(n.key).latestRawTileData,p=Math.floor((d&&d.byteLength||0)/1024),f=r.getTile(n).tileSize,m=512/Math.min(f,512)*(n.overscaledZ/e.transform.zoom)*.5;let g=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(g+=` => ${n.overscaledZ}`),function(e,t){e.initDebugOverlayCanvas();const r=e.debugOverlayCanvas,n=e.context.gl,i=e.debugOverlayCanvas.getContext("2d");i.clearRect(0,0,r.width,r.height),i.shadowColor="white",i.shadowBlur=2,i.lineWidth=1.5,i.strokeStyle="white",i.textBaseline="top",i.font="bold 36px Open Sans, sans-serif",i.fillText(t,5,5),i.strokeText(t,5,5),e.debugOverlayTexture.update(r),e.debugOverlayTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}(e,`${g} ${p}kB`);const _=e.transform.getProjectionData({overscaledTileID:n,applyGlobeMatrix:!0,applyTerrainMatrix:!0});o.draw(i,a.TRIANGLES,s,l,Zt.alphaBlended,Wt.disabled,$r(t.bo.transparent,m),null,_,u,e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments),o.draw(i,a.LINE_STRIP,s,l,c,Wt.disabled,$r(t.bo.red),h,_,u,e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments)}function Oi(e,t,r,n){const{isRenderingGlobe:i}=n,a=e.context,o=a.gl,s=e.transform,l=e.colorModeForRenderPass(),c=e.getDepthModeFor3D(),u=e.useProgram("terrain");a.bindFramebuffer.set(null),a.viewport.set([0,0,e.width,e.height]);for(const n of r){const r=t.getTerrainMesh(n.tileID),h=e.renderToTexture.getTexture(n),d=t.getTerrainData(n.tileID);a.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,h.texture);const p=t.getMeshFrameDelta(s.zoom),f=s.calculateFogMatrix(n.tileID.toUnwrapped()),m=zr(p,f,e.style.sky,s.pitch,i),g=s.getProjectionData({overscaledTileID:n.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});u.draw(a,o.TRIANGLES,c,Kt.disabled,l,Wt.backCCW,m,d,g,"terrain",r.vertexBuffer,r.indexBuffer,r.segments)}}function Ni(e,r){if(!r.mesh){const n=new t.aV;n.emplaceBack(-1,-1),n.emplaceBack(1,-1),n.emplaceBack(1,1),n.emplaceBack(-1,1);const i=new t.aX;i.emplaceBack(0,1,2),i.emplaceBack(0,2,3),r.mesh=new kt(e.createVertexBuffer(n,It.members),e.createIndexBuffer(i),t.aW.simpleSegment(0,0,n.length,i.length))}return r.mesh}class Vi{constructor(e,r){this.context=new ri(e),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:t.ar(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ce.maxOverzooming+Ce.maxUnderzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Pt}resize(e,t,r){if(this.width=Math.floor(e*r),this.height=Math.floor(t*r),this.pixelRatio=r,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const e of this.style._order)this.style._layers[e].resize()}setup(){const e=this.context,r=new t.aV;r.emplaceBack(0,0),r.emplaceBack(t.a4,0),r.emplaceBack(0,t.a4),r.emplaceBack(t.a4,t.a4),this.tileExtentBuffer=e.createVertexBuffer(r,It.members),this.tileExtentSegments=t.aW.simpleSegment(0,0,4,2);const n=new t.aV;n.emplaceBack(0,0),n.emplaceBack(t.a4,0),n.emplaceBack(0,t.a4),n.emplaceBack(t.a4,t.a4),this.debugBuffer=e.createVertexBuffer(n,It.members),this.debugSegments=t.aW.simpleSegment(0,0,4,5);const i=new t.cg;i.emplaceBack(0,0,0,0),i.emplaceBack(t.a4,0,t.a4,0),i.emplaceBack(0,t.a4,0,t.a4),i.emplaceBack(t.a4,t.a4,t.a4,t.a4),this.rasterBoundsBuffer=e.createVertexBuffer(i,Ir.members),this.rasterBoundsSegments=t.aW.simpleSegment(0,0,4,2);const a=new t.aV;a.emplaceBack(0,0),a.emplaceBack(t.a4,0),a.emplaceBack(0,t.a4),a.emplaceBack(t.a4,t.a4),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(a,It.members),this.rasterBoundsSegmentsPosOnly=t.aW.simpleSegment(0,0,4,5);const o=new t.aV;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,It.members),this.viewportSegments=t.aW.simpleSegment(0,0,4,2);const s=new t.ch;s.emplaceBack(0),s.emplaceBack(1),s.emplaceBack(3),s.emplaceBack(2),s.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(s);const l=new t.aX;l.emplaceBack(1,0,2),l.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(l);const c=this.context.gl;this.stencilClearMode=new Kt({func:c.ALWAYS,mask:0},0,255,c.ZERO,c.ZERO,c.ZERO),this.tileExtentMesh=new kt(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,r=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const n=t.N();t.c6(n,0,this.width,this.height,0,0,1),t.Q(n,n,[r.drawingBufferWidth,r.drawingBufferHeight,0]);const i={mainMatrix:n,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:n};this.useProgram("clippingMask",null,!0).draw(e,r.TRIANGLES,Xt.disabled,this.stencilClearMode,Zt.disabled,Wt.disabled,null,null,i,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,t,r){if(this.currentStencilSource===e.source||!e.isTileClipped()||!t||!t.length)return;this.currentStencilSource=e.source,this.nextStencilID+t.length>256&&this.clearStencil();const n=this.context;n.setColorMode(Zt.disabled),n.setDepthMode(Xt.disabled);const i={};for(const e of t)i[e.key]=this.nextStencilID++;this._renderTileMasks(i,t,r,!0),this._renderTileMasks(i,t,r,!1),this._tileClippingMaskIDs=i}_renderTileMasks(e,t,r,n){const i=this.context,a=i.gl,o=this.style.projection,s=this.transform,l=this.useProgram("clippingMask");for(const c of t){const t=e[c.key],u=this.style.map.terrain&&this.style.map.terrain.getTerrainData(c),h=o.getMeshFromTileID(this.context,c.canonical,n,!0,"stencil"),d=s.getProjectionData({overscaledTileID:c,applyGlobeMatrix:!r,applyTerrainMatrix:!0});l.draw(i,a.TRIANGLES,Xt.disabled,new Kt({func:a.ALWAYS,mask:0},t,255,a.KEEP,a.KEEP,a.REPLACE),Zt.disabled,r?Wt.disabled:Wt.backCCW,null,u,d,"$clipping",h.vertexBuffer,h.indexBuffer,h.segments)}}_renderTilesDepthBuffer(){const e=this.context,t=e.gl,r=this.style.projection,n=this.transform,i=this.useProgram("depth"),a=this.getDepthModeFor3D(),o=Pe(n,{tileSize:n.tileSize});for(const s of o){const o=this.style.map.terrain&&this.style.map.terrain.getTerrainData(s),l=r.getMeshFromTileID(this.context,s.canonical,!0,!0,"raster"),c=n.getProjectionData({overscaledTileID:s,applyGlobeMatrix:!0,applyTerrainMatrix:!0});i.draw(e,t.TRIANGLES,a,Kt.disabled,Zt.disabled,Wt.backCCW,null,o,c,"$clipping",l.vertexBuffer,l.indexBuffer,l.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,t=this.context.gl;return new Kt({func:t.NOTEQUAL,mask:255},e,255,t.KEEP,t.KEEP,t.REPLACE)}stencilModeForClipping(e){const t=this.context.gl;return new Kt({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const t=this.context.gl,r=e.sort((e,t)=>t.overscaledZ-e.overscaledZ),n=r[r.length-1].overscaledZ,i=r[0].overscaledZ-n+1;if(i>1){this.currentStencilSource=void 0,this.nextStencilID+i>256&&this.clearStencil();const e={};for(let r=0;r<i;r++)e[r+n]=new Kt({func:t.GEQUAL,mask:255},r+this.nextStencilID,255,t.KEEP,t.KEEP,t.REPLACE);return this.nextStencilID+=i,[e,r]}return[{[n]:Kt.disabled},r]}stencilConfigForOverlapTwoPass(e){const t=this.context.gl,r=e.sort((e,t)=>t.overscaledZ-e.overscaledZ),n=r[r.length-1].overscaledZ,i=r[0].overscaledZ-n+1;if(this.clearStencil(),i>1){const e={},a={};for(let r=0;r<i;r++)e[r+n]=new Kt({func:t.GREATER,mask:255},i+1+r,255,t.KEEP,t.KEEP,t.REPLACE),a[r+n]=new Kt({func:t.GREATER,mask:255},1+r,255,t.KEEP,t.KEEP,t.REPLACE);return this.nextStencilID=2*i+1,[e,a,r]}return this.nextStencilID=3,[{[n]:new Kt({func:t.GREATER,mask:255},2,255,t.KEEP,t.KEEP,t.REPLACE)},{[n]:new Kt({func:t.GREATER,mask:255},1,255,t.KEEP,t.KEEP,t.REPLACE)},r]}colorModeForRenderPass(){const e=this.context.gl;if(this._showOverdrawInspector){const r=1/8;return new Zt([e.CONSTANT_COLOR,e.ONE],new t.bo(r,r,r,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?Zt.unblended:Zt.alphaBlended}getDepthModeForSublayer(e,t,r){if(!this.opaquePassEnabledForLayer())return Xt.disabled;const n=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Xt(r||this.context.gl.LEQUAL,t,[n,n])}getDepthModeFor3D(){return new Xt(this.context.gl.LEQUAL,Xt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,r){var n,i;this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(c()),this.imageManager.beginFrame();const a=this.style._order,o=this.style.tileManagers,s={},l={},u={},h={isRenderingToTexture:!1,isRenderingGlobe:(null===(n=e.projection)||void 0===n?void 0:n.transitionState)>0};for(const e in o){const t=o[e];t.used&&t.prepare(this.context),s[e]=t.getVisibleCoordinates(!1),l[e]=s[e].slice().reverse(),u[e]=t.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let e=0;e<a.length;e++)if(this.style._layers[a[e]].is3D()){this.opaquePassCutoff=e;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const e of a){const t=this.style._layers[e];if(!t.hasOffscreenPass()||t.isHidden(this.transform.zoom))continue;const r=l[t.source];("custom"===t.type||r.length)&&this.renderLayer(this,o[t.source],t,r,h)}if(null===(i=this.style.projection)||void 0===i||i.updateGPUdependent({context:this.context,useProgram:e=>this.useProgram(e)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?t.bo.black:t.bo.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(e,t){const r=e.context,n=r.gl,i=((e,t,r)=>{const n=Math.cos(t.rollInRadians),i=Math.sin(t.rollInRadians),a=_e(t),o=t.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:e.properties.get("sky-color"),u_horizon_color:e.properties.get("horizon-color"),u_horizon:[(t.width/2-a*i)*r,(t.height/2+a*n)*r],u_horizon_normal:[-i,n],u_sky_horizon_blend:e.properties.get("sky-horizon-blend")*t.height/2*r,u_sky_blend:o}})(t,e.style.map.transform,e.pixelRatio),a=new Xt(n.LEQUAL,Xt.ReadWrite,[0,1]),o=Kt.disabled,s=e.colorModeForRenderPass(),l=e.useProgram("sky"),c=Ni(r,t);l.draw(r,n.TRIANGLES,a,o,s,Wt.disabled,i,null,void 0,"sky",c.vertexBuffer,c.indexBuffer,c.segments)}(this,this.style.sky),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=a.length-1;this.currentLayer>=0;this.currentLayer--){const e=this.style._layers[a[this.currentLayer]],t=o[e.source],r=s[e.source];this._renderTileClippingMasks(e,r,!1),this.renderLayer(this,t,e,r,h)}this.renderPass="translucent";let d=!1;for(this.currentLayer=0;this.currentLayer<a.length;this.currentLayer++){const e=this.style._layers[a[this.currentLayer]],t=o[e.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(e,h))continue;this.opaquePassEnabledForLayer()||d||(d=!0,h.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const r=("symbol"===e.type?u:l)[e.source];this._renderTileClippingMasks(e,s[e.source],!!this.renderToTexture),this.renderLayer(this,t,e,r,h)}if(h.isRenderingGlobe&&function(e,r,n){const i=e.context,a=i.gl,o=e.useProgram("atmosphere"),s=new Xt(a.LEQUAL,Xt.ReadOnly,[0,1]),l=e.transform,c=function(e,r){const n=e.properties.get("position"),i=[-n.x,-n.y,-n.z],a=t.ar(new Float64Array(16));return"map"===e.properties.get("anchor")&&(t.bf(a,a,r.rollInRadians),t.bg(a,a,-r.pitchInRadians),t.bf(a,a,r.bearingInRadians),t.bg(a,a,r.center.lat*Math.PI/180),t.bI(a,a,-r.center.lng*Math.PI/180)),t.cf(i,i,a),i}(n,e.transform),u=l.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),h=r.properties.get("atmosphere-blend")*u.projectionTransition;if(0===h)return;const d=ur(l.worldSize,l.center.lat),p=l.inverseProjectionMatrix,f=new Float64Array(4);f[3]=1,t.aG(f,f,l.modelViewProjectionMatrix),f[0]/=f[3],f[1]/=f[3],f[2]/=f[3],f[3]=1,t.aG(f,f,p),f[0]/=f[3],f[1]/=f[3],f[2]/=f[3],f[3]=1;const m=((e,t,r,n,i)=>({u_sun_pos:e,u_atmosphere_blend:t,u_globe_position:r,u_globe_radius:n,u_inv_proj_matrix:i}))(c,h,[f[0],f[1],f[2]],d,p),g=Ni(i,r);o.draw(i,a.TRIANGLES,s,Kt.disabled,Zt.alphaBlended,Wt.disabled,m,null,null,"atmosphere",g.vertexBuffer,g.indexBuffer,g.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const e=function(e,t){let r=null;const n=Object.values(e._layers).flatMap(r=>r.source&&!r.isHidden(t)?[e.tileManagers[r.source]]:[]),i=n.filter(e=>"vector"===e.getSource().type),a=n.filter(e=>"vector"!==e.getSource().type),o=e=>{(!r||r.getSource().maxzoom<e.getSource().maxzoom)&&(r=e)};return i.forEach(e=>o(e)),r||a.forEach(e=>o(e)),r}(this.style,this.transform.zoom);e&&function(e,t,r){for(let n=0;n<r.length;n++)Bi(e,t,r[n])}(this,e,e.getVisibleCoordinates())}this.options.showPadding&&function(e){const t=e.transform.padding;Li(e,e.transform.height-(t.top||0),3,ki),Li(e,t.bottom||0,3,Ii),Ri(e,t.left||0,3,Ai),Ri(e,e.transform.width-(t.right||0),3,zi);const r=e.transform.centerPoint;!function(e,t,r,n){Fi(e,t-1,r-10,2,20,n),Fi(e,t-10,r-1,20,2,n)}(e,r.x,e.transform.height-r.y,Di)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const r=this.terrainFacilitator.matrix,n=this.transform.modelViewProjectionMatrix;let i=this.terrainFacilitator.dirty;i||(i=e?!t.ci(r,n):!t.cj(r,n)),i||(i=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),i&&(t.ck(r,n),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(e,r){const n=e.context,i=n.gl,a=e.transform,o=Zt.unblended,s=new Xt(i.LEQUAL,Xt.ReadWrite,[0,1]),l=r.tileManager.getRenderableTiles(),c=e.useProgram("terrainDepth");n.bindFramebuffer.set(r.getFramebuffer("depth").framebuffer),n.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),n.clear({color:t.bo.transparent,depth:1});for(const e of l){const t=r.getTerrainMesh(e.tileID),l=r.getTerrainData(e.tileID),u=a.getProjectionData({overscaledTileID:e.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),h={u_ele_delta:r.getMeshFrameDelta(a.zoom)};c.draw(n,i.TRIANGLES,s,Kt.disabled,o,Wt.backCCW,h,l,u,"terrain",t.vertexBuffer,t.indexBuffer,t.segments)}n.bindFramebuffer.set(null),n.viewport.set([0,0,e.width,e.height])}(this,this.style.map.terrain),function(e,r){const n=e.context,i=n.gl,a=e.transform,o=Zt.unblended,s=new Xt(i.LEQUAL,Xt.ReadWrite,[0,1]),l=r.getCoordsTexture(),c=r.tileManager.getRenderableTiles(),u=e.useProgram("terrainCoords");n.bindFramebuffer.set(r.getFramebuffer("coords").framebuffer),n.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),n.clear({color:t.bo.transparent,depth:1}),r.coordsIndex=[];for(const e of c){const t=r.getTerrainMesh(e.tileID),c=r.getTerrainData(e.tileID);n.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,l.texture);const h={u_terrain_coords_id:(255-r.coordsIndex.length)/255,u_texture:0,u_ele_delta:r.getMeshFrameDelta(a.zoom)},d=a.getProjectionData({overscaledTileID:e.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});u.draw(n,i.TRIANGLES,s,Kt.disabled,o,Wt.backCCW,h,c,d,"terrain",t.vertexBuffer,t.indexBuffer,t.segments),r.coordsIndex.push(e.tileID.key)}n.bindFramebuffer.set(null),n.viewport.set([0,0,e.width,e.height])}(this,this.style.map.terrain))}renderLayer(e,r,n,i,a){n.isHidden(this.transform.zoom)||("background"===n.type||"custom"===n.type||(i||[]).length)&&(this.id=n.id,t.cl(n)?function(e,r,n,i,a,o){if("translucent"!==e.renderPass)return;const{isRenderingToTexture:s}=o,l=Kt.disabled,c=e.colorModeForRenderPass();(n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(e,r,n,i,a,o,s,l,c){const u=r.transform,h=r.style.map.terrain,d="map"===a,p="map"===o;for(const a of e){const e=i.getTile(a),o=e.getBucket(n);if(!o||!o.text||!o.text.segments.get().length)continue;const f=t.ax(o.textSizeData,u.zoom),m=t.aM(e,1,r.transform.zoom),g=De(d,r.transform,m),_="none"!==n.layout.get("icon-text-fit")&&o.hasIconData();if(f){const r=Math.pow(2,u.zoom-e.tileID.overscaledZ),n=h?(e,t)=>h.getElevation(a,e,t):null;li(o,d,p,c,u,g,r,f,_,t.aN(u,e,s,l),a.toUnwrapped(),n)}}}(i,e,n,r,n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),a),0!==n.paint.get("icon-opacity").constantOr(1)&&ui(e,r,n,i,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),l,c,s),0!==n.paint.get("text-opacity").constantOr(1)&&ui(e,r,n,i,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),l,c,s),r.map.showCollisionBoxes&&(ii(e,r,n,i,!0),ii(e,r,n,i,!1))}(e,r,n,i,this.style.placement.variableOffsets,a):t.cm(n)?function(e,r,n,i,a){if("translucent"!==e.renderPass)return;const{isRenderingToTexture:o}=a,s=n.paint.get("circle-opacity"),l=n.paint.get("circle-stroke-width"),c=n.paint.get("circle-stroke-opacity"),u=!n.layout.get("circle-sort-key").isConstant();if(0===s.constantOr(1)&&(0===l.constantOr(1)||0===c.constantOr(1)))return;const h=e.context,d=h.gl,p=e.transform,f=e.getDepthModeForSublayer(0,Xt.ReadOnly),m=Kt.disabled,g=e.colorModeForRenderPass(),_=[],y=p.getCircleRadiusCorrection();for(let a=0;a<i.length;a++){const s=i[a],l=r.getTile(s),c=l.getBucket(n);if(!c)continue;const h=n.paint.get("circle-translate"),d=n.paint.get("circle-translate-anchor"),f=t.aN(p,l,h,d),m=c.programConfigurations.get(n.id),g=e.useProgram("circle",m),v=c.layoutVertexBuffer,b=c.indexBuffer,x=e.style.map.terrain&&e.style.map.terrain.getTerrainData(s),w={programConfiguration:m,program:g,layoutVertexBuffer:v,indexBuffer:b,uniformValues:Ur(e,l,n,f,y),terrainData:x,projectionData:p.getProjectionData({overscaledTileID:s,applyGlobeMatrix:!o,applyTerrainMatrix:!0})};if(u){const e=c.segments.get();for(const r of e)_.push({segments:new t.aW([r]),sortKey:r.sortKey,state:w})}else _.push({segments:c.segments,sortKey:0,state:w})}u&&_.sort((e,t)=>e.sortKey-t.sortKey);for(const t of _){const{programConfiguration:r,program:i,layoutVertexBuffer:a,indexBuffer:o,uniformValues:s,terrainData:l,projectionData:c}=t.state;i.draw(h,d.TRIANGLES,f,m,g,Wt.backCCW,s,l,c,n.id,a,o,t.segments,n.paint,e.transform.zoom,r)}}(e,r,n,i,a):t.cn(n)?function(e,r,n,i,a){if(0===n.paint.get("heatmap-opacity"))return;const o=e.context,{isRenderingToTexture:s,isRenderingGlobe:l}=a;if(e.style.map.terrain){for(const t of i){const i=r.getTile(t);r.hasRenderableParent(t)||("offscreen"===e.renderPass?di(e,i,n,t,l):"translucent"===e.renderPass&&pi(e,n,t,s,l))}o.viewport.set([0,0,e.width,e.height])}else"offscreen"===e.renderPass?function(e,r,n,i){const a=e.context,o=a.gl,s=e.transform,l=Kt.disabled,c=new Zt([o.ONE,o.ONE],t.bo.transparent,[!0,!0,!0,!0]);(function(e,r,n){const i=e.gl;e.activeTexture.set(i.TEXTURE1),e.viewport.set([0,0,r.width/4,r.height/4]);let a=n.heatmapFbos.get(t.cc);a?(i.bindTexture(i.TEXTURE_2D,a.colorAttachment.get()),e.bindFramebuffer.set(a.framebuffer)):(a=fi(e,r.width/4,r.height/4),n.heatmapFbos.set(t.cc,a))})(a,e,n),a.clear({color:t.bo.transparent});for(let t=0;t<i.length;t++){const u=i[t];if(r.hasRenderableParent(u))continue;const h=r.getTile(u),d=h.getBucket(n);if(!d)continue;const p=d.programConfigurations.get(n.id),f=e.useProgram("heatmap",p),m=s.getProjectionData({overscaledTileID:u,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),g=s.getCircleRadiusCorrection();f.draw(a,o.TRIANGLES,Xt.disabled,l,c,Wt.backCCW,Zr(h,s.zoom,n.paint.get("heatmap-intensity"),g),null,m,n.id,d.layoutVertexBuffer,d.indexBuffer,d.segments,n.paint,s.zoom,p)}a.viewport.set([0,0,e.width,e.height])}(e,r,n,i):"translucent"===e.renderPass&&function(e,r){const n=e.context,i=n.gl;n.setColorMode(e.colorModeForRenderPass());const a=r.heatmapFbos.get(t.cc);a&&(n.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,a.colorAttachment.get()),n.activeTexture.set(i.TEXTURE1),mi(n,r).bind(i.LINEAR,i.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(n,i.TRIANGLES,Xt.disabled,Kt.disabled,e.colorModeForRenderPass(),Wt.disabled,Hr(e,r,0,1),null,null,r.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,r.paint,e.transform.zoom))}(e,n)}(e,r,n,i,a):t.co(n)?function(e,t,r,n,i){if("translucent"!==e.renderPass)return;const{isRenderingToTexture:a}=i,o=r.paint.get("line-opacity"),s=r.paint.get("line-width");if(0===o.constantOr(1)||0===s.constantOr(1))return;const l=e.getDepthModeForSublayer(0,Xt.ReadOnly),c=e.colorModeForRenderPass(),u=r.paint.get("line-dasharray"),h=u.constantOr(1),d=r.paint.get("line-pattern"),p=d.constantOr(1),f=r.paint.get("line-gradient"),m=r.getCrossfadeParameters();let g;g=p?"linePattern":h&&f?"lineGradientSDF":h?"lineSDF":f?"lineGradient":"line";const _=e.context,y=_.gl,v=e.transform;let b=!0;for(const i of n){const n=t.getTile(i);if(p&&!n.patternsLoaded())continue;const o=n.getBucket(r);if(!o)continue;const s=o.programConfigurations.get(r.id),x=e.context.program.get(),w=e.useProgram(g,s),T=b||w.program!==x,S=e.style.map.terrain&&e.style.map.terrain.getTerrainData(i),P=d.constantOr(null),E=u&&u.constantOr(null);if(P&&n.imageAtlas){const e=n.imageAtlas,t=e.patternPositions[P.to.toString()],r=e.patternPositions[P.from.toString()];t&&r&&s.setConstantPatternPositions(t,r)}else if(E){const t="round"===r.layout.get("line-cap"),n=e.lineAtlas.getDash(E.to,t),i=e.lineAtlas.getDash(E.from,t);s.setConstantDashPositions(n,i)}const C=v.getProjectionData({overscaledTileID:i,applyGlobeMatrix:!a,applyTerrainMatrix:!0}),M=v.getPixelScale();let k;p?(k=en(e,n,r,M,m),_i(_,y,n,s,m)):h&&f?(k=rn(e,n,r,M,m,o.lineClipsArray.length),bi(e,t,_,y,r,o,i,s,m)):h?(k=tn(e,n,r,M,m),yi(e,_,y,s,T,m)):f?(k=Jr(e,n,r,M,o.lineClipsArray.length),vi(e,t,_,y,r,o,i)):k=Qr(e,n,r,M);const I=e.stencilModeForClipping(i);w.draw(_,y.TRIANGLES,l,I,c,Wt.disabled,k,S,C,r.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,r.paint,e.transform.zoom,s,o.layoutVertexBuffer2),b=!1}}(e,r,n,i,a):t.cp(n)?function(e,r,n,i,a){const o=n.paint.get("fill-color"),s=n.paint.get("fill-opacity");if(0===s.constantOr(1))return;const{isRenderingToTexture:l}=a,c=e.colorModeForRenderPass(),u=n.paint.get("fill-pattern"),h=e.opaquePassEnabledForLayer()&&!u.constantOr(1)&&1===o.constantOr(t.bo.transparent).a&&1===s.constantOr(0)?"opaque":"translucent";if(e.renderPass===h){const t=e.getDepthModeForSublayer(1,"opaque"===e.renderPass?Xt.ReadWrite:Xt.ReadOnly);wi(e,r,n,i,t,c,!1,l)}if("translucent"===e.renderPass&&n.paint.get("fill-antialias")){const t=e.getDepthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,Xt.ReadOnly);wi(e,r,n,i,t,c,!0,l)}}(e,r,n,i,a):t.cq(n)?function(e,t,r,n,i){const a=r.paint.get("fill-extrusion-opacity");if(0===a)return;const{isRenderingToTexture:o}=i;if("translucent"===e.renderPass){const i=new Xt(e.context.gl.LEQUAL,Xt.ReadWrite,e.depthRangeFor3D);if(1!==a||r.paint.get("fill-extrusion-pattern").constantOr(1))Ti(e,t,r,n,i,Kt.disabled,Zt.disabled,o),Ti(e,t,r,n,i,e.stencilModeFor3D(),e.colorModeForRenderPass(),o);else{const a=e.colorModeForRenderPass();Ti(e,t,r,n,i,Kt.disabled,a,o)}}}(e,r,n,i,a):t.cr(n)?function(e,r,n,i,a){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass)return;const{isRenderingToTexture:o}=a,s=e.context,l=e.style.projection.useSubdivision,c=e.getDepthModeForSublayer(0,Xt.ReadOnly),u=e.colorModeForRenderPass();if("offscreen"===e.renderPass)!function(e,r,n,i,a,o,s){const l=e.context,c=l.gl;for(const u of n){const n=r.getTile(u),h=n.dem;if(!h||!h.data)continue;if(!n.needsHillshadePrepare)continue;const d=h.dim,p=h.stride,f=h.getPixels();if(l.activeTexture.set(c.TEXTURE1),l.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(p),n.demTexture){const e=n.demTexture;e.update(f,{premultiply:!1}),e.bind(c.NEAREST,c.CLAMP_TO_EDGE)}else n.demTexture=new t.T(l,f,c.RGBA,{premultiply:!1}),n.demTexture.bind(c.NEAREST,c.CLAMP_TO_EDGE);l.activeTexture.set(c.TEXTURE0);let m=n.fbo;if(!m){const e=new t.T(l,{width:d,height:d,data:null},c.RGBA);e.bind(c.LINEAR,c.CLAMP_TO_EDGE),m=n.fbo=l.createFramebuffer(d,d,!0,!1),m.colorAttachment.set(e.texture)}l.bindFramebuffer.set(m.framebuffer),l.viewport.set([0,0,d,d]),e.useProgram("hillshadePrepare").draw(l,c.TRIANGLES,a,o,s,Wt.disabled,Xr(n.tileID,h),null,null,i.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),n.needsHillshadePrepare=!1}}(e,r,i,n,c,Kt.disabled,u),s.viewport.set([0,0,e.width,e.height]);else if("translucent"===e.renderPass)if(l){const[t,a,s]=e.stencilConfigForOverlapTwoPass(i);Si(e,r,n,s,t,c,u,!1,o),Si(e,r,n,s,a,c,u,!0,o)}else{const[t,a]=e.getStencilConfigForOverlapAndUpdateStencilID(i);Si(e,r,n,a,t,c,u,!1,o)}}(e,r,n,i,a):t.cs(n)?function(e,t,r,n,i){if("translucent"!==e.renderPass)return;if(!n.length)return;const{isRenderingToTexture:a}=i,o=e.style.projection.useSubdivision,s=e.getDepthModeForSublayer(0,Xt.ReadOnly),l=e.colorModeForRenderPass();if(o){const[i,o,c]=e.stencilConfigForOverlapTwoPass(n);Pi(e,t,r,c,i,s,l,!1,a),Pi(e,t,r,c,o,s,l,!0,a)}else{const[i,o]=e.getStencilConfigForOverlapAndUpdateStencilID(n);Pi(e,t,r,o,i,s,l,!1,a)}}(e,r,n,i,a):t.bT(n)?function(e,t,r,n,i){if("translucent"!==e.renderPass)return;if(0===r.paint.get("raster-opacity"))return;if(!n.length)return;const{isRenderingToTexture:a}=i,o=t.getSource(),s=e.style.projection.useSubdivision;if(o instanceof te)Ci(e,t,r,n,null,!1,!1,o.tileCoords,o.flippedWindingOrder,a);else if(s){const[i,o,s]=e.stencilConfigForOverlapTwoPass(n);Ci(e,t,r,s,i,!1,!0,Ei,!1,a),Ci(e,t,r,s,o,!0,!0,Ei,!1,a)}else{const[i,o]=e.getStencilConfigForOverlapAndUpdateStencilID(n);Ci(e,t,r,o,i,!1,!0,Ei,!1,a)}}(e,r,n,i,a):t.ct(n)?function(e,t,r,n,i){const a=r.paint.get("background-color"),o=r.paint.get("background-opacity");if(0===o)return;const{isRenderingToTexture:s}=i,l=e.context,c=l.gl,u=e.style.projection,h=e.transform,d=h.tileSize,p=r.paint.get("background-pattern");if(e.isPatternMissing(p))return;const f=!p&&1===a.a&&1===o&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==f)return;const m=Kt.disabled,g=e.getDepthModeForSublayer(0,"opaque"===f?Xt.ReadWrite:Xt.ReadOnly),_=e.colorModeForRenderPass(),y=e.useProgram(p?"backgroundPattern":"background"),v=n||Pe(h,{tileSize:d,terrain:e.style.map.terrain});p&&(l.activeTexture.set(c.TEXTURE0),e.imageManager.bind(e.context));const b=r.getCrossfadeParameters();for(const t of v){const n=h.getProjectionData({overscaledTileID:t,applyGlobeMatrix:!s,applyTerrainMatrix:!0}),i=p?dn(o,e,p,{tileID:t,tileSize:d},b):hn(o,a),f=e.style.map.terrain&&e.style.map.terrain.getTerrainData(t),v=u.getMeshFromTileID(l,t.canonical,!1,!0,"raster");y.draw(l,c.TRIANGLES,g,m,_,Wt.backCCW,i,f,n,r.id,v.vertexBuffer,v.indexBuffer,v.segments)}}(e,0,n,i,a):t.cu(n)&&function(e,t,r,n){const{isRenderingGlobe:i}=n,a=e.context,o=r.implementation,s=e.style.projection,l=e.transform,c=l.getProjectionDataForCustomLayer(i),u={farZ:l.farZ,nearZ:l.nearZ,fov:l.fov*Math.PI/180,modelViewProjectionMatrix:l.modelViewProjectionMatrix,projectionMatrix:l.projectionMatrix,shaderData:{variantName:s.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;\nuniform mat4 u_projection_matrix;\n${s.shaderPreludeCode.vertexSource}`,define:s.shaderDefine},defaultProjectionData:c},h=o.renderingMode?o.renderingMode:"2d";if("offscreen"===e.renderPass){const t=o.prerender;t&&(e.setCustomLayerDefaults(),a.setColorMode(e.colorModeForRenderPass()),t.call(o,a.gl,u),a.setDirty(),e.setBaseState())}else if("translucent"===e.renderPass){e.setCustomLayerDefaults(),a.setColorMode(e.colorModeForRenderPass()),a.setStencilMode(Kt.disabled);const t="3d"===h?e.getDepthModeFor3D():e.getDepthModeForSublayer(0,Xt.ReadOnly);a.setDepthMode(t),o.render(a.gl,u),a.setDirty(),e.setBaseState(),a.bindFramebuffer.set(null)}}(e,0,n,a))}saveTileTexture(e){const t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const t=this._tileTextures[e];return t&&t.length>0?t.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const t=this.imageManager.getPattern(e.from.toString()),r=this.imageManager.getPattern(e.to.toString());return!t||!r}useProgram(e,t,r=!1,n=[]){this.cache=this.cache||{};const i=!!this.style.map.terrain,a=this.style.projection,o=r?Ct.projectionMercator:a.shaderPreludeCode,s=r?At:a.shaderDefine,l=e+(t?t.cacheKey:"")+`/${r?zt:a.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(i?"/terrain":"")+(n?`/${n.join("/")}`:"");return this.cache[l]||(this.cache[l]=new Rr(this.context,Ct[e],t,fn[e],this._showOverdrawInspector,i,o,s,n)),this.cache[l]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new t.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){var e,t;if(this._tileTextures){for(const e in this._tileTextures){const t=this._tileTextures[e];if(t)for(const e of t)e.destroy()}this._tileTextures={}}if(this.tileExtentBuffer&&this.tileExtentBuffer.destroy(),this.debugBuffer&&this.debugBuffer.destroy(),this.rasterBoundsBuffer&&this.rasterBoundsBuffer.destroy(),this.rasterBoundsBufferPosOnly&&this.rasterBoundsBufferPosOnly.destroy(),this.viewportBuffer&&this.viewportBuffer.destroy(),this.tileBorderIndexBuffer&&this.tileBorderIndexBuffer.destroy(),this.quadTriangleIndexBuffer&&this.quadTriangleIndexBuffer.destroy(),this.tileExtentMesh&&(null===(e=this.tileExtentMesh.vertexBuffer)||void 0===e||e.destroy()),this.tileExtentMesh&&(null===(t=this.tileExtentMesh.indexBuffer)||void 0===t||t.destroy()),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.cache){for(const e in this.cache){const t=this.cache[e];t&&t.program&&this.context.gl.deleteProgram(t.program)}this.cache={}}this.context&&this.context.setDefault()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:t}=this.context.gl;return this.width!==e||this.height!==t}}function ji(e,t){let r,n=!1,i=null,a=null;const o=()=>{i=null,n&&(e.apply(a,r),i=setTimeout(o,t),n=!1)};return(...e)=>(n=!0,a=this,r=e,i||o(),i)}class Ui{constructor(e){this._getCurrentHash=()=>{const e=window.location.hash.replace("#","");if(this._hashName){let t;return e.split("&").map(e=>e.split("=")).forEach(e=>{e[0]===this._hashName&&(t=e)}),(t&&t[1]||"").split("/")}return e.split("/")},this._onHashChange=()=>{const e=this._getCurrentHash();if(!this._isValidHash(e))return!1;const t=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(e[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:t,pitch:+(e[4]||0)}),!0},this._updateHashUnthrottled=()=>{const e=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,e)},this._removeHash=()=>{const e=this._getCurrentHash();if(0===e.length)return;const t=e.join("/");let r=t;r.split("&").length>0&&(r=r.split("&")[0]),this._hashName&&(r=`${this._hashName}=${t}`);let n=window.location.hash.replace(r,"");n.startsWith("#&")?n=n.slice(0,1)+n.slice(2):"#"===n&&(n="");let i=window.location.href.replace(/(#.+)?$/,n);i=i.replace("&&","&"),window.history.replaceState(window.history.state,null,i)},this._updateHash=ji(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const t=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,n=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),i=Math.pow(10,n),a=Math.round(t.lng*i)/i,o=Math.round(t.lat*i)/i,s=this._map.getBearing(),l=this._map.getPitch();let c="";if(c+=e?`/${a}/${o}/${r}`:`${r}/${o}/${a}`,(s||l)&&(c+="/"+Math.round(10*s)/10),l&&(c+=`/${Math.round(l)}`),this._hashName){const e=this._hashName;let t=!1;const r=window.location.hash.slice(1).split("&").map(r=>{const n=r.split("=")[0];return n===e?(t=!0,`${n}=${c}`):r}).filter(e=>e);return t||r.push(`${e}=${c}`),`#${r.join("&")}`}return`#${c}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new t.V(+e[2],+e[1])}catch(e){return!1}const r=+e[0],n=+(e[3]||0),i=+(e[4]||0);return r>=this._map.getMinZoom()&&r<=this._map.getMaxZoom()&&n>=-180&&n<=180&&i>=this._map.getMinPitch()&&i<=this._map.getMaxPitch()}}const Gi={linearity:.3,easing:t.cv(0,0,.3,1)},qi=t.e({deceleration:2500,maxSpeed:1400},Gi),$i=t.e({deceleration:20,maxSpeed:1400},Gi),Zi=t.e({deceleration:1e3,maxSpeed:360},Gi),Hi=t.e({deceleration:1e3,maxSpeed:90},Gi),Wi=t.e({deceleration:1e3,maxSpeed:360},Gi);class Xi{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:c(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,t=c();for(;e.length>0&&t-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const r={zoom:0,bearing:0,pitch:0,roll:0,pan:new t.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:e}of this._inertiaBuffer)r.zoom+=e.zoomDelta||0,r.bearing+=e.bearingDelta||0,r.pitch+=e.pitchDelta||0,r.roll+=e.rollDelta||0,e.panDelta&&r.pan._add(e.panDelta),e.around&&(r.around=e.around),e.pinchAround&&(r.pinchAround=e.pinchAround);const n=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,i={};if(r.pan.mag()){const a=Ki(r.pan.mag(),n,t.e({},qi,e||{})),o=r.pan.mult(a.amount/r.pan.mag()),s=this._map.cameraHelper.handlePanInertia(o,this._map.transform);i.center=s.easingCenter,i.offset=s.easingOffset,Yi(i,a)}if(r.zoom){const e=Ki(r.zoom,n,$i);i.zoom=this._map.transform.zoom+e.amount,Yi(i,e)}if(r.bearing){const e=Ki(r.bearing,n,Zi);i.bearing=this._map.transform.bearing+t.an(e.amount,-179,179),Yi(i,e)}if(r.pitch){const e=Ki(r.pitch,n,Hi);i.pitch=this._map.transform.pitch+e.amount,Yi(i,e)}if(r.roll){const e=Ki(r.roll,n,Wi);i.roll=this._map.transform.roll+t.an(e.amount,-179,179),Yi(i,e)}if(i.zoom||i.bearing){const e=void 0===r.pinchAround?r.around:r.pinchAround;i.around=e?this._map.unproject(e):this._map.getCenter()}return this.clear(),t.e(i,{noMoveStart:!0})}}function Yi(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function Ki(e,r,n){const{maxSpeed:i,linearity:a,deceleration:o}=n,s=t.an(e*a/(r/1e3),-i,i),l=Math.abs(s)/(o*a);return{easing:n.easing,duration:1e3*l,amount:s*(l/2)}}class Qi extends t.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,n,i={}){n=n instanceof MouseEvent?n:new MouseEvent(e,n);const a=u.mousePos(r.getCanvas(),n),o=r.unproject(a);super(e,t.e({point:a,lngLat:o,originalEvent:n},i)),this._defaultPrevented=!1,this.target=r}}class Ji extends t.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,n){const i="touchend"===e?n.changedTouches:n.touches,a=u.touchPos(r.getCanvasContainer(),i),o=a.map(e=>r.unproject(e)),s=a.reduce((e,t,r,n)=>e.add(t.div(n.length)),new t.P(0,0));super(e,{points:a,point:s,lngLats:o,lngLat:r.unproject(s),originalEvent:n}),this._defaultPrevented=!1}}class ea extends t.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,r){super(e,{originalEvent:r}),this._defaultPrevented=!1}}class ta{constructor(e,t){this._map=e,this._clickTolerance=t.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new ea(e.type,this._map,e))}mousedown(e,t){return this._mousedownPos=t,this._firePreventable(new Qi(e.type,this._map,e))}mouseup(e){this._map.fire(new Qi(e.type,this._map,e))}click(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||this._map.fire(new Qi(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Qi(e.type,this._map,e))}mouseover(e){this._map.fire(new Qi(e.type,this._map,e))}mouseout(e){this._map.fire(new Qi(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Ji(e.type,this._map,e))}touchmove(e){this._map.fire(new Ji(e.type,this._map,e))}touchend(e){this._map.fire(new Ji(e.type,this._map,e))}touchcancel(e){this._map.fire(new Ji(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ra{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Qi(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Qi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Qi(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class na{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(t.P.convert(e),this._map.terrain)}}class ia{constructor(e,t){this._map=e,this._tr=new na(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(u.disableDrag(),this._startPos=this._lastPos=t,this._active=!0)}mousemoveWindow(e,t){if(!this._active)return;const r=t;if(this._lastPos.equals(r)||!this._box&&r.dist(this._startPos)<this._clickTolerance)return;const n=this._startPos;this._lastPos=r,this._box||(this._box=u.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const i=Math.min(n.x,r.x),a=Math.max(n.x,r.x),o=Math.min(n.y,r.y),s=Math.max(n.y,r.y);u.setTransform(this._box,`translate(${i}px,${o}px)`),this._box.style.width=a-i+"px",this._box.style.height=s-o+"px"}mouseupWindow(e,r){if(!this._active)return;if(0!==e.button)return;const n=this._startPos,i=r;if(this.reset(),u.suppressClick(),n.x!==i.x||n.y!==i.y)return this._map.fire(new t.l("boxzoomend",{originalEvent:e})),{cameraAnimation:e=>e.fitScreenCoordinates(n,i,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(u.remove(this._box),this._box=null),u.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,r){return this._map.fire(new t.l(e,{originalEvent:r}))}}function aa(e,t){if(e.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${e.length}, points ${t.length}`);const r={};for(let n=0;n<e.length;n++)r[e[n].identifier]=t[n];return r}class oa{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,r,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),n.length===this.numTouches&&(this.centroid=function(e){const r=new t.P(0,0);for(const t of e)r._add(t);return r.div(e.length)}(r),this.touches=aa(n,r)))}touchmove(e,t,r){if(this.aborted||!this.centroid)return;const n=aa(r,t);for(const e in this.touches){const t=n[e];(!t||t.dist(this.touches[e])>30)&&(this.aborted=!0)}}touchend(e,t,r){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===r.length){const e=!this.aborted&&this.centroid;if(this.reset(),e)return e}}}class sa{constructor(e){this.singleTap=new oa(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,t,r){this.singleTap.touchstart(e,t,r)}touchmove(e,t,r){this.singleTap.touchmove(e,t,r)}touchend(e,t,r){const n=this.singleTap.touchend(e,t,r);if(n){const t=e.timeStamp-this.lastTime<500,r=!this.lastTap||this.lastTap.dist(n)<30;if(t&&r||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=n,this.count===this.numTaps)return this.reset(),n}}}class la{constructor(e){this._tr=new na(e),this._zoomIn=new sa({numTouches:1,numTaps:2}),this._zoomOut=new sa({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,t,r){this._zoomIn.touchstart(e,t,r),this._zoomOut.touchstart(e,t,r)}touchmove(e,t,r){this._zoomIn.touchmove(e,t,r),this._zoomOut.touchmove(e,t,r)}touchend(e,t,r){const n=this._zoomIn.touchend(e,t,r),i=this._zoomOut.touchend(e,t,r),a=this._tr;return n?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:a.zoom+1,around:a.unproject(n)},{originalEvent:e})}):i?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:a.zoom-1,around:a.unproject(i)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ca{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const t=this._moveFunction(...e);if(t.bearingDelta||t.pitchDelta||t.rollDelta||t.around||t.panDelta)return this._active=!0,t}dragStart(e,t){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(t)?t[0]:t,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,t){if(!this.isEnabled())return;const r=this._lastPoint;if(!r)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const n=Array.isArray(t)?t[0]:t;return!this._moved&&n.dist(r)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=n,this._move(r,n))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&u.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const ua=0,ha=2,da={[ua]:1,[ha]:2};class pa{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const t=u.mouseButton(e);this._eventButton=t}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(e,t){const r=da[t];return void 0===e.buttons||(e.buttons&r)!==r}(e,this._eventButton)}isValidEndEvent(e){return u.mouseButton(e)===this._eventButton}}class fa{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return 1===e.targetTouches.length}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class ma{constructor(e=new pa({checkCorrectEvent:()=>!0}),t=new fa){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=t}_executeRelevantHandler(e,t,r){return e instanceof MouseEvent?t(e):"undefined"!=typeof TouchEvent&&e instanceof TouchEvent?r(e):void 0}startMove(e){this._executeRelevantHandler(e,e=>this.mouseMoveStateManager.startMove(e),e=>this.oneFingerTouchMoveStateManager.startMove(e))}endMove(e){this._executeRelevantHandler(e,e=>this.mouseMoveStateManager.endMove(e),e=>this.oneFingerTouchMoveStateManager.endMove(e))}isValidStartEvent(e){return this._executeRelevantHandler(e,e=>this.mouseMoveStateManager.isValidStartEvent(e),e=>this.oneFingerTouchMoveStateManager.isValidStartEvent(e))}isValidMoveEvent(e){return this._executeRelevantHandler(e,e=>this.mouseMoveStateManager.isValidMoveEvent(e),e=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(e))}isValidEndEvent(e){return this._executeRelevantHandler(e,e=>this.mouseMoveStateManager.isValidEndEvent(e),e=>this.oneFingerTouchMoveStateManager.isValidEndEvent(e))}}const ga=e=>{e.mousedown=e.dragStart,e.mousemoveWindow=e.dragMove,e.mouseup=e.dragEnd,e.contextmenu=e=>{e.preventDefault()}};class _a{constructor(e,t){this._clickTolerance=e.clickTolerance||1,this._map=t,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new t.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,t,r){return this._calculateTransform(e,t,r)}touchmove(e,t,r){if(this._active){if(!this._shouldBePrevented(r.length))return e.preventDefault(),this._calculateTransform(e,t,r);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,t,r){this._calculateTransform(e,t,r),this._active&&this._shouldBePrevented(r.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,r,n){n.length>0&&(this._active=!0);const i=aa(n,r),a=new t.P(0,0),o=new t.P(0,0);let s=0;for(const e in i){const t=i[e],r=this._touches[e];r&&(a._add(t),o._add(t.sub(r)),s++,i[e]=t)}if(this._touches=i,this._shouldBePrevented(s)||!o.mag())return;const l=o.div(s);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(s),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ya{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,t,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([t[0],t[1]]))}touchmove(e,t,r){if(!this._firstTwoTouches)return;e.preventDefault();const[n,i]=this._firstTwoTouches,a=va(r,t,n),o=va(r,t,i);if(!a||!o)return;const s=this._aroundCenter?null:a.add(o).div(2);return this._move([a,o],s,e)}touchend(e,t,r){if(!this._firstTwoTouches)return;const[n,i]=this._firstTwoTouches,a=va(r,t,n),o=va(r,t,i);a&&o||(this._active&&u.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function va(e,t,r){for(let n=0;n<e.length;n++)if(e[n].identifier===r)return t[n]}function ba(e,t){return Math.log(e/t)/Math.LN2}class xa extends ya{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,t){const r=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(ba(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ba(this._distance,r),pinchAround:t}}}function wa(e,t){return 180*e.angleWith(t)/Math.PI}class Ta extends ya{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,t,r){const n=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:wa(this._vector,n),pinchAround:t}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const t=25/(Math.PI*this._minDiameter)*360,r=wa(e,this._startVector);return Math.abs(r)<t}}function Sa(e){return Math.abs(e.y)>Math.abs(e.x)}class Pa extends ya{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,t,r){super.touchstart(e,t,r),this._currentTouchCount=r.length}_start(e){this._lastPoints=e,Sa(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,t,r){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const n=e[0].sub(this._lastPoints[0]),i=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(n,i,r.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(n.y+i.y)/2*-.5}):void 0}gestureBeginsVertically(e,t,r){if(void 0!==this._valid)return this._valid;const n=e.mag()>=2,i=t.mag()>=2;if(!n&&!i)return;if(!n||!i)return void 0===this._firstMove&&(this._firstMove=r),r-this._firstMove<100&&void 0;const a=e.y>0==t.y>0;return Sa(e)&&Sa(t)&&a}}const Ea={panStep:100,bearingStep:15,pitchStep:10};class Ca{constructor(e){this._tr=new na(e);const t=Ea;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let t=0,r=0,n=0,i=0,a=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?r=-1:(e.preventDefault(),i=-1);break;case 39:e.shiftKey?r=1:(e.preventDefault(),i=1);break;case 38:e.shiftKey?n=1:(e.preventDefault(),a=-1);break;case 40:e.shiftKey?n=-1:(e.preventDefault(),a=1);break;default:return}return this._rotationDisabled&&(r=0,n=0),{cameraAnimation:o=>{const s=this._tr;o.easeTo({duration:300,easeId:"keyboardHandler",easing:Ma,zoom:t?Math.round(s.zoom)+t*(e.shiftKey?2:1):s.zoom,bearing:s.bearing+r*this._bearingStep,pitch:s.pitch+n*this._pitchStep,offset:[-i*this._panStep,-a*this._panStep],center:s.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ma(e){return e*(2-e)}const ka=4.000244140625,Ia=1/450;class Aa{constructor(e,t){this._onTimeout=e=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)},this._map=e,this._tr=new na(e),this._triggerRenderFrame=t,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Ia}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around)}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let t=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const r=c(),n=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,0!==t&&t%ka==0?this._type="wheel":0!==t&&Math.abs(t)<4?this._type="trackpad":n>400?(this._type=null,this._lastValue=t,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(n*t)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,t+=this._lastValue)),e.shiftKey&&t&&(t/=4),this._type&&(this._lastWheelEvent=e,this._delta-=t,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=u.mousePos(this._map.getCanvas(),e),n=this._tr;this._aroundPoint=this._aroundCenter?n.transform.locationToScreenPoint(t.V.convert(n.center)):r,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const e=this._tr.transform;if("number"==typeof this._lastExpectedZoom){const t=e.zoom-this._lastExpectedZoom;"number"==typeof this._startZoom&&(this._startZoom+=t),"number"==typeof this._targetZoom&&(this._targetZoom+=t)}if(0!==this._delta){const r="wheel"===this._type&&Math.abs(this._delta)>ka?this._wheelZoomRate:this._defaultZoomRate;let n=2/(1+Math.exp(-Math.abs(this._delta*r)));this._delta<0&&0!==n&&(n=1/n);const i="number"!=typeof this._targetZoom?e.scale:t.aq(this._targetZoom);this._targetZoom=e.applyConstrain(e.getCameraLngLat(),t.at(i*n)).zoom,"wheel"===this._type&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const r="number"!=typeof this._targetZoom?e.zoom:this._targetZoom,n=this._startZoom,i=this._easing;let a,o=!1;if("wheel"===this._type&&n&&i){const e=c()-this._lastWheelEventTime,s=Math.min((e+5)/200,1),l=i(s);a=t.G.number(n,r,l),s<1?this._frameId||(this._frameId=!0):o=!0}else a=r,o=!0;return this._active=!0,o&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=a,{noInertia:!0,needsRenderFrame:!o,zoomDelta:a-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let r=t.cx;if(this._prevEase){const e=this._prevEase,n=(c()-e.start)/e.duration,i=e.easing(n+.01)-e.easing(n),a=.27/Math.sqrt(i*i+1e-4)*.01,o=Math.sqrt(.0729-a*a);r=t.cv(a,o,.25,1)}return this._prevEase={start:c(),duration:e,easing:r},r}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class za{constructor(e,t){this._clickZoom=e,this._tapZoom=t}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Da{constructor(e){this._tr=new na(e),this.reset()}reset(){this._active=!1}dblclick(e,t){return e.preventDefault(),{cameraAnimation:r=>{r.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(t)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class La{constructor(){this._tap=new sa({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,t,r){if(!this._swipePoint)if(this._tapTime){const n=t[0],i=e.timeStamp-this._tapTime<500,a=this._tapPoint.dist(n)<30;i&&a?r.length>0&&(this._swipePoint=n,this._swipeTouch=r[0].identifier):this.reset()}else this._tap.touchstart(e,t,r)}touchmove(e,t,r){if(this._tapTime){if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;const n=t[0],i=n.y-this._swipePoint.y;return this._swipePoint=n,e.preventDefault(),this._active=!0,{zoomDelta:i/128}}}else this._tap.touchmove(e,t,r)}touchend(e,t,r){if(this._tapTime)this._swipePoint&&0===r.length&&this.reset();else{const n=this._tap.touchend(e,t,r);n&&(this._tapTime=e.timeStamp,this._tapPoint=n)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ra{constructor(e,t,r){this._el=e,this._mousePan=t,this._touchPan=r}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Fa{constructor(e,t,r,n){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=t,this._mousePitch=r,this._mouseRoll=n}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Ba{constructor(e,t,r,n){this._el=e,this._touchZoom=t,this._touchRotate=r,this._tapDragZoom=n,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Oa{constructor(e,t){this._bypassKey=-1!==navigator.userAgent.indexOf("Mac")?"metaKey":"ctrlKey",this._map=e,this._options=t,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=u.create("div","maplibregl-cooperative-gesture-screen",e);let t=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");"metaKey"===this._bypassKey&&(t=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const r=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),n=document.createElement("div");n.className="maplibregl-desktop-message",n.textContent=t,this._container.appendChild(n);const i=document.createElement("div");i.className="maplibregl-mobile-message",i.textContent=r,this._container.appendChild(i),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(u.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,r){this._enabled&&(this._map.fire(new t.l("cooperativegestureprevented",{gestureType:e,originalEvent:r})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Na=e=>e.zoom||e.drag||e.roll||e.pitch||e.rotate;class Va extends t.l{}function ja(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta||e.rollDelta}class Ua{constructor(e,r){this.handleWindowEvent=e=>{this.handleEvent(e,`${e.type}Window`)},this.handleEvent=(e,r)=>{if("blur"===e.type)return void this.stop(!0);this._updatingCamera=!0;const n="renderFrame"===e.type?void 0:e,i={needsRenderFrame:!1},a={},o={};for(const{handlerName:s,handler:l,allowed:c}of this._handlers){if(!l.isEnabled())continue;let h;if(this._blockedByActive(o,c,s))l.reset();else if(l[r||e.type]){if(t.cy(e,r||e.type)){const t=u.mousePos(this._map.getCanvas(),e);h=l[r||e.type](e,t)}else if(t.cz(e,r||e.type)){const t=this._getMapTouches(e.touches),n=u.touchPos(this._map.getCanvas(),t);h=l[r||e.type](e,n,t)}else t.cA(r||e.type)||(h=l[r||e.type](e));this.mergeHandlerResult(i,a,h,s,n),h&&h.needsRenderFrame&&this._triggerRenderFrame()}(h||l.isActive())&&(o[s]=l)}const s={};for(const e in this._previousActiveHandlers)o[e]||(s[e]=n);this._previousActiveHandlers=o,(Object.keys(s).length||ja(i))&&(this._changes.push([i,a,s]),this._triggerRenderFrame()),(Object.keys(o).length||ja(i))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:l}=i;l&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],l(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Xi(e),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r);const n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[window,"blur",void 0]];for(const[e,t,r]of this._listeners)u.addEventListener(e,t,e===document?this.handleWindowEvent:this.handleEvent,r)}destroy(){for(const[e,t,r]of this._listeners)u.removeEventListener(e,t,e===document?this.handleWindowEvent:this.handleEvent,r)}_addDefaultHandlers(e){const r=this._map,n=r.getCanvasContainer();this._add("mapEvent",new ta(r,e));const i=r.boxZoom=new ia(r,e);this._add("boxZoom",i),e.interactive&&e.boxZoom&&i.enable();const a=r.cooperativeGestures=new Oa(r,e.cooperativeGestures);this._add("cooperativeGestures",a),e.cooperativeGestures&&a.enable();const o=new la(r),s=new Da(r);r.doubleClickZoom=new za(s,o),this._add("tapZoom",o),this._add("clickZoom",s),e.interactive&&e.doubleClickZoom&&r.doubleClickZoom.enable();const l=new La;this._add("tapDragZoom",l);const c=r.touchPitch=new Pa(r);this._add("touchPitch",c),e.interactive&&e.touchPitch&&r.touchPitch.enable(e.touchPitch);const h=()=>r.project(r.getCenter()),d=function({enable:e,clickTolerance:r,aroundCenter:n=!0,minPixelCenterThreshold:i=100,rotateDegreesPerPixelMoved:a=.8},o){const s=new pa({checkCorrectEvent:e=>0===u.mouseButton(e)&&e.ctrlKey||2===u.mouseButton(e)&&!e.ctrlKey});return new ca({clickTolerance:r,move:(e,r)=>{const s=o();if(n&&Math.abs(s.y-e.y)>i)return{bearingDelta:t.cw(new t.P(e.x,r.y),r,s)};let l=(r.x-e.x)*a;return n&&r.y<s.y&&(l=-l),{bearingDelta:l}},moveStateManager:s,enable:e,assignEvents:ga})}(e,h),p=function({enable:e,clickTolerance:t,pitchDegreesPerPixelMoved:r=-.5}){const n=new pa({checkCorrectEvent:e=>0===u.mouseButton(e)&&e.ctrlKey||2===u.mouseButton(e)});return new ca({clickTolerance:t,move:(e,t)=>({pitchDelta:(t.y-e.y)*r}),moveStateManager:n,enable:e,assignEvents:ga})}(e),f=function({enable:e,clickTolerance:t,rollDegreesPerPixelMoved:r=.3},n){const i=new pa({checkCorrectEvent:e=>2===u.mouseButton(e)&&e.ctrlKey});return new ca({clickTolerance:t,move:(e,t)=>{const i=n();let a=(t.x-e.x)*r;return t.y<i.y&&(a=-a),{rollDelta:a}},moveStateManager:i,enable:e,assignEvents:ga})}(e,h);r.dragRotate=new Fa(e,d,p,f),this._add("mouseRotate",d,["mousePitch"]),this._add("mousePitch",p,["mouseRotate","mouseRoll"]),this._add("mouseRoll",f,["mousePitch"]),e.interactive&&e.dragRotate&&r.dragRotate.enable();const m=function({enable:e,clickTolerance:t}){const r=new pa({checkCorrectEvent:e=>0===u.mouseButton(e)&&!e.ctrlKey});return new ca({clickTolerance:t,move:(e,t)=>({around:t,panDelta:t.sub(e)}),activateOnStart:!0,moveStateManager:r,enable:e,assignEvents:ga})}(e),g=new _a(e,r);r.dragPan=new Ra(n,m,g),this._add("mousePan",m),this._add("touchPan",g,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&r.dragPan.enable(e.dragPan);const _=new Ta,y=new xa;r.touchZoomRotate=new Ba(n,y,_,l),this._add("touchRotate",_,["touchPan","touchZoom"]),this._add("touchZoom",y,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&r.touchZoomRotate.enable(e.touchZoomRotate),this._add("blockableMapEvent",new ra(r));const v=r.scrollZoom=new Aa(r,()=>this._triggerRenderFrame());this._add("scrollZoom",v,["mousePan"]),e.interactive&&e.scrollZoom&&r.scrollZoom.enable(e.scrollZoom);const b=r.keyboard=new Ca(r);this._add("keyboard",b),e.interactive&&e.keyboard&&r.keyboard.enable()}_add(e,t,r){this._handlers.push({handlerName:e,handler:t,allowed:r}),this._handlersById[e]=t}stop(e){if(!this._updatingCamera){for(const{handler:e}of this._handlers)e.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Na(this._eventsInProgress))||this.isZooming()}_blockedByActive(e,t,r){for(const n in e)if(n!==r&&(!t||t.indexOf(n)<0))return!0;return!1}_getMapTouches(e){const t=[];for(const r of e)this._el.contains(r.target)&&t.push(r);return t}mergeHandlerResult(e,r,n,i,a){if(!n)return;t.e(e,n);const o={handlerName:i,originalEvent:n.originalEvent||a};void 0!==n.zoomDelta&&(r.zoom=o),void 0!==n.panDelta&&(r.drag=o),void 0!==n.rollDelta&&(r.roll=o),void 0!==n.pitchDelta&&(r.pitch=o),void 0!==n.bearingDelta&&(r.rotate=o)}_applyChanges(){const e={},r={},n={};for(const[i,a,o]of this._changes)i.panDelta&&(e.panDelta=(e.panDelta||new t.P(0,0))._add(i.panDelta)),i.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+i.zoomDelta),i.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+i.bearingDelta),i.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+i.pitchDelta),i.rollDelta&&(e.rollDelta=(e.rollDelta||0)+i.rollDelta),void 0!==i.around&&(e.around=i.around),void 0!==i.pinchAround&&(e.pinchAround=i.pinchAround),i.noInertia&&(e.noInertia=i.noInertia),t.e(r,a),t.e(n,o);this._updateMapTransform(e,r,n),this._changes=[]}_updateMapTransform(e,t,r){const n=this._map,i=n._getTransformForUpdate(),a=n.terrain;if(!(ja(e)||a&&this._terrainMovement))return this._fireEvents(t,r,!0);n._stop(!0);let{panDelta:o,zoomDelta:s,bearingDelta:l,pitchDelta:c,rollDelta:u,around:h,pinchAround:d}=e;void 0!==d&&(h=d),h=h||n.transform.centerPoint,a&&!i.isPointOnMapSurface(h)&&(h=i.centerPoint);const p={panDelta:o,zoomDelta:s,rollDelta:u,pitchDelta:c,bearingDelta:l,around:h};this._map.cameraHelper.useGlobeControls&&!i.isPointOnMapSurface(h)&&(h=i.centerPoint);const f=h.distSqr(i.centerPoint)<.01?i.center:i.screenPointToLocation(o?h.sub(o):h);this._handleMapControls({terrain:a,tr:i,deltasForHelper:p,preZoomAroundLoc:f,combinedEventsInProgress:t,panDelta:o}),n._applyUpdatedTransform(i),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(t,r,!0)}_handleMapControls({terrain:e,tr:t,deltasForHelper:r,preZoomAroundLoc:n,combinedEventsInProgress:i,panDelta:a}){const o=this._map.cameraHelper;if(o.handleMapControlsRollPitchBearingZoom(r,t),e)return o.useGlobeControls?(this._terrainMovement||!i.drag&&!i.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void o.handleMapControlsPan(r,t,n)):this._terrainMovement||!i.drag&&!i.zoom?void(i.drag&&this._terrainMovement&&a?t.setCenter(t.screenPointToLocation(t.centerPoint.sub(a))):o.handleMapControlsPan(r,t,n)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void o.handleMapControlsPan(r,t,n));o.handleMapControlsPan(r,t,n)}_fireEvents(e,r,n){const i=Na(this._eventsInProgress),a=Na(e),o={};for(const t in e){const{originalEvent:r}=e[t];this._eventsInProgress[t]||(o[`${t}start`]=r),this._eventsInProgress[t]=e[t]}!i&&a&&this._fireEvent("movestart",a.originalEvent);for(const e in o)this._fireEvent(e,o[e]);a&&this._fireEvent("move",a.originalEvent);for(const t in e){const{originalEvent:r}=e[t];this._fireEvent(t,r)}const l={};let c;for(const e in this._eventsInProgress){const{handlerName:t,originalEvent:n}=this._eventsInProgress[e];this._handlersById[t].isActive()||(delete this._eventsInProgress[e],c=r[t]||n,l[`${e}end`]=c)}for(const e in l)this._fireEvent(e,l[e]);const u=Na(this._eventsInProgress),h=(i||a)&&!u;if(h&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const e=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&e.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(e)}if(n&&h){this._updatingCamera=!0;const e=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),r=e=>0!==e&&-this._bearingSnap<e&&e<this._bearingSnap;!e||!e.essential&&s.prefersReducedMotion?(this._map.fire(new t.l("moveend",{originalEvent:c})),r(this._map.getBearing())&&this._map.resetNorth()):(r(e.bearing||this._map.getBearing())&&(e.bearing=0),e.freezeElevation=!0,this._map.easeTo(e,{originalEvent:c})),this._updatingCamera=!1}}_fireEvent(e,r){this._map.fire(new t.l(e,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new Va("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class Ga extends t.E{constructor(e,t,r){super(),this._renderFrameCallback=()=>{const e=Math.min((c()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=r.bearingSnap,this.cameraHelper=t,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,t){e.apply(this.transform),this.transform=e,this.cameraHelper=t}getCenter(){return new t.V(this.transform.center.lng,this.transform.center.lat)}setCenter(e,t){return this.jumpTo({center:e},t)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,t){return this.jumpTo({elevation:e},t),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,r,n){return e=t.P.convert(e).mult(-1),this.panTo(this.transform.center,t.e({offset:e},r),n)}panTo(e,r,n){return this.easeTo(t.e({center:e},r),n)}getZoom(){return this.transform.zoom}setZoom(e,t){return this.jumpTo({zoom:e},t),this}zoomTo(e,r,n){return this.easeTo(t.e({zoom:e},r),n)}zoomIn(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}zoomOut(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,r){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new t.l("movestart",r)).fire(new t.l("move",r)).fire(new t.l("moveend",r))),this}getBearing(){return this.transform.bearing}setBearing(e,t){return this.jumpTo({bearing:e},t),this}getPadding(){return this.transform.padding}setPadding(e,t){return this.jumpTo({padding:e},t),this}rotateTo(e,r,n){return this.easeTo(t.e({bearing:e},r),n)}resetNorth(e,r){return this.rotateTo(0,t.e({duration:1e3},e),r),this}resetNorthPitch(e,r){return this.easeTo(t.e({bearing:0,pitch:0,roll:0,duration:1e3},e),r),this}snapToNorth(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}getPitch(){return this.transform.pitch}setPitch(e,t){return this.jumpTo({pitch:e},t),this}getRoll(){return this.transform.roll}setRoll(e,t){return this.jumpTo({roll:e},t),this}cameraForBounds(e,t){e=H.convert(e).adjustAntiMeridian();const r=t&&t.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),r,t)}_cameraForBoxAndBearing(e,r,n,i){const a={top:0,bottom:0,right:0,left:0};if("number"==typeof(i=t.e({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){const e=i.padding;i.padding={top:e,bottom:e,right:e,left:e}}const o=t.e(a,i.padding);i.padding=o;const s=this.transform,l=new H(e,r);return this.cameraHelper.cameraForBoxAndBearing(i,o,l,n,s)}fitBounds(e,t,r){return this._fitInternal(this.cameraForBounds(e,t),t,r)}fitScreenCoordinates(e,r,n,i,a){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(t.P.convert(e)),this.transform.screenPointToLocation(t.P.convert(r)),n,i),i,a)}_fitInternal(e,r,n){return e?(delete(r=t.e(e,r)).padding,r.linear?this.easeTo(r,n):this.flyTo(r,n)):this}jumpTo(e,r){this.stop();const n=this._getTransformForUpdate();let i=!1,a=!1,o=!1;const s=n.zoom;this.cameraHelper.handleJumpToCenterZoom(n,e);const l=n.zoom!==s;return"elevation"in e&&n.elevation!==+e.elevation&&n.setElevation(+e.elevation),"bearing"in e&&n.bearing!==+e.bearing&&(i=!0,n.setBearing(+e.bearing)),"pitch"in e&&n.pitch!==+e.pitch&&(a=!0,n.setPitch(+e.pitch)),"roll"in e&&n.roll!==+e.roll&&(o=!0,n.setRoll(+e.roll)),null==e.padding||n.isPaddingEqual(e.padding)||n.setPadding(e.padding),this._applyUpdatedTransform(n),this.fire(new t.l("movestart",r)).fire(new t.l("move",r)),l&&this.fire(new t.l("zoomstart",r)).fire(new t.l("zoom",r)).fire(new t.l("zoomend",r)),i&&this.fire(new t.l("rotatestart",r)).fire(new t.l("rotate",r)).fire(new t.l("rotateend",r)),a&&this.fire(new t.l("pitchstart",r)).fire(new t.l("pitch",r)).fire(new t.l("pitchend",r)),o&&this.fire(new t.l("rollstart",r)).fire(new t.l("roll",r)).fire(new t.l("rollend",r)),this.fire(new t.l("moveend",r))}calculateCameraOptionsFromTo(e,r,n,i=0){const a=t.aa.fromLngLat(e,r),o=t.aa.fromLngLat(n,i),s=o.x-a.x,l=o.y-a.y,c=o.z-a.z,u=Math.hypot(s,l,c);if(0===u)throw new Error("Can't calculate camera options with same From and To");const h=Math.hypot(s,l),d=t.at(this.transform.cameraToCenterDistance/u/this.transform.tileSize),p=180*Math.atan2(s,-l)/Math.PI;let f=180*Math.acos(h/u)/Math.PI;return f=c<0?90-f:90+f,{center:o.toLngLat(),elevation:i,zoom:d,pitch:f,bearing:p}}calculateCameraOptionsFromCameraLngLatAltRotation(e,t,r,n,i){const a=this.transform.calculateCenterFromCameraLngLatAlt(e,t,r,n);return{center:a.center,elevation:a.elevation,zoom:a.zoom,bearing:r,pitch:n,roll:i}}easeTo(e,r){this._stop(!1,e.easeId),(!1===(e=t.e({offset:[0,0],duration:500,easing:t.cx},e)).animate||!e.essential&&s.prefersReducedMotion)&&(e.duration=0);const n=this._getTransformForUpdate(),i=this.getBearing(),a=n.pitch,o=n.roll,l="bearing"in e?this._normalizeBearing(e.bearing,i):i,c="pitch"in e?+e.pitch:a,u="roll"in e?this._normalizeBearing(e.roll,o):o,h="padding"in e?e.padding:n.padding,d=t.P.convert(e.offset);let p,f;e.around&&(p=t.V.convert(e.around),f=n.locationToScreenPoint(p));const m={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},g=this.cameraHelper.handleEaseTo(n,{bearing:l,pitch:c,roll:u,padding:h,around:p,aroundPoint:f,offsetAsPoint:d,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||i!==l,this._pitching=this._pitching||c!==a,this._rolling=this._rolling||u!==o,this._padding=!n.isPaddingEqual(h),this._zooming=this._zooming||g.isZooming,this._easeId=e.easeId,this._prepareEase(r,e.noMoveStart,m),this.terrain&&this._prepareElevation(g.elevationCenter),this._ease(t=>{g.easeFunc(t),this.terrain&&!e.freezeElevation&&this._updateElevation(t),this._applyUpdatedTransform(n),this._fireMoveEvents(r)},t=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r,t)},e),this}_prepareEase(e,r,n={}){this._moving=!0,r||n.moving||this.fire(new t.l("movestart",e)),this._zooming&&!n.zooming&&this.fire(new t.l("zoomstart",e)),this._rotating&&!n.rotating&&this.fire(new t.l("rotatestart",e)),this._pitching&&!n.pitching&&this.fire(new t.l("pitchstart",e)),this._rolling&&!n.rolling&&this.fire(new t.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){void 0!==this._elevationStart&&void 0!==this._elevationCenter||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const r=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&r!==this._elevationTarget){const t=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(t-(r-(t*e+this._elevationStart))/(1-e)),this._elevationTarget=r}this.transform.setElevation(t.G.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const t=e.getCameraLngLat(),r=e.getCameraAltitude(),n=this.terrain?this.terrain.getElevationForLngLatZoom(t,e.zoom):0;if(r<n){const r=this.calculateCameraOptionsFromTo(t,n,e.center,e.elevation);return{pitch:r.pitch,zoom:r.zoom}}return{}}_applyUpdatedTransform(e){const t=[];if(t.push(e=>this._elevateCameraIfInsideTerrain(e)),this.transformCameraUpdate&&t.push(e=>this.transformCameraUpdate(e)),!t.length)return;const r=e.clone();for(const e of t){const t=r.clone(),{center:n,zoom:i,roll:a,pitch:o,bearing:s,elevation:l}=e(t);n&&t.setCenter(n),void 0!==l&&t.setElevation(l),void 0!==i&&t.setZoom(i),void 0!==a&&t.setRoll(a),void 0!==o&&t.setPitch(o),void 0!==s&&t.setBearing(s),r.apply(t)}this.transform.apply(r)}_fireMoveEvents(e){this.fire(new t.l("move",e)),this._zooming&&this.fire(new t.l("zoom",e)),this._rotating&&this.fire(new t.l("rotate",e)),this._pitching&&this.fire(new t.l("pitch",e)),this._rolling&&this.fire(new t.l("roll",e))}_afterEase(e,r){if(this._easeId&&r&&this._easeId===r)return;delete this._easeId;const n=this._zooming,i=this._rotating,a=this._pitching,o=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,n&&this.fire(new t.l("zoomend",e)),i&&this.fire(new t.l("rotateend",e)),a&&this.fire(new t.l("pitchend",e)),o&&this.fire(new t.l("rollend",e)),this.fire(new t.l("moveend",e))}flyTo(e,r){if(!e.essential&&s.prefersReducedMotion){const n=t.U(e,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(n,r)}this.stop(),e=t.e({offset:[0,0],speed:1.2,curve:1.42,easing:t.cx},e);const n=this._getTransformForUpdate(),i=n.bearing,a=n.pitch,o=n.roll,l=n.padding,c="bearing"in e?this._normalizeBearing(e.bearing,i):i,u="pitch"in e?+e.pitch:a,h="roll"in e?this._normalizeBearing(e.roll,o):o,d="padding"in e?e.padding:n.padding,p=t.P.convert(e.offset);let f=n.centerPoint.add(p);const m=n.screenPointToLocation(f),g=this.cameraHelper.handleFlyTo(n,{bearing:c,pitch:u,roll:h,padding:d,locationAtOffset:m,offsetAsPoint:p,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let _=e.curve;const y=Math.max(n.width,n.height),v=y/g.scaleOfZoom,b=g.pixelPathLength;"number"==typeof g.scaleOfMinZoom&&(_=Math.sqrt(y/g.scaleOfMinZoom/b*2));const x=_*_;function w(e){const t=(v*v-y*y+(e?-1:1)*x*x*b*b)/(2*(e?v:y)*x*b);return Math.log(Math.sqrt(t*t+1)-t)}function T(e){return(Math.exp(e)-Math.exp(-e))/2}function S(e){return(Math.exp(e)+Math.exp(-e))/2}const P=w(!1);let E=function(e){return S(P)/S(P+_*e)},C=function(e){return y*((S(P)*(T(t=P+_*e)/S(t))-T(P))/x)/b;var t},M=(w(!0)-P)/_;if(Math.abs(b)<2e-6||!isFinite(M)){if(Math.abs(y-v)<1e-6)return this.easeTo(e,r);const t=v<y?-1:1;M=Math.abs(Math.log(v/y))/_,C=()=>0,E=e=>Math.exp(t*_*e)}return e.duration="duration"in e?+e.duration:1e3*M/("screenSpeed"in e?+e.screenSpeed/_:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=i!==c,this._pitching=u!==a,this._rolling=h!==o,this._padding=!n.isPaddingEqual(d),this._prepareEase(r,!1),this.terrain&&this._prepareElevation(g.targetCenter),this._ease(s=>{const m=s*M,_=1/E(m),y=C(m);this._rotating&&n.setBearing(t.G.number(i,c,s)),this._pitching&&n.setPitch(t.G.number(a,u,s)),this._rolling&&n.setRoll(t.G.number(o,h,s)),this._padding&&(n.interpolatePadding(l,d,s),f=n.centerPoint.add(p)),g.easeFunc(s,_,y,f),this.terrain&&!e.freezeElevation&&this._updateElevation(s),this._applyUpdatedTransform(n),this._fireMoveEvents(r)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,t){var r;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const e=this._onEaseEnd;delete this._onEaseEnd,e.call(this,t)}return e||null===(r=this.handlers)||void 0===r||r.stop(!1),this}_ease(e,t,r){!1===r.animate||0===r.duration?(e(1),t()):(this._easeStart=c(),this._easeOptions=r,this._onEaseFrame=e,this._onEaseEnd=t,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,r){e=t.W(e,-180,180);const n=Math.abs(e-r);return Math.abs(e-360-r)<n&&(e-=360),Math.abs(e+360-r)<n&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(t.V.convert(e),this.transform.tileZoom):null}}const qa={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class $a{constructor(e=qa){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=e=>{!e||"metadata"!==e.sourceDataType&&"visibility"!==e.sourceDataType&&"style"!==e.dataType&&"terrain"!==e.type||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=u.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=u.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=u.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){u.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,t){const r=this._map._getUIString(`AttributionControl.${t}`);e.title=r,e.setAttribute("aria-label",r)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(e=>"string"!=typeof e?"":e)):"string"==typeof this.options.customAttribution&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}const t=this._map.style.tileManagers;for(const r in t){const n=t[r];if(n.used||n.usedForTerrain){const t=n.getSource();t.attribution&&e.indexOf(t.attribution)<0&&e.push(t.attribution)}}e=e.filter(e=>String(e).trim()),e.sort((e,t)=>e.length-t.length),e=e.filter((t,r)=>{for(let n=r+1;n<e.length;n++)if(e[n].indexOf(t)>=0)return!1;return!0});const r=e.join(" | ");r!==this._attribHTML&&(this._attribHTML=r,e.length?(this._innerContainer.innerHTML=u.sanitize(r),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Za{constructor(e={}){this._updateCompact=()=>{const e=this._container.children;if(e.length){const t=e[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&t.classList.add("maplibregl-compact"):t.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=u.create("div","maplibregl-ctrl");const t=u.create("a","maplibregl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://maplibre.org/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){u.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Ha{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}remove(e){const t=this._currentlyRunning,r=t?this._queue.concat(t):this._queue;for(const t of r)if(t.id===e)return void(t.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const t=this._currentlyRunning=this._queue;this._queue=[];for(const r of t)if(!r.cancelled&&(r.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Wa=t.aT([{name:"a_pos3d",type:"Int16",components:3}]);class Xa extends t.E{constructor(e){super(),this._lastTilesetChange=c(),this.tileManager=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(e,r){this.tileManager.update(e,r),this._renderableTilesKeys=[];const n={};for(const i of Pe(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:r,calculateTileZoom:this.tileManager._source.calculateTileZoom}))n[i.key]=!0,this._renderableTilesKeys.push(i.key),this._tiles[i.key]||(i.terrainRttPosMatrix32f=new Float64Array(16),t.c6(i.terrainRttPosMatrix32f,0,t.a4,t.a4,0,0,1),this._tiles[i.key]=new de(i,this.tileSize),this._lastTilesetChange=c());for(const e in this._tiles)n[e]||delete this._tiles[e]}freeRtt(e){for(const t in this._tiles){const r=this._tiles[t];(!e||r.tileID.equals(e)||r.tileID.isChildOf(e)||e.isChildOf(r.tileID))&&(r.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,t){return t?this._getTerrainCoordsForTileRanges(e,t):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const r={};for(const n of this._renderableTilesKeys){const i=this._tiles[n].tileID,a=e.clone(),o=t.bj();if(i.canonical.equals(e.canonical))t.c6(o,0,t.a4,t.a4,0,0,1);else if(i.canonical.isChildOf(e.canonical)){const r=i.canonical.z-e.canonical.z,n=i.canonical.x-(i.canonical.x>>r<<r),a=i.canonical.y-(i.canonical.y>>r<<r),s=t.a4>>r;t.c6(o,0,s,s,0,0,1),t.O(o,o,[-n*s,-a*s,0])}else{if(!e.canonical.isChildOf(i.canonical))continue;{const r=e.canonical.z-i.canonical.z,n=e.canonical.x-(e.canonical.x>>r<<r),a=e.canonical.y-(e.canonical.y>>r<<r),s=t.a4>>r;t.c6(o,0,t.a4,t.a4,0,0,1),t.O(o,o,[n*s,a*s,0]),t.Q(o,o,[1/2**r,1/2**r,0])}}a.terrainRttPosMatrix32f=new Float32Array(o),r[n]=a}return r}_getTerrainCoordsForTileRanges(e,r){const n={};for(const i of this._renderableTilesKeys){const a=this._tiles[i].tileID;if(!this._isWithinTileRanges(a,r))continue;const o=e.clone(),s=t.bj();if(a.canonical.z===e.canonical.z){const r=e.canonical.x-a.canonical.x,n=e.canonical.y-a.canonical.y;t.c6(s,0,t.a4,t.a4,0,0,1),t.O(s,s,[r*t.a4,n*t.a4,0])}else if(a.canonical.z>e.canonical.z){const r=a.canonical.z-e.canonical.z,n=a.canonical.x-(a.canonical.x>>r<<r),i=a.canonical.y-(a.canonical.y>>r<<r),o=e.canonical.x-(a.canonical.x>>r),l=e.canonical.y-(a.canonical.y>>r),c=t.a4>>r;t.c6(s,0,c,c,0,0,1),t.O(s,s,[-n*c+o*t.a4,-i*c+l*t.a4,0])}else{const r=e.canonical.z-a.canonical.z,n=e.canonical.x-(e.canonical.x>>r<<r),i=e.canonical.y-(e.canonical.y>>r<<r),o=(e.canonical.x>>r)-a.canonical.x,l=(e.canonical.y>>r)-a.canonical.y,c=t.a4<<r;t.c6(s,0,c,c,0,0,1),t.O(s,s,[n*t.a4+o*c,i*t.a4+l*c,0])}o.terrainRttPosMatrix32f=new Float32Array(s),n[i]=o}return n}getSourceTile(e,t){const r=this.tileManager._source;let n=e.overscaledZ-this.deltaZoom;if(n>r.maxzoom&&(n=r.maxzoom),n<r.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(n).key);let i=this.tileManager.getTileByID(this._sourceTileCache[e.key]);if((!i||!i.dem)&&t)for(;n>=r.minzoom&&(!i||!i.dem);)i=this.tileManager.getTileByID(e.scaledTo(n--).key);return i}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,t){return t[e.canonical.z]&&e.canonical.x>=t[e.canonical.z].minTileX&&e.canonical.x<=t[e.canonical.z].maxTileX&&e.canonical.y>=t[e.canonical.z].minTileY&&e.canonical.y<=t[e.canonical.z].maxTileY}}class Ya{constructor(e,t,r){this._meshCache={},this.painter=e,this.tileManager=new Xa(t),this.options=r,this.exaggeration="number"==typeof r.exaggeration?r.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,r,n,i=t.a4){var a;if(!(r>=0&&r<i&&n>=0&&n<i))return 0;const o=this.getTerrainData(e),s=null===(a=o.tile)||void 0===a?void 0:a.dem;if(!s)return 0;const l=t.cB([],[r/i*t.a4,n/i*t.a4],o.u_terrain_matrix),c=[l[0]*s.dim,l[1]*s.dim],u=Math.floor(c[0]),h=Math.floor(c[1]),d=c[0]-u,p=c[1]-h;return s.get(u,h)*(1-d)*(1-p)+s.get(u+1,h)*d*(1-p)+s.get(u,h+1)*(1-d)*p+s.get(u+1,h+1)*d*p}getElevationForLngLatZoom(e,r){if(!t.cC(r,e.wrap()))return 0;const{tileID:n,mercatorX:i,mercatorY:a}=this._getOverscaledTileIDFromLngLatZoom(e,r);return this.getElevation(n,i%t.a4,a%t.a4,t.a4)}getElevation(e,r,n,i=t.a4){return this.getDEMElevation(e,r,n,i)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const e=this.painter.context,r=new t.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new t.T(e,r,e.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new t.T(e,new t.R({width:1,height:1}),e.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=t.ar([])}const r=this.tileManager.getSourceTile(e,!0);if(r&&r.dem&&(!r.demTexture||r.needsTerrainPrepare)){const e=this.painter.context;r.demTexture=this.painter.getTileTexture(r.dem.stride),r.demTexture?r.demTexture.update(r.dem.getPixels(),{premultiply:!1}):r.demTexture=new t.T(e,r.dem.getPixels(),e.gl.RGBA,{premultiply:!1}),r.demTexture.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),r.needsTerrainPrepare=!1}const n=r&&r+r.tileID.key+e.key;if(n&&!this._demMatrixCache[n]){const n=this.tileManager.getSource().maxzoom;let i=e.canonical.z-r.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=n?i=e.canonical.z-n:t.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const a=e.canonical.x-(e.canonical.x>>i<<i),o=e.canonical.y-(e.canonical.y>>i<<i),s=t.cD(new Float64Array(16),[1/(t.a4<<i),1/(t.a4<<i),0]);t.O(s,s,[a*t.a4,o*t.a4,0]),this._demMatrixCache[e.key]={matrix:s,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:r&&r.dem&&r.dem.dim||1,u_terrain_matrix:n?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:r&&r.dem&&r.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(r&&r.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:r}}getFramebuffer(e){const r=this.painter,n=r.width/devicePixelRatio,i=r.height/devicePixelRatio;return!this._fbo||this._fbo.width===n&&this._fbo.height===i||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new t.T(r.context,{width:n,height:i,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new t.T(r.context,{width:n,height:i,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=r.context.createFramebuffer(n,i,!0,!1),this._fbo.depthAttachment.set(r.context.createRenderbuffer(r.context.gl.DEPTH_COMPONENT16,n,i))),this._fbo.colorAttachment.set("coords"===e?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const r=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let e=0,t=0;e<this._coordsTextureSize;e++)for(let n=0;n<this._coordsTextureSize;n++,t+=4)r[t+0]=255&n,r[t+1]=255&e,r[t+2]=n>>8<<4|e>>8,r[t+3]=0;const n=new t.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(r.buffer)),i=new t.T(e,n,e.gl.RGBA,{premultiply:!1});return i.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=i,i}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const r=new Uint8Array(4),n=this.painter.context,i=n.gl,a=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),o=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),s=Math.round(this.painter.height/devicePixelRatio);n.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),i.readPixels(a,s-o-1,1,1,i.RGBA,i.UNSIGNED_BYTE,r),n.bindFramebuffer.set(null);const l=r[0]+(r[2]>>4<<8),c=r[1]+((15&r[2])<<8),u=this.coordsIndex[255-r[3]],h=u&&this.tileManager.getTileByID(u);if(!h)return null;const d=this._coordsTextureSize,p=(1<<h.tileID.canonical.z)*d;return new t.aa((h.tileID.canonical.x*d+l)/p+h.tileID.wrap,(h.tileID.canonical.y*d+c)/p,this.getElevation(h.tileID,l,c,d))}depthAtPoint(e){const t=new Uint8Array(4),r=this.painter.context,n=r.gl;return r.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),n.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,n.RGBA,n.UNSIGNED_BYTE,t),r.bindFramebuffer.set(null),(t[0]/16777216+t[1]/65536+t[2]/256+t[3])/256}getTerrainMesh(e){var r;const n=(null===(r=this.painter.style.projection)||void 0===r?void 0:r.transitionState)>0,i=n&&0===e.canonical.y,a=n&&e.canonical.y===(1<<e.canonical.z)-1,o=`m_${i?"n":""}_${a?"s":""}`;if(this._meshCache[o])return this._meshCache[o];const s=this.painter.context,l=new t.cE,c=new t.aX,u=this.meshSize,h=t.a4/u,d=u*u;for(let e=0;e<=u;e++)for(let t=0;t<=u;t++)l.emplaceBack(t*h,e*h,0);for(let e=0;e<d;e+=u+1)for(let t=0;t<u;t++)c.emplaceBack(t+e,u+t+e+1,u+t+e+2),c.emplaceBack(t+e,u+t+e+2,t+e+1);const p=l.length,f=p+(u+1),m=(u+1)*u,g=i?t.bq:0,_=i?0:1,y=a?t.br:t.a4,v=a?0:1;for(let e=0;e<=u;e++)l.emplaceBack(e*h,g,_);for(let e=0;e<=u;e++)l.emplaceBack(e*h,y,v);for(let e=0;e<u;e++)c.emplaceBack(m+e,f+e,f+e+1),c.emplaceBack(m+e,f+e+1,m+e+1),c.emplaceBack(0+e,p+e+1,p+e),c.emplaceBack(0+e,0+e+1,p+e+1);const b=l.length,x=b+2*(u+1);for(const e of[0,1])for(let r=0;r<=u;r++)for(const n of[0,1])l.emplaceBack(e*t.a4,r*h,n);for(let e=0;e<2*u;e+=2)c.emplaceBack(b+e,b+e+1,b+e+3),c.emplaceBack(b+e,b+e+3,b+e+2),c.emplaceBack(x+e,x+e+3,x+e+1),c.emplaceBack(x+e,x+e+2,x+e+3);const w=new kt(s.createVertexBuffer(l,Wa.members),s.createIndexBuffer(c),t.aW.simpleSegment(0,0,l.length,c.length));return this._meshCache[o]=w,w}getMeshFrameDelta(e){return 2*Math.PI*t.bD/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,t){var r;const{tileID:n}=this._getOverscaledTileIDFromLngLatZoom(e,t);return null!==(r=this.getMinMaxElevation(n).minElevation)&&void 0!==r?r:0}getMinMaxElevation(e){const t=this.getTerrainData(e).tile,r={minElevation:null,maxElevation:null};return t&&t.dem&&(r.minElevation=t.dem.min*this.exaggeration,r.maxElevation=t.dem.max*this.exaggeration),r}_getOverscaledTileIDFromLngLatZoom(e,r){const n=t.aa.fromLngLat(e.wrap()),i=(1<<r)*t.a4,a=n.x*i,o=n.y*i,s=Math.floor(a/t.a4),l=Math.floor(o/t.a4);return{tileID:new t.a1(r,0,r,s,l),mercatorX:a,mercatorY:o}}}class Ka{constructor(e,t,r){this._context=e,this._size=t,this._tileSize=r,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const r=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),n=new t.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return n.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),r.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),r.colorAttachment.set(n.texture),{id:e,fbo:r,texture:n,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(t=>e.id!==t),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const e of this._recentlyUsed)if(!this._objects[e].inUse)return this._objects[e];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some(e=>!e.inUse)}}const Qa={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Ja{constructor(e,t){this.painter=e,this.terrain=t,this.pool=new Ka(e.context,30,t.tileManager.tileSize*t.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,t){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=e._order.filter(r=>!e._layers[r].isHidden(t)),this._coordsAscending={};for(const t in e.tileManagers){this._coordsAscending[t]={};const r=e.tileManagers[t].getVisibleCoordinates(),n=e.tileManagers[t].getSource(),i=n instanceof te?n.terrainTileRanges:null;for(const e of r){const r=this.terrain.tileManager.getTerrainCoords(e,i);for(const e in r)this._coordsAscending[t][e]||(this._coordsAscending[t][e]=[]),this._coordsAscending[t][e].push(r[e])}}this._coordsAscendingStr={};for(const t of e._order){const r=e._layers[t],n=r.source;if(Qa[r.type]&&!this._coordsAscendingStr[n]){this._coordsAscendingStr[n]={};for(const e in this._coordsAscending[n])this._coordsAscendingStr[n][e]=this._coordsAscending[n][e].map(e=>e.key).sort().join()}}for(const e of this._renderableTiles)for(const t in this._coordsAscendingStr){const r=this._coordsAscendingStr[t][e.tileID.key];r&&r!==e.rttCoords[t]&&(e.rtt=[])}}renderLayer(e,r){if(e.isHidden(this.painter.transform.zoom))return!1;const n=Object.assign(Object.assign({},r),{isRenderingToTexture:!0}),i=e.type,a=this.painter,o=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Qa[i]&&(this._prevType&&Qa[this._prevType]||this._stacks.push([]),this._prevType=i,this._stacks[this._stacks.length-1].push(e.id),!o))return!0;if(Qa[this._prevType]||Qa[i]&&o){this._prevType=i;const e=this._stacks.length-1,r=this._stacks[e]||[];for(const i of this._renderableTiles){if(this.pool.isFull()&&(Oi(this.painter,this.terrain,this._rttTiles,n),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(i),i.rtt[e]){const t=this.pool.getObjectForId(i.rtt[e].id);if(t.stamp===i.rtt[e].stamp){this.pool.useObject(t);continue}}const o=this.pool.getOrCreateFreeObject();this.pool.useObject(o),this.pool.stampObject(o),i.rtt[e]={id:o.id,stamp:o.stamp},a.context.bindFramebuffer.set(o.fbo.framebuffer),a.context.clear({color:t.bo.transparent,stencil:0}),a.currentStencilSource=void 0;for(let e=0;e<r.length;e++){const t=a.style._layers[r[e]],s=t.source?this._coordsAscending[t.source][i.tileID.key]:[i.tileID];a.context.viewport.set([0,0,o.fbo.width,o.fbo.height]),a._renderTileClippingMasks(t,s,!0),a.renderLayer(a,a.style.tileManagers[t.source],t,s,n),t.source&&(i.rttCoords[t.source]=this._coordsAscendingStr[t.source][i.tileID.key])}}return Oi(this.painter,this.terrain,this._rttTiles,n),this._rttTiles=[],this.pool.freeAllObjects(),Qa[i]}return!1}}const eo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},to=r,ro={hash:!1,interactive:!0,bearingSnap:7,attributionControl:qa,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:t.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,reduceMotion:void 0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0,experimentalZoomLevelsToOverscale:void 0},no={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class io{constructor(e,r,n=!1){this.mousedown=e=>{this.startMove(e,u.mousePos(this.element,e)),u.addEventListener(window,"mousemove",this.mousemove),u.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=e=>{this.move(e,u.mousePos(this.element,e))},this.mouseup=e=>{this._rotatePitchHandler.dragEnd(e),this.offTemp()},this.touchstart=e=>{1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=u.touchPos(this.element,e.targetTouches)[0],this.startMove(e,this._startPos),u.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),u.addEventListener(window,"touchend",this.touchend))},this.touchmove=e=>{1!==e.targetTouches.length?this.reset():(this._lastPos=u.touchPos(this.element,e.targetTouches)[0],this.move(e,this._lastPos))},this.touchend=e=>{0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=r;const i=new ma;this._rotatePitchHandler=new ca({clickTolerance:3,move:(e,i)=>{const a=r.getBoundingClientRect(),o=new t.P((a.bottom-a.top)/2,(a.right-a.left)/2);return{bearingDelta:t.cw(new t.P(e.x,i.y),i,o),pitchDelta:n?-.5*(i.y-e.y):void 0}},moveStateManager:i,enable:!0,assignEvents:()=>{}}),this.map=e,u.addEventListener(r,"mousedown",this.mousedown),u.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),u.addEventListener(r,"touchcancel",this.reset)}startMove(e,t){this._rotatePitchHandler.dragStart(e,t),u.disableDrag()}move(e,t){const r=this.map,{bearingDelta:n,pitchDelta:i}=this._rotatePitchHandler.dragMove(e,t)||{};n&&r.setBearing(r.getBearing()+n),i&&r.setPitch(r.getPitch()+i)}off(){const e=this.element;u.removeEventListener(e,"mousedown",this.mousedown),u.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),u.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),u.removeEventListener(window,"touchend",this.touchend),u.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){u.enableDrag(),u.removeEventListener(window,"mousemove",this.mousemove),u.removeEventListener(window,"mouseup",this.mouseup),u.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),u.removeEventListener(window,"touchend",this.touchend)}}let ao;function oo(e,r,n,i=!1){if(i||!n.getCoveringTilesDetailsProvider().allowWorldCopies())return null==e?void 0:e.wrap();const a=new t.V(e.lng,e.lat);if(e=new t.V(e.lng,e.lat),r){const i=new t.V(e.lng-360,e.lat),a=new t.V(e.lng+360,e.lat),o=n.locationToScreenPoint(e).distSqr(r);n.locationToScreenPoint(i).distSqr(r)<o?e=i:n.locationToScreenPoint(a).distSqr(r)<o&&(e=a)}for(;Math.abs(e.lng-n.center.lng)>180;){const t=n.locationToScreenPoint(e);if(t.x>=0&&t.y>=0&&t.x<=n.width&&t.y<=n.height)break;e.lng>n.center.lng?e.lng-=360:e.lng+=360}return e.lng!==a.lng&&n.isPointOnMapSurface(n.locationToScreenPoint(e))?e:a}const so={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function lo(e,t,r){const n=e.classList;for(const e in so)n.remove(`maplibregl-${r}-anchor-${e}`);n.add(`maplibregl-${r}-anchor-${t}`)}class co extends t.E{constructor(e){if(super(),this._onKeyPress=e=>{const t=e.code,r=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==r&&13!==r||this.togglePopup()},this._onMapClick=e=>{const t=e.originalEvent.target,r=this._element;this._popup&&(t===r||r.contains(t))&&this.togglePopup()},this._update=e=>{if(!this._map)return;const t=this._map.loaded()&&!this._map.isMoving();("terrain"===(null==e?void 0:e.type)||"render"===(null==e?void 0:e.type)&&!t)&&this._map.once("render",this._update),this._lngLat=oo(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let r="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?r=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(r=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let n="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?n="rotateX(0deg)":"map"===this._pitchAlignment&&(n=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||e&&"moveend"!==e.type||(this._pos=this._pos.round()),u.setTransform(this._element,`${so[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${n} ${r}`),s.frameAsync(new AbortController).then(()=>{this._updateOpacity(e&&"moveend"===e.type)}).catch(()=>{})},this._onMove=e=>{if(!this._isDragging){const t=this._clickTolerance||this._map._clickTolerance;this._isDragging=e.point.dist(this._pointerdownPos)>=t}this._isDragging&&(this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.l("dragstart"))),this.fire(new t.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.l("dragend")),this._state="inactive"},this._addDragHandler=e=>{this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(this._pos).add(this._offset),this._pointerdownPos=e.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&"auto"!==e.pitchAlignment?e.pitchAlignment:this._rotationAlignment,this.setOpacity(null==e?void 0:e.opacity,null==e?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=t.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=u.create("div");const r=u.createNS("http://www.w3.org/2000/svg","svg"),n=41,i=27;r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height",`${n}px`),r.setAttributeNS(null,"width",`${i}px`),r.setAttributeNS(null,"viewBox",`0 0 ${i} ${n}`);const a=u.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");const o=u.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"fill-rule","nonzero");const s=u.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"transform","translate(3.0, 29.0)"),s.setAttributeNS(null,"fill","#000000");const l=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const e of l){const t=u.createNS("http://www.w3.org/2000/svg","ellipse");t.setAttributeNS(null,"opacity","0.04"),t.setAttributeNS(null,"cx","10.5"),t.setAttributeNS(null,"cy","5.80029008"),t.setAttributeNS(null,"rx",e.rx),t.setAttributeNS(null,"ry",e.ry),s.appendChild(t)}const c=u.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"fill",this._color);const h=u.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),c.appendChild(h);const d=u.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"opacity","0.25"),d.setAttributeNS(null,"fill","#000000");const p=u.createNS("http://www.w3.org/2000/svg","path");p.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),d.appendChild(p);const f=u.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"transform","translate(6.0, 7.0)"),f.setAttributeNS(null,"fill","#FFFFFF");const m=u.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(8.0, 8.0)");const g=u.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");const _=u.createNS("http://www.w3.org/2000/svg","circle");_.setAttributeNS(null,"fill","#FFFFFF"),_.setAttributeNS(null,"cx","5.5"),_.setAttributeNS(null,"cy","5.5"),_.setAttributeNS(null,"r","5.4999962"),m.appendChild(g),m.appendChild(_),o.appendChild(s),o.appendChild(c),o.appendChild(d),o.appendChild(f),o.appendChild(m),r.appendChild(o),r.setAttributeNS(null,"height",n*this._scale+"px"),r.setAttributeNS(null,"width",i*this._scale+"px"),this._element.appendChild(r),this._offset=t.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",e=>{e.preventDefault()}),this._element.addEventListener("mousedown",e=>{e.preventDefault()}),lo(this._element,this._anchor,"marker"),e&&e.className)for(const t of e.className.split(" "))this._element.classList.add(t);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),u.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.V.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const t=38.1,r=13.5,n=Math.abs(r)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-t],"bottom-left":[n,-1*(t-r+n)],"bottom-right":[-n,-1*(t-r+n)],left:[r,-1*(t-r)],right:[-r,-1*(t-r)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var r,n;const i=null===(r=this._map)||void 0===r?void 0:r.terrain,a=this._map.transform.isLocationOccluded(this._lngLat);if(!i||a){const e=a?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==e&&(this._element.style.opacity=e))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const o=this._map,s=o.terrain.depthAtPoint(this._pos),l=o.terrain.getElevationForLngLatZoom(this._lngLat,o.transform.tileZoom);if(o.transform.lngLatToCameraDepth(this._lngLat,l)-s<.006)return void(this._element.style.opacity=this._opacity);const c=-this._offset.y/o.transform.pixelsPerMeter,u=Math.sin(o.getPitch()*Math.PI/180)*c,h=o.terrain.depthAtPoint(new t.P(this._pos.x,this._pos.y-this._offset.y)),d=o.transform.lngLatToCameraDepth(this._lngLat,l+u)-h>.006;(null===(n=this._popup)||void 0===n?void 0:n.isOpen())&&d&&this._popup.remove(),this._element.style.opacity=d?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=t.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&"auto"!==e?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,t){return(void 0===this._opacity||void 0===e&&void 0===t)&&(this._opacity="1",this._opacityWhenCovered="0.2"),void 0!==e&&(this._opacity=e),void 0!==t&&(this._opacityWhenCovered=t),this._map&&this._updateOpacity(!0),this}}const uo={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ho=0,po=!1;const fo={maxWidth:100,unit:"metric"};function mo(e,t,r){const n=r&&r.maxWidth||100,i=e._container.clientHeight/2,a=e._container.clientWidth/2,o=e.unproject([a-n/2,i]),s=e.unproject([a+n/2,i]),l=Math.round(e.project(s).x-e.project(o).x),c=Math.min(n,l,e._container.clientWidth),u=o.distanceTo(s);if(r&&"imperial"===r.unit){const r=3.2808*u;r>5280?go(t,c,r/5280,e._getUIString("ScaleControl.Miles")):go(t,c,r,e._getUIString("ScaleControl.Feet"))}else r&&"nautical"===r.unit?go(t,c,u/1852,e._getUIString("ScaleControl.NauticalMiles")):u>=1e3?go(t,c,u/1e3,e._getUIString("ScaleControl.Kilometers")):go(t,c,u,e._getUIString("ScaleControl.Meters"))}function go(e,t,r,n){const i=function(e){const t=Math.pow(10,`${Math.floor(e)}`.length-1);let r=e/t;return r=r>=10?10:r>=5?5:r>=3?3:r>=2?2:r>=1?1:function(e){const t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(r),t*r}(r);e.style.width=t*(i/r)+"px",e.innerHTML=`${i}&nbsp;${n}`}const _o={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},yo=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function vo(e){if(e){if("number"==typeof e){const r=Math.round(Math.abs(e)/Math.SQRT2);return{center:new t.P(0,0),top:new t.P(0,e),"top-left":new t.P(r,r),"top-right":new t.P(-r,r),bottom:new t.P(0,-e),"bottom-left":new t.P(r,-r),"bottom-right":new t.P(-r,-r),left:new t.P(e,0),right:new t.P(-e,0)}}if(e instanceof t.P||Array.isArray(e)){const r=t.P.convert(e);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:t.P.convert(e.center||[0,0]),top:t.P.convert(e.top||[0,0]),"top-left":t.P.convert(e["top-left"]||[0,0]),"top-right":t.P.convert(e["top-right"]||[0,0]),bottom:t.P.convert(e.bottom||[0,0]),"bottom-left":t.P.convert(e["bottom-left"]||[0,0]),"bottom-right":t.P.convert(e["bottom-right"]||[0,0]),left:t.P.convert(e.left||[0,0]),right:t.P.convert(e.right||[0,0])}}return vo(new t.P(0,0))}const bo=r;e.AJAXError=t.cI,e.Event=t.l,e.Evented=t.E,e.LngLat=t.V,e.MercatorCoordinate=t.aa,e.Point=t.P,e.addProtocol=t.cJ,e.config=t.a,e.removeProtocol=t.cK,e.AttributionControl=$a,e.BoxZoomHandler=ia,e.CanvasSource=ne,e.CooperativeGesturesHandler=Oa,e.DoubleClickZoomHandler=za,e.DragPanHandler=Ra,e.DragRotateHandler=Fa,e.EdgeInsets=Lt,e.FullscreenControl=class extends t.E{constructor(e={}){super(),this._onFullscreenChange=()=>{var e;let t=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;null===(e=null==t?void 0:t.shadowRoot)||void 0===e?void 0:e.fullscreenElement;)t=t.shadowRoot.fullscreenElement;t===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,e&&e.container&&(e.container instanceof HTMLElement?this._container=e.container:t.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=u.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){u.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const e=this._fullscreenButton=u.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);u.create("span","maplibregl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new t.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new t.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},e.GeoJSONSource=ee,e.GeolocateControl=class extends t.E{constructor(e){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new t.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const r=new t.V(e.coords.longitude,e.coords.latitude),n=e.coords.accuracy,i=this._map.getBearing(),a=t.e({bearing:i},this.options.fitBoundsOptions),o=H.fromLngLat(r,n);this._map.fitBounds(o,a,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const r=new t.V(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=e.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=e=>{if(this._map){if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&po)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new t.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=u.create("button","maplibregl-ctrl-geolocate",this._container),u.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(!1===e){t.w("Geolocation support is not available so the GeolocateControl will be disabled.");const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}else{const e=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=u.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new co({element:this._dotElement}),this._circleElement=u.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new co({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",e=>{const r=(null==e?void 0:e[0])instanceof ResizeObserverEntry;e.geolocateSource||"ACTIVE_LOCK"!==this._watchState||r||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new t.l("trackuserlocationend")),this.fire(new t.l("userlocationlostfocus")))})}},this.options=t.e({},uo,e)}onAdd(e){return this._map=e,this._container=u.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return t._(this,arguments,void 0,function*(e=!1){if(void 0!==ao&&!e)return ao;if(void 0===window.navigator.permissions)return ao=!!window.navigator.geolocation,ao;try{const e=yield window.navigator.permissions.query({name:"geolocation"});ao="denied"!==e.state}catch(e){ao=!!window.navigator.geolocation}return ao})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),u.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,ho=0,po=!1}_isOutOfMapMaxBounds(e){const t=this._map.getMaxBounds(),r=e.coords;return t&&(r.longitude<t.getWest()||r.longitude>t.getEast()||r.latitude<t.getSouth()||r.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const e=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&e))return;const t=this._map.project(e),r=this._map.unproject([t.x+100,t.y]),n=e.distanceTo(r)/100,i=2*this._accuracy/n;this._circleElement.style.width=`${i.toFixed(2)}px`,this._circleElement.style.height=`${i.toFixed(2)}px`}trigger(){if(!this._setup)return t.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ho--,po=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new t.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.l("trackuserlocationstart")),this.fire(new t.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ho++,ho>1?(e={maximumAge:6e5,timeout:0},po=!0):(e=this.options.positionOptions,po=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},e.GlobeControl=class{constructor(){this._toggleProjection=()=>{var e;const t=null===(e=this._map.getProjection())||void 0===e?void 0:e.type;this._map.setProjection("mercator"!==t&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var e;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),"globe"===(null===(e=this._map.getProjection())||void 0===e?void 0:e.type)?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(e){return this._map=e,this._container=u.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=u.create("button","maplibregl-ctrl-globe",this._container),u.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){u.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},e.Hash=Ui,e.ImageSource=te,e.KeyboardHandler=Ca,e.LngLatBounds=H,e.LogoControl=Za,e.Map=class extends Ga{constructor(e){var r,n;t.cF.mark(t.cG.create);const i=Object.assign(Object.assign(Object.assign({},ro),e),{canvasContextAttributes:Object.assign(Object.assign({},ro.canvasContextAttributes),e.canvasContextAttributes)});if(null!=i.minZoom&&null!=i.maxZoom&&i.minZoom>i.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=i.minPitch&&null!=i.maxPitch&&i.minPitch>i.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=i.minPitch&&i.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=i.maxPitch&&i.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const a=new jt,o=new $t;if(void 0!==i.minZoom&&a.setMinZoom(i.minZoom),void 0!==i.maxZoom&&a.setMaxZoom(i.maxZoom),void 0!==i.minPitch&&a.setMinPitch(i.minPitch),void 0!==i.maxPitch&&a.setMaxPitch(i.maxPitch),void 0!==i.renderWorldCopies&&a.setRenderWorldCopies(i.renderWorldCopies),null!==i.transformConstrain&&a.setConstrainOverride(i.transformConstrain),super(a,o,{bearingSnap:i.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Ha,this._controls=[],this._mapId=t.ag(),this._lostContextStyle={style:null,images:null},this._contextLost=e=>{e.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.painter.destroy();for(const e of Object.values(this.style._layers))if("custom"===e.type&&console.warn(`Custom layer with id '${e.id}' cannot be restored after WebGL context loss. You will need to re-add it manually after context restoration.`),e._listeners)for(const[t]of Object.entries(e._listeners))console.warn(`Custom layer with id '${e.id}' had event listeners for event '${t}' which cannot be restored after WebGL context loss. You will need to re-add them manually after context restoration.`);this._lostContextStyle=this._getStyleAndImages(),this.style.destroy(),this.style=null,this.fire(new t.l("webglcontextlost",{originalEvent:e}))},this._contextRestored=e=>{this._lostContextStyle.style&&this.setStyle(this._lostContextStyle.style,{diff:!1}),this._lostContextStyle.images&&(this.style.imageManager.images=this._lostContextStyle.images),this._setupPainter(),this.resize(),this._update(),this.fire(new t.l("webglcontextrestored",{originalEvent:e}))},this._onMapScroll=e=>{if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=i.interactive,this._maxTileCacheSize=i.maxTileCacheSize,this._maxTileCacheZoomLevels=i.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},i.canvasContextAttributes),this._trackResize=!0===i.trackResize,this._bearingSnap=i.bearingSnap,this._centerClampedToGround=i.centerClampedToGround,this._refreshExpiredTiles=!0===i.refreshExpiredTiles,this._fadeDuration=i.fadeDuration,this._crossSourceCollisions=!0===i.crossSourceCollisions,this._collectResourceTiming=!0===i.collectResourceTiming,this._locale=Object.assign(Object.assign({},eo),i.locale),this._clickTolerance=i.clickTolerance,this._overridePixelRatio=i.pixelRatio,this._maxCanvasSize=i.maxCanvasSize,this._zoomLevelsToOverscale=i.experimentalZoomLevelsToOverscale,this.transformCameraUpdate=i.transformCameraUpdate,this.transformConstrain=i.transformConstrain,this.cancelPendingTileRequestsWhileZooming=!0===i.cancelPendingTileRequestsWhileZooming,void 0!==i.reduceMotion&&(s.prefersReducedMotion=i.reduceMotion),this._imageQueueHandle=_.addThrottleControl(()=>this.isMoving()),this._requestManager=new y(i.transformRequest),"string"==typeof i.container){if(this._container=document.getElementById(i.container),!this._container)throw new Error(`Container '${i.container}' not found.`)}else{if(!(i.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=i.container}if(i.maxBounds&&this.setMaxBounds(i.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),"undefined"!=typeof window){addEventListener("online",this._onWindowOnline,!1);let e=!1;const t=ji(e=>{this._trackResize&&!this._removed&&(this.resize(e),this.redraw())},50);this._resizeObserver=new ResizeObserver(r=>{e?t(r):e=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Ua(this,i),this._hash=i.hash&&new Ui("string"==typeof i.hash&&i.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:i.center,elevation:i.elevation,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch,roll:i.roll}),i.bounds&&(this.resize(),this.fitBounds(i.bounds,t.e({},i.fitBoundsOptions,{duration:0}))));const l="string"==typeof i.style||!("globe"===(null===(n=null===(r=i.style)||void 0===r?void 0:r.projection)||void 0===n?void 0:n.type));this.resize(null,l),this._localIdeographFontFamily=i.localIdeographFontFamily,this._validateStyle=i.validateStyle,i.style&&this.setStyle(i.style,{localIdeographFontFamily:i.localIdeographFontFamily}),i.attributionControl&&this.addControl(new $a("boolean"==typeof i.attributionControl?void 0:i.attributionControl)),i.maplibreLogo&&this.addControl(new Za,i.logoPosition),this.on("style.load",()=>{if(l||this._resizeTransform(),this.transform.unmodified){const e=t.U(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(e)}}),this.on("data",e=>{this._update("style"===e.dataType),this.fire(new t.l(`${e.dataType}data`,e))}),this.on("dataloading",e=>{this.fire(new t.l(`${e.dataType}dataloading`,e))}),this.on("dataabort",e=>{this.fire(new t.l("sourcedataabort",e))})}_getMapId(){return this._mapId}setGlobalStateProperty(e,t){return this.style.setGlobalStateProperty(e,t),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(e,r){if(void 0===r&&(r=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=e.onAdd(this);this._controls.push(e);const i=this._controlPositions[r];return-1!==r.indexOf("bottom")?i.insertBefore(n,i.firstChild):i.appendChild(n),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new t.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(e);return r>-1&&this._controls.splice(r,1),e.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}coveringTiles(e){return Pe(this.transform,e)}calculateCameraOptionsFromTo(e,t,r,n){return null==n&&this.terrain&&(n=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(e,t,r,n)}resize(e,r=!0){const[n,i]=this._containerDimensions(),a=this._getClampedPixelRatio(n,i);if(this._resizeCanvas(n,i,a),this.painter.resize(n,i,a),this.painter.overLimit()){const e=this.painter.context.gl;this._maxCanvasSize=[e.drawingBufferWidth,e.drawingBufferHeight];const t=this._getClampedPixelRatio(n,i);this._resizeCanvas(n,i,t),this.painter.resize(n,i,t)}this._resizeTransform(r);const o=!this._moving;return o&&(this.stop(),this.fire(new t.l("movestart",e)).fire(new t.l("move",e))),this.fire(new t.l("resize",e)),o&&this.fire(new t.l("moveend",e)),this}_resizeTransform(e=!0){var t;const[r,n]=this._containerDimensions();this.transform.resize(r,n,e),null===(t=this._requestedCameraState)||void 0===t||t.resize(r,n,e)}_getClampedPixelRatio(e,t){const{0:r,1:n}=this._maxCanvasSize,i=this.getPixelRatio(),a=e*i,o=t*i;return Math.min(a>r?r/a:1,o>n?n/o:1)*i}getPixelRatio(){var e;return null!==(e=this._overridePixelRatio)&&void 0!==e?e:devicePixelRatio}setPixelRatio(e){this._overridePixelRatio=e,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(e){return this.transform.setMaxBounds(H.convert(e)),this._update()}setMinZoom(e){if((e=null==e?-2:e)>=-2&&e<=this.transform.maxZoom)return this.transform.setMinZoom(e),this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.setMaxZoom(e),this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if((e=null==e?0:e)<0)throw new Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch)return this.transform.setMinPitch(e),this._update(),this.getPitch()<e&&this.setPitch(e),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if((e=null==e?60:e)>180)throw new Error("maxPitch must be less than or equal to 180");if(e>=this.transform.minPitch)return this.transform.setMaxPitch(e),this._update(),this.getPitch()>e&&this.setPitch(e),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.setRenderWorldCopies(e),this._update()}setTransformConstrain(e){return this.transform.setConstrainOverride(e),this._update()}project(e){return this.transform.locationToScreenPoint(t.V.convert(e),this.style&&this.terrain)}unproject(e){return this.transform.screenPointToLocation(t.P.convert(e),this.terrain)}isMoving(){var e;return this._moving||(null===(e=this.handlers)||void 0===e?void 0:e.isMoving())}isZooming(){var e;return this._zooming||(null===(e=this.handlers)||void 0===e?void 0:e.isZooming())}isRotating(){var e;return this._rotating||(null===(e=this.handlers)||void 0===e?void 0:e.isRotating())}_createDelegatedListener(e,t,r){if("mouseenter"===e||"mouseover"===e){let n=!1;const i=i=>{const a=t.filter(e=>this.getLayer(e)),o=0!==a.length?this.queryRenderedFeatures(i.point,{layers:a}):[];o.length?n||(n=!0,r.call(this,new Qi(e,this,i.originalEvent,{features:o}))):n=!1};return{layers:t,listener:r,delegates:{mousemove:i,mouseout:()=>{n=!1}}}}if("mouseleave"===e||"mouseout"===e){let n=!1;const i=i=>{const a=t.filter(e=>this.getLayer(e));(0!==a.length?this.queryRenderedFeatures(i.point,{layers:a}):[]).length?n=!0:n&&(n=!1,r.call(this,new Qi(e,this,i.originalEvent)))},a=t=>{n&&(n=!1,r.call(this,new Qi(e,this,t.originalEvent)))};return{layers:t,listener:r,delegates:{mousemove:i,mouseout:a}}}{const n=e=>{const n=t.filter(e=>this.getLayer(e)),i=0!==n.length?this.queryRenderedFeatures(e.point,{layers:n}):[];i.length&&(e.features=i,r.call(this,e),delete e.features)};return{layers:t,listener:r,delegates:{[e]:n}}}}_saveDelegatedListener(e,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(t)}_removeDelegatedListener(e,t,r){if(!this._delegatedListeners||!this._delegatedListeners[e])return;const n=this._delegatedListeners[e];for(let e=0;e<n.length;e++){const i=n[e];if(i.listener===r&&i.layers.length===t.length&&i.layers.every(e=>t.includes(e))){for(const e in i.delegates)this.off(e,i.delegates[e]);return void n.splice(e,1)}}}on(e,t,r){if(void 0===r)return super.on(e,t);const n="string"==typeof t?[t]:t,i=this._createDelegatedListener(e,n,r);this._saveDelegatedListener(e,i);for(const e in i.delegates)this.on(e,i.delegates[e]);return{unsubscribe:()=>{this._removeDelegatedListener(e,n,r)}}}once(e,t,r){if(void 0===r)return super.once(e,t);const n="string"==typeof t?[t]:t,i=this._createDelegatedListener(e,n,r);for(const t in i.delegates){const a=i.delegates[t];i.delegates[t]=(...t)=>{this._removeDelegatedListener(e,n,r),a(...t)}}this._saveDelegatedListener(e,i);for(const e in i.delegates)this.once(e,i.delegates[e]);return this}off(e,t,r){return void 0===r?super.off(e,t):(this._removeDelegatedListener(e,"string"==typeof t?[t]:t,r),this)}queryRenderedFeatures(e,r){if(!this.style)return[];let n;const i=e instanceof t.P||Array.isArray(e),a=i?e:[[0,0],[this.transform.width,this.transform.height]];if(r=r||(i?{}:e)||{},a instanceof t.P||"number"==typeof a[0])n=[t.P.convert(a)];else{const e=t.P.convert(a[0]),r=t.P.convert(a[1]);n=[e,new t.P(r.x,e.y),r,new t.P(e.x,r.y),e]}return this.style.queryRenderedFeatures(n,r,this.transform)}querySourceFeatures(e,t){return this.style.querySourceFeatures(e,t)}setStyle(e,r){return!1!==(r=t.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},r)).diff&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(e,r))}setTransformRequest(e){return this._requestManager.setTransformRequest(e),this}_getUIString(e){const t=this._locale[e];if(null==t)throw new Error(`Missing UI string '${e}'`);return t}_updateStyle(e,t){var r,n;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(e,t));const i=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!e)),e?(this.style=new kr(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e,t,i):this.style.loadJSON(e,t,i),this):(null===(n=null===(r=this.style)||void 0===r?void 0:r.projection)||void 0===n||n.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new kr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,r){if("string"==typeof e){const n=this._requestManager.transformRequest(e,"Style");t.j(n,new AbortController).then(e=>{this._updateDiff(e.data,r)}).catch(e=>{e&&this.fire(new t.k(e))})}else"object"==typeof e&&this._updateDiff(e,r)}_updateDiff(e,r){try{this.style.setState(e,r)&&this._update(!0)}catch(n){t.w(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(e,r)}}getStyle(){if(this.style)return this.style.serialize()}_getStyleAndImages(){return this.style?{style:this.style.serialize(),images:this.style.imageManager.cloneImages()}:{style:null,images:{}}}isStyleLoaded(){return this.style?this.style.loaded():t.w("There is no style added to the map.")}addSource(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)}isSourceLoaded(e){const r=this.style&&this.style.tileManagers[e];if(void 0!==r)return r.loaded();this.fire(new t.k(new Error(`There is no tile manager with ID '${e}'`)))}setTerrain(e){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),e){const r=this.style.tileManagers[e.source];if(!r)throw new Error(`cannot load terrain, because there exists no source with ID: ${e.source}`);null===this.terrain&&r.reload();for(const r in this.style._layers){const n=this.style._layers[r];"hillshade"===n.type&&n.source===e.source&&t.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),"color-relief"===n.type&&n.source===e.source&&t.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ya(this.painter,r,e),this.painter.renderToTexture=new Ja(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=t=>{var r;"style"===t.dataType?this.terrain.tileManager.freeRtt():"source"===t.dataType&&t.tile&&(t.sourceId!==e.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),"image"===(null===(r=t.source)||void 0===r?void 0:r.type)?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(t.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new t.l("terrain",{terrain:e})),this}getTerrain(){var e,t;return null!==(t=null===(e=this.terrain)||void 0===e?void 0:e.options)&&void 0!==t?t:null}areTilesLoaded(){const e=this.style&&this.style.tileManagers;for(const t in e){const r=e[t]._tiles;for(const e in r){const t=r[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}}return!0}removeSource(e){return this.style.removeSource(e),this._update(!0)}getSource(e){return this.style.getSource(e)}setSourceTileLodParams(e,t,r){if(r){const n=this.getSource(r);if(!n)throw new Error(`There is no source with ID "${r}", cannot set LOD parameters`);n.calculateTileZoom=we(Math.max(1,e),Math.max(1,t))}else for(const r in this.style.tileManagers)this.style.tileManagers[r].getSource().calculateTileZoom=we(Math.max(1,e),Math.max(1,t));return this._update(!0),this}refreshTiles(e,r){const n=this.style.tileManagers[e];if(!n)throw new Error(`There is no tile manager with ID "${e}", cannot refresh tile`);void 0===r?n.reload(!0):n.refreshTiles(r.map(e=>new t.ad(e.z,e.x,e.y)))}addImage(e,r,n={}){const{pixelRatio:i=1,sdf:a=!1,stretchX:o,stretchY:l,content:c,textFitWidth:u,textFitHeight:h}=n;if(this._lazyInitEmptyStyle(),!(r instanceof HTMLImageElement||t.b(r))){if(void 0===r.width||void 0===r.height)return this.fire(new t.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:n,height:s,data:d}=r,p=r;return this.style.addImage(e,{data:new t.R({width:n,height:s},new Uint8Array(d)),pixelRatio:i,stretchX:o,stretchY:l,content:c,textFitWidth:u,textFitHeight:h,sdf:a,version:0,userImage:p}),p.onAdd&&p.onAdd(this,e),this}}{const{width:n,height:d,data:p}=s.getImageData(r);this.style.addImage(e,{data:new t.R({width:n,height:d},p),pixelRatio:i,stretchX:o,stretchY:l,content:c,textFitWidth:u,textFitHeight:h,sdf:a,version:0})}}updateImage(e,r){const n=this.style.getImage(e);if(!n)return this.fire(new t.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const i=r instanceof HTMLImageElement||t.b(r)?s.getImageData(r):r,{width:a,height:o,data:l}=i;if(void 0===a||void 0===o)return this.fire(new t.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(a!==n.data.width||o!==n.data.height)return this.fire(new t.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const c=!(r instanceof HTMLImageElement||t.b(r));return n.data.replace(l,c),this.style.updateImage(e,n),this}getImage(e){return this.style.getImage(e)}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new t.k(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(e){return _.getImage(this._requestManager.transformRequest(e,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)}moveLayer(e,t){return this.style.moveLayer(e,t),this._update(!0)}removeLayer(e){return this.style.removeLayer(e),this._update(!0)}getLayer(e){return this.style.getLayer(e)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(e,t,r){return this.style.setLayerZoomRange(e,t,r),this._update(!0)}setFilter(e,t,r={}){return this.style.setFilter(e,t,r),this._update(!0)}getFilter(e){return this.style.getFilter(e)}setPaintProperty(e,t,r,n={}){return this.style.setPaintProperty(e,t,r,n),this._update(!0)}getPaintProperty(e,t){return this.style.getPaintProperty(e,t)}setLayoutProperty(e,t,r,n={}){return this.style.setLayoutProperty(e,t,r,n),this._update(!0)}getLayoutProperty(e,t){return this.style.getLayoutProperty(e,t)}setGlyphs(e,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(e,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(e,t,r={}){return this._lazyInitEmptyStyle(),this.style.addSprite(e,t,r,e=>{e||this._update(!0)}),this}removeSprite(e){return this._lazyInitEmptyStyle(),this.style.removeSprite(e),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(e,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(e,t,e=>{e||this._update(!0)}),this}setLight(e,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(e,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(e,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(e,t){return this.style.setFeatureState(e,t),this._update()}removeFeatureState(e,t){return this.style.removeFeatureState(e,t),this._update()}getFeatureState(e){return this.style.getFeatureState(e)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let e=0,t=0;return this._container&&(e=this._container.clientWidth||400,t=this._container.clientHeight||300),[e,t]}_setupContainer(){const e=this._container;e.classList.add("maplibregl-map");const t=this._canvasContainer=u.create("div","maplibregl-canvas-container",e);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=u.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const r=this._containerDimensions(),n=this._getClampedPixelRatio(r[0],r[1]);this._resizeCanvas(r[0],r[1],n);const i=this._controlContainer=u.create("div","maplibregl-control-container",e),a=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(e=>{a[e]=u.create("div",`maplibregl-ctrl-${e} `,i)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(e,t,r){this._canvas.width=Math.floor(r*e),this._canvas.height=Math.floor(r*t),this._canvas.style.width=`${e}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const e=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",r=>{t={requestedAttributes:e},r&&(t.statusMessage=r.statusMessage,t.type=r.type)},{once:!0});let r=null;if(r=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,e):this._canvas.getContext("webgl2",e)||this._canvas.getContext("webgl",e),!r){const e="Failed to initialize WebGL";throw t?(t.message=e,new Error(JSON.stringify(t))):new Error(e)}this.painter=new Vi(r,this.transform),h.testSupport(r)}migrateProjection(e,r){super.migrateProjection(e,r),this.painter.transform=e,this.fire(new t.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_render(e){var r,n,i,a,o;const s=this._idleTriggered?this._fadeDuration:0,l=(null===(r=this.style.projection)||void 0===r?void 0:r.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),this._removed)return;let u=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const e=this.transform.zoom,r=c();this.style.zoomHistory.update(e,r);const n=new t.H(e,{now:r,fadeDuration:s,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),i=n.crossFadingFactor();1===i&&i===this._crossFadingFactor||(u=!0,this._crossFadingFactor=i),this.style.update(n)}const h=(null===(n=this.style.projection)||void 0===n?void 0:n.transitionState)>0!==l;null===(i=this.style.projection)||void 0===i||i.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState(null===(a=this.style.projection)||void 0===a?void 0:a.transitionState,null===(o=this.style.projection)||void 0===o?void 0:o.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||h)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,s,this._crossSourceCollisions,h),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:s,showPadding:this.showPadding}),this.fire(new t.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,t.cF.mark(t.cG.load),this.fire(new t.l("load"))),this.style&&(this.style.hasTransitions()||u)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new t.l("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0,t.cF.mark(t.cG.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var e;this._hash&&this._hash.remove();for(const e of this._controls)e.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),"undefined"!=typeof window&&removeEventListener("online",this._onWindowOnline,!1),_.removeThrottleControl(this._imageQueueHandle),null===(e=this._resizeObserver)||void 0===e||e.disconnect();const r=this.painter.context.gl.getExtension("WEBGL_lose_context");(null==r?void 0:r.loseContext)&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),u.remove(this._canvasContainer),u.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),t.cF.clearMetrics(),this._removed=!0,this.fire(new t.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,s.frame(this._frameRequest,e=>{t.cF.frame(e),this._frameRequest=null;try{this._render(e)}catch(e){if(!t.cH(e)&&!function(e){return e.message===ei}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get version(){return to}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(e){return this._lazyInitEmptyStyle(),this.style.setProjection(e),this._update(!0)}},e.MapMouseEvent=Qi,e.MapTouchEvent=Ji,e.MapWheelEvent=ea,e.Marker=co,e.NavigationControl=class{constructor(e){this._updateZoomButtons=()=>{const e=this._map.getZoom(),t=e===this._map.getMaxZoom(),r=e===this._map.getMinZoom();this._zoomInButton.disabled=t,this._zoomOutButton.disabled=r,this._zoomInButton.setAttribute("aria-disabled",t.toString()),this._zoomOutButton.setAttribute("aria-disabled",r.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,t)=>{const r=this._map._getUIString(`NavigationControl.${t}`);e.title=r,e.setAttribute("aria-label",r)},this.options=t.e({},no,e),this._container=u.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),u.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),u.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=u.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new io(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){u.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(e,t){const r=u.create("button",e,this._container);return r.type="button",r.addEventListener("click",t),r}},e.Popup=class extends t.E{constructor(e){super(),this._updateOpacity=()=>{void 0!==this.options.locationOccludedOpacity&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&u.remove(this._content),this._container&&(u.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new t.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=u.create("div","maplibregl-popup",this._map.getContainer()),this._tip=u.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const e of this.options.className.split(" "))this._container.classList.add(e);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=oo(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const t=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let r=this.options.anchor;const n=vo(this.options.offset);if(!r){const e=this._container.offsetWidth,i=this._container.offsetHeight;let a;a=t.y+n.bottom.y<i?["top"]:t.y>this._map.transform.height-i?["bottom"]:[],t.x<e/2?a.push("left"):t.x>this._map.transform.width-e/2&&a.push("right"),r=0===a.length?"bottom":a.join("-")}let i=t.add(n[r]);this.options.subpixelPositioning||(i=i.round()),u.setTransform(this._container,`${so[r]} translate(${i.x}px,${i.y}px)`),lo(this._container,r,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=t.e(Object.create(_o),e)}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new t.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.V.convert(e),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(document.createTextNode(e))}setHTML(e){const t=document.createDocumentFragment(),r=document.createElement("body");let n;for(r.innerHTML=e;n=r.firstChild,n;)t.appendChild(n);return this.setDOMContent(t)}getMaxWidth(){var e;return null===(e=this._container)||void 0===e?void 0:e.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=u.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(e),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(e){return this._container&&this._container.classList.add(e),this}removeClassName(e){return this._container&&this._container.classList.remove(e),this}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){if(this._container)return this._container.classList.toggle(e)}setSubpixelPositioning(e){this.options.subpixelPositioning=e}_createCloseButton(){this.options.closeButton&&(this._closeButton=u.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const e=this._container.querySelector(yo);e&&e.focus()}},e.RasterDEMTileSource=K,e.RasterTileSource=Y,e.ScaleControl=class{constructor(e){this._onMove=()=>{mo(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,mo(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},fo),e)}getDefaultPosition(){return"bottom-left"}onAdd(e){return this._map=e,this._container=u.create("div","maplibregl-ctrl maplibregl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){u.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},e.ScrollZoomHandler=Aa,e.Style=kr,e.TerrainControl=class{constructor(e){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=e}onAdd(e){return this._map=e,this._container=u.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=u.create("button","maplibregl-ctrl-terrain",this._container),u.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){u.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},e.TwoFingersTouchPitchHandler=Pa,e.TwoFingersTouchRotateHandler=Ta,e.TwoFingersTouchZoomHandler=xa,e.TwoFingersTouchZoomRotateHandler=Ba,e.VectorTileSource=X,e.VideoSource=re,e.addSourceType=(e,r)=>t._(void 0,void 0,void 0,function*(){if(ae(e))throw new Error(`A source type called "${e}" already exists.`);((e,t)=>{ie[e]=t})(e,r)}),e.clearPrewarmedResources=function(){const e=B;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(L),B=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},e.createTileMesh=rr,e.getMaxParallelImageRequests=function(){return t.a.MAX_PARALLEL_IMAGE_REQUESTS},e.getRTLTextPluginStatus=function(){return ce().getRTLTextPluginStatus()},e.getVersion=function(){return bo},e.getWorkerCount=function(){return R.workerCount},e.getWorkerUrl=function(){return t.a.WORKER_URL},e.importScriptInWorkers=function(e){return j().broadcast("IS",e)},e.isTimeFrozen=function(){return l.isFrozen()},e.now=c,e.prewarm=function(){N().acquire(L)},e.restoreNow=function(){l.restoreNow()},e.setMaxParallelImageRequests=function(e){t.a.MAX_PARALLEL_IMAGE_REQUESTS=e},e.setNow=function(e){l.setNow(e)},e.setRTLTextPlugin=function(e,t){return ce().setRTLTextPlugin(e,t)},e.setWorkerCount=function(e){R.workerCount=e},e.setWorkerUrl=function(e){t.a.WORKER_URL=e}}),e}()},6539:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3C/svg%3E"},6540:(e,t,r)=>{"use strict";e.exports=r(9869)},6694:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2722%27 height=%2722%27 fill=%27%2333b5e5%27 viewBox=%270 0 22 22%27%3E%3Cpath d=%27m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0%27/%3E%3C/svg%3E"},7035:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23333%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z%27/%3E%3C/svg%3E"},7187:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(6540)),a=n(r(5338)),o=r(1166);r(8052),a.default.createRoot(document.getElementById("root")).render(i.default.createElement(o.App,null))},7603:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z%27/%3E%3C/svg%3E"},7659:e=>{"use strict";var t={};e.exports=function(e,r){var n=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},7695:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%2333b5e5%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3C/svg%3E"},7825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var i=void 0!==r.layer;i&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,i&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var a=r.sourceMap;a&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},7914:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2788%27 height=%2723%27 fill=%27none%27%3E%3Cpath fill=%27%23000%27 fill-opacity=%27.4%27 fill-rule=%27evenodd%27 d=%27M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.25 1.25 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.25 1.25 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5 5 0 0 1 .314-.787l.009-.016a4.6 4.6 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.6 4.6 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4q.47.48.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.42 2.42 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.45 2.45 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675q.318.302.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.8 4.8 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.4 3.4 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.25 1.25 0 0 1 .689 1.004 4.7 4.7 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528q-.001.515-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.8 5.8 0 0 1-.548-2.512q0-.429.053-.843a1.3 1.3 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.8 4.8 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.5 4.5 0 0 1-1.935-.424 1.25 1.25 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.4 2.4 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.7 4.7 0 0 1-1.782 1.884 4.77 4.77 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.5 4.5 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a5 5 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.25 1.25 0 0 1-1.115.676h-.098a1.25 1.25 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15q.493-.356.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267q-.133-.329-.526-.658l-.032-.028a3.2 3.2 0 0 0-.668-.428l-.27-.12a3.3 3.3 0 0 0-1.235-.23q-1.136-.001-1.974.493a3.36 3.36 0 0 0-1.3 1.382q-.445.89-.444 2.074 0 1.2.51 2.107a3.8 3.8 0 0 0 1.382 1.381 3.9 3.9 0 0 0 1.893.477q.795 0 1.455-.33zm-2.789-5.38q-.576.675-.575 1.762 0 1.102.559 1.794.576.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.2 2.2 0 0 0 .468-.29l.178-.161a2.2 2.2 0 0 0 .397-.561q.244-.5.244-1.15v-.115q0-.708-.296-1.267l-.043-.077a2.2 2.2 0 0 0-.633-.709l-.13-.086-.047-.028a2.1 2.1 0 0 0-1.073-.285q-1.052 0-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.96.96 0 0 0-.353-.389.85.85 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.6 2.6 0 0 0 .331.423q.319.33.755.548l.173.074q.65.255 1.49.255 1.02 0 1.844-.493a3.45 3.45 0 0 0 1.316-1.4q.493-.904.493-2.089 0-1.909-.988-2.913-.988-1.02-2.584-1.02-.898 0-1.575.347a3 3 0 0 0-.415.262l-.199.166a3.4 3.4 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138q.206.29.48.5l.155.11.053.034q.51.296 1.119.297 1.07 0 1.645-.675.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.435 0-.835.16a2 2 0 0 0-.284.136 2 2 0 0 0-.363.254 2.2 2.2 0 0 0-.46.569l-.082.162a2.6 2.6 0 0 0-.213 1.072v.115q0 .707.296 1.267l.135.211zm.964-.818a1.1 1.1 0 0 0 .367.385.94.94 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a1 1 0 0 0-.503.135l-.012.007a.86.86 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.4 1.4 0 0 0 .14.66zm15.7-6.222q.347-.346.346-.856a1.05 1.05 0 0 0-.345-.79 1.18 1.18 0 0 0-.84-.329q-.51 0-.855.33a1.05 1.05 0 0 0-.346.79q0 .51.346.855.345.346.856.346.51 0 .839-.346zm4.337 9.314.033-1.332q.191.403.59.747l.098.081a4 4 0 0 0 .316.224l.223.122a3.2 3.2 0 0 0 1.44.322 3.8 3.8 0 0 0 1.875-.477 3.5 3.5 0 0 0 1.382-1.366q.527-.89.526-2.09 0-1.184-.444-2.073a3.24 3.24 0 0 0-1.283-1.399q-.823-.51-1.942-.51a3.5 3.5 0 0 0-1.527.344l-.086.043-.165.09a3 3 0 0 0-.33.214q-.432.315-.656.707a2 2 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.5 2.5 0 0 0 .566.7q.117.098.245.18l.144.08a2.1 2.1 0 0 0 .975.232q1.07 0 1.645-.675.576-.69.576-1.778 0-1.102-.576-1.777-.56-.691-1.645-.692a2.2 2.2 0 0 0-1.015.235q-.22.113-.415.282l-.15.142a2.1 2.1 0 0 0-.42.594q-.223.479-.223 1.1v.115q0 .705.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.87.87 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.1 1.1 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013q.345-.13.724-.14l.069-.002q.493 0 .642.099l.247-1.794q-.196-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2 2 0 0 0-.411.148 2.2 2.2 0 0 0-.4.249 2.5 2.5 0 0 0-.485.499 2.7 2.7 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884q0-.546.159-.943a1.5 1.5 0 0 1 .466-.636 2.5 2.5 0 0 1 .399-.253 2 2 0 0 1 .224-.099zm9.784 2.656.05-.922q0-1.743-.856-2.698-.838-.97-2.584-.97-1.119-.001-2.007.493a3.46 3.46 0 0 0-1.4 1.382q-.493.906-.493 2.106 0 1.07.428 1.975.428.89 1.332 1.432.906.526 2.255.526.973 0 1.668-.185l.044-.012.135-.04q.613-.184.984-.421l-.542-1.267q-.3.162-.642.274l-.297.087q-.51.131-1.3.131-.954 0-1.497-.444a1.6 1.6 0 0 1-.192-.193q-.366-.44-.512-1.234l-.004-.021zm-5.427-1.256-.003.022h3.752v-.138q-.011-.727-.288-1.118a1 1 0 0 0-.156-.176q-.46-.428-1.316-.428-.986 0-1.494.604-.379.45-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z%27/%3E%3Cpath fill=%27%23fff%27 d=%27m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81q-1.02 0-1.893-.478a3.8 3.8 0 0 1-1.381-1.382q-.51-.906-.51-2.106 0-1.185.444-2.074a3.36 3.36 0 0 1 1.3-1.382q.839-.494 1.974-.494a3.3 3.3 0 0 1 1.234.231 3.3 3.3 0 0 1 .97.575q.396.33.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332q-.279.593-1.02 1.053a3.17 3.17 0 0 1-1.662.444zm.296-1.482q.938 0 1.58-.642.642-.66.642-1.711v-.115q0-.708-.296-1.267a2.2 2.2 0 0 0-.807-.872 2.1 2.1 0 0 0-1.119-.313q-1.053 0-1.629.692-.575.675-.575 1.76 0 1.103.559 1.795.577.675 1.645.675zm6.521-6.237h1.711v1.4q.906-1.597 2.83-1.597 1.596 0 2.584 1.02.988 1.005.988 2.914 0 1.185-.493 2.09a3.46 3.46 0 0 1-1.316 1.399 3.5 3.5 0 0 1-1.844.493q-.954 0-1.662-.329a2.67 2.67 0 0 1-1.086-.97l.017 5.134h-1.728zm4.048 6.22q1.07 0 1.645-.674.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.592 0-1.12.296-.51.28-.822.823-.296.527-.296 1.234v.115q0 .708.296 1.267.313.543.823.855.51.296 1.119.297z%27/%3E%3Cpath fill=%27%23e1e3e9%27 d=%27M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.16 1.16 0 0 1-.856-.346 1.17 1.17 0 0 1-.346-.856 1.05 1.05 0 0 1 .346-.79q.346-.329.856-.329.494 0 .839.33a1.05 1.05 0 0 1 .345.79 1.16 1.16 0 0 1-.345.855q-.33.346-.84.346zm7.875 9.133a3.17 3.17 0 0 1-1.662-.444q-.723-.46-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283q.279-.658 1.086-1.119a3.5 3.5 0 0 1 1.778-.477q1.119 0 1.942.51a3.24 3.24 0 0 1 1.283 1.4q.445.888.444 2.072 0 1.201-.526 2.09a3.5 3.5 0 0 1-1.382 1.366 3.8 3.8 0 0 1-1.876.477zm-.296-1.481q1.069 0 1.645-.675.577-.69.577-1.778 0-1.102-.577-1.776-.56-.691-1.645-.692a2.12 2.12 0 0 0-1.58.659q-.642.641-.642 1.694v.115q0 .71.296 1.267a2.4 2.4 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481q.263-.757.856-1.217a2.14 2.14 0 0 1 1.349-.46q.527 0 .724.098l-.247 1.794q-.149-.099-.642-.099-.774 0-1.416.494-.626.493-.626 1.58v3.883h-1.777V9.242zm9.534 7.718q-1.35 0-2.255-.526-.904-.543-1.332-1.432a4.6 4.6 0 0 1-.428-1.975q0-1.2.493-2.106a3.46 3.46 0 0 1 1.4-1.382q.889-.495 2.007-.494 1.744 0 2.584.97.855.956.856 2.7 0 .444-.05.92h-5.43q.18 1.005.708 1.45.542.443 1.497.443.79 0 1.3-.131a4 4 0 0 0 .938-.362l.542 1.267q-.411.263-1.119.46-.708.198-1.711.197zm1.596-4.558q.016-1.02-.444-1.432-.46-.428-1.316-.428-1.728 0-1.991 1.86z%27/%3E%3Cpath d=%27M5.074 15.948a.484.657 0 0 0-.486.659v1.84a.484.657 0 0 0 .486.659h4.101a.484.657 0 0 0 .486-.659v-1.84a.484.657 0 0 0-.486-.659zm3.56 1.16H5.617v.838h3.017z%27 style=%27fill:%23fff;fill-rule:evenodd;stroke-width:1.03600001%27/%3E%3Cg style=%27stroke-width:1.12603545%27%3E%3Cpath d=%27M-9.408-1.416c-3.833-.025-7.056 2.912-7.08 6.615-.02 3.08 1.653 4.832 3.107 6.268.903.892 1.721 1.74 2.32 2.902l-.525-.004c-.543-.003-.992.304-1.24.639a1.87 1.87 0 0 0-.362 1.121l-.011 1.877c-.003.402.104.787.347 1.125.244.338.688.653 1.23.656l4.142.028c.542.003.99-.306 1.238-.641a1.87 1.87 0 0 0 .363-1.121l.012-1.875a1.87 1.87 0 0 0-.348-1.127c-.243-.338-.688-.653-1.23-.656l-.518-.004c.597-1.145 1.425-1.983 2.348-2.87 1.473-1.414 3.18-3.149 3.2-6.226-.016-3.59-2.923-6.684-6.993-6.707m-.006 1.1v.002c3.274.02 5.92 2.532 5.9 5.6-.017 2.706-1.39 4.026-2.863 5.44-1.034.994-2.118 2.033-2.814 3.633-.018.041-.052.055-.075.065q-.013.004-.02.01a.34.34 0 0 1-.226.084.34.34 0 0 1-.224-.086l-.092-.077c-.699-1.615-1.768-2.669-2.781-3.67-1.454-1.435-2.797-2.762-2.78-5.478.02-3.067 2.7-5.545 5.975-5.523m-.02 2.826c-1.62-.01-2.944 1.315-2.955 2.96-.01 1.646 1.295 2.988 2.916 2.999h.002c1.621.01 2.943-1.316 2.953-2.961.011-1.646-1.294-2.988-2.916-2.998m-.005 1.1c1.017.006 1.829.83 1.822 1.89s-.83 1.874-1.848 1.867c-1.018-.006-1.829-.83-1.822-1.89s.83-1.874 1.848-1.868m-2.155 11.857 4.14.025c.271.002.49.305.487.676l-.013 1.875c-.003.37-.224.67-.495.668l-4.14-.025c-.27-.002-.487-.306-.485-.676l.012-1.875c.003-.37.224-.67.494-.668%27 style=%27color:%23000;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:%23000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:evenodd;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:%23000;solid-opacity:1;vector-effect:none;fill:%23000;fill-opacity:.4;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto%27 transform=%27translate%2815.553 2.85%29scale%28.88807%29%27/%3E%3Cpath d=%27M-9.415-.316C-12.69-.338-15.37 2.14-15.39 5.207c-.017 2.716 1.326 4.041 2.78 5.477 1.013 1 2.081 2.055 2.78 3.67l.092.076a.34.34 0 0 0 .225.086.34.34 0 0 0 .227-.083l.019-.01c.022-.009.057-.024.074-.064.697-1.6 1.78-2.64 2.814-3.634 1.473-1.414 2.847-2.733 2.864-5.44.02-3.067-2.627-5.58-5.901-5.601m-.057 8.784c1.621.011 2.944-1.315 2.955-2.96.01-1.646-1.295-2.988-2.916-2.999-1.622-.01-2.945 1.315-2.955 2.96s1.295 2.989 2.916 3%27 style=%27clip-rule:evenodd;fill:%23e1e3e9;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4%27 transform=%27translate%2815.553 2.85%29scale%28.88807%29%27/%3E%3Cpath d=%27M-11.594 15.465c-.27-.002-.492.297-.494.668l-.012 1.876c-.003.371.214.673.485.675l4.14.027c.271.002.492-.298.495-.668l.012-1.877c.003-.37-.215-.672-.485-.674z%27 style=%27clip-rule:evenodd;fill:%23fff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4%27 transform=%27translate%2815.553 2.85%29scale%28.88807%29%27/%3E%3C/g%3E%3C/svg%3E"},8052:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>_});var n=r(5072),i=r.n(n),a=r(7825),o=r.n(a),s=r(7659),l=r.n(s),c=r(5056),u=r.n(c),h=r(540),d=r.n(h),p=r(1113),f=r.n(p),m=r(3849),g={};g.styleTagTransform=f(),g.setAttributes=u(),g.insert=l().bind(null,"head"),g.domAPI=o(),g.insertStyleElement=d(),i()(m.A,g);const _=m.A&&m.A.locals?m.A.locals:void 0},8164:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z%27/%3E%3C/svg%3E"},8460:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23999%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3Cpath fill=%27red%27 d=%27m14 5 1 1-9 9-1-1z%27/%3E%3C/svg%3E"},8605:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27m10.5 14 4-8 4 8z%27/%3E%3Cpath fill=%27%23ccc%27 d=%27m10.5 16 4 8 4-8z%27/%3E%3C/svg%3E"},8869:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23e54e33%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3C/svg%3E"},9387:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2722%27 height=%2722%27 fill=%27none%27 stroke=%27%23333%27 viewBox=%270 0 22 22%27%3E%3Ccircle cx=%2711%27 cy=%2711%27 r=%278.5%27/%3E%3Cpath d=%27M17.5 11c0 4.819-3.02 8.5-6.5 8.5S4.5 15.819 4.5 11 7.52 2.5 11 2.5s6.5 3.681 6.5 8.5Z%27/%3E%3Cpath d=%27M13.5 11c0 2.447-.331 4.64-.853 6.206-.262.785-.562 1.384-.872 1.777-.314.399-.58.517-.775.517s-.461-.118-.775-.517c-.31-.393-.61-.992-.872-1.777C8.831 15.64 8.5 13.446 8.5 11s.331-4.64.853-6.206c.262-.785.562-1.384.872-1.777.314-.399.58-.517.775-.517s.461.118.775.517c.31.393.61.992.872 1.777.522 1.565.853 3.76.853 6.206Z%27/%3E%3Cpath d=%27M11 7.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138q.07-.058.224-.138c.299-.151.763-.302 1.379-.434C7.378 5.666 9.091 5.5 11 5.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138q-.07.058-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428ZM4.486 6.436ZM11 16.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138 1.3 1.3 0 0 1 .224-.138c.299-.151.763-.302 1.379-.434C7.378 14.666 9.091 14.5 11 14.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138a1.3 1.3 0 0 1-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428Zm-6.514-1.064ZM11 12.5c-2.46 0-4.672-.222-6.255-.574-.796-.177-1.406-.38-1.805-.59a1.5 1.5 0 0 1-.39-.272.3.3 0 0 1-.047-.064.3.3 0 0 1 .048-.064c.066-.073.189-.167.389-.272.399-.21 1.009-.413 1.805-.59C6.328 9.722 8.54 9.5 11 9.5s4.672.222 6.256.574c.795.177 1.405.38 1.804.59.2.105.323.2.39.272a.3.3 0 0 1 .047.064.3.3 0 0 1-.048.064 1.4 1.4 0 0 1-.389.272c-.399.21-1.009.413-1.804.59-1.584.352-3.796.574-6.256.574Zm-8.501-1.51v.002zm0 .018v.002zm17.002.002v-.002zm0-.018v-.002z%27/%3E%3C/svg%3E"},9739:(e,t,r)=>{"use strict";r.d(t,{A:()=>ye});var n=r(1601),i=r.n(n),a=r(6314),o=r.n(a),s=r(4417),l=r.n(s),c=new URL(r(7035),r.b),u=new URL(r(3470),r.b),h=new URL(r(8164),r.b),d=new URL(r(4665),r.b),p=new URL(r(4890),r.b),f=new URL(r(3363),r.b),m=new URL(r(3490),r.b),g=new URL(r(7603),r.b),_=new URL(r(3913),r.b),y=new URL(r(1413),r.b),v=new URL(r(4643),r.b),b=new URL(r(216),r.b),x=new URL(r(1907),r.b),w=new URL(r(8605),r.b),T=new URL(r(9387),r.b),S=new URL(r(2353),r.b),P=new URL(r(5446),r.b),E=new URL(r(6694),r.b),C=new URL(r(4420),r.b),M=new URL(r(5796),r.b),k=new URL(r(2228),r.b),I=new URL(r(9819),r.b),A=new URL(r(7695),r.b),z=new URL(r(8869),r.b),D=new URL(r(557),r.b),L=new URL(r(8460),r.b),R=new URL(r(6539),r.b),F=new URL(r(3737),r.b),B=new URL(r(7914),r.b),O=new URL(r(6117),r.b),N=new URL(r(6311),r.b),V=o()(i()),j=l()(c),U=l()(u),G=l()(h),q=l()(d),$=l()(p),Z=l()(f),H=l()(m),W=l()(g),X=l()(_),Y=l()(y),K=l()(v),Q=l()(b),J=l()(x),ee=l()(w),te=l()(T),re=l()(S),ne=l()(P),ie=l()(E),ae=l()(C),oe=l()(M),se=l()(k),le=l()(I),ce=l()(A),ue=l()(z),he=l()(D),de=l()(L),pe=l()(R),fe=l()(F),me=l()(B),ge=l()(O),_e=l()(N);V.push([e.id,`.maplibregl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgb(0, 0, 0, 0)}.maplibregl-canvas{left:0;position:absolute;top:0}.maplibregl-map:fullscreen{height:100%;width:100%}.maplibregl-ctrl-group button.maplibregl-ctrl-compass{touch-action:none}.maplibregl-canvas-container.maplibregl-interactive,.maplibregl-ctrl-group button.maplibregl-ctrl-compass{cursor:grab;-webkit-user-select:none;-moz-user-select:none;user-select:none}.maplibregl-canvas-container.maplibregl-interactive.maplibregl-track-pointer{cursor:pointer}.maplibregl-canvas-container.maplibregl-interactive:active,.maplibregl-ctrl-group button.maplibregl-ctrl-compass:active{cursor:grabbing}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-canvas-container.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:pinch-zoom}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:none}.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures,.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-ctrl-bottom-left,.maplibregl-ctrl-bottom-right,.maplibregl-ctrl-top-left,.maplibregl-ctrl-top-right{pointer-events:none;position:absolute;z-index:2}.maplibregl-ctrl-top-left{left:0;top:0}.maplibregl-ctrl-top-right{right:0;top:0}.maplibregl-ctrl-bottom-left{bottom:0;left:0}.maplibregl-ctrl-bottom-right{bottom:0;right:0}.maplibregl-ctrl{clear:both;pointer-events:auto;transform:translate(0)}.maplibregl-ctrl-top-left .maplibregl-ctrl{float:left;margin:10px 0 0 10px}.maplibregl-ctrl-top-right .maplibregl-ctrl{float:right;margin:10px 10px 0 0}.maplibregl-ctrl-bottom-left .maplibregl-ctrl{float:left;margin:0 0 10px 10px}.maplibregl-ctrl-bottom-right .maplibregl-ctrl{float:right;margin:0 10px 10px 0}.maplibregl-ctrl-group{background:#fff;border-radius:4px}.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0, 0, 0, 0.1)}@media(forced-colors: active){.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.maplibregl-ctrl-group button{background-color:transparent;border:0;box-sizing:border-box;cursor:pointer;display:block;height:29px;outline:none;padding:0;width:29px}.maplibregl-ctrl-group button+button{border-top:1px solid #ddd}.maplibregl-ctrl button .maplibregl-ctrl-icon{background-position:50%;background-repeat:no-repeat;display:block;height:100%;width:100%}@media(forced-colors: active){.maplibregl-ctrl-icon{background-color:transparent}.maplibregl-ctrl-group button+button{border-top:1px solid ButtonText}}.maplibregl-ctrl button::-moz-focus-inner{border:0;padding:0}.maplibregl-ctrl-attrib-button:focus,.maplibregl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl button:disabled{cursor:not-allowed}.maplibregl-ctrl button:disabled .maplibregl-ctrl-icon{opacity:.25}@media(hover: hover){.maplibregl-ctrl button:not(:disabled):hover{background-color:rgba(0, 0, 0, 0.05)}}.maplibregl-ctrl button:not(:disabled):active{background-color:rgba(0, 0, 0, 0.05)}.maplibregl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.maplibregl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.maplibregl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.maplibregl-ctrl-group button:focus:only-child{border-radius:inherit}.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(${j})}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(${U})}@media(forced-colors: active){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(${G})}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(${q})}}@media(forced-colors: active)and (prefers-color-scheme: light){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(${$})}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(${Z})}}.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(${H})}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(${W})}@media(forced-colors: active){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(${X})}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(${Y})}}@media(forced-colors: active)and (prefers-color-scheme: light){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(${K})}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(${W})}}.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(${Q})}@media(forced-colors: active){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(${J})}}@media(forced-colors: active)and (prefers-color-scheme: light){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(${ee})}}.maplibregl-ctrl button.maplibregl-ctrl-globe .maplibregl-ctrl-icon{background-image:url(${te})}.maplibregl-ctrl button.maplibregl-ctrl-globe-enabled .maplibregl-ctrl-icon{background-image:url(${re})}.maplibregl-ctrl button.maplibregl-ctrl-terrain .maplibregl-ctrl-icon{background-image:url(${ne})}.maplibregl-ctrl button.maplibregl-ctrl-terrain-enabled .maplibregl-ctrl-icon{background-image:url(${ie})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(${ae})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(${oe})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url(${se})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url(${le})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url(${ce})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url(${ue})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-waiting .maplibregl-ctrl-icon{animation:maplibregl-spin 2s linear infinite}@media(forced-colors: active){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(${he})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(${de})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url(${se})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url(${le})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url(${ce})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url(${ue})}}@media(forced-colors: active)and (prefers-color-scheme: light){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(${pe})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(${fe})}}@keyframes maplibregl-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}a.maplibregl-ctrl-logo{background-image:url(${me});background-repeat:no-repeat;cursor:pointer;display:block;height:23px;margin:0 0 -4px -4px;overflow:hidden;width:88px}a.maplibregl-ctrl-logo.maplibregl-compact{width:14px}@media(forced-colors: active){a.maplibregl-ctrl-logo{background-color:transparent;background-image:url(${me})}}@media(forced-colors: active)and (prefers-color-scheme: light){a.maplibregl-ctrl-logo{background-image:url(${me})}}.maplibregl-ctrl.maplibregl-ctrl-attrib{background-color:hsla(0, 0%, 100%, 0.5);margin:0;padding:0 5px}@media screen{.maplibregl-ctrl-attrib.maplibregl-compact{background-color:#fff;border-radius:12px;box-sizing:content-box;color:#000;margin:10px;min-height:20px;padding:2px 24px 2px 0;position:relative}.maplibregl-ctrl-attrib.maplibregl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact-show,.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact-show{border-radius:12px;padding:2px 8px 2px 28px}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-inner{display:none}.maplibregl-ctrl-attrib-button{background-color:hsla(0, 0%, 100%, 0.5);background-image:url(${ge});border:0;border-radius:12px;box-sizing:border-box;cursor:pointer;display:none;height:24px;outline:none;position:absolute;right:0;top:0;width:24px}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;list-style:none}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button::-webkit-details-marker{display:none}.maplibregl-ctrl-bottom-left .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-top-left .maplibregl-ctrl-attrib-button{left:0}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-inner{display:block}.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-button{background-color:rgba(0, 0, 0, 0.05)}.maplibregl-ctrl-bottom-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;right:0}.maplibregl-ctrl-top-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{right:0;top:0}.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{left:0;top:0}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;left:0}}@media screen and (forced-colors: active){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url(${_e})}}@media screen and (forced-colors: active)and (prefers-color-scheme: light){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url(${ge})}}.maplibregl-ctrl-attrib a{color:rgba(0, 0, 0, 0.75);text-decoration:none}.maplibregl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.maplibregl-attrib-empty{display:none}.maplibregl-ctrl-scale{background-color:hsla(0, 0%, 100%, 0.75);border:2px solid #333;border-top:#333;box-sizing:border-box;color:#333;font-size:10px;padding:0 5px;white-space:nowrap}.maplibregl-popup{display:flex;left:0;pointer-events:none;position:absolute;top:0;will-change:transform}.maplibregl-popup-anchor-top,.maplibregl-popup-anchor-top-left,.maplibregl-popup-anchor-top-right{flex-direction:column}.maplibregl-popup-anchor-bottom,.maplibregl-popup-anchor-bottom-left,.maplibregl-popup-anchor-bottom-right{flex-direction:column-reverse}.maplibregl-popup-anchor-left{flex-direction:row}.maplibregl-popup-anchor-right{flex-direction:row-reverse}.maplibregl-popup-tip{border:10px solid transparent;height:0;width:0;z-index:1}.maplibregl-popup-anchor-top .maplibregl-popup-tip{align-self:center;border-bottom-color:#fff;border-top:none}.maplibregl-popup-anchor-top-left .maplibregl-popup-tip{align-self:flex-start;border-bottom-color:#fff;border-left:none;border-top:none}.maplibregl-popup-anchor-top-right .maplibregl-popup-tip{align-self:flex-end;border-bottom-color:#fff;border-right:none;border-top:none}.maplibregl-popup-anchor-bottom .maplibregl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.maplibregl-popup-anchor-left .maplibregl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.maplibregl-popup-anchor-right .maplibregl-popup-tip{align-self:center;border-left-color:#fff;border-right:none}.maplibregl-popup-close-button{background-color:transparent;border:0;border-radius:0 3px 0 0;cursor:pointer;position:absolute;right:0;top:0}.maplibregl-popup-close-button:hover{background-color:rgba(0, 0, 0, 0.05)}.maplibregl-popup-content{background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0, 0, 0, 0.1);padding:15px 10px;pointer-events:auto;position:relative}.maplibregl-popup-anchor-top-left .maplibregl-popup-content{border-top-left-radius:0}.maplibregl-popup-anchor-top-right .maplibregl-popup-content{border-top-right-radius:0}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-content{border-bottom-left-radius:0}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-content{border-bottom-right-radius:0}.maplibregl-popup-track-pointer{display:none}.maplibregl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.maplibregl-map:hover .maplibregl-popup-track-pointer{display:flex}.maplibregl-map:active .maplibregl-popup-track-pointer{display:none}.maplibregl-marker{left:0;position:absolute;top:0;transition:opacity .2s;will-change:transform}.maplibregl-user-location-dot,.maplibregl-user-location-dot:before{background-color:#1da1f2;border-radius:50%;height:15px;width:15px}.maplibregl-user-location-dot:before{animation:maplibregl-user-location-dot-pulse 2s infinite;content:"";position:absolute}.maplibregl-user-location-dot:after{border:2px solid #fff;border-radius:50%;box-shadow:0 0 3px rgba(0, 0, 0, 0.35);box-sizing:border-box;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px}@keyframes maplibregl-user-location-dot-pulse{0%{opacity:1;transform:scale(1)}70%{opacity:0;transform:scale(3)}to{opacity:0;transform:scale(1)}}.maplibregl-user-location-dot-stale{background-color:#aaa}.maplibregl-user-location-dot-stale:after{display:none}.maplibregl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);border-radius:100%;height:1px;width:1px}.maplibregl-crosshair,.maplibregl-crosshair .maplibregl-interactive,.maplibregl-crosshair .maplibregl-interactive:active{cursor:crosshair}.maplibregl-boxzoom{background:#fff;border:2px dotted #202020;height:0;left:0;opacity:.5;position:absolute;top:0;width:0}.maplibregl-cooperative-gesture-screen{align-items:center;background:rgba(0, 0, 0, 0.4);color:#fff;display:flex;font-size:1.4em;inset:0;justify-content:center;line-height:1.2;opacity:0;padding:1rem;pointer-events:none;position:absolute;transition:opacity 1s ease 1s;z-index:99999}.maplibregl-cooperative-gesture-screen.maplibregl-show{opacity:1;transition:opacity .05s}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:none}@media(hover: none),(pointer: coarse){.maplibregl-cooperative-gesture-screen .maplibregl-desktop-message{display:none}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:block}}.maplibregl-pseudo-fullscreen{height:100% !important;left:0 !important;position:fixed !important;top:0 !important;width:100% !important;z-index:99999}`,""]);const ye=V},9819:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23e58978%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3C/svg%3E"},9869:(e,t)=>{"use strict";var r=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),f=Symbol.iterator,m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,_={};function y(e,t,r){this.props=e,this.context=t,this.refs=_,this.updater=r||m}function v(){}function b(e,t,r){this.props=e,this.context=t,this.refs=_,this.updater=r||m}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var x=b.prototype=new v;x.constructor=b,g(x,y.prototype),x.isPureReactComponent=!0;var w=Array.isArray;function T(){}var S={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function E(e,t,n){var i=n.ref;return{$$typeof:r,type:e,key:t,ref:void 0!==i?i:null,props:n}}function C(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}var M=/\/+/g;function k(e,t){return"object"==typeof e&&null!==e&&null!=e.key?(r=""+e.key,n={"=":"=0",":":"=2"},"$"+r.replace(/[=:]/g,function(e){return n[e]})):t.toString(36);var r,n}function I(e,t,i,a,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(s){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case r:case n:u=!0;break;case d:return I((u=e._init)(e._payload),t,i,a,o)}}if(u)return o=o(e),u=""===a?"."+k(e,0):a,w(o)?(i="",null!=u&&(i=u.replace(M,"$&/")+"/"),I(o,t,i,"",function(e){return e})):null!=o&&(C(o)&&(l=o,c=i+(null==o.key||e&&e.key===o.key?"":(""+o.key).replace(M,"$&/")+"/")+u,o=E(l.type,c,l.props)),t.push(o)),1;u=0;var h,p=""===a?".":a+":";if(w(e))for(var m=0;m<e.length;m++)u+=I(a=e[m],t,i,s=p+k(a,m),o);else if("function"==typeof(m=null===(h=e)||"object"!=typeof h?null:"function"==typeof(h=f&&h[f]||h["@@iterator"])?h:null))for(e=m.call(e),m=0;!(a=e.next()).done;)u+=I(a=a.value,t,i,s=p+k(a,m++),o);else if("object"===s){if("function"==typeof e.then)return I(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"==typeof e.status?e.then(T,T):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,i,a,o);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function A(e,t,r){if(null==e)return e;var n=[],i=0;return I(e,n,"","",function(e){return t.call(r,e,i++)}),n}function z(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},L={map:A,forEach:function(e,t,r){A(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return A(e,function(){t++}),t},toArray:function(e){return A(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=p,t.Children=L,t.Component=y,t.Fragment=i,t.Profiler=o,t.PureComponent=b,t.StrictMode=a,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return S.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,r){if(null==e)throw Error("The argument must be a React element, but you passed "+e+".");var n=g({},e.props),i=e.key;if(null!=t)for(a in void 0!==t.key&&(i=""+t.key),t)!P.call(t,a)||"key"===a||"__self"===a||"__source"===a||"ref"===a&&void 0===t.ref||(n[a]=t[a]);var a=arguments.length-2;if(1===a)n.children=r;else if(1<a){for(var o=Array(a),s=0;s<a;s++)o[s]=arguments[s+2];n.children=o}return E(e.type,i,n)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:s,_context:e},e},t.createElement=function(e,t,r){var n,i={},a=null;if(null!=t)for(n in void 0!==t.key&&(a=""+t.key),t)P.call(t,n)&&"key"!==n&&"__self"!==n&&"__source"!==n&&(i[n]=t[n]);var o=arguments.length-2;if(1===o)i.children=r;else if(1<o){for(var s=Array(o),l=0;l<o;l++)s[l]=arguments[l+2];i.children=s}if(e&&e.defaultProps)for(n in o=e.defaultProps)void 0===i[n]&&(i[n]=o[n]);return E(e,a,i)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:z}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=S.T,r={};S.T=r;try{var n=e(),i=S.S;null!==i&&i(r,n),"object"==typeof n&&null!==n&&"function"==typeof n.then&&n.then(T,D)}catch(e){D(e)}finally{null!==t&&null!==r.types&&(t.types=r.types),S.T=t}},t.unstable_useCacheRefresh=function(){return S.H.useCacheRefresh()},t.use=function(e){return S.H.use(e)},t.useActionState=function(e,t,r){return S.H.useActionState(e,t,r)},t.useCallback=function(e,t){return S.H.useCallback(e,t)},t.useContext=function(e){return S.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return S.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return S.H.useEffect(e,t)},t.useEffectEvent=function(e){return S.H.useEffectEvent(e)},t.useId=function(){return S.H.useId()},t.useImperativeHandle=function(e,t,r){return S.H.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return S.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return S.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return S.H.useMemo(e,t)},t.useOptimistic=function(e,t){return S.H.useOptimistic(e,t)},t.useReducer=function(e,t,r){return S.H.useReducer(e,t,r)},t.useRef=function(e){return S.H.useRef(e)},t.useState=function(e){return S.H.useState(e)},t.useSyncExternalStore=function(e,t,r){return S.H.useSyncExternalStore(e,t,r)},t.useTransition=function(){return S.H.useTransition()},t.version="19.2.0"},9982:(e,t,r)=>{"use strict";e.exports=r(4477)}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={id:n,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.exports}r.m=e,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.b="undefined"!=typeof document&&document.baseURI||self.location.href,r.nc=void 0,r(7187)})();